# Comparing `tmp/odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0-py3-none-any.whl.zip` & `tmp/odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,14 @@
-Zip file size: 60465 bytes, number of entries: 20
--rw-r--r--  2.0 unx     1277 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/README.rst
--rw-r--r--  2.0 unx      181 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/__init__.py
--rw-r--r--  2.0 unx      863 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/__manifest__.py
--rw-r--r--  2.0 unx      638 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/data/base_automation_data.xml
--rw-r--r--  2.0 unx      466 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/data/ir_actions_server_data.xml
--rw-r--r--  2.0 unx      889 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/data/policy_template_data.xml
--rw-r--r--  2.0 unx      286 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/models/__init__.py
--rw-r--r--  2.0 unx     4206 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/models/inventory_closing.py
--rw-r--r--  2.0 unx     1230 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/models/inventory_closing_queue_job_batch.py
--rw-r--r--  2.0 unx      366 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/models/inventory_closing_type.py
--rw-r--r--  2.0 unx      796 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/models/stock_valuation_layer.py
--rw-r--r--  2.0 unx      211 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/security/ir.model.access.csv
--rw-r--r--  2.0 unx    48333 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/static/description/icon.png
--rw-r--r--  2.0 unx      954 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/views/inventory_closing_type_views.xml
--rw-r--r--  2.0 unx     2188 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/views/inventory_closing_views.xml
--rw-r--r--  2.0 unx     1161 b- defN 24-Mar-26 03:39 odoo/addons/ssi_inventory_closing_queue/views/stock_valuation_layer_views.xml
--rw-r--r--  2.0 unx     1876 b- defN 24-Mar-26 03:39 odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Mar-26 03:39 odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 24-Mar-26 03:39 odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2431 b- defN 24-Mar-26 03:39 odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/RECORD
-20 files, 68449 bytes uncompressed, 56205 bytes compressed:  17.9%
+Zip file size: 54613 bytes, number of entries: 12
+-rw-r--r--  2.0 unx     1277 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/README.rst
+-rw-r--r--  2.0 unx      181 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/__init__.py
+-rw-r--r--  2.0 unx      728 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/__manifest__.py
+-rw-r--r--  2.0 unx     1009 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/data/base_automation_data.xml
+-rw-r--r--  2.0 unx      950 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/data/ir_actions_server_data.xml
+-rw-r--r--  2.0 unx      192 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/models/__init__.py
+-rw-r--r--  2.0 unx     2949 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/models/inventory_closing.py
+-rw-r--r--  2.0 unx    48333 b- defN 24-May-11 15:14 odoo/addons/ssi_inventory_closing_queue/static/description/icon.png
+-rw-r--r--  2.0 unx     2000 b- defN 24-May-11 15:14 odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-11 15:14 odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 24-May-11 15:14 odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1390 b- defN 24-May-11 15:14 odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/RECORD
+12 files, 59106 bytes uncompressed, 52143 bytes compressed:  11.8%
```

## zipnote {}

```diff
@@ -9,53 +9,29 @@
 
 Filename: odoo/addons/ssi_inventory_closing_queue/data/base_automation_data.xml
 Comment: 
 
 Filename: odoo/addons/ssi_inventory_closing_queue/data/ir_actions_server_data.xml
 Comment: 
 
-Filename: odoo/addons/ssi_inventory_closing_queue/data/policy_template_data.xml
-Comment: 
-
 Filename: odoo/addons/ssi_inventory_closing_queue/models/__init__.py
 Comment: 
 
 Filename: odoo/addons/ssi_inventory_closing_queue/models/inventory_closing.py
 Comment: 
 
-Filename: odoo/addons/ssi_inventory_closing_queue/models/inventory_closing_queue_job_batch.py
-Comment: 
-
-Filename: odoo/addons/ssi_inventory_closing_queue/models/inventory_closing_type.py
-Comment: 
-
-Filename: odoo/addons/ssi_inventory_closing_queue/models/stock_valuation_layer.py
-Comment: 
-
-Filename: odoo/addons/ssi_inventory_closing_queue/security/ir.model.access.csv
-Comment: 
-
 Filename: odoo/addons/ssi_inventory_closing_queue/static/description/icon.png
 Comment: 
 
-Filename: odoo/addons/ssi_inventory_closing_queue/views/inventory_closing_type_views.xml
-Comment: 
-
-Filename: odoo/addons/ssi_inventory_closing_queue/views/inventory_closing_views.xml
-Comment: 
-
-Filename: odoo/addons/ssi_inventory_closing_queue/views/stock_valuation_layer_views.xml
-Comment: 
-
-Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/METADATA
+Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/WHEEL
+Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/top_level.txt
+Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/RECORD
+Filename: odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/ssi_inventory_closing_queue/__manifest__.py

```diff
@@ -1,28 +1,25 @@
 # Copyright 2024 OpenSynergy Indonesia
 # Copyright 2024 PT. Simetri Sinergi Indonesia
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 {
     "name": "Inventory Closing Queue",
-    "version": "14.0.1.1.0",
+    "version": "14.0.2.0.0",
     "website": "https://simetri-sinergi.id",
     "author": "PT. Simetri Sinergi Indonesia, OpenSynergy Indonesia",
     "license": "AGPL-3",
     "installable": True,
     "depends": [
         "queue_job_batch",
         "ssi_inventory_closing",
+        "ssi_transaction_queue_done_mixin",
+        "ssi_transaction_queue_cancel_mixin",
         "base_automation",
     ],
     "data": [
-        "security/ir.model.access.csv",
         "data/ir_actions_server_data.xml",
         "data/base_automation_data.xml",
-        "data/policy_template_data.xml",
-        "views/inventory_closing_views.xml",
-        "views/inventory_closing_type_views.xml",
-        "views/stock_valuation_layer_views.xml",
     ],
     "demo": [],
     "images": [],
 }
```

## odoo/addons/ssi_inventory_closing_queue/data/base_automation_data.xml

### odoo/addons/ssi_inventory_closing_queue/data/base_automation_data.xml

```diff
@@ -1,14 +1,20 @@
 <?xml version="1.0" encoding="utf-8"?>
 <odoo>
   <!-- Copyright 2022 OpenSynergy Indonesia
      Copyright 2022 PT. Simetri Sinergi Indonesia
      License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->
   <data>
     <record id="inventory_closing_done" model="base.automation">
-      <field name="action_server_id" ref="inventory_closing_action_done"/>
+      <field name="action_server_id" ref="inventory_closing_action_recompute_queue_done_result"/>
       <field name="trigger">on_write</field>
-      <field name="filter_pre_domain">[('state','=','confirm'), ('all_job_finished','=',False)]</field>
-      <field name="filter_domain">[('state','=','confirm'), ('all_job_finished','=',True)]</field>
+      <field name="filter_pre_domain">[]</field>
+      <field name="filter_domain">[('done_queue_job_batch_state','=','finished')]</field>
+    </record>
+    <record id="inventory_closing_cancel" model="base.automation">
+      <field name="action_server_id" ref="inventory_closing_action_recompute_queue_cancel_result"/>
+      <field name="trigger">on_write</field>
+      <field name="filter_pre_domain">[]</field>
+      <field name="filter_domain">[('cancel_queue_job_batch_state','=','finished')]</field>
     </record>
   </data>
 </odoo>
```

## odoo/addons/ssi_inventory_closing_queue/data/ir_actions_server_data.xml

### odoo/addons/ssi_inventory_closing_queue/data/ir_actions_server_data.xml

```diff
@@ -1,14 +1,20 @@
 <?xml version="1.0" encoding="utf-8"?>
 <odoo>
   <!-- Copyright 2024 OpenSynergy Indonesia
      Copyright 2024 PT. Simetri Sinergi Indonesia
      License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->
   <data>
-    <record id="inventory_closing_action_done" model="ir.actions.server">
-      <field name="name">Action Done</field>
+    <record id="inventory_closing_action_recompute_queue_done_result" model="ir.actions.server">
+      <field name="name">Action Recompute Queue Done Result</field>
       <field name="model_id" ref="model_inventory_closing"/>
       <field name="state">code</field>
-      <field name="code">records.action_done()</field>
+      <field name="code">records.action_recompute_queue_done_result()</field>
+    </record>
+    <record id="inventory_closing_action_recompute_queue_cancel_result" model="ir.actions.server">
+      <field name="name">Action Recompute Queue Cancel Result</field>
+      <field name="model_id" ref="model_inventory_closing"/>
+      <field name="state">code</field>
+      <field name="code">records.action_recompute_queue_cancel_result()</field>
     </record>
   </data>
 </odoo>
```

## odoo/addons/ssi_inventory_closing_queue/models/__init__.py

```diff
@@ -1,10 +1,7 @@
 # Copyright 2024 OpenSynergy Indonesia
 # Copyright 2024 PT. Simetri Sinergi Indonesia
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 from . import (
-    stock_valuation_layer,
-    inventory_closing_type,
-    inventory_closing_queue_job_batch,
     inventory_closing,
 )
```

## odoo/addons/ssi_inventory_closing_queue/models/inventory_closing.py

```diff
@@ -1,129 +1,89 @@
 # Copyright 2024 OpenSynergy Indonesia
 # Copyright 2024 PT. Simetri Sinergi Indonesia
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 
-from odoo import _, api, fields, models
+from odoo import _, api, models
 
 from odoo.addons.ssi_decorator import ssi_decorator
 
 
 class InventoryClosing(models.Model):
-    _inherit = "inventory_closing"
-
-    _after_approved_method = False
-
-    queue_job_batch_ids = fields.One2many(
-        string="Queue Job Batch(s)",
-        comodel_name="inventory_closing_queue_job_batch",
-        inverse_name="inventory_closing_id",
-    )
-
-    @api.depends(
-        "queue_job_batch_ids",
-        "queue_job_batch_ids.job_batch_state",
-    )
-    def _compute_all_job_finished(self):
-        for rec in self:
-            job_not_finish_ids = rec.queue_job_batch_ids.filtered(
-                lambda x: x.job_batch_state != "finished"
-            )
-            if len(job_not_finish_ids) > 0:
-                rec.all_job_finished = False
-            else:
-                rec.all_job_finished = True
-
-    all_job_finished = fields.Boolean(
-        string="All Job Finished",
-        compute="_compute_all_job_finished",
-        store=True,
-    )
-
-    def _check_all_finished(self):
-        self.ensure_one()
-        result = True
-        for job_batch in self.queue_job_batch_ids:
-            if job_batch.job_batch_state != "finished":
-                result = False
-                break
-        return result
-
-    def _prepare_ic_queue_job_batch_data(self, batch_id):
-        data = {
-            "inventory_closing_id": self.id,
-            "job_batch_id": batch_id,
-        }
-        return data
-
-    def create_ic_queue_job_batch(self, batch_id):
-        self.ensure_one()
-        obj_ic_queue_job_batch = self.env["inventory_closing_queue_job_batch"]
-        obj_ic_queue_job_batch.create(self._prepare_ic_queue_job_batch_data(batch_id))
-        return True
-
-    def _create_aml_from_svl(self, svl_ids, index):
-        self.ensure_one()
-        queue_job_obj = self.env["queue.job"]
-        str_group = "[%s] Inventory Closing Batch for ID %s" % (str(index), self.id)
-        batch = self.env["queue.job.batch"].get_new_batch(str_group)
-        for svl in svl_ids:
-            description = "Create AML From SVL for ID %s" % (self.id)
-            job = (
-                svl.with_context(job_batch=batch)
-                .with_delay(description=_(description))
-                ._create_accounting_entry()
-            )
-            criteria = [("uuid", "=", job.uuid)]
-            job_id = queue_job_obj.search(criteria, limit=1, order="id desc").id
-            svl.update(
-                {
-                    "job_id": job_id,
-                }
-            )
-        batch.enqueue()
-        self.create_ic_queue_job_batch(batch.id)
+    _inherit = [
+        "mixin.transaction_queue_cancel",
+        "mixin.transaction_queue_done",
+        "inventory_closing",
+    ]
+    _name = "inventory_closing"
+
+    _after_approved_method = "action_queue_done"
+    _statusbar_visible_label = "draft,confirm,queue_done,done"
+
+    # Attributes related to add element on view automatically
+    _automatically_insert_view_element = True
+    _automatically_insert_multiple_approval_page = True
+    _queue_processing_create_page = True
+    _automatically_insert_queue_done_button = False
+    _automatically_insert_queue_cancel_button = False
+
+    _queue_to_done_insert_form_element_ok = True
+    _queue_to_done_form_xpath = "//group[@name='queue_processing']"
+
+    _queue_to_cancel_insert_form_element_ok = True
+    _queue_to_cancel_form_xpath = "//group[@name='queue_processing']"
+
+    _method_to_run_from_wizard = "action_queue_cancel"
+
+    @ssi_decorator.post_queue_done_action()
+    def _02_create_aml_from_svl_on_queue_done(self):
+        self.ensure_one()
+        for svl in self.stock_valuation_layer_ids:
+            description = "Create AML From SVL ID %s" % (svl.id)
+            svl.with_context(job_batch=self.done_queue_job_batch_id).with_delay(
+                description=_(description)
+            )._create_accounting_entry()
 
     @ssi_decorator.post_done_action()
     def _01_update_svl_journal(self):
         self.ensure_one()
         return True
 
     @ssi_decorator.post_done_action()
     def _02_create_aml_from_svl(self):
         self.ensure_one()
         return True
 
-    @ssi_decorator.post_approve_action()
-    def _01_post_update_svl_journal(self):
+    @ssi_decorator.post_queue_done_action()
+    def _01_update_svl_journal_on_queue_done(self):
         self.ensure_one()
         for move in self.stock_move_ids:
             if not move.journal_id:
                 move.picking_id.write(
                     {
                         "journal_id": self.journal_id.id,
                     }
                 )
 
-    @ssi_decorator.post_approve_action()
-    def _02_post_create_aml_from_svl(self):
+    @ssi_decorator.post_cancel_action()
+    def _01_delete_aml(self):
+        self.ensure_one()
+        return True
+
+    @ssi_decorator.post_queue_cancel_action()
+    def _01_delete_aml_on_queue_cancel(self):
         self.ensure_one()
-        svl_ids = self.stock_valuation_layer_ids.filtered(lambda x: not x.job_id)
-        if svl_ids:
-            batch_job_limit = self.type_id.batch_job_limit
-            for index, i in enumerate(range(0, len(svl_ids), batch_job_limit), start=1):
-                self._create_aml_from_svl(svl_ids[i : i + batch_job_limit], index)
-        else:
-            self._requeue_job_batch()
-
-    def _requeue_job_batch(self):
-        self.ensure_one()
-        svl_ids = self.stock_valuation_layer_ids.filtered(
-            lambda x: x.job_state != "done"
-        )
-        if svl_ids:
-            for svl in svl_ids:
-                svl.job_id.requeue()
-
-    def action_requeue(self):
-        for record in self.sudo():
-            record._requeue_job_batch()
+        for svl in self.stock_valuation_layer_ids:
+            description = "Delete AML From SVL ID %s" % (svl.id)
+            svl.with_context(job_batch=self.cancel_queue_job_batch_id).with_delay(
+                description=_(description)
+            )._delete_accounting_entry()
+
+    @api.model
+    def _get_policy_field(self):
+        res = super(InventoryClosing, self)._get_policy_field()
+        policy_field = [
+            "queue_done_ok",
+            "queue_cancel_ok",
+        ]
+        res += policy_field
+        return res
```

## Comparing `odoo14_addon_ssi_inventory_closing_queue-14.0.1.1.0.dist-info/METADATA` & `odoo14_addon_ssi_inventory_closing_queue-14.0.2.0.0.dist-info/METADATA`

 * *Files 8% similar despite different names*

```diff
@@ -1,22 +1,24 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-ssi-inventory-closing-queue
-Version: 14.0.1.1.0
+Version: 14.0.2.0.0
 Summary: Inventory Closing Queue
 Home-page: https://simetri-sinergi.id
 Author: PT. Simetri Sinergi Indonesia, OpenSynergy Indonesia
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
 Classifier: Framework :: Odoo :: 14.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
 Requires-Python: >=3.6
 Requires-Dist: odoo14-addon-queue-job-batch
 Requires-Dist: odoo14-addon-ssi-inventory-closing
+Requires-Dist: odoo14-addon-ssi-transaction-queue-cancel-mixin
+Requires-Dist: odoo14-addon-ssi-transaction-queue-done-mixin
 Requires-Dist: odoo <14.1dev,>=14.0a
 
 .. image:: https://img.shields.io/badge/licence-AGPL--3-blue.svg
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
 
 =======================
```

