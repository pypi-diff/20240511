# Comparing `tmp/odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0-py3-none-any.whl.zip` & `tmp/odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 60472 bytes, number of entries: 20
--rw-r--r--  2.0 unx     1232 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/README.rst
--rw-r--r--  2.0 unx      194 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/__init__.py
--rw-r--r--  2.0 unx      776 b- defN 23-Dec-30 14:52 odoo/addons/ssi_transaction_cancel_mixin/__manifest__.py
--rw-r--r--  2.0 unx      818 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/demo/base_cancel_reason_demo.xml
--rw-r--r--  2.0 unx      237 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/models/__init__.py
--rw-r--r--  2.0 unx      679 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/models/base_cancel_reason.py
--rw-r--r--  2.0 unx     1073 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/models/ir_model.py
--rw-r--r--  2.0 unx     7198 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/models/mixin_transaction_cancel.py
--rw-r--r--  2.0 unx      375 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/security/ir.model.access.csv
--rw-r--r--  2.0 unx    48333 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/static/description/icon.png
--rw-r--r--  2.0 unx      771 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/templates/mixin_transaction_cancel_templates.xml
--rw-r--r--  2.0 unx     2308 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/views/base_cancel_reason_views.xml
--rw-r--r--  2.0 unx      679 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/views/ir_model_views.xml
--rw-r--r--  2.0 unx      200 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/wizards/__init__.py
--rw-r--r--  2.0 unx     1684 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason.py
--rw-r--r--  2.0 unx     1498 b- defN 23-Dec-30 14:51 odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason_views.xml
--rw-r--r--  2.0 unx     1799 b- defN 23-Dec-30 14:55 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Dec-30 14:55 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Dec-30 14:55 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2438 b- defN 23-Dec-30 14:55 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/RECORD
-20 files, 72389 bytes uncompressed, 56200 bytes compressed:  22.4%
+Zip file size: 60744 bytes, number of entries: 20
+-rw-r--r--  2.0 unx     1232 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/README.rst
+-rw-r--r--  2.0 unx      194 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/__init__.py
+-rw-r--r--  2.0 unx      776 b- defN 24-Apr-08 04:44 odoo/addons/ssi_transaction_cancel_mixin/__manifest__.py
+-rw-r--r--  2.0 unx      818 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/demo/base_cancel_reason_demo.xml
+-rw-r--r--  2.0 unx      237 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/models/__init__.py
+-rw-r--r--  2.0 unx      679 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/models/base_cancel_reason.py
+-rw-r--r--  2.0 unx     1073 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/models/ir_model.py
+-rw-r--r--  2.0 unx     8279 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/models/mixin_transaction_cancel.py
+-rw-r--r--  2.0 unx      375 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/security/ir.model.access.csv
+-rw-r--r--  2.0 unx    48333 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/static/description/icon.png
+-rw-r--r--  2.0 unx      981 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/templates/mixin_transaction_cancel_templates.xml
+-rw-r--r--  2.0 unx     2308 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/views/base_cancel_reason_views.xml
+-rw-r--r--  2.0 unx      679 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/views/ir_model_views.xml
+-rw-r--r--  2.0 unx      200 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/wizards/__init__.py
+-rw-r--r--  2.0 unx     1684 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason.py
+-rw-r--r--  2.0 unx     1498 b- defN 24-Apr-08 04:43 odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason_views.xml
+-rw-r--r--  2.0 unx     1797 b- defN 24-Apr-08 04:44 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-08 04:44 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 24-Apr-08 04:44 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2438 b- defN 24-Apr-08 04:44 odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/RECORD
+20 files, 73678 bytes uncompressed, 56472 bytes compressed:  23.4%
```

## zipnote {}

```diff
@@ -42,20 +42,20 @@
 
 Filename: odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason.py
 Comment: 
 
 Filename: odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason_views.xml
 Comment: 
 
-Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/METADATA
+Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/WHEEL
+Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/top_level.txt
+Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/RECORD
+Filename: odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/ssi_transaction_cancel_mixin/__manifest__.py

```diff
@@ -1,13 +1,13 @@
 # Copyright 2022 OpenSynergy Indonesia
 # Copyright 2022 PT. Simetri Sinergi Indonesia
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/lgpl).
 {
     "name": "Transaction Mixin - Cancel State",
-    "version": "14.0.1.8.0",
+    "version": "14.0.1.9.0",
     "website": "https://simetri-sinergi.id",
     "author": "OpenSynergy Indonesia, PT. Simetri Sinergi Indonesia",
     "license": "AGPL-3",
     "installable": True,
     "depends": [
         "ssi_transaction_mixin",
     ],
```

## odoo/addons/ssi_transaction_cancel_mixin/models/mixin_transaction_cancel.py

```diff
@@ -2,15 +2,18 @@
 # Copyright 2022 PT. Simetri Sinergi Indonesia
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/lgpl).
 
 from inspect import getmembers
 
 from lxml import etree
 
-from odoo import api, fields, models
+from odoo import _, api, fields, models
+from odoo.exceptions import UserError
+
+from odoo.addons.ssi_decorator import ssi_decorator
 
 
 class MixinTransactionCancel(models.AbstractModel):
     _name = "mixin.transaction_cancel"
     _inherit = [
         "mixin.transaction",
     ]
@@ -95,20 +98,38 @@
             if self.is_decorator(func, "_post_cancel_action"):
                 methods.append(func)
         if methods:
             self.run_decorator_method(methods)
 
     def action_cancel(self, cancel_reason=False):
         for record in self.sudo():
+            record._check_cancel_policy()
             record._run_pre_cancel_check()
             record._run_pre_cancel_action()
             record.write(record._prepare_cancel_data(cancel_reason))
             record._run_post_cancel_check()
             record._run_post_cancel_action()
 
+    def _check_cancel_policy(self):
+        self.ensure_one()
+        if self.env.context.get("bypass_cancel_policy", False):
+            return True
+
+        if not self.cancel_ok:
+            error_message = """
+                Context: Cancel %s
+                Database ID: %s
+                Problem: Document is not allowed to cancel
+                Solution: Check cancel policy prerequisite
+                """ % (
+                self._description.lower(),
+                self.id,
+            )
+            raise UserError(_(error_message))
+
     def _prepare_restart_data(self):
         self.ensure_one()
         _super = super(MixinTransactionCancel, self)
         result = _super._prepare_restart_data()
         result.update(
             {
                 "cancel_reason_id": False,
@@ -201,7 +222,18 @@
             view_arch = self._add_view_element(
                 view_arch,
                 "ssi_transaction_cancel_mixin.cancel_reason",
                 "/form/sheet/div[@class='oe_left']/div[@class='oe_title']/h1",
                 "after",
             )
         return view_arch
+
+    @ssi_decorator.insert_on_tree_view()
+    def _01_view_add_tree_cancel_button(self, view_arch):
+        if self._automatically_insert_confirm_button:
+            view_arch = self._add_view_element(
+                view_arch,
+                "ssi_transaction_cancel_mixin.tree_button_cancel",
+                "/tree/header",
+                "inside",
+            )
+        return view_arch
```

## odoo/addons/ssi_transaction_cancel_mixin/templates/mixin_transaction_cancel_templates.xml

### odoo/addons/ssi_transaction_cancel_mixin/templates/mixin_transaction_cancel_templates.xml

```diff
@@ -2,14 +2,17 @@
 <odoo>
   <template id="cancel_policy_field">
     <field name="cancel_ok"/>
   </template>
   <template id="button_cancel">
     <button name="%(ssi_transaction_cancel_mixin.base_select_cancel_reason_action)d" string="Cancel" type="action" attrs="{'invisible':[('cancel_ok','!=',True)]}"/>
   </template>
+  <template id="tree_button_cancel">
+    <button name="%(ssi_transaction_cancel_mixin.base_select_cancel_reason_action)d" string="Cancel" type="action"/>
+  </template>
   <template id="cancel_reason">
     <h2 attrs="{'invisible': [('state', '!=', 'cancel')]}">
       <label for="cancel_reason_id" string="Cancellation reason:"/>
       <field name="cancel_reason_id" class="oe_inline"/>
     </h2>
   </template>
   <template id="cancel_filter">
```

## Comparing `odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/METADATA` & `odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,22 +1,22 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-ssi-transaction-cancel-mixin
-Version: 14.0.1.8.0
+Version: 14.0.1.9.0
 Summary: Transaction Mixin - Cancel State
 Home-page: https://simetri-sinergi.id
 Author: OpenSynergy Indonesia, PT. Simetri Sinergi Indonesia
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
 Classifier: Framework :: Odoo :: 14.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
 Requires-Python: >=3.6
 Requires-Dist: odoo14-addon-ssi-transaction-mixin
-Requires-Dist: odoo (<14.1dev,>=14.0a)
+Requires-Dist: odoo <14.1dev,>=14.0a
 
 .. image:: https://img.shields.io/badge/licence-AGPL--3-blue.svg
    :target: http://www.gnu.org/licenses/lgpl-3.0-standalone.html
    :alt: License: AGPL-3
 
 ================================
 Transaction Mixin - Cancel State
```

## Comparing `odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/RECORD` & `odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 odoo/addons/ssi_transaction_cancel_mixin/README.rst,sha256=CGLsclLa0VUFBRWlMt8rRC7sOSUv4EqRp-S_UvcVCaU,1232
 odoo/addons/ssi_transaction_cancel_mixin/__init__.py,sha256=wJoQUI3YmB8vss-Ui-9TK6LnDvTJE7JINkW-jl7BEJs,194
-odoo/addons/ssi_transaction_cancel_mixin/__manifest__.py,sha256=tOkZ5U3lWhQ5G0TnLKBhDyM9nFtWyGLCX3tgxYj29Fs,776
+odoo/addons/ssi_transaction_cancel_mixin/__manifest__.py,sha256=OZhZP3UmTXIEwo3Vz9LSPJbFqoR0UhovFFJdw-NBR8c,776
 odoo/addons/ssi_transaction_cancel_mixin/demo/base_cancel_reason_demo.xml,sha256=Y6QPrAwAUWQFmtoX8eUr8TxHL63NkHSY6jAPNZGtB3Q,818
 odoo/addons/ssi_transaction_cancel_mixin/models/__init__.py,sha256=mUgo_ZJ2qR1Z1ux8fVYpI-3U81-eI7SdFxytt_GcsQo,237
 odoo/addons/ssi_transaction_cancel_mixin/models/base_cancel_reason.py,sha256=pNuH5XxLZW7gevj2xWjBMglCUZaSf5S1exjHkhRSiy0,679
 odoo/addons/ssi_transaction_cancel_mixin/models/ir_model.py,sha256=zZhG-ORTOKEZFfqj0xO3s57pgpDjkW4laXtVYv3Z0R0,1073
-odoo/addons/ssi_transaction_cancel_mixin/models/mixin_transaction_cancel.py,sha256=AdPDSuxbx6D5odKe3aJAROf_BMntYkZHJNRiCUErrD0,7198
+odoo/addons/ssi_transaction_cancel_mixin/models/mixin_transaction_cancel.py,sha256=muLR1UbCmHkoddTcW3jRIO96zvXHyA7StBYkfy2YOTw,8279
 odoo/addons/ssi_transaction_cancel_mixin/security/ir.model.access.csv,sha256=4MahTEuhwQjid3rogXWwwJ2BbS5nukBMBBC_F-pfowg,375
 odoo/addons/ssi_transaction_cancel_mixin/static/description/icon.png,sha256=lNGJOSg4cMRfwPTfFKVT6d5B2N1N83iVpEEN1blqu1I,48333
-odoo/addons/ssi_transaction_cancel_mixin/templates/mixin_transaction_cancel_templates.xml,sha256=LGA8l-1rFng-Upp26M1nYvH3m9ghAJzmj2ALhA9v0ok,771
+odoo/addons/ssi_transaction_cancel_mixin/templates/mixin_transaction_cancel_templates.xml,sha256=oZfT07TsqnUR-sYX9pYkSmihQMjnzUsSXTNLW_zaxsQ,981
 odoo/addons/ssi_transaction_cancel_mixin/views/base_cancel_reason_views.xml,sha256=ylhtl_p8Urb47gXmzbhvkhqkuWYfngAk55hd1eIgPV0,2308
 odoo/addons/ssi_transaction_cancel_mixin/views/ir_model_views.xml,sha256=wCYb6w4t2TyUrXXeVWxYYoYLeRPIBsegw3HqtfCtvsY,679
 odoo/addons/ssi_transaction_cancel_mixin/wizards/__init__.py,sha256=qPWth63bYPufgsDdfE6Tup9Ld-LDombPON0NKo3fJr0,200
 odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason.py,sha256=qM9objMbycccthzRfOAp2EKbpzUh9TQWRigcNqQHLOA,1684
 odoo/addons/ssi_transaction_cancel_mixin/wizards/base_select_cancel_reason_views.xml,sha256=Qj8yqGNe_k0FxAQUFfgyiGD10PY_fTCiL0-X0oK5RBw,1498
-odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/METADATA,sha256=eWrDPiBwK5PAb60bApykUyVOEP_o3FRHrIrSEdcB4lI,1799
-odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.8.0.dist-info/RECORD,,
+odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/METADATA,sha256=FpmRfTKuP7Wokp-HidVtCeAC3MffFN5c4jrJQiLJ70Q,1797
+odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/WHEEL,sha256=oiQVh_5PnQM0E3gPdiz09WCNmwiHDMaGer_elqB3coM,92
+odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_ssi_transaction_cancel_mixin-14.0.1.9.0.dist-info/RECORD,,
```

