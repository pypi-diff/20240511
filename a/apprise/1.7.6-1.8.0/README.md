# Comparing `tmp/apprise-1.7.6.tar.gz` & `tmp/apprise-1.8.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "apprise-1.7.6.tar", last modified: Sun Apr 14 00:12:19 2024, max compression
+gzip compressed data, was "apprise-1.8.0.tar", last modified: Sat May 11 20:13:25 2024, max compression
```

## Comparing `apprise-1.7.6.tar` & `apprise-1.8.0.tar`

### file list

```diff
@@ -1,360 +1,360 @@
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.107314 apprise-1.7.6/
--rw-r--r--   0 l2g       (1000) l2g       (1000)      941 2024-04-10 23:44:32.000000 apprise-1.7.6/KEYWORDS
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1343 2024-01-27 20:33:15.000000 apprise-1.7.6/LICENSE
--rw-r--r--   0 l2g       (1000) l2g       (1000)      237 2023-06-03 19:32:05.000000 apprise-1.7.6/MANIFEST.in
--rw-r--r--   0 l2g       (1000) l2g       (1000)    44618 2024-04-14 00:12:19.107314 apprise-1.7.6/PKG-INFO
--rw-r--r--   0 l2g       (1000) l2g       (1000)    42316 2024-04-10 23:44:32.000000 apprise-1.7.6/README.md
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.068314 apprise-1.7.6/apprise/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    32865 2024-03-30 01:23:37.000000 apprise-1.7.6/apprise/Apprise.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2203 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/Apprise.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11647 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/AppriseAsset.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)      979 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/AppriseAsset.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12540 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/AppriseAttachment.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1145 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/AppriseAttachment.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16909 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/AppriseConfig.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1568 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/AppriseConfig.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8994 2024-04-11 01:21:34.000000 apprise-1.7.6/apprise/AppriseLocale.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2053 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/AttachmentManager.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2058 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/ConfigurationManager.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2041 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/NotificationManager.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    29423 2024-03-29 20:20:13.000000 apprise-1.7.6/apprise/URLBase.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)      520 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/URLBase.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3368 2024-04-14 00:10:26.000000 apprise-1.7.6/apprise/__init__.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.069314 apprise-1.7.6/apprise/assets/
--rw-r--r--   0 l2g       (1000) l2g       (1000)      986 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/NotifyXML-1.0.xsd
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1758 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/NotifyXML-1.1.xsd
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.062314 apprise-1.7.6/apprise/assets/themes/
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.072314 apprise-1.7.6/apprise/assets/themes/default/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-failure-128x128.ico
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16135 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-failure-128x128.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    41931 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-failure-256x256.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2437 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-failure-32x32.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7600 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-failure-72x72.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-info-128x128.ico
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16671 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-info-128x128.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    43331 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-info-256x256.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2485 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-info-32x32.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7875 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-info-72x72.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)   160907 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-logo.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-success-128x128.ico
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17446 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-success-128x128.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    48729 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-success-256x256.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2471 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-success-32x32.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7858 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-success-72x72.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-warning-128x128.ico
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16784 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-warning-128x128.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)    43708 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-warning-256x256.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2472 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-warning-32x32.png
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7913 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/assets/themes/default/apprise-warning-72x72.png
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.072314 apprise-1.7.6/apprise/attachment/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13656 2024-03-29 19:00:10.000000 apprise-1.7.6/apprise/attachment/AttachBase.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)      961 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/attachment/AttachBase.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4765 2024-03-12 22:02:34.000000 apprise-1.7.6/apprise/attachment/AttachFile.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13779 2024-03-29 19:00:10.000000 apprise-1.7.6/apprise/attachment/AttachHTTP.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1658 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/attachment/__init__.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    20697 2024-03-09 21:39:52.000000 apprise-1.7.6/apprise/cli.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5593 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/common.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)      447 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/common.pyi
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.073314 apprise-1.7.6/apprise/config/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    53194 2024-03-29 20:20:13.000000 apprise-1.7.6/apprise/config/ConfigBase.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)       54 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/config/ConfigBase.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6138 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/config/ConfigFile.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9457 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/config/ConfigHTTP.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2829 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/config/ConfigMemory.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1663 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/config/__init__.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6277 2024-04-13 23:33:39.000000 apprise-1.7.6/apprise/conversion.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.073314 apprise-1.7.6/apprise/decorators/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7972 2024-03-29 20:20:13.000000 apprise-1.7.6/apprise/decorators/CustomNotifyPlugin.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1487 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/decorators/__init__.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5111 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/decorators/notify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    87738 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/emojis.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.073314 apprise-1.7.6/apprise/i18n/
--rw-r--r--   0 l2g       (1000) l2g       (1000)        0 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/i18n/__init__.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.063314 apprise-1.7.6/apprise/i18n/en/
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.073314 apprise-1.7.6/apprise/i18n/en/LC_MESSAGES/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3959 2024-04-14 00:12:18.000000 apprise-1.7.6/apprise/i18n/en/LC_MESSAGES/apprise.mo
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6921 2024-01-27 20:32:17.000000 apprise-1.7.6/apprise/logger.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    26857 2024-03-09 21:39:49.000000 apprise-1.7.6/apprise/manager.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.087314 apprise-1.7.6/apprise/plugins/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16654 2024-03-12 22:16:02.000000 apprise-1.7.6/apprise/plugins/NotifyAppriseAPI.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25523 2024-04-13 23:33:39.000000 apprise-1.7.6/apprise/plugins/NotifyAprs.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15698 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyBark.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    30360 2024-04-09 00:19:20.000000 apprise-1.7.6/apprise/plugins/NotifyBase.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)       21 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/plugins/NotifyBase.pyi
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12867 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyBoxcar.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16005 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyBulkSMS.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13290 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyBulkVS.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15550 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyBurstSMS.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6673 2024-04-09 01:04:23.000000 apprise-1.7.6/apprise/plugins/NotifyChantify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11229 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyClickSend.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15043 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyD7Networks.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14379 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyDBus.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13624 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyDapnet.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12009 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyDingTalk.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    26072 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyDiscord.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    39789 2024-04-09 00:19:20.000000 apprise-1.7.6/apprise/plugins/NotifyEmail.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    24039 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyEmby.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11498 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyEnigma2.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.088314 apprise-1.7.6/apprise/plugins/NotifyFCM/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    21669 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyFCM/__init__.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4592 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyFCM/color.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1718 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyFCM/common.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11197 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyFCM/oauth.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8163 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyFCM/priority.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7266 2024-04-10 23:44:32.000000 apprise-1.7.6/apprise/plugins/NotifyFeishu.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12748 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyFlock.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17905 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyForm.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6644 2024-04-13 23:33:39.000000 apprise-1.7.6/apprise/plugins/NotifyFreeMobile.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9059 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyGnome.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12622 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyGoogleChat.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10551 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyGotify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14023 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyGrowl.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3641 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyGuilded.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10739 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyHomeAssistant.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11136 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyHttpSMS.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13425 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyIFTTT.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13851 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyJSON.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13581 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyJoin.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12620 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyKavenegar.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8214 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyKumulos.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    37534 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyLametric.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10676 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyLine.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14459 2024-03-09 21:39:52.000000 apprise-1.7.6/apprise/plugins/NotifyLunaSea.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    19545 2024-03-30 16:22:13.000000 apprise-1.7.6/apprise/plugins/NotifyMQTT.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12677 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMSG91.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    22976 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMSTeams.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8271 2024-02-03 17:43:14.000000 apprise-1.7.6/apprise/plugins/NotifyMacOSX.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25409 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMailgun.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    35277 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMastodon.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    50049 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMatrix.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12722 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMattermost.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12248 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMessageBird.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9600 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyMisskey.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12759 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyNextcloud.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11011 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyNextcloudTalk.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12990 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyNotica.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15857 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyNotifiarr.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12035 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyNotifico.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    27979 2024-04-07 16:07:14.000000 apprise-1.7.6/apprise/plugins/NotifyNtfy.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25190 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyOffice365.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    18153 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyOneSignal.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    20515 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyOpsgenie.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17874 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPagerDuty.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13849 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPagerTree.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10291 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyParsePlatform.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10587 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPopcornNotify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9782 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyProwl.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15372 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushBullet.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6922 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushDeer.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7134 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushMe.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    26756 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushSafer.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12270 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushed.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8952 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushjet.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    21213 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushover.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12496 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyPushy.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11982 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyRSyslog.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25785 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyReddit.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14500 2024-02-18 15:11:50.000000 apprise-1.7.6/apprise/plugins/NotifyRevolt.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25738 2024-04-14 00:09:29.000000 apprise-1.7.6/apprise/plugins/NotifyRocketChat.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11823 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyRyver.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    33545 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySES.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    24161 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySMSEagle.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14125 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySMSManager.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    19711 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySMTP2Go.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    24159 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySNS.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16213 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySendGrid.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5779 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyServerChan.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16733 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySignalAPI.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10876 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySimplePush.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16813 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySinch.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    42521 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySlack.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    27878 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySparkPost.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16023 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyStreamlabs.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11105 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySynology.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10617 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifySyslog.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7253 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyTechulusPush.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    37187 2024-04-11 01:21:34.000000 apprise-1.7.6/apprise/plugins/NotifyTelegram.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11885 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyThreema.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15976 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyTwilio.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    28841 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyTwist.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    30152 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyTwitter.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12552 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyVoipms.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13431 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyVonage.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8789 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyWeComBot.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9164 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyWebexTeams.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    19924 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyWhatsApp.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8563 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyWindows.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12096 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyXBMC.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16973 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/NotifyXML.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13968 2024-04-09 01:01:29.000000 apprise-1.7.6/apprise/plugins/NotifyZulip.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    18725 2024-01-27 20:31:31.000000 apprise-1.7.6/apprise/plugins/__init__.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)        0 2023-06-03 19:32:05.000000 apprise-1.7.6/apprise/py.typed
--rw-r--r--   0 l2g       (1000) l2g       (1000)    53185 2024-01-27 20:12:32.000000 apprise-1.7.6/apprise/utils.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.068314 apprise-1.7.6/apprise.egg-info/
--rw-r--r--   0 l2g       (1000) l2g       (1000)    44618 2024-04-14 00:12:18.000000 apprise-1.7.6/apprise.egg-info/PKG-INFO
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10509 2024-04-14 00:12:19.000000 apprise-1.7.6/apprise.egg-info/SOURCES.txt
--rw-r--r--   0 l2g       (1000) l2g       (1000)        1 2024-04-14 00:12:18.000000 apprise-1.7.6/apprise.egg-info/dependency_links.txt
--rw-r--r--   0 l2g       (1000) l2g       (1000)       45 2024-04-14 00:12:18.000000 apprise-1.7.6/apprise.egg-info/entry_points.txt
--rw-r--r--   0 l2g       (1000) l2g       (1000)      101 2024-04-14 00:12:18.000000 apprise-1.7.6/apprise.egg-info/requires.txt
--rw-r--r--   0 l2g       (1000) l2g       (1000)        8 2024-04-14 00:12:18.000000 apprise-1.7.6/apprise.egg-info/top_level.txt
--rw-r--r--   0 l2g       (1000) l2g       (1000)       65 2023-08-20 16:57:52.000000 apprise-1.7.6/dev-requirements.txt
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.088314 apprise-1.7.6/packaging/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1281 2023-06-03 19:32:05.000000 apprise-1.7.6/packaging/README.md
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.088314 apprise-1.7.6/packaging/man/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9039 2024-03-30 13:59:07.000000 apprise-1.7.6/packaging/man/apprise.1
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13374 2024-03-30 13:59:07.000000 apprise-1.7.6/packaging/man/apprise.1.html
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8164 2024-03-09 21:39:52.000000 apprise-1.7.6/packaging/man/apprise.md
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.089314 apprise-1.7.6/packaging/redhat/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1586 2024-01-27 20:41:30.000000 apprise-1.7.6/packaging/redhat/apprise-click67-support.patch
--rw-r--r--   0 l2g       (1000) l2g       (1000)      596 2024-01-27 20:41:32.000000 apprise-1.7.6/packaging/redhat/apprise-no-macosx-testing.patch
--rw-r--r--   0 l2g       (1000) l2g       (1000)      785 2024-01-27 20:41:35.000000 apprise-1.7.6/packaging/redhat/apprise-pytest-session_mocker-removal.patch
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14180 2024-04-14 00:11:13.000000 apprise-1.7.6/packaging/redhat/python-apprise.spec
--rw-r--r--   0 l2g       (1000) l2g       (1000)      164 2023-06-03 19:32:05.000000 apprise-1.7.6/requirements.txt
--rw-r--r--   0 l2g       (1000) l2g       (1000)      861 2024-04-14 00:12:19.108314 apprise-1.7.6/setup.cfg
--rwxr-xr-x   0 l2g       (1000) l2g       (1000)     4387 2024-04-14 00:10:08.000000 apprise-1.7.6/setup.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.105314 apprise-1.7.6/test/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2422 2024-01-27 20:33:15.000000 apprise-1.7.6/test/conftest.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.106314 apprise-1.7.6/test/helpers/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1618 2024-01-27 20:33:15.000000 apprise-1.7.6/test/helpers/__init__.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1668 2023-08-20 03:33:33.000000 apprise-1.7.6/test/helpers/asyncio.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4924 2024-01-27 20:33:15.000000 apprise-1.7.6/test/helpers/module.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    22600 2024-01-27 20:33:15.000000 apprise-1.7.6/test/helpers/rest.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    68108 2024-04-09 00:19:20.000000 apprise-1.7.6/test/test_api.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12488 2024-04-09 00:19:20.000000 apprise-1.7.6/test/test_apprise_attachments.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    40246 2024-03-09 21:39:49.000000 apprise-1.7.6/test/test_apprise_cli.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    40843 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_apprise_config.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2248 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_apprise_emojis.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3617 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_apprise_pickle.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13983 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_apprise_translations.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    96705 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_apprise_utils.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3693 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_asyncio.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3372 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_attach_base.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8491 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_attach_file.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17522 2024-03-29 19:00:10.000000 apprise-1.7.6/test/test_attach_http.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    42141 2024-03-30 13:53:24.000000 apprise-1.7.6/test/test_config_base.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4112 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_config_file.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10868 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_config_http.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2358 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_config_memory.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6698 2024-03-30 13:53:24.000000 apprise-1.7.6/test/test_conversion.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15813 2024-03-29 20:20:13.000000 apprise-1.7.6/test/test_decorator_notify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7557 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_escapes.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14361 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_logger.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13614 2024-03-03 19:41:00.000000 apprise-1.7.6/test/test_notification_manager.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12929 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_notify_base.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9896 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_apprise_api.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12977 2024-04-13 23:33:39.000000 apprise-1.7.6/test/test_plugin_aprs.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5274 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_bark.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6614 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_boxcar.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7285 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_bulksms.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6274 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_bulkvs.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6266 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_burstsms.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2890 2024-04-09 01:01:27.000000 apprise-1.7.6/test/test_plugin_chantify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3358 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_clicksend.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15681 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_custom_form.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11633 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_custom_json.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13640 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_custom_xml.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7486 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_d7networks.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8034 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_dapnet.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3980 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_dingtalk.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    27507 2024-02-18 15:11:50.000000 apprise-1.7.6/test/test_plugin_discord.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    71463 2024-04-09 00:19:20.000000 apprise-1.7.6/test/test_plugin_email.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14521 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_emby.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6088 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_enigma2.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    31323 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_fcm.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2856 2024-04-10 23:44:32.000000 apprise-1.7.6/test/test_plugin_feishu.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6308 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_flock.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2918 2024-03-30 13:53:24.000000 apprise-1.7.6/test/test_plugin_freemobile.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17424 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_glib.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12170 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_gnome.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6321 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_google_chat.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6415 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_gotify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12690 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_growl.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6570 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_guilded.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5233 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_homeassistant.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5689 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_httpsms.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6761 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_ifttt.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7448 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_join.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4226 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_kavenegar.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4063 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_kumulos.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9782 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_lametric.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3355 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_line.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10004 2024-03-09 21:39:52.000000 apprise-1.7.6/test/test_plugin_lunasea.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7654 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_macosx.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14672 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_mailgun.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25055 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_mastodon.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    38833 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_matrix.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4940 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_mattermost.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4575 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_messagebird.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3813 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_misskey.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14198 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_mqtt.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7272 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_msg91.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    23826 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_msteams.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7226 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_nextcloud.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6868 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_nextcloudtalk.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5079 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_notica.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6146 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_notifiarr.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4376 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_notifico.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    20084 2024-02-17 16:42:25.000000 apprise-1.7.6/test/test_plugin_ntfy.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    12395 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_office365.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7949 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_onesignal.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7439 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_opsgenie.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4943 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pagerduty.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4871 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pagertree.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3750 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_parse_platform.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3619 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_popcorn_notify.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6632 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_prowl.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13080 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushbullet.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4230 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushdeer.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7236 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushed.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3781 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushjet.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3726 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushme.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    15398 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushover.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9043 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushsafer.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5531 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_pushy.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14553 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_reddit.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17404 2024-02-18 15:11:50.000000 apprise-1.7.6/test/test_plugin_revolt.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    11605 2024-04-14 00:09:29.000000 apprise-1.7.6/test/test_plugin_rocket_chat.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6913 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_rsyslog.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5067 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_ryver.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5497 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_sendgrid.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2710 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_serverchan.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14643 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_ses.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    13355 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_signal.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5695 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_simplepush.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6246 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_sinch.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    26717 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_slack.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6373 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_sms_manager.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    25558 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_smseagle.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8764 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_smtp2go.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14294 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_sns.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    14172 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_sparkpost.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5036 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_streamlabs.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5820 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_synology.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5021 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_syslog.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3061 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_techululs_push.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    35550 2024-04-11 01:21:34.000000 apprise-1.7.6/test/test_plugin_telegram.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     5975 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_threema.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4831 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_title_maxlen.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     8253 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_twilio.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    16766 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_twist.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    35721 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_twitter.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7584 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_voipms.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     7918 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_vonage.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3970 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_webex_teams.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     3167 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_wecombot.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     9129 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_whatsapp.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)    10786 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_windows.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     6495 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_plugin_xbmc_kodi.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)     4887 2024-04-09 01:01:29.000000 apprise-1.7.6/test/test_plugin_zulip.py
--rw-r--r--   0 l2g       (1000) l2g       (1000)   140538 2024-01-27 20:33:15.000000 apprise-1.7.6/test/test_rest_plugins.py
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.106314 apprise-1.7.6/test/var/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     1913 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/01_test_example.html
--rw-r--r--   0 l2g       (1000) l2g       (1000)      277 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/apprise-archive.zip
--rw-r--r--   0 l2g       (1000) l2g       (1000)    76646 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/apprise-test.gif
--rw-r--r--   0 l2g       (1000) l2g       (1000)    73667 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/apprise-test.jpeg
--rw-r--r--   0 l2g       (1000) l2g       (1000)    17856 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/apprise-test.mp4
--rw-r--r--   0 l2g       (1000) l2g       (1000)   248280 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/apprise-test.png
-drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-04-14 00:12:19.107314 apprise-1.7.6/test/var/fcm/
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2231 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/fcm/service_account-bad-type.json
--rw-r--r--   0 l2g       (1000) l2g       (1000)     2238 2023-06-03 19:32:05.000000 apprise-1.7.6/test/var/fcm/service_account.json
--rw-r--r--   0 l2g       (1000) l2g       (1000)        8 2023-06-03 19:32:05.000000 apprise-1.7.6/win-requirements.txt
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.682125 apprise-1.8.0/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      941 2024-04-10 23:44:32.000000 apprise-1.8.0/KEYWORDS
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1343 2024-01-27 20:33:15.000000 apprise-1.8.0/LICENSE
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      237 2023-06-03 19:32:05.000000 apprise-1.8.0/MANIFEST.in
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    44821 2024-05-11 20:13:25.682125 apprise-1.8.0/PKG-INFO
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    42316 2024-04-10 23:44:32.000000 apprise-1.8.0/README.md
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.636125 apprise-1.8.0/apprise/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3388 2024-05-11 20:09:06.000000 apprise-1.8.0/apprise/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    32837 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/apprise.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2203 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/apprise.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12528 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/apprise_attachment.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1145 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/apprise_attachment.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16896 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/apprise_config.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1568 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/apprise_config.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11643 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/asset.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      979 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/asset.pyi
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.637125 apprise-1.8.0/apprise/assets/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      986 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/NotifyXML-1.0.xsd
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1758 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/NotifyXML-1.1.xsd
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.628125 apprise-1.8.0/apprise/assets/themes/
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.647125 apprise-1.8.0/apprise/assets/themes/default/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-failure-128x128.ico
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16135 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-failure-128x128.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    41931 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-failure-256x256.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2437 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-failure-32x32.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7600 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-failure-72x72.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-info-128x128.ico
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16671 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-info-128x128.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    43331 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-info-256x256.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2485 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-info-32x32.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7875 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-info-72x72.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)   160907 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-logo.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-success-128x128.ico
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17446 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-success-128x128.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    48729 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-success-256x256.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2471 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-success-32x32.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7858 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-success-72x72.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    67646 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-warning-128x128.ico
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16784 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-warning-128x128.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    43708 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-warning-256x256.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2472 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-warning-32x32.png
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7913 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/assets/themes/default/apprise-warning-72x72.png
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.648125 apprise-1.8.0/apprise/attachment/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1678 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/attachment/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13692 2024-05-11 20:08:24.000000 apprise-1.8.0/apprise/attachment/base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      961 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/attachment/base.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4752 2024-05-11 19:09:19.000000 apprise-1.8.0/apprise/attachment/file.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13748 2024-05-11 20:08:24.000000 apprise-1.8.0/apprise/attachment/http.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    20697 2024-03-09 21:39:52.000000 apprise-1.8.0/apprise/cli.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5593 2024-01-27 20:32:17.000000 apprise-1.8.0/apprise/common.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      447 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/common.pyi
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.649125 apprise-1.8.0/apprise/config/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1679 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/config/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    53173 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/config/base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)       54 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/config/base.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6125 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/config/file.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9440 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/config/http.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2816 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/config/memory.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6273 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/conversion.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.649125 apprise-1.8.0/apprise/decorators/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1487 2024-01-27 20:12:32.000000 apprise-1.8.0/apprise/decorators/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8019 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/decorators/base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5097 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/decorators/notify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    87738 2024-01-27 20:12:32.000000 apprise-1.8.0/apprise/emojis.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.650125 apprise-1.8.0/apprise/i18n/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)        0 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/i18n/__init__.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.628125 apprise-1.8.0/apprise/i18n/en/
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.650125 apprise-1.8.0/apprise/i18n/en/LC_MESSAGES/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3959 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise/i18n/en/LC_MESSAGES/apprise.mo
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8994 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/locale.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6921 2024-01-27 20:32:17.000000 apprise-1.8.0/apprise/logger.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    27218 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/manager.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2200 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/manager_attachment.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2205 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/manager_config.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2211 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/manager_plugins.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.662125 apprise-1.8.0/apprise/plugins/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    18701 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16638 2024-05-05 16:17:22.000000 apprise-1.8.0/apprise/plugins/apprise_api.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25506 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/aprs.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15681 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/bark.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    30350 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)       21 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/base.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12850 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/boxcar.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15988 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/bulksms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13273 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/bulkvs.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15533 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/burstsms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6660 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/chantify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11408 2024-05-05 16:46:29.000000 apprise-1.8.0/apprise/plugins/clicksend.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17888 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/custom_form.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13834 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/custom_json.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16956 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/custom_xml.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15030 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/d7networks.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13607 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/dapnet.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14366 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/dbus.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11992 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/dingtalk.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    26053 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/discord.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    39912 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/email.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    24022 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/emby.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11481 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/enigma2.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.663125 apprise-1.8.0/apprise/plugins/fcm/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    21657 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/fcm/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4585 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/fcm/color.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1718 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/fcm/common.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11197 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/fcm/oauth.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8163 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/fcm/priority.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7253 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/feishu.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12735 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/flock.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6679 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/freemobile.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9046 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/gnome.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12609 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/google_chat.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10538 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/gotify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14006 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/growl.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3707 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/guilded.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10722 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/home_assistant.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11123 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/httpsms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13412 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/ifttt.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13568 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/join.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12607 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/kavenegar.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8201 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/kumulos.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    37521 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/lametric.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10659 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/line.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14442 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/lunasea.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8258 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/macosx.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25396 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/mailgun.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    35254 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/mastodon.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    50032 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/matrix.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12709 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/mattermost.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12235 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/messagebird.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9587 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/misskey.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    19528 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/mqtt.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12664 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/msg91.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    22964 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/msteams.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12742 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/nextcloud.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10994 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/nextcloudtalk.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12973 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/notica.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15844 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/notifiarr.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12022 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/notifico.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    27956 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/ntfy.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25173 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/office365.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    18140 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/one_signal.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    20502 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/opsgenie.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17857 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pagerduty.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13836 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pagertree.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10278 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/parseplatform.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10574 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/popcorn_notify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9769 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/prowl.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15353 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushbullet.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6909 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushdeer.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12253 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushed.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8935 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushjet.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7121 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushme.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    21194 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushover.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    26743 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushsafer.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12483 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/pushy.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25768 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/reddit.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14487 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/revolt.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25721 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/rocketchat.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11969 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/rsyslog.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11810 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/ryver.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16200 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/sendgrid.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5766 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/serverchan.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    33528 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/ses.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16716 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/signal_api.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10859 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/simplepush.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16796 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/sinch.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    42508 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/slack.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    24144 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/smseagle.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14112 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/smsmanager.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    19698 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/smtp2go.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    24142 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/sns.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    27865 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/sparkpost.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16010 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/streamlabs.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11088 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/synology.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10604 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/syslog.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7240 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/techuluspush.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    37168 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/telegram.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11868 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/threema.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15959 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/twilio.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    28824 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/twist.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    30129 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/twitter.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12539 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/voipms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13414 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/vonage.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9151 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/webexteams.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8776 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/wecombot.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    19911 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/whatsapp.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8550 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/windows.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12079 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/xbmc.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13955 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/plugins/zulip.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)        0 2023-06-03 19:32:05.000000 apprise-1.8.0/apprise/py.typed
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    29455 2024-05-11 20:08:24.000000 apprise-1.8.0/apprise/url.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      520 2024-04-27 17:03:21.000000 apprise-1.8.0/apprise/url.pyi
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    53461 2024-05-11 20:08:24.000000 apprise-1.8.0/apprise/utils.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.681125 apprise-1.8.0/apprise.egg-info/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    44821 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise.egg-info/PKG-INFO
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9774 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise.egg-info/SOURCES.txt
+-rw-r--r--   0 l2g       (1000) l2g       (1000)        1 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise.egg-info/dependency_links.txt
+-rw-r--r--   0 l2g       (1000) l2g       (1000)       45 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise.egg-info/entry_points.txt
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      101 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise.egg-info/requires.txt
+-rw-r--r--   0 l2g       (1000) l2g       (1000)        8 2024-05-11 20:13:25.000000 apprise-1.8.0/apprise.egg-info/top_level.txt
+-rw-r--r--   0 l2g       (1000) l2g       (1000)       65 2023-08-20 16:57:52.000000 apprise-1.8.0/dev-requirements.txt
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.663125 apprise-1.8.0/packaging/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1281 2023-06-03 19:32:05.000000 apprise-1.8.0/packaging/README.md
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.663125 apprise-1.8.0/packaging/man/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9039 2024-05-11 20:12:18.000000 apprise-1.8.0/packaging/man/apprise.1
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13371 2024-05-11 20:12:18.000000 apprise-1.8.0/packaging/man/apprise.1.html
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8164 2024-03-09 21:39:52.000000 apprise-1.8.0/packaging/man/apprise.md
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.665125 apprise-1.8.0/packaging/redhat/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1586 2024-01-27 20:41:30.000000 apprise-1.8.0/packaging/redhat/apprise-click67-support.patch
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      596 2024-01-27 20:41:32.000000 apprise-1.8.0/packaging/redhat/apprise-no-macosx-testing.patch
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      785 2024-01-27 20:41:35.000000 apprise-1.8.0/packaging/redhat/apprise-pytest-session_mocker-removal.patch
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14261 2024-05-11 20:09:44.000000 apprise-1.8.0/packaging/redhat/python-apprise.spec
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      164 2023-06-03 19:32:05.000000 apprise-1.8.0/requirements.txt
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      861 2024-05-11 20:13:25.682125 apprise-1.8.0/setup.cfg
+-rwxr-xr-x   0 l2g       (1000) l2g       (1000)     4387 2024-05-11 20:08:47.000000 apprise-1.8.0/setup.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.679125 apprise-1.8.0/test/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2413 2024-04-27 17:03:21.000000 apprise-1.8.0/test/conftest.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.680125 apprise-1.8.0/test/helpers/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1618 2024-01-27 20:33:15.000000 apprise-1.8.0/test/helpers/__init__.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1668 2023-08-20 03:33:33.000000 apprise-1.8.0/test/helpers/asyncio.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7153 2024-04-27 17:03:21.000000 apprise-1.8.0/test/helpers/module.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    22600 2024-01-27 20:33:15.000000 apprise-1.8.0/test/helpers/rest.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    68090 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_api.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12439 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_apprise_attachments.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    40234 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_apprise_cli.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    40369 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_apprise_config.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2248 2024-01-27 20:33:15.000000 apprise-1.8.0/test/test_apprise_emojis.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3603 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_apprise_pickle.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13668 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_apprise_translations.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    97787 2024-05-11 20:08:24.000000 apprise-1.8.0/test/test_apprise_utils.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3689 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_asyncio.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3366 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_attach_base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8479 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_attach_file.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17641 2024-05-11 20:08:24.000000 apprise-1.8.0/test/test_attach_http.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    42095 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_config_base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4082 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_config_file.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10847 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_config_http.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2320 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_config_memory.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6698 2024-03-30 13:53:24.000000 apprise-1.8.0/test/test_conversion.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    19951 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_decorator_notify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7557 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_escapes.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14368 2024-04-27 16:36:51.000000 apprise-1.8.0/test/test_logger.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12427 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_notification_manager.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12840 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_notify_base.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10135 2024-05-05 16:17:22.000000 apprise-1.8.0/test/test_plugin_apprise_api.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12971 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_aprs.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5268 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_bark.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6608 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_boxcar.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7279 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_bulksms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6268 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_bulkvs.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6260 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_burstsms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2884 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_chantify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3498 2024-05-05 16:46:29.000000 apprise-1.8.0/test/test_plugin_clicksend.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15682 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_custom_form.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11618 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_custom_json.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13617 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_custom_xml.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7480 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_d7networks.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8028 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_dapnet.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3974 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_dingtalk.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    27501 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_discord.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    72421 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_email.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14479 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_emby.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6082 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_enigma2.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    31261 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_fcm.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2850 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_feishu.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6302 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_flock.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2912 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_freemobile.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17170 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_glib.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12146 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_gnome.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6316 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_google_chat.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6409 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_gotify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12684 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_growl.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6556 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_guilded.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5228 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_homeassistant.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5683 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_httpsms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6715 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_ifttt.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7442 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_join.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4220 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_kavenegar.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4057 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_kumulos.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9776 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_lametric.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3349 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_line.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9982 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_lunasea.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7624 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_macosx.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14634 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_mailgun.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25025 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_mastodon.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    38765 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_matrix.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4934 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_mattermost.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4569 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_messagebird.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3807 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_misskey.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14192 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_mqtt.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7234 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_msg91.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    23820 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_msteams.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7220 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_nextcloud.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6862 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_nextcloudtalk.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5073 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_notica.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6140 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_notifiarr.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4370 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_notifico.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    20078 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_ntfy.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    12389 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_office365.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7944 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_onesignal.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7433 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_opsgenie.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4937 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pagerduty.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4865 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pagertree.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3744 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_parse_platform.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3614 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_popcorn_notify.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6626 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_prowl.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13074 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushbullet.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4208 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushdeer.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7230 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushed.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3775 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushjet.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3720 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushme.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    15368 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushover.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9037 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushsafer.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5525 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_pushy.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14531 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_reddit.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17390 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_revolt.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    11599 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_rocket_chat.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6907 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_rsyslog.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5061 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_ryver.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5491 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_sendgrid.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2704 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_serverchan.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14637 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_ses.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    13339 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_signal.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5689 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_simplepush.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6240 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_sinch.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    26711 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_slack.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6367 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_sms_manager.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    25552 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_smseagle.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8758 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_smtp2go.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14319 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_sns.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    14166 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_sparkpost.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5030 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_streamlabs.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5814 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_synology.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4959 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_syslog.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3055 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_techululs_push.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    35544 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_telegram.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     5949 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_threema.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4820 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_title_maxlen.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     8215 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_twilio.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    16632 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_twist.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    35715 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_twitter.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7578 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_voipms.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     7912 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_vonage.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3964 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_webex_teams.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     3161 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_wecombot.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     9123 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_whatsapp.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    10722 2024-04-27 16:36:51.000000 apprise-1.8.0/test/test_plugin_windows.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     6489 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_xbmc_kodi.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     4881 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_plugin_zulip.py
+-rw-r--r--   0 l2g       (1000) l2g       (1000)   140503 2024-04-27 17:03:21.000000 apprise-1.8.0/test/test_rest_plugins.py
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.681125 apprise-1.8.0/test/var/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     1913 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/01_test_example.html
+-rw-r--r--   0 l2g       (1000) l2g       (1000)      277 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/apprise-archive.zip
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    76646 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/apprise-test.gif
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    73667 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/apprise-test.jpeg
+-rw-r--r--   0 l2g       (1000) l2g       (1000)    17856 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/apprise-test.mp4
+-rw-r--r--   0 l2g       (1000) l2g       (1000)   248280 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/apprise-test.png
+drwxr-xr-x   0 l2g       (1000) l2g       (1000)        0 2024-05-11 20:13:25.681125 apprise-1.8.0/test/var/fcm/
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2231 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/fcm/service_account-bad-type.json
+-rw-r--r--   0 l2g       (1000) l2g       (1000)     2238 2023-06-03 19:32:05.000000 apprise-1.8.0/test/var/fcm/service_account.json
+-rw-r--r--   0 l2g       (1000) l2g       (1000)        8 2023-06-03 19:32:05.000000 apprise-1.8.0/win-requirements.txt
```

### Comparing `apprise-1.7.6/KEYWORDS` & `apprise-1.8.0/KEYWORDS`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/LICENSE` & `apprise-1.8.0/LICENSE`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/PKG-INFO` & `apprise-1.8.0/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: apprise
-Version: 1.7.6
+Version: 1.8.0
 Summary: Push Notifications that work with just about every platform!
 Home-page: https://github.com/caronc/apprise
 Author: Chris Caron
 Author-email: lead2gold@gmail.com
 License: BSD
 Keywords: Alerts Apprise API Automated Packet Reporting System AWS Boxcar BulkSMS BulkVS Burst SMS Chantify Chat CLI ClickSend D7Networks Dapnet DBus DingTalk Discord Email Emby Enigma2 FCM Feishu Flock Form Free Mobile Gnome Google Chat Gotify Growl Guilded Home Assistant httpSMS IFTTT Join JSON Kavenegar KODI Kumulos LaMetric Line LunaSea MacOSX Mailgun Mastodon Matrix Mattermost MessageBird Microsoft Misskey MQTT MSG91 MSTeams Nextcloud NextcloudTalk Notica Notifiarr Notifico Ntfy Office365 OneSignal Opsgenie PagerDuty PagerTree ParsePlatform PopcornNotify Prowl PushBullet Pushed Pushjet PushMe Push Notifications Pushover PushSafer Pushy PushDeer Reddit Revolt Rocket.Chat RSyslog Ryver SendGrid ServerChan SES Signal SimplePush Sinch Slack SMSEagle SMS Manager SMTP2Go SNS SparkPost Streamlabs Stride Synology Chat Syslog Techulus Telegram Threema Gateway Twilio Twist Twitter Voipms Vonage Webex WeCom Bot WhatsApp Windows XBMC XML Zulip
 Classifier: Development Status :: 5 - Production/Stable
@@ -25,14 +25,21 @@
 Classifier: Programming Language :: Python :: Implementation :: PyPy
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Topic :: Software Development :: Libraries :: Application Frameworks
 Requires-Python: >=3.6
 Description-Content-Type: text/markdown
 License-File: LICENSE
+Requires-Dist: certifi
+Requires-Dist: dataclasses; python_version < "3.7"
+Requires-Dist: requests
+Requires-Dist: requests-oauthlib
+Requires-Dist: click>=5.0
+Requires-Dist: markdown
+Requires-Dist: PyYAML
 
 ![Apprise Logo](https://raw.githubusercontent.com/caronc/apprise/master/apprise/assets/themes/default/apprise-logo.png)
 
 <hr/>
 
 **ap·prise** / *verb*<br/>
 To inform or tell (someone). To make one aware of something.
```

### Comparing `apprise-1.7.6/README.md` & `apprise-1.8.0/README.md`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/Apprise.py` & `apprise-1.8.0/apprise/apprise.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,26 +29,26 @@
 import asyncio
 import concurrent.futures as cf
 import os
 from itertools import chain
 from . import common
 from .conversion import convert_between
 from .utils import is_exclusive_match
-from .NotificationManager import NotificationManager
+from .manager_plugins import NotificationManager
 from .utils import parse_list
 from .utils import parse_urls
 from .utils import cwe312_url
 from .emojis import apply_emojis
 from .logger import logger
-from .AppriseAsset import AppriseAsset
-from .AppriseConfig import AppriseConfig
-from .AppriseAttachment import AppriseAttachment
-from .AppriseLocale import AppriseLocale
-from .config.ConfigBase import ConfigBase
-from .plugins.NotifyBase import NotifyBase
+from .asset import AppriseAsset
+from .apprise_config import AppriseConfig
+from .apprise_attachment import AppriseAttachment
+from .locale import AppriseLocale
+from .config.base import ConfigBase
+from .plugins.base import NotifyBase
 
 from . import plugins
 from . import __version__
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
```

### Comparing `apprise-1.7.6/apprise/Apprise.pyi` & `apprise-1.8.0/apprise/apprise.pyi`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/AppriseAsset.py` & `apprise-1.8.0/apprise/asset.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import re
 from uuid import uuid4
 from os.path import join
 from os.path import dirname
 from os.path import isfile
 from os.path import abspath
 from .common import NotifyType
-from .NotificationManager import NotificationManager
+from .manager_plugins import NotificationManager
 
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
 
 
 class AppriseAsset:
```

### Comparing `apprise-1.7.6/apprise/AppriseAsset.pyi` & `apprise-1.8.0/apprise/asset.pyi`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/AppriseAttachment.py` & `apprise-1.8.0/apprise/apprise_attachment.py`

 * *Files 0% similar despite different names*

```diff
@@ -23,17 +23,17 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from . import URLBase
-from .attachment.AttachBase import AttachBase
-from .AppriseAsset import AppriseAsset
-from .AttachmentManager import AttachmentManager
+from .attachment.base import AttachBase
+from .asset import AppriseAsset
+from .manager_attachment import AttachmentManager
 from .logger import logger
 from .common import ContentLocation
 from .common import CONTENT_LOCATIONS
 from .utils import GET_SCHEMA_RE
 
 # Grant access to our Notification Manager Singleton
 A_MGR = AttachmentManager()
```

### Comparing `apprise-1.7.6/apprise/AppriseAttachment.pyi` & `apprise-1.8.0/apprise/apprise_attachment.pyi`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/AppriseConfig.py` & `apprise-1.8.0/apprise/apprise_config.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,17 +24,17 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from . import ConfigBase
 from . import CONFIG_FORMATS
-from .ConfigurationManager import ConfigurationManager
+from .manager_config import ConfigurationManager
 from . import URLBase
-from .AppriseAsset import AppriseAsset
+from .asset import AppriseAsset
 from . import common
 from .utils import GET_SCHEMA_RE
 from .utils import parse_list
 from .utils import is_exclusive_match
 from .logger import logger
 
 # Grant access to our Configuration Manager Singleton
```

### Comparing `apprise-1.7.6/apprise/AppriseConfig.pyi` & `apprise-1.8.0/apprise/apprise_config.pyi`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/AppriseLocale.py` & `apprise-1.8.0/apprise/locale.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/AttachmentManager.py` & `apprise-1.8.0/apprise/manager_attachment.py`

 * *Files 6% similar despite different names*

```diff
@@ -22,14 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
+import re
 from os.path import dirname
 from os.path import abspath
 from os.path import join
 from .manager import PluginManager
 
 
 class AttachmentManager(PluginManager):
@@ -48,7 +49,11 @@
     _id = 'attachment'
 
     # Our Module Python path name
     module_name_prefix = f'apprise.{_id}'
 
     # The module path to scan
     module_path = join(abspath(dirname(__file__)), _id)
+
+    # For filtering our result set
+    module_filter_re = re.compile(
+        r'^(?P<name>' + fname_prefix + r'(?!Base)[A-Za-z0-9]+)$')
```

### Comparing `apprise-1.7.6/apprise/ConfigurationManager.py` & `apprise-1.8.0/apprise/manager_config.py`

 * *Files 4% similar despite different names*

```diff
@@ -22,14 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
+import re
 from os.path import dirname
 from os.path import abspath
 from os.path import join
 from .manager import PluginManager
 
 
 class ConfigurationManager(PluginManager):
@@ -48,7 +49,11 @@
     _id = 'config'
 
     # Our Module Python path name
     module_name_prefix = f'apprise.{_id}'
 
     # The module path to scan
     module_path = join(abspath(dirname(__file__)), _id)
+
+    # For filtering our result set
+    module_filter_re = re.compile(
+        r'^(?P<name>' + fname_prefix + r'(?!Base)[A-Za-z0-9]+)$')
```

### Comparing `apprise-1.7.6/apprise/NotificationManager.py` & `apprise-1.8.0/apprise/manager_plugins.py`

 * *Files 9% similar despite different names*

```diff
@@ -22,14 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
+import re
 from os.path import dirname
 from os.path import abspath
 from os.path import join
 from .manager import PluginManager
 
 
 class NotificationManager(PluginManager):
@@ -48,7 +49,12 @@
     _id = 'plugins'
 
     # Our Module Python path name
     module_name_prefix = f'apprise.{_id}'
 
     # The module path to scan
     module_path = join(abspath(dirname(__file__)), _id)
+
+    # For filtering our result set
+    module_filter_re = re.compile(
+        r'^(?P<name>' + fname_prefix +
+        r'(?!Base|ImageSize|Type)[A-Za-z0-9]+)$')
```

### Comparing `apprise-1.7.6/apprise/URLBase.py` & `apprise-1.8.0/apprise/url.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,16 +31,16 @@
 import time
 from datetime import datetime
 from xml.sax.saxutils import escape as sax_escape
 
 from urllib.parse import unquote as _unquote
 from urllib.parse import quote as _quote
 
-from .AppriseLocale import gettext_lazy as _
-from .AppriseAsset import AppriseAsset
+from .locale import gettext_lazy as _
+from .asset import AppriseAsset
 from .utils import urlencode
 from .utils import parse_url
 from .utils import parse_bool
 from .utils import parse_list
 from .utils import parse_phone_no
 
 # Used to break a path list into parts
@@ -740,15 +740,15 @@
             if 'port' in results['qsd']:
                 results['port'] = results['qsd']['port']
 
         return results
 
     @staticmethod
     def parse_url(url, verify_host=True, plus_to_space=False,
-                  strict_port=False):
+                  strict_port=False, sanitize=True):
         """Parses the URL and returns it broken apart into a dictionary.
 
         This is very specific and customized for Apprise.
 
 
         Args:
             url (str): The URL you want to fully parse.
@@ -761,15 +761,16 @@
         Returns:
             A dictionary is returned containing the URL fully parsed if
             successful, otherwise None is returned.
         """
 
         results = parse_url(
             url, default_schema='unknown', verify_host=verify_host,
-            plus_to_space=plus_to_space, strict_port=strict_port)
+            plus_to_space=plus_to_space, strict_port=strict_port,
+            sanitize=sanitize)
 
         if not results:
             # We're done; we failed to parse our url
             return results
 
         return URLBase.post_process_parse_url_results(results)
```

### Comparing `apprise-1.7.6/apprise/URLBase.pyi` & `apprise-1.8.0/apprise/url.pyi`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/__init__.py` & `apprise-1.8.0/apprise/__init__.py`

 * *Files 6% similar despite different names*

```diff
@@ -23,15 +23,15 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 __title__ = 'Apprise'
-__version__ = '1.7.6'
+__version__ = '1.8.0'
 __author__ = 'Chris Caron'
 __license__ = 'BSD'
 __copywrite__ = 'Copyright (C) 2024 Chris Caron <lead2gold@gmail.com>'
 __email__ = 'lead2gold@gmail.com'
 __status__ = 'Production'
 
 from .common import NotifyType
@@ -45,39 +45,40 @@
 from .common import ConfigFormat
 from .common import CONFIG_FORMATS
 from .common import ContentIncludeMode
 from .common import CONTENT_INCLUDE_MODES
 from .common import ContentLocation
 from .common import CONTENT_LOCATIONS
 
-from .URLBase import URLBase
-from .URLBase import PrivacyMode
-from .plugins.NotifyBase import NotifyBase
-from .config.ConfigBase import ConfigBase
-from .attachment.AttachBase import AttachBase
-
-from .Apprise import Apprise
-from .AppriseAsset import AppriseAsset
-from .AppriseConfig import AppriseConfig
-from .AppriseAttachment import AppriseAttachment
+from .url import URLBase
+from .url import PrivacyMode
+from .plugins.base import NotifyBase
+from .config.base import ConfigBase
+from .attachment.base import AttachBase
+
+from .apprise import Apprise
+from .locale import AppriseLocale
+from .asset import AppriseAsset
+from .apprise_config import AppriseConfig
+from .apprise_attachment import AppriseAttachment
 
 from . import decorators
 
 # Inherit our logging with our additional entries added to it
 from .logger import logging
 from .logger import logger
 from .logger import LogCapture
 
 # Set default logging handler to avoid "No handler found" warnings.
 logging.getLogger(__name__).addHandler(logging.NullHandler())
 
 __all__ = [
     # Core
     'Apprise', 'AppriseAsset', 'AppriseConfig', 'AppriseAttachment', 'URLBase',
-    'NotifyBase', 'ConfigBase', 'AttachBase',
+    'NotifyBase', 'ConfigBase', 'AttachBase', 'AppriseLocale',
 
     # Reference
     'NotifyType', 'NotifyImageSize', 'NotifyFormat', 'OverflowMode',
     'NOTIFY_TYPES', 'NOTIFY_IMAGE_SIZES', 'NOTIFY_FORMATS', 'OVERFLOW_MODES',
     'ConfigFormat', 'CONFIG_FORMATS',
     'ContentIncludeMode', 'CONTENT_INCLUDE_MODES',
     'ContentLocation', 'CONTENT_LOCATIONS',
```

### Comparing `apprise-1.7.6/apprise/assets/NotifyXML-1.0.xsd` & `apprise-1.8.0/apprise/assets/NotifyXML-1.0.xsd`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/NotifyXML-1.1.xsd` & `apprise-1.8.0/apprise/assets/NotifyXML-1.1.xsd`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-failure-128x128.ico` & `apprise-1.8.0/apprise/assets/themes/default/apprise-failure-128x128.ico`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-failure-128x128.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-failure-128x128.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-failure-256x256.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-failure-256x256.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-failure-32x32.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-failure-32x32.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-failure-72x72.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-failure-72x72.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-info-128x128.ico` & `apprise-1.8.0/apprise/assets/themes/default/apprise-info-128x128.ico`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-info-128x128.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-info-128x128.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-info-256x256.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-info-256x256.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-info-32x32.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-info-32x32.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-info-72x72.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-info-72x72.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-logo.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-logo.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-success-128x128.ico` & `apprise-1.8.0/apprise/assets/themes/default/apprise-success-128x128.ico`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-success-128x128.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-success-128x128.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-success-256x256.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-success-256x256.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-success-32x32.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-success-32x32.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-success-72x72.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-success-72x72.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-warning-128x128.ico` & `apprise-1.8.0/apprise/assets/themes/default/apprise-warning-128x128.ico`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-warning-128x128.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-warning-128x128.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-warning-256x256.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-warning-256x256.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-warning-32x32.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-warning-32x32.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/assets/themes/default/apprise-warning-72x72.png` & `apprise-1.8.0/apprise/assets/themes/default/apprise-warning-72x72.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/attachment/AttachBase.py` & `apprise-1.8.0/apprise/attachment/base.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,18 +25,18 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 import time
 import mimetypes
-from ..URLBase import URLBase
+from ..url import URLBase
 from ..utils import parse_bool
 from ..common import ContentLocation
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class AttachBase(URLBase):
     """
     This is the base class for all supported attachment types
     """
 
@@ -311,15 +311,15 @@
 
         If a download fails, you should ensure these values are set to None.
         """
         raise NotImplementedError(
             "download() is implimented by the child class.")
 
     @staticmethod
-    def parse_url(url, verify_host=True, mimetype_db=None):
+    def parse_url(url, verify_host=True, mimetype_db=None, sanitize=True):
         """Parses the URL and returns it broken apart into a dictionary.
 
         This is very specific and customized for Apprise.
 
         Args:
             url (str): The URL you want to fully parse.
             verify_host (:obj:`bool`, optional): a flag kept with the parsed
@@ -329,15 +329,16 @@
                  you leave this default value set to True.
 
         Returns:
             A dictionary is returned containing the URL fully parsed if
             successful, otherwise None is returned.
         """
 
-        results = URLBase.parse_url(url, verify_host=verify_host)
+        results = URLBase.parse_url(
+            url, verify_host=verify_host, sanitize=sanitize)
 
         if not results:
             # We're done; we failed to parse our url
             return results
 
         # Allow overriding the default config mime type
         if 'mime' in results['qsd']:
```

### Comparing `apprise-1.7.6/apprise/attachment/AttachBase.pyi` & `apprise-1.8.0/apprise/attachment/base.pyi`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/attachment/AttachFile.py` & `apprise-1.8.0/apprise/attachment/file.py`

 * *Files 4% similar despite different names*

```diff
@@ -24,17 +24,17 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import os
-from .AttachBase import AttachBase
+from .base import AttachBase
 from ..common import ContentLocation
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class AttachFile(AttachBase):
     """
     A wrapper for File based attachment sources
     """
```

### Comparing `apprise-1.7.6/apprise/attachment/AttachHTTP.py` & `apprise-1.8.0/apprise/attachment/http.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,18 +27,18 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import os
 import requests
 import threading
 from tempfile import NamedTemporaryFile
-from .AttachBase import AttachBase
+from .base import AttachBase
 from ..common import ContentLocation
-from ..URLBase import PrivacyMode
-from ..AppriseLocale import gettext_lazy as _
+from ..url import PrivacyMode
+from ..locale import gettext_lazy as _
 
 
 class AttachHTTP(AttachBase):
     """
     A wrapper for HTTP based attachment sources
     """
 
@@ -292,16 +292,15 @@
 
         super().invalidate()
 
     def __del__(self):
         """
         Tidy memory if open
         """
-        with self._lock:
-            self.invalidate()
+        self.invalidate()
 
     def url(self, privacy=False, *args, **kwargs):
         """
         Returns the URL built dynamically based on specified arguments.
         """
 
         # Our URL parameters
@@ -359,16 +358,15 @@
     @staticmethod
     def parse_url(url):
         """
         Parses the URL and returns enough arguments that can allow
         us to re-instantiate this object.
 
         """
-        results = AttachBase.parse_url(url)
-
+        results = AttachBase.parse_url(url, sanitize=False)
         if not results:
             # We're done early as we couldn't load the results
             return results
 
         # Add our headers that the user can potentially over-ride if they wish
         # to to our returned result set
         results['headers'] = results['qsd-']
```

### Comparing `apprise-1.7.6/apprise/attachment/__init__.py` & `apprise-1.8.0/apprise/attachment/__init__.py`

 * *Files 8% similar despite different names*

```diff
@@ -23,17 +23,18 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 # Used for testing
-from .AttachBase import AttachBase
-from ..AttachmentManager import AttachmentManager
+from .base import AttachBase
+from ..manager_attachment import AttachmentManager
 
 # Initalize our Attachment Manager Singleton
 A_MGR = AttachmentManager()
 
 __all__ = [
     # Reference
     'AttachBase',
+    'AttachmentManager',
 ]
```

### Comparing `apprise-1.7.6/apprise/cli.py` & `apprise-1.8.0/apprise/cli.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/common.py` & `apprise-1.8.0/apprise/common.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/config/ConfigBase.py` & `apprise-1.8.0/apprise/config/base.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,23 +29,23 @@
 import os
 import re
 import yaml
 import time
 
 from .. import plugins
 from .. import common
-from ..AppriseAsset import AppriseAsset
-from ..URLBase import URLBase
-from ..ConfigurationManager import ConfigurationManager
+from ..asset import AppriseAsset
+from ..url import URLBase
 from ..utils import GET_SCHEMA_RE
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import parse_urls
 from ..utils import cwe312_url
-from ..NotificationManager import NotificationManager
+from ..manager_config import ConfigurationManager
+from ..manager_plugins import NotificationManager
 
 # Test whether token is valid or not
 VALID_TOKEN = re.compile(
     r'(?P<token>[a-z0-9][a-z0-9_]+)', re.I)
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
```

### Comparing `apprise-1.7.6/apprise/config/ConfigFile.py` & `apprise-1.8.0/apprise/config/file.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,18 +24,18 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import os
-from .ConfigBase import ConfigBase
+from .base import ConfigBase
 from ..common import ConfigFormat
 from ..common import ContentIncludeMode
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class ConfigFile(ConfigBase):
     """
     A wrapper for File based configuration sources
     """
```

### Comparing `apprise-1.7.6/apprise/config/ConfigHTTP.py` & `apprise-1.8.0/apprise/config/http.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,19 +24,19 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
-from .ConfigBase import ConfigBase
+from .base import ConfigBase
 from ..common import ConfigFormat
 from ..common import ContentIncludeMode
-from ..URLBase import PrivacyMode
-from ..AppriseLocale import gettext_lazy as _
+from ..url import PrivacyMode
+from ..locale import gettext_lazy as _
 
 # Support YAML formats
 # text/yaml
 # text/x-yaml
 # application/yaml
 # application/x-yaml
 MIME_IS_YAML = re.compile('(text|application)/(x-)?yaml', re.I)
```

### Comparing `apprise-1.7.6/apprise/config/ConfigMemory.py` & `apprise-1.8.0/apprise/config/memory.py`

 * *Files 2% similar despite different names*

```diff
@@ -22,16 +22,16 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from .ConfigBase import ConfigBase
-from ..AppriseLocale import gettext_lazy as _
+from .base import ConfigBase
+from ..locale import gettext_lazy as _
 
 
 class ConfigMemory(ConfigBase):
     """
     For information that was loaded from memory and does not
     persist anywhere.
     """
```

### Comparing `apprise-1.7.6/apprise/config/__init__.py` & `apprise-1.8.0/apprise/config/__init__.py`

 * *Files 8% similar despite different names*

```diff
@@ -23,17 +23,18 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 # Used for testing
-from .ConfigBase import ConfigBase
-from ..ConfigurationManager import ConfigurationManager
+from .base import ConfigBase
+from ..manager_config import ConfigurationManager
 
 # Initalize our Config Manager Singleton
 C_MGR = ConfigurationManager()
 
 __all__ = [
     # Reference
     'ConfigBase',
+    'ConfigurationManager',
 ]
```

### Comparing `apprise-1.7.6/apprise/conversion.py` & `apprise-1.8.0/apprise/conversion.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 from markdown import markdown
 from .common import NotifyFormat
-from .URLBase import URLBase
+from .url import URLBase
 
 from html.parser import HTMLParser
 
 
 def convert_between(from_format, to_format, content):
     """
     Converts between different suported formats. If no conversion exists,
```

### Comparing `apprise-1.7.6/apprise/decorators/CustomNotifyPlugin.py` & `apprise-1.8.0/apprise/decorators/base.py`

 * *Files 2% similar despite different names*

```diff
@@ -23,16 +23,16 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from ..plugins.NotifyBase import NotifyBase
-from ..NotificationManager import NotificationManager
+from ..plugins.base import NotifyBase
+from ..manager_plugins import NotificationManager
 from ..utils import URL_DETAILS_RE
 from ..utils import parse_url
 from ..utils import url_assembly
 from ..utils import dict_full_update
 from .. import common
 from ..logger import logger
 import inspect
@@ -51,14 +51,17 @@
     # Our Custom notification
     service_url = 'https://github.com/caronc/apprise/wiki/Custom_Notification'
 
     # Over-ride our category since this inheritance of the NotifyBase class
     # should be treated differently.
     category = 'custom'
 
+    # Support Attachments
+    attachment_support = True
+
     # Define object templates
     templates = (
         '{schema}://',
     )
 
     @staticmethod
     def parse_url(url):
```

### Comparing `apprise-1.7.6/apprise/decorators/__init__.py` & `apprise-1.8.0/apprise/decorators/__init__.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/decorators/notify.py` & `apprise-1.8.0/apprise/decorators/notify.py`

 * *Files 4% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from .CustomNotifyPlugin import CustomNotifyPlugin
+from .base import CustomNotifyPlugin
 
 
 def notify(on, name=None):
     """
     @notify decorator allows you to map functions you've defined to be loaded
     as a regular notify by Apprise.  You must identify a protocol that
     users will trigger your call by.
```

### Comparing `apprise-1.7.6/apprise/emojis.py` & `apprise-1.8.0/apprise/emojis.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/i18n/en/LC_MESSAGES/apprise.mo` & `apprise-1.8.0/apprise/i18n/en/LC_MESSAGES/apprise.mo`

 * *Files 0% similar despite different names*

#### msgunfmt {}

```diff
@@ -7,15 +7,15 @@
 "Last-Translator: Chris Caron <lead2gold@gmail.com>\n"
 "Language: en\n"
 "Language-Team: en <LL@li.org>\n"
 "Plural-Forms: nplurals=2; plural=(n != 1);\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=utf-8\n"
 "Content-Transfer-Encoding: 8bit\n"
-"Generated-By: Babel 2.12.1\n"
+"Generated-By: Babel 2.13.1\n"
 
 msgid "API Key"
 msgstr "API Key"
 
 msgid "Access Key"
 msgstr "Access Key"
```

### Comparing `apprise-1.7.6/apprise/logger.py` & `apprise-1.8.0/apprise/logger.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/manager.py` & `apprise-1.8.0/apprise/manager.py`

 * *Files 2% similar despite different names*

```diff
@@ -57,14 +57,17 @@
 
     # Our Module Python path name
     module_name_prefix = f'apprise.{_id}'
 
     # The module path to scan
     module_path = join(abspath(dirname(__file__)), _id)
 
+    # For filtering our result when scanning a module
+    module_filter_re = re.compile(r'^(?P<name>((?!_)[A-Za-z0-9]+))$')
+
     # thread safe loading
     _lock = threading.Lock()
 
     def __init__(self, *args, **kwargs):
         """
         Over-ride our class instantiation to provide a singleton
         """
@@ -173,29 +176,25 @@
                 self._schema_map = {}
                 self._custom_module_map = {}
 
             # Used for the detection of additional Notify Services objects
             # The .py extension is optional as we support loading directories
             # too
             module_re = re.compile(
-                r'^(?P<name>' + self.fname_prefix + r'[a-z0-9]+)(\.py)?$',
+                r'^(?P<name>(?!base|_)[a-z0-9_]+)(\.py)?$',
                 re.I)
 
             t_start = time.time()
             for f in os.listdir(module_path):
                 tl_start = time.time()
                 match = module_re.match(f)
                 if not match:
                     # keep going
                     continue
 
-                elif match.group('name') == f'{self.fname_prefix}Base':
-                    # keep going
-                    continue
-
                 # Store our notification/plugin name:
                 module_name = match.group('name')
                 module_pyname = '{}.{}'.format(module_name_prefix, module_name)
 
                 if module_name in self._module_map:
                     logger.warning(
                         "%s(s) (%s) already loaded; ignoring %s",
@@ -212,56 +211,64 @@
                     # No problem, we can try again another way...
                     module = import_module(
                         os.path.join(module_path, f), module_pyname)
                     if not module:
                         # logging found in import_module and not needed here
                         continue
 
-                if not hasattr(module, module_name):
+                module_class = None
+                for m_class in [obj for obj in dir(module)
+                                if self.module_filter_re.match(obj)]:
+                    # Get our plugin
+                    plugin = getattr(module, m_class)
+                    if not hasattr(plugin, 'app_id'):
+                        # Filter out non-notification modules
+                        logger.trace(
+                            "(%s) import failed; no app_id defined in %s",
+                            self.name, m_class, os.path.join(module_path, f))
+                        continue
+
+                    # Add our plugin name to our module map
+                    self._module_map[module_name] = {
+                        'plugin': set([plugin]),
+                        'module': module,
+                        'path': '{}.{}'.format(
+                            module_name_prefix, module_name),
+                        'native': True,
+                    }
+
+                    fn = getattr(plugin, 'schemas', None)
+                    schemas = set([]) if not callable(fn) else fn(plugin)
+
+                    # map our schema to our plugin
+                    for schema in schemas:
+                        if schema in self._schema_map:
+                            logger.error(
+                                "{} schema ({}) mismatch detected - {} to {}"
+                                .format(self.name, schema, self._schema_map,
+                                        plugin))
+                            continue
+
+                        # Assign plugin
+                        self._schema_map[schema] = plugin
+
+                    # Store our class
+                    module_class = m_class
+                    break
+
+                if not module_class:
                     # Not a library we can load as it doesn't follow the simple
                     # rule that the class must bear the same name as the
                     # notification file itself.
                     logger.trace(
                         "%s (%s) import failed; no filename/Class "
                         "match found in %s",
                         self.name, module_name, os.path.join(module_path, f))
                     continue
 
-                # Get our plugin
-                plugin = getattr(module, module_name)
-                if not hasattr(plugin, 'app_id'):
-                    # Filter out non-notification modules
-                    logger.trace(
-                        "(%s) import failed; no app_id defined in %s",
-                        self.name, module_name, os.path.join(module_path, f))
-                    continue
-
-                # Add our plugin name to our module map
-                self._module_map[module_name] = {
-                    'plugin': set([plugin]),
-                    'module': module,
-                    'path': '{}.{}'.format(module_name_prefix, module_name),
-                    'native': True,
-                }
-
-                fn = getattr(plugin, 'schemas', None)
-                schemas = set([]) if not callable(fn) else fn(plugin)
-
-                # map our schema to our plugin
-                for schema in schemas:
-                    if schema in self._schema_map:
-                        logger.error(
-                            "{} schema ({}) mismatch detected - {} to {}"
-                            .format(self.name, schema, self._schema_map,
-                                    plugin))
-                        continue
-
-                    # Assign plugin
-                    self._schema_map[schema] = plugin
-
                 logger.trace(
                     '{} {} loaded in {:.6f}s'.format(
                         self.name, module_name, (time.time() - tl_start)))
 
             # Track the directory loaded so we never load it again
             self._loaded.add(module_path)
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyAppriseAPI.py` & `apprise-1.8.0/apprise/plugins/apprise_api.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,20 +27,20 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 from json import dumps
 import base64
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class AppriseAPIMethod:
     """
     Defines the method to post data tot he remote server
     """
     JSON = 'json'
@@ -119,15 +119,15 @@
             'private': True,
         },
         'token': {
             'name': _('Token'),
             'type': 'string',
             'required': True,
             'private': True,
-            'regex': (r'^[A-Z0-9_-]{1,32}$', 'i'),
+            'regex': (r'^[A-Z0-9_-]{1,128}$', 'i'),
         },
     })
 
     # Define our template arguments
     template_args = dict(NotifyBase.template_args, **{
         'tags': {
             'name': _('Tags'),
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyAprs.py` & `apprise-1.8.0/apprise/plugins/aprs.py`

 * *Files 0% similar despite different names*

```diff
@@ -66,17 +66,17 @@
 # APRS message format specification:
 # http://www.aprs.org/doc/APRS101.PDF
 #
 
 import socket
 import sys
 from itertools import chain
-from .NotifyBase import NotifyBase
-from ..AppriseLocale import gettext_lazy as _
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..locale import gettext_lazy as _
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_call_sign
 from ..utils import parse_call_sign
 from .. import __version__
 import re
 
 # Fixed APRS-IS server locales
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyBark.py` & `apprise-1.8.0/apprise/plugins/bark.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,21 +28,21 @@
 
 #
 # API: https://github.com/Finb/bark-server/blob/master/docs/API_V2.md#python
 #
 import requests
 import json
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Sounds generated off of: https://github.com/Finb/Bark/tree/master/Sounds
 BARK_SOUNDS = (
     "alarm.caf",
     "anticipate.caf",
     "bell.caf",
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyBase.py` & `apprise-1.8.0/apprise/plugins/base.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,24 +26,24 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import asyncio
 import re
 from functools import partial
 
-from ..URLBase import URLBase
+from ..url import URLBase
 from ..common import NotifyType
 from ..utils import parse_bool
 from ..common import NOTIFY_TYPES
 from ..common import NotifyFormat
 from ..common import NOTIFY_FORMATS
 from ..common import OverflowMode
 from ..common import OVERFLOW_MODES
-from ..AppriseLocale import gettext_lazy as _
-from ..AppriseAttachment import AppriseAttachment
+from ..locale import gettext_lazy as _
+from ..apprise_attachment import AppriseAttachment
 
 
 class NotifyBase(URLBase):
     """
     This is the base class for all notification services
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyBoxcar.py` & `apprise-1.8.0/apprise/plugins/boxcar.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,22 +31,22 @@
 import hmac
 from json import dumps
 from time import time
 from hashlib import sha1
 from itertools import chain
 from urllib.parse import urlparse
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..utils import parse_bool
 from ..utils import parse_list
 from ..utils import validate_regex
 from ..common import NotifyType
 from ..common import NotifyImageSize
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default to sending to all devices if nothing is specified
 DEFAULT_TAG = '@all'
 
 # The tags value is an structure containing an array of strings defining the
 # list of tagged devices that the notification need to be send to, and a
 # boolean operator (‘and’ / ‘or’) that defines the criteria to match devices
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyBulkSMS.py` & `apprise-1.8.0/apprise/plugins/bulksms.py`

 * *Files 2% similar despite different names*

```diff
@@ -32,21 +32,21 @@
 #
 # API is documented here:
 #   - https://www.bulksms.com/developer/json/v1/#tag/Message
 import re
 import requests
 import json
 from itertools import chain
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 IS_GROUP_RE = re.compile(
     r'^(@?(?P<group>[A-Z0-9_-]+))$',
     re.IGNORECASE,
 )
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyBulkVS.py` & `apprise-1.8.0/apprise/plugins/bulkvs.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,21 +31,21 @@
 #     https://www.bulkvs.com/
 
 # API is documented here:
 #   - https://portal.bulkvs.com/api/v1.0/documentation#/\
 #             Messaging/post_messageSend
 import requests
 import json
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyBulkVS(NotifyBase):
     """
     A wrapper for BulkVS Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyBurstSMS.py` & `apprise-1.8.0/apprise/plugins/burstsms.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,22 +29,22 @@
 # Sign-up with https://burstsms.com/
 #
 # Define your API Secret here and acquire your API Key
 #  - https://can.transmitsms.com/profile
 #
 import requests
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class BurstSMSCountryCode:
     # Australia
     AU = 'au'
     # New Zeland
     NZ = 'nz'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyChantify.py` & `apprise-1.8.0/apprise/plugins/chantify.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,18 +31,18 @@
 
 # The API URL will look something like this:
 #    https://api.chanify.net/v1/sender/token
 #
 
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyChantify(NotifyBase):
     """
     A wrapper for Chantify Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyClickSend.py` & `apprise-1.8.0/apprise/plugins/clicksend.py`

 * *Files 3% similar despite different names*

```diff
@@ -37,23 +37,22 @@
 #   - clicksend://{user}:{password}@{phoneno1}/{phoneno2}
 
 # The API reference used to build this plugin was documented here:
 #  https://developers.clicksend.com/docs/rest/v3/
 #
 import requests
 from json import dumps
-from base64 import b64encode
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 CLICKSEND_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token.',
 }
 
 
@@ -85,29 +84,30 @@
     title_maxlen = 0
 
     # The maximum SMS batch size accepted by the ClickSend API
     default_batch_size = 1000
 
     # Define object templates
     templates = (
-        '{schema}://{user}:{password}@{targets}',
+        '{schema}://{user}:{apikey}@{targets}',
     )
 
     # Define our template tokens
     template_tokens = dict(NotifyBase.template_tokens, **{
         'user': {
             'name': _('User Name'),
             'type': 'string',
             'required': True,
         },
-        'password': {
-            'name': _('Password'),
+        'apikey': {
+            'name': _('API Key'),
             'type': 'string',
             'private': True,
             'required': True,
+            'map_to': 'password',
         },
         'target_phone': {
             'name': _('Target Phone No'),
             'type': 'string',
             'prefix': '+',
             'regex': (r'^[0-9\s)(+-]+$', 'i'),
             'map_to': 'targets',
@@ -120,14 +120,17 @@
     })
 
     # Define our template arguments
     template_args = dict(NotifyBase.template_args, **{
         'to': {
             'alias_of': 'targets',
         },
+        'key': {
+            'alias_of': 'apikey',
+        },
         'batch': {
             'name': _('Batch Mode'),
             'type': 'bool',
             'default': False,
         },
     })
 
@@ -170,17 +173,14 @@
             # There were no services to notify
             self.logger.warning('There were no ClickSend targets to notify.')
             return False
 
         headers = {
             'User-Agent': self.app_id,
             'Content-Type': 'application/json; charset=utf-8',
-            'Authorization': 'Basic {}'.format(
-                b64encode('{}:{}'.format(
-                    self.user, self.password).encode('utf-8'))),
         }
 
         # error tracking (used for function return)
         has_error = False
 
         # prepare JSON Object
         payload = {
@@ -204,14 +204,15 @@
 
             # Always call throttle before any remote server i/o is made
             self.throttle()
             try:
                 r = requests.post(
                     self.notify_url,
                     data=dumps(payload),
+                    auth=(self.user, self.password),
                     headers=headers,
                     verify=self.verify_certificate,
                     timeout=self.request_timeout,
                 )
                 if r.status_code != requests.codes.ok:
                     # We had a problem
                     status_str = \
@@ -318,14 +319,20 @@
         results['targets'].extend(
             NotifyClickSend.split_path(results['fullpath']))
 
         # Get Batch Mode Flag
         results['batch'] = \
             parse_bool(results['qsd'].get('batch', False))
 
+        # API Key
+        if 'key' in results['qsd'] and len(results['qsd']['key']):
+            # Extract the API Key from an argument
+            results['password'] = \
+                NotifyClickSend.unquote(results['qsd']['key'])
+
         # Support the 'to' variable so that we can support rooms this way too
         # The 'to' makes it easier to use yaml configuration
         if 'to' in results['qsd'] and len(results['qsd']['to']):
             results['targets'] += \
                 NotifyClickSend.parse_phone_no(results['qsd']['to'])
 
         return results
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyD7Networks.py` & `apprise-1.8.0/apprise/plugins/d7networks.py`

 * *Files 1% similar despite different names*

```diff
@@ -35,21 +35,21 @@
 #
 # API Reference: https://d7networks.com/docs/Messages/Send_Message/
 
 import requests
 from json import dumps
 from json import loads
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 D7NETWORKS_HTTP_ERROR_MAP = {
     401: 'Invalid Argument(s) Specified.',
     403: 'Unauthorized - Authentication Failure.',
     412: 'A Routing Error Occured',
     500: 'A Serverside Error Occured Handling the Request.',
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyDBus.py` & `apprise-1.8.0/apprise/plugins/dbus.py`

 * *Files 2% similar despite different names*

```diff
@@ -23,19 +23,19 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import sys
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default our global support flag
 NOTIFY_DBUS_SUPPORT_ENABLED = False
 
 # Image support is dependant on the GdkPixbuf library being available
 NOTIFY_DBUS_IMAGE_SUPPORT = False
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyDapnet.py` & `apprise-1.8.0/apprise/plugins/dapnet.py`

 * *Files 2% similar despite different names*

```diff
@@ -47,17 +47,17 @@
 
 # The API reference used to build this plugin was documented here:
 #  https://hampager.de/dokuwiki/doku.php#dapnet_api
 #
 import requests
 from requests.auth import HTTPBasicAuth
 
-from .NotifyBase import NotifyBase
-from ..AppriseLocale import gettext_lazy as _
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..locale import gettext_lazy as _
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_call_sign
 from ..utils import parse_call_sign
 from ..utils import parse_list
 from ..utils import parse_bool
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyDingTalk.py` & `apprise-1.8.0/apprise/plugins/dingtalk.py`

 * *Files 2% similar despite different names*

```diff
@@ -30,21 +30,21 @@
 import time
 import hmac
 import hashlib
 import base64
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Register at https://dingtalk.com
 #   - Download their PC based software as it is the only way you can create
 #     a custom robot.  You can create a custom robot per group.  You will
 #     be provided an access_token that Apprise will need.
 
 # Syntax:
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyDiscord.py` & `apprise-1.8.0/apprise/plugins/discord.py`

 * *Files 0% similar despite different names*

```diff
@@ -46,22 +46,22 @@
 import re
 import requests
 from json import dumps
 from datetime import timedelta
 from datetime import datetime
 from datetime import timezone
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
-from ..attachment.AttachBase import AttachBase
+from ..locale import gettext_lazy as _
+from ..attachment.base import AttachBase
 
 
 # Used to detect user/role IDs
 USER_ROLE_DETECTION_RE = re.compile(
     r'\s*(?:<@(?P<role>&?)(?P<id>[0-9]+)>|@(?P<value>[a-z0-9]+))', re.I)
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyEmail.py` & `apprise-1.8.0/apprise/plugins/email.py`

 * *Files 0% similar despite different names*

```diff
@@ -37,20 +37,20 @@
 from email.header import Header
 from email import charset
 
 from socket import error as SocketError
 from datetime import datetime
 from datetime import timezone
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyFormat, NotifyType
 from ..conversion import convert_between
-from ..utils import is_email, parse_emails, is_hostname
-from ..AppriseLocale import gettext_lazy as _
+from ..utils import is_ipaddr, is_email, parse_emails, is_hostname
+from ..locale import gettext_lazy as _
 from ..logger import logger
 
 # Globally Default encoding mode set to Quoted Printable.
 charset.add_charset('utf-8', charset.QP, charset.QP, 'utf-8')
 
 
 class WebBaseLogin:
@@ -1049,16 +1049,20 @@
         if not results:
             # We're done early as we couldn't load the results
             return results
 
         # Prepare our target lists
         results['targets'] = []
 
-        if not is_hostname(results['host'], ipv4=False, ipv6=False,
-                           underscore=False):
+        if is_ipaddr(results['host']):
+            # Silently move on and do not disrupt any configuration
+            pass
+
+        elif not is_hostname(results['host'], ipv4=False, ipv6=False,
+                             underscore=False):
 
             if is_email(NotifyEmail.unquote(results['host'])):
                 # Don't lose defined email addresses
                 results['targets'].append(NotifyEmail.unquote(results['host']))
 
             # Detect if we have a valid hostname or not; be sure to reset it's
             # value if invalid; we'll attempt to figure this out later on
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyEmby.py` & `apprise-1.8.0/apprise/plugins/emby.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,20 +30,20 @@
 # Authentication: https://github.com/MediaBrowser/Emby/wiki/Authentication
 # Notifications: https://github.com/MediaBrowser/Emby/wiki/Remote-control
 import requests
 import hashlib
 from json import dumps
 from json import loads
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..utils import parse_bool
 from ..common import NotifyType
 from .. import __version__ as VERSION
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyEmby(NotifyBase):
     """
     A wrapper for Emby Notifications
     """
     # The default descriptive name associated with the Notification
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyEnigma2.py` & `apprise-1.8.0/apprise/plugins/enigma2.py`

 * *Files 2% similar despite different names*

```diff
@@ -33,18 +33,18 @@
 # - https://github.com/E2OpenPlugins/e2openplugin-OpenWebif
 # - https://github.com/E2OpenPlugins/e2openplugin-OpenWebif/wiki/\
 #       OpenWebif-API-documentation#message
 
 import requests
 from json import loads
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class Enigma2MessageType:
     # Defines the Enigma2 notification types Apprise can map to
     INFO = 1
     WARNING = 2
     ERROR = 3
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFCM/__init__.py` & `apprise-1.8.0/apprise/plugins/fcm/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -46,23 +46,23 @@
 # https://firebase.google.com/docs/cloud-messaging/http-server-ref\
 #       #send-downstream
 #
 # If you Generate a new private key, it will provide a .json file
 # You will need this in order to send an apprise messag
 import requests
 from json import dumps
-from ..NotifyBase import NotifyBase
+from ..base import NotifyBase
 from ...common import NotifyType
 from ...utils import validate_regex
 from ...utils import parse_list
 from ...utils import parse_bool
 from ...utils import dict_full_update
 from ...common import NotifyImageSize
-from ...AppriseAttachment import AppriseAttachment
-from ...AppriseLocale import gettext_lazy as _
+from ...apprise_attachment import AppriseAttachment
+from ...locale import gettext_lazy as _
 from .common import (FCMMode, FCM_MODES)
 from .priority import (FCM_PRIORITIES, FCMPriorityManager)
 from .color import FCMColorManager
 
 # Default our global support flag
 NOTIFY_FCM_SUPPORT_ENABLED = False
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFCM/color.py` & `apprise-1.8.0/apprise/plugins/fcm/color.py`

 * *Files 0% similar despite different names*

```diff
@@ -32,15 +32,15 @@
 
 # Legacy color payload example here:
 # https://firebase.google.com/docs/reference/fcm/rest/v1/\
 #       projects.messages#androidnotification
 import re
 from ...utils import parse_bool
 from ...common import NotifyType
-from ...AppriseAsset import AppriseAsset
+from ...asset import AppriseAsset
 
 
 class FCMColorManager:
     """
     A Simple object to accept either a boolean value
       - True: Use colors provided by Apprise
       - False: Do not use colors at all
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFCM/common.py` & `apprise-1.8.0/apprise/plugins/fcm/common.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFCM/oauth.py` & `apprise-1.8.0/apprise/plugins/fcm/oauth.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFCM/priority.py` & `apprise-1.8.0/apprise/plugins/fcm/priority.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFeishu.py` & `apprise-1.8.0/apprise/plugins/feishu.py`

 * *Files 2% similar despite different names*

```diff
@@ -32,18 +32,18 @@
 # Custom Bot Setup
 #    https://open.feishu.cn/document/client-docs/bot-v3/add-custom-bot
 #
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyFeishu(NotifyBase):
     """
     A wrapper for Feishu Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFlock.py` & `apprise-1.8.0/apprise/plugins/flock.py`

 * *Files 1% similar despite different names*

```diff
@@ -40,22 +40,22 @@
 #
 #  It becomes your 'token' that you will pass into this class
 #
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..common import NotifyImageSize
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Extend HTTP Error Messages
 FLOCK_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token.',
 }
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyForm.py` & `apprise-1.8.0/apprise/plugins/custom_form.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,19 +25,19 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class FORMPayloadField:
     """
     Identifies the fields available in the FORM Payload
     """
     VERSION = 'version'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyFreeMobile.py` & `apprise-1.8.0/apprise/plugins/freemobile.py`

 * *Files 2% similar despite different names*

```diff
@@ -32,17 +32,17 @@
 # the URL will look something like this:
 #      https://smsapi.free-mobile.fr/sendmsg
 #
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyFreeMobile(NotifyBase):
     """
     A wrapper for Free-Mobile Notifications
     """
 
@@ -122,14 +122,15 @@
         """
         Send our notification
         """
 
         # prepare our headers
         headers = {
             'User-Agent': self.app_id,
+            'Content-Type': 'application/json',
         }
 
         # Prepare our payload
         payload = {
             'user': self.user,
             'pass': self.password,
             'msg': body
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyGnome.py` & `apprise-1.8.0/apprise/plugins/gnome.py`

 * *Files 2% similar despite different names*

```diff
@@ -22,19 +22,19 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default our global support flag
 NOTIFY_GNOME_SUPPORT_ENABLED = False
 
 try:
     # 3rd party modules (Gnome Only)
     import gi
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyGoogleChat.py` & `apprise-1.8.0/apprise/plugins/google_chat.py`

 * *Files 1% similar despite different names*

```diff
@@ -54,19 +54,19 @@
 #         incoming-bot-python
 #    - https://developers.google.com/hangouts/chat/reference/rest
 #
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyGoogleChat(NotifyBase):
     """
     A wrapper to Google Chat Notifications
 
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyGotify.py` & `apprise-1.8.0/apprise/plugins/gotify.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,18 +30,18 @@
 # Example: https://github.com/gotify/server/blob/\
 #        f2c2688f0b5e6a816bbcec768ca1c0de5af76b88/ADD_MESSAGE_EXAMPLES.md#python
 # API: https://gotify.net/docs/swagger-docs
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType, NotifyFormat
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Priorities
 class GotifyPriority:
     LOW = 0
     MODERATE = 3
     NORMAL = 5
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyGrowl.py` & `apprise-1.8.0/apprise/plugins/growl.py`

 * *Files 0% similar despite different names*

```diff
@@ -22,20 +22,20 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default our global support flag
 NOTIFY_GROWL_SUPPORT_ENABLED = False
 
 try:
     import gntp.notifier
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyGuilded.py` & `apprise-1.8.0/apprise/plugins/guilded.py`

 * *Files 3% similar despite different names*

```diff
@@ -41,18 +41,19 @@
 #     guilded://WEBHOOK_ID/WEBHOOK_TOKEN
 #
 # API Documentation on Webhooks:
 #    - https://discord.com/developers/docs/resources/webhook
 #
 
 import re
-from .NotifyDiscord import NotifyDiscord
+# Import namespace so the class won't conflict with the actual Notify object
+from . import discord
 
 
-class NotifyGuilded(NotifyDiscord):
+class NotifyGuilded(discord.NotifyDiscord):
     """
     A wrapper to Guilded Notifications
 
     """
 
     # The default descriptive name associated with the Notification
     service_name = 'Guilded'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyHomeAssistant.py` & `apprise-1.8.0/apprise/plugins/home_assistant.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,19 +30,19 @@
 # Home Assistant Profile page.
 
 import requests
 from json import dumps
 
 from uuid import uuid4
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyHomeAssistant(NotifyBase):
     """
     A wrapper for Home Assistant Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyHttpSMS.py` & `apprise-1.8.0/apprise/plugins/httpsms.py`

 * *Files 0% similar despite different names*

```diff
@@ -27,20 +27,20 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 # To use this service you will need a httpSMS account
 # You will need credits (new accounts start with a few)
 #     https://httpsms.com
 import requests
 import json
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyHttpSMS(NotifyBase):
     """
     A wrapper for HttpSMS Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyIFTTT.py` & `apprise-1.8.0/apprise/plugins/ifttt.py`

 * *Files 1% similar despite different names*

```diff
@@ -40,19 +40,19 @@
 #
 # For each event you create you will assign it a name (this will be known as
 # the {event} when building your URL.
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyIFTTT(NotifyBase):
     """
     A wrapper for IFTTT Notifications
 
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyJSON.py` & `apprise-1.8.0/apprise/plugins/custom_json.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,19 +26,19 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 import base64
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class JSONPayloadField:
     """
     Identifies the fields available in the JSON Payload
     """
     VERSION = 'version'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyJoin.py` & `apprise-1.8.0/apprise/plugins/join.py`

 * *Files 2% similar despite different names*

```diff
@@ -35,21 +35,21 @@
 #
 # You can download the app for your phone here:
 #   https://play.google.com/store/apps/details?id=com.joaomgcd.join
 
 import re
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 JOIN_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token.',
 }
 
 # Used to detect a device
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyKavenegar.py` & `apprise-1.8.0/apprise/plugins/kavenegar.py`

 * *Files 1% similar despite different names*

```diff
@@ -34,20 +34,20 @@
 #
 # This provider does not accept +1 (for example) as a country code. You need
 # to specify 001 instead.
 #
 import requests
 from json import loads
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 # Based on https://kavenegar.com/rest.html
 KAVENEGAR_HTTP_ERROR_MAP = {
     200: 'The request was approved',
     400: 'Parameters are incomplete',
     401: 'Account has been disabled',
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyKumulos.py` & `apprise-1.8.0/apprise/plugins/kumulos.py`

 * *Files 2% similar despite different names*

```diff
@@ -35,18 +35,18 @@
 #
 # The API reference used to build this plugin was documented here:
 #  https://docs.kumulos.com/messaging/api/#sending-in-app-messages
 #
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 KUMULOS_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid API and/or Server Key.',
     422: 'Unprocessable Entity - The request was unparsable.',
     400: 'Bad Request - Targeted users do not exist or have unsubscribed.',
 }
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyLametric.py` & `apprise-1.8.0/apprise/plugins/lametric.py`

 * *Files 0% similar despite different names*

```diff
@@ -86,18 +86,18 @@
 # A great source for the icon reference:
 # - https://developer.lametric.com/icons
 
 
 import re
 import requests
 from json import dumps
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 from ..utils import is_hostname
 from ..utils import is_ipaddr
 
 # A URL Parser to detect App ID
 LAMETRIC_APP_ID_DETECTOR_RE = re.compile(
     r'(com\.lametric\.)?(?P<app_id>[0-9a-z.-]{1,64})'
     r'(/(?P<app_ver>[1-9][0-9]*))?', re.I)
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyLine.py` & `apprise-1.8.0/apprise/plugins/line.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,22 +29,22 @@
 #
 # API Docs: https://developers.line.biz/en/reference/messaging-api/
 
 import requests
 import re
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..utils import validate_regex
 from ..utils import parse_list
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Used to break path apart into list of streams
 TARGET_LIST_DELIM = re.compile(r'[ \t\r\n,#\\/]+')
 
 
 class NotifyLine(NotifyBase):
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyLunaSea.py` & `apprise-1.8.0/apprise/plugins/lunasea.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,23 +29,23 @@
 # API:
 #   https://docs.lunasea.app/lunasea/notifications/custom-notifications
 #
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..utils import parse_list
 from ..utils import is_hostname
 from ..utils import is_ipaddr
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
-from ..URLBase import PrivacyMode
+from ..locale import gettext_lazy as _
+from ..url import PrivacyMode
 
 
 class LunaSeaMode:
     """
     Define LunaSea Notification Modes
     """
     # App posts upstream to the developer API on LunaSea's website
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMQTT.py` & `apprise-1.8.0/apprise/plugins/mqtt.py`

 * *Files 0% similar despite different names*

```diff
@@ -34,20 +34,20 @@
 #   https://github.com/eclipse/paho.mqtt.python\
 #           /blob/master/src/paho/mqtt/client.py
 import ssl
 import re
 from time import sleep
 from datetime import datetime
 from os.path import isfile
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default our global support flag
 NOTIFY_MQTT_SUPPORT_ENABLED = False
 
 try:
     # 3rd party modules
     import paho.mqtt.client as mqtt
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMSG91.py` & `apprise-1.8.0/apprise/plugins/msg91.py`

 * *Files 2% similar despite different names*

```diff
@@ -34,20 +34,20 @@
 # Note: You will need to define a template for this to work
 #
 # Get details on the API used in this plugin here:
 #   - https://docs.msg91.com/reference/send-sms
 import re
 import requests
 from json import dumps
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no, parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class MSG91PayloadField:
     """
     Identifies the fields available in the JSON Payload
     """
     BODY = 'body'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMSTeams.py` & `apprise-1.8.0/apprise/plugins/msteams.py`

 * *Files 1% similar despite different names*

```diff
@@ -77,24 +77,24 @@
 #   msteams://TEAM/ABCD/DEFG/HIJK
 #
 import re
 import requests
 import json
 from json.decoder import JSONDecodeError
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import parse_bool
 from ..utils import validate_regex
 from ..utils import apply_template
 from ..utils import TemplateType
-from ..AppriseAttachment import AppriseAttachment
-from ..AppriseLocale import gettext_lazy as _
+from ..apprise_attachment import AppriseAttachment
+from ..locale import gettext_lazy as _
 
 
 class NotifyMSTeams(NotifyBase):
     """
     A wrapper for Microsoft Teams Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMacOSX.py` & `apprise-1.8.0/apprise/plugins/macosx.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,19 +26,19 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import platform
 import subprocess
 import os
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default our global support flag
 NOTIFY_MACOSX_SUPPORT_ENABLED = False
 
 
 if platform.system() == 'Darwin':
     # Check this is Mac OS X 10.8, or higher
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMailgun.py` & `apprise-1.8.0/apprise/plugins/mailgun.py`

 * *Files 0% similar despite different names*

```diff
@@ -52,23 +52,23 @@
 #
 #  The {user}@{domain} effectively assembles the 'from' email address
 #  the email will be transmitted from.  If no email address is specified
 #  then it will also become the 'to' address as well.
 #
 import requests
 from email.utils import formataddr
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import parse_emails
 from ..utils import parse_bool
 from ..utils import is_email
 from ..utils import validate_regex
 from ..logger import logger
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Provide some known codes Mailgun uses and what they translate to:
 # Based on https://documentation.mailgun.com/en/latest/api-intro.html#errors
 MAILGUN_HTTP_ERROR_MAP = {
     400: 'A bad request was made to the server.',
     401: 'The provided API Key was not valid.',
     402: 'The request failed for a reason out of your control.',
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMastodon.py` & `apprise-1.8.0/apprise/plugins/mastodon.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,24 +29,24 @@
 import re
 import requests
 from copy import deepcopy
 from json import dumps, loads
 from datetime import datetime
 from datetime import timezone
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
-from ..attachment.AttachBase import AttachBase
+from ..locale import gettext_lazy as _
+from ..attachment.base import AttachBase
 
 # Accept:
 # - @username
 # - username
 # - username@host.com
 # - @username@host.com
 IS_USER = re.compile(
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMatrix.py` & `apprise-1.8.0/apprise/plugins/matrix.py`

 * *Files 0% similar despite different names*

```diff
@@ -33,24 +33,24 @@
 import re
 import requests
 from markdown import markdown
 from json import dumps
 from json import loads
 from time import time
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..common import NotifyFormat
 from ..utils import parse_bool
 from ..utils import parse_list
 from ..utils import is_hostname
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Define default path
 MATRIX_V1_WEBHOOK_PATH = '/api/v1/matrix/hook'
 MATRIX_V2_API_PATH = '/_matrix/client/r0'
 MATRIX_V3_API_PATH = '/_matrix/client/v3'
 MATRIX_V3_MEDIA_PATH = '/_matrix/media/v3'
 MATRIX_V2_MEDIA_PATH = '/_matrix/media/r0'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMattermost.py` & `apprise-1.8.0/apprise/plugins/mattermost.py`

 * *Files 1% similar despite different names*

```diff
@@ -35,21 +35,21 @@
 # mmost://localhost:8065/yobjmukpaw3r3urc5h6i369yima
 #  - swap http with mmost
 #  - drop /hooks/ reference
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Some Reference Locations:
 # - https://docs.mattermost.com/developer/webhooks-incoming.html
 # - https://docs.mattermost.com/administration/config-settings.html
 
 
 class NotifyMattermost(NotifyBase):
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMessageBird.py` & `apprise-1.8.0/apprise/plugins/messagebird.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,20 +30,20 @@
 #
 # Get your (apikey) and api example from the dashboard here:
 #   - https://dashboard.messagebird.com/en/user/index
 #
 
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyMessageBird(NotifyBase):
     """
     A wrapper for MessageBird Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyMisskey.py` & `apprise-1.8.0/apprise/plugins/misskey.py`

 * *Files 2% similar despite different names*

```diff
@@ -43,18 +43,18 @@
 #
 # This plugin also supports taking the URL (as identified above) directly
 # as well.
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class MisskeyVisibility:
     """
     The visibility of any note created
     """
     # post will be public
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyNextcloud.py` & `apprise-1.8.0/apprise/plugins/nextcloud.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,19 +24,19 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import parse_list
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyNextcloud(NotifyBase):
     """
     A wrapper for Nextcloud Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyNextcloudTalk.py` & `apprise-1.8.0/apprise/plugins/nextcloudtalk.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,19 +25,19 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
 from json import dumps
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import parse_list
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyNextcloudTalk(NotifyBase):
     """
     A wrapper for Nextcloud Talk Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyNotica.py` & `apprise-1.8.0/apprise/plugins/notica.py`

 * *Files 1% similar despite different names*

```diff
@@ -39,19 +39,19 @@
 #
 # 3. With respect to the above, your apprise URL would be:
 #       notica://abc123
 #
 import re
 import requests
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NoticaMode:
     """
     Tracks if we're accessing the notica upstream server or a locally hosted
     one.
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyNotifiarr.py` & `apprise-1.8.0/apprise/plugins/notifiarr.py`

 * *Files 0% similar despite different names*

```diff
@@ -27,17 +27,17 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 from json import dumps
 from itertools import chain
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 from ..common import NotifyImageSize
 from ..utils import parse_list, parse_bool
 from ..utils import validate_regex
 
 # Used to break path apart into list of channels
 CHANNEL_LIST_DELIM = re.compile(r'[ \t\r\n,#\\/]+')
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyNotifico.py` & `apprise-1.8.0/apprise/plugins/notifico.py`

 * *Files 0% similar despite different names*

```diff
@@ -40,19 +40,19 @@
 #
 # This plugin also supports taking the URL (as identified above) directly
 # as well.
 
 import re
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotificoFormat:
     # Resets all formatting
     Reset = '\x0F'
 
     # Formatting
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyNtfy.py` & `apprise-1.8.0/apprise/plugins/ntfy.py`

 * *Files 0% similar despite different names*

```diff
@@ -37,26 +37,26 @@
 #   ntfy://ntfy.local.domain/?priority=max
 import re
 import requests
 from json import loads
 from json import dumps
 from os.path import basename
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..common import NotifyImageSize
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import is_hostname
 from ..utils import is_ipaddr
 from ..utils import validate_regex
-from ..URLBase import PrivacyMode
-from ..attachment.AttachBase import AttachBase
+from ..url import PrivacyMode
+from ..attachment.base import AttachBase
 
 
 class NtfyMode:
     """
     Define ntfy Notification Modes
     """
     # App posts upstream to the developer API on ntfy's website
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyOffice365.py` & `apprise-1.8.0/apprise/plugins/office365.py`

 * *Files 0% similar despite different names*

```diff
@@ -60,22 +60,22 @@
 # 8. Now you're good to go
 
 import requests
 from datetime import datetime
 from datetime import timedelta
 from json import loads
 from json import dumps
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import is_email
 from ..utils import parse_emails
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyOffice365(NotifyBase):
     """
     A wrapper for Office 365 Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyOneSignal.py` & `apprise-1.8.0/apprise/plugins/one_signal.py`

 * *Files 1% similar despite different names*

```diff
@@ -33,22 +33,22 @@
 #  - https://documentation.onesignal.com/docs/accounts-and-keys
 #  - https://documentation.onesignal.com/reference/create-notification
 
 import requests
 from json import dumps
 from itertools import chain
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..utils import validate_regex
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import is_email
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class OneSignalCategory:
     """
     We define the different category types that we can notify via OneSignal
     """
     PLAYER = 'include_player_ids'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyOpsgenie.py` & `apprise-1.8.0/apprise/plugins/opsgenie.py`

 * *Files 0% similar despite different names*

```diff
@@ -45,21 +45,21 @@
 #
 # API Documentation: https://docs.opsgenie.com/docs/alert-api
 # API Integration Docs: https://docs.opsgenie.com/docs/api-integration
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
 from ..utils import is_uuid
 from ..utils import parse_list
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class OpsgenieCategory(NotifyBase):
     """
     We define the different category types that we can notify
     """
     USER = 'user'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPagerDuty.py` & `apprise-1.8.0/apprise/plugins/pagerduty.py`

 * *Files 2% similar despite different names*

```diff
@@ -30,21 +30,21 @@
 #   - https://developer.pagerduty.com/api-reference/\
 #       368ae3d938c9e-send-an-event-to-pager-duty
 #
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..utils import validate_regex
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class PagerDutySeverity:
     """
     Defines the Pager Duty Severity Levels
     """
     INFO = 'info'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPagerTree.py` & `apprise-1.8.0/apprise/plugins/pagertree.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,19 +27,19 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from json import dumps
 
 from uuid import uuid4
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Actions
 class PagerTreeAction:
     CREATE = 'create'
     ACKNOWLEDGE = 'acknowledge'
     RESOLVE = 'resolve'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyParsePlatform.py` & `apprise-1.8.0/apprise/plugins/parseplatform.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,18 +26,18 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Used to break path apart into list of targets
 TARGET_LIST_DELIM = re.compile(r'[ \t\r\n,\\/]+')
 
 
 # Priorities
 class ParsePlatformDevice:
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPopcornNotify.py` & `apprise-1.8.0/apprise/plugins/popcorn_notify.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,22 +24,22 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_email
 from ..utils import is_phone_no
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyPopcornNotify(NotifyBase):
     """
     A wrapper for PopcornNotify Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyProwl.py` & `apprise-1.8.0/apprise/plugins/prowl.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,18 +24,18 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Priorities
 class ProwlPriority:
     LOW = -2
     MODERATE = -1
     NORMAL = 0
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushBullet.py` & `apprise-1.8.0/apprise/plugins/pushbullet.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,21 +26,21 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from json import dumps
 from json import loads
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..utils import is_email
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
-from ..attachment.AttachBase import AttachBase
+from ..locale import gettext_lazy as _
+from ..attachment.base import AttachBase
 
 # Flag used as a placeholder to sending to all devices
 PUSHBULLET_SEND_TO_ALL = 'ALL_DEVICES'
 
 # Provide some known codes Pushbullet uses and what they translate to:
 PUSHBULLET_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token.',
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushDeer.py` & `apprise-1.8.0/apprise/plugins/pushdeer.py`

 * *Files 2% similar despite different names*

```diff
@@ -25,17 +25,17 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
 from ..common import NotifyType
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Syntax:
 #  schan://{key}/
 
 
 class NotifyPushDeer(NotifyBase):
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushMe.py` & `apprise-1.8.0/apprise/plugins/pushme.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,20 +24,20 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import validate_regex
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyPushMe(NotifyBase):
     """
     A wrapper for PushMe Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushSafer.py` & `apprise-1.8.0/apprise/plugins/pushsafer.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,19 +26,19 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import base64
 import requests
 from json import loads
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class PushSaferSound:
     """
     Defines all of the supported PushSafe sounds
     """
     # Silent
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushed.py` & `apprise-1.8.0/apprise/plugins/pushed.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,20 +27,20 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 from json import dumps
 from itertools import chain
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Used to detect and parse channels
 IS_CHANNEL = re.compile(r'^#?(?P<name>[A-Za-z0-9]+)$')
 
 # Used to detect and parse a users push id
 IS_USER_PUSHED_ID = re.compile(r'^@(?P<name>[A-Za-z0-9]+)$')
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushjet.py` & `apprise-1.8.0/apprise/plugins/pushjet.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,19 +25,19 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyPushjet(NotifyBase):
     """
     A wrapper for Pushjet Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushover.py` & `apprise-1.8.0/apprise/plugins/pushover.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,22 +26,22 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 from itertools import chain
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..conversion import convert_between
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
-from ..attachment.AttachBase import AttachBase
+from ..locale import gettext_lazy as _
+from ..attachment.base import AttachBase
 
 # Flag used as a placeholder to sending to all devices
 PUSHOVER_SEND_TO_ALL = 'ALL_DEVICES'
 
 # Used to detect a Device
 VALIDATE_DEVICE = re.compile(r'^\s*(?P<device>[a-z0-9_-]{1,25})\s*$', re.I)
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyPushy.py` & `apprise-1.8.0/apprise/plugins/pushy.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,19 +28,19 @@
 
 # API reference: https://pushy.me/docs/api/send-notifications
 import re
 import requests
 from itertools import chain
 
 from json import dumps, loads
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Used to detect a Device and Topic
 VALIDATE_DEVICE = re.compile(r'^@(?P<device>[a-z0-9]+)$', re.I)
 VALIDATE_TOPIC = re.compile(r'^[#]?(?P<topic>[a-z0-9]+)$', re.I)
 
 # Extend HTTP Error Messages
 PUSHY_HTTP_ERROR_MAP = {
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyRSyslog.py` & `apprise-1.8.0/apprise/plugins/rsyslog.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,18 +25,18 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 import socket
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class syslog:
     """
     Extrapoloated information from the syslog library so that this plugin
     would not be dependent on it.
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyReddit.py` & `apprise-1.8.0/apprise/plugins/reddit.py`

 * *Files 1% similar despite different names*

```diff
@@ -49,22 +49,22 @@
 #   - https://github.com/reddit-archive/reddit/wiki/API
 import requests
 from json import loads
 from datetime import timedelta
 from datetime import datetime
 from datetime import timezone
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 from .. import __title__, __version__
 
 # Extend HTTP Error Messages
 REDDIT_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token',
 }
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyRevolt.py` & `apprise-1.8.0/apprise/plugins/revolt.py`

 * *Files 0% similar despite different names*

```diff
@@ -38,21 +38,21 @@
 
 import requests
 from json import dumps, loads
 from datetime import timedelta
 from datetime import datetime
 from datetime import timezone
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import validate_regex
 from ..utils import parse_list
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyRevolt(NotifyBase):
     """
     A wrapper for Revolt Notifications
 
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyRocketChat.py` & `apprise-1.8.0/apprise/plugins/rocketchat.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,22 +28,22 @@
 
 import re
 import requests
 from json import loads
 from json import dumps
 from itertools import chain
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 IS_CHANNEL = re.compile(r'^#(?P<name>[A-Za-z0-9_-]+)$')
 IS_USER = re.compile(r'^@(?P<name>[A-Za-z0-9._-]+)$')
 IS_ROOM_ID = re.compile(r'^(?P<name>[A-Za-z0-9]+)$')
 
 # Extend HTTP Error Messages
 RC_HTTP_ERROR_MAP = {
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyRyver.py` & `apprise-1.8.0/apprise/plugins/ryver.py`

 * *Files 2% similar despite different names*

```diff
@@ -34,20 +34,20 @@
 #                          |                                        |
 #  These are important <---^----------------------------------------^
 #
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class RyverWebhookMode:
     """
     Ryver supports to webhook modes
     """
     SLACK = 'slack'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySES.py` & `apprise-1.8.0/apprise/plugins/ses.py`

 * *Files 0% similar despite different names*

```diff
@@ -91,21 +91,21 @@
 from email.mime.text import MIMEText
 from email.mime.application import MIMEApplication
 from email.mime.multipart import MIMEMultipart
 from email.utils import formataddr
 from email.header import Header
 from urllib.parse import quote
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_emails
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 from ..utils import is_email
 
 # Our Regin Identifier
 # support us-gov-west-1 syntax as well
 IS_REGION = re.compile(
     r'^\s*(?P<country>[a-z]{2})-(?P<area>[a-z-]+?)-(?P<no>[0-9]+)\s*$', re.I)
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySMSEagle.py` & `apprise-1.8.0/apprise/plugins/smseagle.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,22 +28,22 @@
 
 import re
 import requests
 from json import dumps, loads
 import base64
 from itertools import chain
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
-from ..URLBase import PrivacyMode
-from ..AppriseLocale import gettext_lazy as _
+from ..url import PrivacyMode
+from ..locale import gettext_lazy as _
 
 
 GROUP_REGEX = re.compile(
     r'^\s*(\#|\%35)(?P<group>[a-z0-9_-]+)', re.I)
 
 CONTACT_REGEX = re.compile(
     r'^\s*(\@|\%40)?(?P<contact>[a-z0-9_-]+)', re.I)
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySMSManager.py` & `apprise-1.8.0/apprise/plugins/smsmanager.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,21 +31,21 @@
 # To use this service you will need a SMS Manager account
 # You will need credits (new accounts start with a few)
 #     https://smsmanager.cz
 #    1. Sign up and get test credit
 #    2. Generate an API key in web administration.
 
 import requests
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class SMSManagerGateway(object):
     """
     The different gateway values
     """
     HIGH = "high"
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySMTP2Go.py` & `apprise-1.8.0/apprise/plugins/smtp2go.py`

 * *Files 1% similar despite different names*

```diff
@@ -45,22 +45,22 @@
 #  the email will be transmitted from.  If no email address is specified
 #  then it will also become the 'to' address as well.
 #
 import base64
 import requests
 from json import dumps
 from email.utils import formataddr
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import parse_emails
 from ..utils import parse_bool
 from ..utils import is_email
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 SMTP2GO_HTTP_ERROR_MAP = {
     429: 'To many requests.',
 }
 
 
 class NotifySMTP2Go(NotifyBase):
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySNS.py` & `apprise-1.8.0/apprise/plugins/sns.py`

 * *Files 0% similar despite different names*

```diff
@@ -32,21 +32,21 @@
 from hashlib import sha256
 from datetime import datetime
 from datetime import timezone
 from collections import OrderedDict
 from xml.etree import ElementTree
 from itertools import chain
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Topic Detection
 # Summary: 256 Characters max, only alpha/numeric plus underscore (_) and
 #          dash (-) additionally allowed.
 #
 #   Soure: https://docs.aws.amazon.com/AWSSimpleQueueService/latest\
 #                   /SQSDeveloperGuide/sqs-limits.html#limits-queues
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySendGrid.py` & `apprise-1.8.0/apprise/plugins/sendgrid.py`

 * *Files 0% similar despite different names*

```diff
@@ -45,21 +45,21 @@
 #  - https://sendgrid.com/docs/API_Reference/Web_API_v3/index.html
 #  - https://sendgrid.com/docs/ui/sending-email/\
 #       how-to-send-an-email-with-dynamic-transactional-templates/
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import is_email
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 SENDGRID_HTTP_ERROR_MAP = {
     401: 'Unauthorized - You do not have authorization to make the request.',
     413: 'Payload To Large - The JSON payload you have included in your '
          'request is too large.',
     429: 'Too Many Requests - The number of requests you have made exceeds '
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyServerChan.py` & `apprise-1.8.0/apprise/plugins/serverchan.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,17 +26,17 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 
 from ..common import NotifyType
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # Register at https://sct.ftqq.com/
 #   - do as the page describe and you will get the token
 
 # Syntax:
 #  schan://{access_token}/
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySignalAPI.py` & `apprise-1.8.0/apprise/plugins/signal_api.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,21 +27,21 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 from json import dumps
 import base64
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import parse_bool
-from ..URLBase import PrivacyMode
-from ..AppriseLocale import gettext_lazy as _
+from ..url import PrivacyMode
+from ..locale import gettext_lazy as _
 
 
 GROUP_REGEX = re.compile(
     r'^\s*((\@|\%40)?(group\.)|\@|\%40)(?P<group>[a-z0-9_=-]+)', re.I)
 
 
 class NotifySignalAPI(NotifyBase):
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySimplePush.py` & `apprise-1.8.0/apprise/plugins/simplepush.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,19 +26,19 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from os import urandom
 from json import loads
 import requests
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 from base64 import urlsafe_b64encode
 import hashlib
 
 try:
     from cryptography.hazmat.primitives import padding
     from cryptography.hazmat.primitives.ciphers import Cipher
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySinch.py` & `apprise-1.8.0/apprise/plugins/sinch.py`

 * *Files 1% similar despite different names*

```diff
@@ -35,21 +35,21 @@
 # This is identified as the source (or where the SMS message will originate
 # from). Activated phone numbers can be found on your dashboard here:
 #  - https://dashboard.sinch.com/numbers/your-numbers/numbers
 #
 import requests
 import json
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class SinchRegion:
     """
     Defines the Sinch Server Regions
     """
     USA = 'us'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySlack.py` & `apprise-1.8.0/apprise/plugins/slack.py`

 * *Files 1% similar despite different names*

```diff
@@ -74,23 +74,23 @@
 
 import re
 import requests
 from json import dumps
 from json import loads
 from time import time
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import is_email
 from ..utils import parse_bool
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 SLACK_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token.',
 }
 
 # Used to break path apart into list of channels
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySparkPost.py` & `apprise-1.8.0/apprise/plugins/sparkpost.py`

 * *Files 1% similar despite different names*

```diff
@@ -54,23 +54,23 @@
 #
 # API Documentation: https://developers.sparkpost.com/api/
 # Specifically: https://developers.sparkpost.com/api/transmissions/
 import requests
 import base64
 from json import loads
 from json import dumps
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import is_email
 from email.utils import formataddr
 from ..utils import validate_regex
 from ..utils import parse_emails
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Provide some known codes SparkPost uses and what they translate to:
 # Based on https://www.sparkpost.com/docs/tech-resources/extended-error-codes/
 SPARKPOST_HTTP_ERROR_MAP = {
     400: 'A bad request was made to the server',
     401: 'Invalid User ID and/or Unauthorized User',
     403: 'Permission Denied; the provided API Key was not valid',
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyStreamlabs.py` & `apprise-1.8.0/apprise/plugins/streamlabs.py`

 * *Files 1% similar despite different names*

```diff
@@ -34,18 +34,18 @@
 #     streamlabs://access_token/
 #
 # API Documentation on Webhooks:
 #    - https://dev.streamlabs.com/
 #
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # calls
 class StrmlabsCall:
     ALERT = 'ALERTS'
     DONATION = 'DONATIONS'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySynology.py` & `apprise-1.8.0/apprise/plugins/synology.py`

 * *Files 2% similar despite different names*

```diff
@@ -25,18 +25,18 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # For API Details see:
 # https://kb.synology.com/en-au/DSM/help/Chat/chat_integration
 
 
 class NotifySynology(NotifyBase):
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifySyslog.py` & `apprise-1.8.0/apprise/plugins/syslog.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,18 +24,18 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import syslog
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class SyslogFacility:
     """
     All of the supported facilities
     """
     KERN = 'kern'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyTechulusPush.py` & `apprise-1.8.0/apprise/plugins/techuluspush.py`

 * *Files 1% similar despite different names*

```diff
@@ -49,18 +49,18 @@
 # Resources
 # - https://push.techulus.com/ - Main Website
 # - https://pushtechulus.docs.apiary.io - API Documentation
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Token required as part of the API request
 # Used to prepare our UUID regex matching
 UUID4_RE = \
     r'[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyTelegram.py` & `apprise-1.8.0/apprise/plugins/telegram.py`

 * *Files 0% similar despite different names*

```diff
@@ -55,23 +55,23 @@
 import requests
 import re
 import os
 
 from json import loads
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..common import NotifyFormat
 from ..utils import parse_bool
 from ..utils import parse_list
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
-from ..attachment.AttachBase import AttachBase
+from ..locale import gettext_lazy as _
+from ..attachment.base import AttachBase
 
 TELEGRAM_IMAGE_XY = NotifyImageSize.XY_256
 
 # Chat ID is required
 # If the Chat ID is positive, then it's addressed to a single person
 # If the Chat ID is negative, then it's targeting a group
 # We can support :topic (an integer) if specified as well
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyThreema.py` & `apprise-1.8.0/apprise/plugins/threema.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,22 +31,22 @@
 #
 # Read more about Threema Gateway API here:
 #   - https://gateway.threema.ch/en/developer/api
 
 import requests
 from itertools import chain
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import validate_regex
 from ..utils import is_email
-from ..URLBase import PrivacyMode
+from ..url import PrivacyMode
 from ..utils import parse_list
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class ThreemaRecipientTypes:
     """
     The supported recipient specifiers
     """
     THREEMA_ID = 'to'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyTwilio.py` & `apprise-1.8.0/apprise/plugins/twilio.py`

 * *Files 2% similar despite different names*

```diff
@@ -42,21 +42,21 @@
 #
 # or consider purchasing a short-code from here:
 #    https://www.twilio.com/docs/glossary/what-is-a-short-code
 #
 import requests
 from json import loads
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyTwilio(NotifyBase):
     """
     A wrapper for Twilio Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyTwist.py` & `apprise-1.8.0/apprise/plugins/twist.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,21 +31,21 @@
 # here: https://developer.twist.com/v3/
 
 import re
 import requests
 from json import loads
 from itertools import chain
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyFormat
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import is_email
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 # A workspace can also be interpreted as a team name too!
 IS_CHANNEL = re.compile(
     r'^#?(?P<name>((?P<workspace>[A-Za-z0-9_-]+):)?'
     r'(?P<channel>[^\s]{1,64}))$')
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyTwitter.py` & `apprise-1.8.0/apprise/plugins/twitter.py`

 * *Files 1% similar despite different names*

```diff
@@ -32,22 +32,22 @@
 import requests
 from copy import deepcopy
 from datetime import datetime
 from datetime import timezone
 from requests_oauthlib import OAuth1
 from json import dumps
 from json import loads
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import parse_bool
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
-from ..attachment.AttachBase import AttachBase
+from ..locale import gettext_lazy as _
+from ..attachment.base import AttachBase
 
 IS_USER = re.compile(r'^\s*@?(?P<user>[A-Z0-9_]+)$', re.I)
 
 
 class TwitterMessageMode:
     """
     Twitter Message Mode
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyVoipms.py` & `apprise-1.8.0/apprise/plugins/voipms.py`

 * *Files 0% similar despite different names*

```diff
@@ -33,20 +33,20 @@
 #
 # Read more about VoIP.ms API here:
 #   - https://voip.ms/m/apidocs.php
 
 import requests
 from json import loads
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import is_email
 from ..utils import parse_phone_no
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyVoipms(NotifyBase):
     """
     A wrapper for Voipms Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyVonage.py` & `apprise-1.8.0/apprise/plugins/vonage.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,21 +29,21 @@
 # Sign-up with https://dashboard.nexmo.com/
 #
 # Get your (api) key and secret here:
 #   - https://dashboard.nexmo.com/getting-started-guide
 #
 import requests
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyVonage(NotifyBase):
     """
     A wrapper for Vonage Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyWeComBot.py` & `apprise-1.8.0/apprise/plugins/wecombot.py`

 * *Files 2% similar despite different names*

```diff
@@ -55,18 +55,18 @@
 # This plugin also supports taking the URL (as identified above) directly
 # as well.
 
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyWeComBot(NotifyBase):
     """
     A wrapper for WeCom Bot Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyWebexTeams.py` & `apprise-1.8.0/apprise/plugins/webexteams.py`

 * *Files 1% similar despite different names*

```diff
@@ -59,19 +59,19 @@
 # - https://developer.cisco.com/ecosystem/webex/apps/\
 #       incoming-webhooks-cisco-systems/ - Simple webhook example
 
 import re
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..common import NotifyFormat
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Extend HTTP Error Messages
 # Based on: https://developer.webex.com/docs/api/basics/rate-limiting
 WEBEX_HTTP_ERROR_MAP = {
     401: 'Unauthorized - Invalid Token.',
     415: 'Unsuported media specified',
     429: 'To many consecutive requests were made.',
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyWhatsApp.py` & `apprise-1.8.0/apprise/plugins/whatsapp.py`

 * *Files 1% similar despite different names*

```diff
@@ -40,20 +40,20 @@
 #  both the access token and the From Phone Number ID.  Note that this not the
 #  from phone number itself, but it's ID.  It's displayed below and contains
 #  way more numbers then your typical phone number
 
 import re
 import requests
 from json import loads, dumps
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import is_phone_no
 from ..utils import parse_phone_no
 from ..utils import validate_regex
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyWhatsApp(NotifyBase):
     """
     A wrapper for WhatsApp Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyWindows.py` & `apprise-1.8.0/apprise/plugins/windows.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,19 +24,19 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from time import sleep
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyImageSize
 from ..common import NotifyType
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # Default our global support flag
 NOTIFY_WINDOWS_SUPPORT_ENABLED = False
 
 try:
     # 3rd party modules (Windows Only)
     import win32api
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyXBMC.py` & `apprise-1.8.0/apprise/plugins/xbmc.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,20 +25,20 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from json import dumps
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyType
 from ..common import NotifyImageSize
 from ..utils import parse_bool
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class NotifyXBMC(NotifyBase):
     """
     A wrapper for XBMC/KODI Notifications
     """
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyXML.py` & `apprise-1.8.0/apprise/plugins/custom_xml.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,19 +26,19 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import re
 import requests
 import base64
 
-from .NotifyBase import NotifyBase
-from ..URLBase import PrivacyMode
+from .base import NotifyBase
+from ..url import PrivacyMode
 from ..common import NotifyImageSize
 from ..common import NotifyType
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 
 class XMLPayloadField:
     """
     Identifies the fields available in the JSON Payload
     """
     VERSION = 'Version'
```

### Comparing `apprise-1.7.6/apprise/plugins/NotifyZulip.py` & `apprise-1.8.0/apprise/plugins/zulip.py`

 * *Files 2% similar despite different names*

```diff
@@ -57,21 +57,21 @@
 
 # The API reference used to build this plugin was documented here:
 #  https://zulipchat.com/api/send-message
 #
 import re
 import requests
 
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 from ..common import NotifyType
 from ..utils import parse_list
 from ..utils import validate_regex
 from ..utils import is_email
 from ..utils import remove_suffix
-from ..AppriseLocale import gettext_lazy as _
+from ..locale import gettext_lazy as _
 
 # A Valid Bot Name
 VALIDATE_BOTNAME = re.compile(r'(?P<name>[A-Z0-9_-]{1,32})', re.I)
 
 # Organization required as part of the API request
 VALIDATE_ORG = re.compile(
     r'(?P<org>[A-Z0-9_-]{1,32})(\.(?P<hostname>[^\s]+))?', re.I)
```

### Comparing `apprise-1.7.6/apprise/plugins/__init__.py` & `apprise-1.8.0/apprise/plugins/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,27 +26,27 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 import copy
 
 # Used for testing
-from .NotifyBase import NotifyBase
+from .base import NotifyBase
 
 from ..common import NotifyImageSize
 from ..common import NOTIFY_IMAGE_SIZES
 from ..common import NotifyType
 from ..common import NOTIFY_TYPES
 from ..utils import parse_list
 from ..utils import cwe312_url
 from ..utils import GET_SCHEMA_RE
 from ..logger import logger
-from ..AppriseLocale import gettext_lazy as _
-from ..AppriseLocale import LazyTranslation
-from ..NotificationManager import NotificationManager
+from ..locale import gettext_lazy as _
+from ..locale import LazyTranslation
+from ..manager_plugins import NotificationManager
 
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
 
 __all__ = [
     # Reference
```

### Comparing `apprise-1.7.6/apprise/utils.py` & `apprise-1.8.0/apprise/utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -537,15 +537,15 @@
     path = TIDY_NUX_PATH_RE.sub('\\1', path)
 
     # Windows Based (final) Trim
     path = expanduser(TIDY_WIN_TRIM_RE.sub('\\1', path))
     return path
 
 
-def parse_qsd(qs, simple=False, plus_to_space=False):
+def parse_qsd(qs, simple=False, plus_to_space=False, sanitize=True):
     """
     Query String Dictionary Builder
 
     A custom implimentation of the parse_qsl() function already provided
     by Python.  This function is slightly more light weight and gives us
     more control over parsing out arguments such as the plus/+ symbol
     at the head of a key/value pair.
@@ -564,14 +564,16 @@
     if simple is set to true, then a ONE dictionary is returned and is not
     sub-parsed for additional elements
 
     plus_to_space will cause all `+` references to become a space as
     per normal URL Encoded defininition. Normal URL parsing applies
     this, but `+` is very actively used character with passwords,
     api keys, tokens, etc.  So Apprise does not do this by default.
+
+    if sanitize is set to False, then kwargs are not placed into lowercase
     """
 
     # Our return result set:
     result = {
         # The arguments passed in (the parsed query). This is in a dictionary
         # of {'key': 'val', etc }.  Keys are all made lowercase before storing
         # to simplify access to them.
@@ -604,15 +606,15 @@
 
         val = nv[1].replace('+', ' ') if plus_to_space else nv[1]
         val = unquote(val)
         val = '' if not val else val.strip()
 
         # Always Query String Dictionary (qsd) for every entry we have
         # content is always made lowercase for easy indexing
-        result['qsd'][key.lower().strip()] = val
+        result['qsd'][key.lower().strip() if sanitize else key] = val
 
         if simple:
             # move along
             continue
 
         # Check for tokens that start with a addition/plus symbol (+)
         k = NOTIFY_CUSTOM_ADD_TOKENS.match(key)
@@ -632,15 +634,15 @@
             # Store content 'as-is'
             result['qsd:'][k.group('key')] = val
 
     return result
 
 
 def parse_url(url, default_schema='http', verify_host=True, strict_port=False,
-              simple=False, plus_to_space=False):
+              simple=False, plus_to_space=False, sanitize=True):
     """A function that greatly simplifies the parsing of a url
     specified by the end user.
 
      Valid syntaxes are:
         <schema>://<user>@<host>:<port>/<path>
         <schema>://<user>:<passwd>@<host>:<port>/<path>
         <schema>://<host>:<port>/<path>
@@ -687,14 +689,16 @@
           'schema': 'http',
           'url': 'http://hostname',
           'host': 'hostname',
         }
 
      If the URL can't be parsed then None is returned
 
+     If sanitize is set to False, then kwargs are not placed in lowercase
+     and wrapping whitespace is not removed
     """
 
     if not isinstance(url, str):
         # Simple error checking
         return None
 
     # Default Results
@@ -746,15 +750,16 @@
         # Could not extract basic content from the URL
         return None
 
     # Parse Query Arugments ?val=key&key=val
     # while ensuring that all keys are lowercase
     if qsdata:
         result.update(parse_qsd(
-            qsdata, simple=simple, plus_to_space=plus_to_space))
+            qsdata, simple=simple, plus_to_space=plus_to_space,
+            sanitize=sanitize))
 
     # Now do a proper extraction of data; http:// is just substitued in place
     # to allow urlparse() to function as expected, we'll swap this back to the
     # expected schema after.
     parsed = urlparse('http://%s' % host)
 
     # Parse results
```

### Comparing `apprise-1.7.6/apprise.egg-info/PKG-INFO` & `apprise-1.8.0/apprise.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: apprise
-Version: 1.7.6
+Version: 1.8.0
 Summary: Push Notifications that work with just about every platform!
 Home-page: https://github.com/caronc/apprise
 Author: Chris Caron
 Author-email: lead2gold@gmail.com
 License: BSD
 Keywords: Alerts Apprise API Automated Packet Reporting System AWS Boxcar BulkSMS BulkVS Burst SMS Chantify Chat CLI ClickSend D7Networks Dapnet DBus DingTalk Discord Email Emby Enigma2 FCM Feishu Flock Form Free Mobile Gnome Google Chat Gotify Growl Guilded Home Assistant httpSMS IFTTT Join JSON Kavenegar KODI Kumulos LaMetric Line LunaSea MacOSX Mailgun Mastodon Matrix Mattermost MessageBird Microsoft Misskey MQTT MSG91 MSTeams Nextcloud NextcloudTalk Notica Notifiarr Notifico Ntfy Office365 OneSignal Opsgenie PagerDuty PagerTree ParsePlatform PopcornNotify Prowl PushBullet Pushed Pushjet PushMe Push Notifications Pushover PushSafer Pushy PushDeer Reddit Revolt Rocket.Chat RSyslog Ryver SendGrid ServerChan SES Signal SimplePush Sinch Slack SMSEagle SMS Manager SMTP2Go SNS SparkPost Streamlabs Stride Synology Chat Syslog Techulus Telegram Threema Gateway Twilio Twist Twitter Voipms Vonage Webex WeCom Bot WhatsApp Windows XBMC XML Zulip
 Classifier: Development Status :: 5 - Production/Stable
@@ -25,14 +25,21 @@
 Classifier: Programming Language :: Python :: Implementation :: PyPy
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Topic :: Software Development :: Libraries :: Application Frameworks
 Requires-Python: >=3.6
 Description-Content-Type: text/markdown
 License-File: LICENSE
+Requires-Dist: certifi
+Requires-Dist: dataclasses; python_version < "3.7"
+Requires-Dist: requests
+Requires-Dist: requests-oauthlib
+Requires-Dist: click>=5.0
+Requires-Dist: markdown
+Requires-Dist: PyYAML
 
 ![Apprise Logo](https://raw.githubusercontent.com/caronc/apprise/master/apprise/assets/themes/default/apprise-logo.png)
 
 <hr/>
 
 **ap·prise** / *verb*<br/>
 To inform or tell (someone). To make one aware of something.
```

### Comparing `apprise-1.7.6/apprise.egg-info/SOURCES.txt` & `apprise-1.8.0/apprise.egg-info/SOURCES.txt`

 * *Files 14% similar despite different names*

```diff
@@ -3,37 +3,37 @@
 MANIFEST.in
 README.md
 dev-requirements.txt
 requirements.txt
 setup.cfg
 setup.py
 win-requirements.txt
-apprise/Apprise.py
-apprise/Apprise.pyi
-apprise/AppriseAsset.py
-apprise/AppriseAsset.pyi
-apprise/AppriseAttachment.py
-apprise/AppriseAttachment.pyi
-apprise/AppriseConfig.py
-apprise/AppriseConfig.pyi
-apprise/AppriseLocale.py
-apprise/AttachmentManager.py
-apprise/ConfigurationManager.py
-apprise/NotificationManager.py
-apprise/URLBase.py
-apprise/URLBase.pyi
 apprise/__init__.py
+apprise/apprise.py
+apprise/apprise.pyi
+apprise/apprise_attachment.py
+apprise/apprise_attachment.pyi
+apprise/apprise_config.py
+apprise/apprise_config.pyi
+apprise/asset.py
+apprise/asset.pyi
 apprise/cli.py
 apprise/common.py
 apprise/common.pyi
 apprise/conversion.py
 apprise/emojis.py
+apprise/locale.py
 apprise/logger.py
 apprise/manager.py
+apprise/manager_attachment.py
+apprise/manager_config.py
+apprise/manager_plugins.py
 apprise/py.typed
+apprise/url.py
+apprise/url.pyi
 apprise/utils.py
 apprise.egg-info/PKG-INFO
 apprise.egg-info/SOURCES.txt
 apprise.egg-info/dependency_links.txt
 apprise.egg-info/entry_points.txt
 apprise.egg-info/requires.txt
 apprise.egg-info/top_level.txt
@@ -56,141 +56,141 @@
 apprise/assets/themes/default/apprise-success-32x32.png
 apprise/assets/themes/default/apprise-success-72x72.png
 apprise/assets/themes/default/apprise-warning-128x128.ico
 apprise/assets/themes/default/apprise-warning-128x128.png
 apprise/assets/themes/default/apprise-warning-256x256.png
 apprise/assets/themes/default/apprise-warning-32x32.png
 apprise/assets/themes/default/apprise-warning-72x72.png
-apprise/attachment/AttachBase.py
-apprise/attachment/AttachBase.pyi
-apprise/attachment/AttachFile.py
-apprise/attachment/AttachHTTP.py
 apprise/attachment/__init__.py
-apprise/config/ConfigBase.py
-apprise/config/ConfigBase.pyi
-apprise/config/ConfigFile.py
-apprise/config/ConfigHTTP.py
-apprise/config/ConfigMemory.py
+apprise/attachment/base.py
+apprise/attachment/base.pyi
+apprise/attachment/file.py
+apprise/attachment/http.py
 apprise/config/__init__.py
-apprise/decorators/CustomNotifyPlugin.py
+apprise/config/base.py
+apprise/config/base.pyi
+apprise/config/file.py
+apprise/config/http.py
+apprise/config/memory.py
 apprise/decorators/__init__.py
+apprise/decorators/base.py
 apprise/decorators/notify.py
 apprise/i18n/__init__.py
 apprise/i18n/en/LC_MESSAGES/apprise.mo
-apprise/plugins/NotifyAppriseAPI.py
-apprise/plugins/NotifyAprs.py
-apprise/plugins/NotifyBark.py
-apprise/plugins/NotifyBase.py
-apprise/plugins/NotifyBase.pyi
-apprise/plugins/NotifyBoxcar.py
-apprise/plugins/NotifyBulkSMS.py
-apprise/plugins/NotifyBulkVS.py
-apprise/plugins/NotifyBurstSMS.py
-apprise/plugins/NotifyChantify.py
-apprise/plugins/NotifyClickSend.py
-apprise/plugins/NotifyD7Networks.py
-apprise/plugins/NotifyDBus.py
-apprise/plugins/NotifyDapnet.py
-apprise/plugins/NotifyDingTalk.py
-apprise/plugins/NotifyDiscord.py
-apprise/plugins/NotifyEmail.py
-apprise/plugins/NotifyEmby.py
-apprise/plugins/NotifyEnigma2.py
-apprise/plugins/NotifyFeishu.py
-apprise/plugins/NotifyFlock.py
-apprise/plugins/NotifyForm.py
-apprise/plugins/NotifyFreeMobile.py
-apprise/plugins/NotifyGnome.py
-apprise/plugins/NotifyGoogleChat.py
-apprise/plugins/NotifyGotify.py
-apprise/plugins/NotifyGrowl.py
-apprise/plugins/NotifyGuilded.py
-apprise/plugins/NotifyHomeAssistant.py
-apprise/plugins/NotifyHttpSMS.py
-apprise/plugins/NotifyIFTTT.py
-apprise/plugins/NotifyJSON.py
-apprise/plugins/NotifyJoin.py
-apprise/plugins/NotifyKavenegar.py
-apprise/plugins/NotifyKumulos.py
-apprise/plugins/NotifyLametric.py
-apprise/plugins/NotifyLine.py
-apprise/plugins/NotifyLunaSea.py
-apprise/plugins/NotifyMQTT.py
-apprise/plugins/NotifyMSG91.py
-apprise/plugins/NotifyMSTeams.py
-apprise/plugins/NotifyMacOSX.py
-apprise/plugins/NotifyMailgun.py
-apprise/plugins/NotifyMastodon.py
-apprise/plugins/NotifyMatrix.py
-apprise/plugins/NotifyMattermost.py
-apprise/plugins/NotifyMessageBird.py
-apprise/plugins/NotifyMisskey.py
-apprise/plugins/NotifyNextcloud.py
-apprise/plugins/NotifyNextcloudTalk.py
-apprise/plugins/NotifyNotica.py
-apprise/plugins/NotifyNotifiarr.py
-apprise/plugins/NotifyNotifico.py
-apprise/plugins/NotifyNtfy.py
-apprise/plugins/NotifyOffice365.py
-apprise/plugins/NotifyOneSignal.py
-apprise/plugins/NotifyOpsgenie.py
-apprise/plugins/NotifyPagerDuty.py
-apprise/plugins/NotifyPagerTree.py
-apprise/plugins/NotifyParsePlatform.py
-apprise/plugins/NotifyPopcornNotify.py
-apprise/plugins/NotifyProwl.py
-apprise/plugins/NotifyPushBullet.py
-apprise/plugins/NotifyPushDeer.py
-apprise/plugins/NotifyPushMe.py
-apprise/plugins/NotifyPushSafer.py
-apprise/plugins/NotifyPushed.py
-apprise/plugins/NotifyPushjet.py
-apprise/plugins/NotifyPushover.py
-apprise/plugins/NotifyPushy.py
-apprise/plugins/NotifyRSyslog.py
-apprise/plugins/NotifyReddit.py
-apprise/plugins/NotifyRevolt.py
-apprise/plugins/NotifyRocketChat.py
-apprise/plugins/NotifyRyver.py
-apprise/plugins/NotifySES.py
-apprise/plugins/NotifySMSEagle.py
-apprise/plugins/NotifySMSManager.py
-apprise/plugins/NotifySMTP2Go.py
-apprise/plugins/NotifySNS.py
-apprise/plugins/NotifySendGrid.py
-apprise/plugins/NotifyServerChan.py
-apprise/plugins/NotifySignalAPI.py
-apprise/plugins/NotifySimplePush.py
-apprise/plugins/NotifySinch.py
-apprise/plugins/NotifySlack.py
-apprise/plugins/NotifySparkPost.py
-apprise/plugins/NotifyStreamlabs.py
-apprise/plugins/NotifySynology.py
-apprise/plugins/NotifySyslog.py
-apprise/plugins/NotifyTechulusPush.py
-apprise/plugins/NotifyTelegram.py
-apprise/plugins/NotifyThreema.py
-apprise/plugins/NotifyTwilio.py
-apprise/plugins/NotifyTwist.py
-apprise/plugins/NotifyTwitter.py
-apprise/plugins/NotifyVoipms.py
-apprise/plugins/NotifyVonage.py
-apprise/plugins/NotifyWeComBot.py
-apprise/plugins/NotifyWebexTeams.py
-apprise/plugins/NotifyWhatsApp.py
-apprise/plugins/NotifyWindows.py
-apprise/plugins/NotifyXBMC.py
-apprise/plugins/NotifyXML.py
-apprise/plugins/NotifyZulip.py
 apprise/plugins/__init__.py
-apprise/plugins/NotifyFCM/__init__.py
-apprise/plugins/NotifyFCM/color.py
-apprise/plugins/NotifyFCM/common.py
-apprise/plugins/NotifyFCM/oauth.py
-apprise/plugins/NotifyFCM/priority.py
+apprise/plugins/apprise_api.py
+apprise/plugins/aprs.py
+apprise/plugins/bark.py
+apprise/plugins/base.py
+apprise/plugins/base.pyi
+apprise/plugins/boxcar.py
+apprise/plugins/bulksms.py
+apprise/plugins/bulkvs.py
+apprise/plugins/burstsms.py
+apprise/plugins/chantify.py
+apprise/plugins/clicksend.py
+apprise/plugins/custom_form.py
+apprise/plugins/custom_json.py
+apprise/plugins/custom_xml.py
+apprise/plugins/d7networks.py
+apprise/plugins/dapnet.py
+apprise/plugins/dbus.py
+apprise/plugins/dingtalk.py
+apprise/plugins/discord.py
+apprise/plugins/email.py
+apprise/plugins/emby.py
+apprise/plugins/enigma2.py
+apprise/plugins/feishu.py
+apprise/plugins/flock.py
+apprise/plugins/freemobile.py
+apprise/plugins/gnome.py
+apprise/plugins/google_chat.py
+apprise/plugins/gotify.py
+apprise/plugins/growl.py
+apprise/plugins/guilded.py
+apprise/plugins/home_assistant.py
+apprise/plugins/httpsms.py
+apprise/plugins/ifttt.py
+apprise/plugins/join.py
+apprise/plugins/kavenegar.py
+apprise/plugins/kumulos.py
+apprise/plugins/lametric.py
+apprise/plugins/line.py
+apprise/plugins/lunasea.py
+apprise/plugins/macosx.py
+apprise/plugins/mailgun.py
+apprise/plugins/mastodon.py
+apprise/plugins/matrix.py
+apprise/plugins/mattermost.py
+apprise/plugins/messagebird.py
+apprise/plugins/misskey.py
+apprise/plugins/mqtt.py
+apprise/plugins/msg91.py
+apprise/plugins/msteams.py
+apprise/plugins/nextcloud.py
+apprise/plugins/nextcloudtalk.py
+apprise/plugins/notica.py
+apprise/plugins/notifiarr.py
+apprise/plugins/notifico.py
+apprise/plugins/ntfy.py
+apprise/plugins/office365.py
+apprise/plugins/one_signal.py
+apprise/plugins/opsgenie.py
+apprise/plugins/pagerduty.py
+apprise/plugins/pagertree.py
+apprise/plugins/parseplatform.py
+apprise/plugins/popcorn_notify.py
+apprise/plugins/prowl.py
+apprise/plugins/pushbullet.py
+apprise/plugins/pushdeer.py
+apprise/plugins/pushed.py
+apprise/plugins/pushjet.py
+apprise/plugins/pushme.py
+apprise/plugins/pushover.py
+apprise/plugins/pushsafer.py
+apprise/plugins/pushy.py
+apprise/plugins/reddit.py
+apprise/plugins/revolt.py
+apprise/plugins/rocketchat.py
+apprise/plugins/rsyslog.py
+apprise/plugins/ryver.py
+apprise/plugins/sendgrid.py
+apprise/plugins/serverchan.py
+apprise/plugins/ses.py
+apprise/plugins/signal_api.py
+apprise/plugins/simplepush.py
+apprise/plugins/sinch.py
+apprise/plugins/slack.py
+apprise/plugins/smseagle.py
+apprise/plugins/smsmanager.py
+apprise/plugins/smtp2go.py
+apprise/plugins/sns.py
+apprise/plugins/sparkpost.py
+apprise/plugins/streamlabs.py
+apprise/plugins/synology.py
+apprise/plugins/syslog.py
+apprise/plugins/techuluspush.py
+apprise/plugins/telegram.py
+apprise/plugins/threema.py
+apprise/plugins/twilio.py
+apprise/plugins/twist.py
+apprise/plugins/twitter.py
+apprise/plugins/voipms.py
+apprise/plugins/vonage.py
+apprise/plugins/webexteams.py
+apprise/plugins/wecombot.py
+apprise/plugins/whatsapp.py
+apprise/plugins/windows.py
+apprise/plugins/xbmc.py
+apprise/plugins/zulip.py
+apprise/plugins/fcm/__init__.py
+apprise/plugins/fcm/color.py
+apprise/plugins/fcm/common.py
+apprise/plugins/fcm/oauth.py
+apprise/plugins/fcm/priority.py
 packaging/README.md
 packaging/man/apprise.1
 packaging/man/apprise.1.html
 packaging/man/apprise.md
 packaging/redhat/apprise-click67-support.patch
 packaging/redhat/apprise-no-macosx-testing.patch
 packaging/redhat/apprise-pytest-session_mocker-removal.patch
```

### Comparing `apprise-1.7.6/packaging/README.md` & `apprise-1.8.0/packaging/README.md`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/packaging/man/apprise.1` & `apprise-1.8.0/packaging/man/apprise.1`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/packaging/man/apprise.1.html` & `apprise-1.8.0/packaging/man/apprise.1.html`

 * *Files 0% similar despite different names*

```diff
@@ -312,15 +312,15 @@
 <h2 id="BUGS">BUGS</h2>
 
 <p>If you find any bugs, please make them known at:
 <a href="https://github.com/caronc/apprise/issues" data-bare-link="true">https://github.com/caronc/apprise/issues</a></p>
 
 <h2 id="COPYRIGHT">COPYRIGHT</h2>
 
-<p>Apprise is Copyright (C) 2024 Chris Caron <a href="&#x6d;&#97;&#x69;&#108;&#x74;&#x6f;&#58;&#x6c;&#x65;&#97;&#x64;&#x32;&#103;&#x6f;&#108;&#x64;&#x40;&#x67;&#x6d;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#111;&#109;" data-bare-link="true">&#x6c;&#101;&#x61;&#x64;&#50;&#103;&#x6f;&#108;&#x64;&#64;&#x67;&#x6d;&#x61;&#105;&#108;&#x2e;&#99;&#111;&#109;</a></p>
+<p>Apprise is Copyright (C) 2024 Chris Caron <a href="&#x6d;&#97;&#x69;&#108;&#x74;&#x6f;&#58;&#108;&#101;&#97;&#100;&#x32;&#x67;&#x6f;&#108;&#100;&#64;&#x67;&#109;&#x61;&#105;&#x6c;&#46;&#x63;&#x6f;&#x6d;" data-bare-link="true">&#108;&#x65;&#97;&#100;&#50;&#x67;&#111;&#x6c;&#x64;&#x40;&#103;&#x6d;&#x61;&#x69;&#x6c;&#46;&#99;&#111;&#x6d;</a></p>
 
 
   <ol class='man-decor man-foot man foot'>
     <li class='tl'>Chris Caron &lt;lead2gold@gmail.com&gt;</li>
     <li class='tc'>March 2024</li>
     <li class='tr'>apprise(1)</li>
   </ol>
```

### Comparing `apprise-1.7.6/packaging/man/apprise.md` & `apprise-1.8.0/packaging/man/apprise.md`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/packaging/redhat/apprise-click67-support.patch` & `apprise-1.8.0/packaging/redhat/apprise-click67-support.patch`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/packaging/redhat/apprise-no-macosx-testing.patch` & `apprise-1.8.0/packaging/redhat/apprise-no-macosx-testing.patch`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/packaging/redhat/apprise-pytest-session_mocker-removal.patch` & `apprise-1.8.0/packaging/redhat/apprise-pytest-session_mocker-removal.patch`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/packaging/redhat/python-apprise.spec` & `apprise-1.8.0/packaging/redhat/python-apprise.spec`

 * *Files 1% similar despite different names*

```diff
@@ -50,15 +50,15 @@
 PushBullet, Pushjet, PushMe, Pushover, PushSafer, Pushy, PushDeer, Revolt,
 Reddit, Rocket.Chat, RSyslog, SendGrid, ServerChan, Signal, SimplePush, Sinch,
 Slack, SMSEagle, SMS Manager, SMTP2Go, SparkPost, Super Toasty, Streamlabs,
 Stride, Synology Chat, Syslog, Techulus Push, Telegram, Threema Gateway, Twilio,
 Twitter, Twist, XBMC, Voipms, Vonage, WeCom Bot, WhatsApp, Webex Teams}
 
 Name:           python-%{pypi_name}
-Version:        1.7.6
+Version:        1.8.0
 Release:        1%{?dist}
 Summary:        A simple wrapper to many popular notification services used today
 License:        BSD
 URL:            https://github.com/caronc/%{pypi_name}
 Source0:        %{url}/archive/v%{version}/%{pypi_name}-%{version}.tar.gz
 
 # RHEL/Rocky 8 ship with Click v6.7 which does not support the .stdout
@@ -191,14 +191,17 @@
 
 %files -n %{pypi_name}
 %{_bindir}/%{pypi_name}
 %{_mandir}/man1/%{pypi_name}.1*
 %{python3_sitelib}/%{pypi_name}/cli.*
 
 %changelog
+* Sat May 11 2024 Chris Caron <lead2gold@gmail.com> - 1.8.0
+- Updated to v1.8.0
+
 * Sat Apr 13 2024 Chris Caron <lead2gold@gmail.com> - 1.7.6
 - Updated to v1.7.6
 
 * Sat Mar 30 2024 Chris Caron <lead2gold@gmail.com> - 1.7.5
 - Updated to v1.7.5
 
 * Sat Mar  9 2024 Chris Caron <lead2gold@gmail.com> - 1.7.4
```

### Comparing `apprise-1.7.6/setup.cfg` & `apprise-1.8.0/setup.cfg`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/setup.py` & `apprise-1.8.0/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -58,15 +58,15 @@
 
 else:
     # Load our CLI
     console_scripts = ['apprise = apprise.cli:main']
 
 setup(
     name='apprise',
-    version='1.7.6',
+    version='1.8.0',
     description='Push Notifications that work with just about every platform!',
     license='BSD',
     long_description=open('README.md', encoding="utf-8").read(),
     long_description_content_type='text/markdown',
     cmdclass=cmdclass,
     url='https://github.com/caronc/apprise',
     keywords=' '.join(re.split(r'\s+', open('KEYWORDS').read())),
```

### Comparing `apprise-1.7.6/test/conftest.py` & `apprise-1.8.0/test/conftest.py`

 * *Files 8% similar despite different names*

```diff
@@ -27,17 +27,17 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import sys
 import os
 
 import pytest
 
-from apprise.NotificationManager import NotificationManager
-from apprise.ConfigurationManager import ConfigurationManager
-from apprise.AttachmentManager import AttachmentManager
+from apprise.manager_plugins import NotificationManager
+from apprise.manager_config import ConfigurationManager
+from apprise.manager_attachment import AttachmentManager
 
 sys.path.append(os.path.join(os.path.dirname(__file__), 'helpers'))
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
 # Grant access to our Config Manager Singleton
 C_MGR = ConfigurationManager()
```

### Comparing `apprise-1.7.6/test/helpers/__init__.py` & `apprise-1.8.0/test/helpers/__init__.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/helpers/asyncio.py` & `apprise-1.8.0/test/helpers/asyncio.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/helpers/rest.py` & `apprise-1.8.0/test/helpers/rest.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/test_api.py` & `apprise-1.8.0/test/test_api.py`

 * *Files 1% similar despite different names*

```diff
@@ -44,18 +44,18 @@
 from apprise import NotifyBase
 from apprise import NotifyType
 from apprise import NotifyFormat
 from apprise import NotifyImageSize
 from apprise import __version__
 from apprise import URLBase
 from apprise import PrivacyMode
-from apprise.AppriseLocale import LazyTranslation
-from apprise.AppriseLocale import gettext_lazy as _
+from apprise.locale import LazyTranslation
+from apprise.locale import gettext_lazy as _
 
-from apprise.NotificationManager import NotificationManager
+from apprise.manager_plugins import NotificationManager
 from apprise.utils import parse_list
 from helpers import OuterEventLoop
 import inspect
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_apprise_attachments.py` & `apprise-1.8.0/test/test_apprise_attachments.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,19 +30,18 @@
 import json
 import requests
 from unittest import mock
 from os.path import getsize
 from os.path import join
 from os.path import dirname
 from inspect import cleandoc
-from apprise.Apprise import Apprise
-from apprise.AttachmentManager import AttachmentManager
-from apprise.AppriseAttachment import AppriseAttachment
-from apprise.AppriseAsset import AppriseAsset
-from apprise.attachment.AttachBase import AttachBase
+from apprise import Apprise, AppriseAsset
+from apprise.manager_attachment import AttachmentManager
+from apprise.apprise_attachment import AppriseAttachment
+from apprise.attachment import AttachBase
 from apprise.common import ContentLocation
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 TEST_VAR_DIR = join(dirname(__file__), 'var')
```

### Comparing `apprise-1.7.6/test/test_apprise_cli.py` & `apprise-1.8.0/test/test_apprise_cli.py`

 * *Files 0% similar despite different names*

```diff
@@ -32,19 +32,18 @@
 import requests
 import json
 from inspect import cleandoc
 from os.path import dirname
 from os.path import join
 from apprise import cli
 from apprise import NotifyBase
-from apprise.NotificationManager import NotificationManager
+from apprise.manager_plugins import NotificationManager
 from click.testing import CliRunner
 from apprise.utils import environ
-
-from apprise.AppriseLocale import gettext_lazy as _
+from apprise.locale import gettext_lazy as _
 
 from importlib import reload
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_apprise_config.py` & `apprise-1.8.0/test/test_apprise_config.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,20 +31,20 @@
 from unittest import mock
 from apprise import NotifyFormat
 from apprise import ConfigFormat
 from apprise import ContentIncludeMode
 from apprise import Apprise
 from apprise import AppriseConfig
 from apprise import AppriseAsset
-from apprise.config.ConfigBase import ConfigBase
-from apprise.plugins.NotifyBase import NotifyBase
-from apprise.NotificationManager import NotificationManager
-from apprise.ConfigurationManager import ConfigurationManager
+from apprise.config import ConfigBase
+from apprise.plugins import NotifyBase
+from apprise.manager_plugins import NotificationManager
+from apprise.manager_config import ConfigurationManager
 
-from apprise.config.ConfigFile import ConfigFile
+from apprise.config.file import ConfigFile
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
@@ -185,15 +185,15 @@
     # Our URL should be found
     assert len(ac.servers()) == 1
 
     # Get our URL back
     assert isinstance(ac[0].url(), str)
 
     # pop an entry from our list
-    assert isinstance(ac.pop(0), ConfigBase) is True
+    assert isinstance(ac.pop(0), ConfigBase)
 
     # Determine we have no more configuration entries loaded
     assert len(ac) == 0
 
     #
     # Test buffer handling (and overflow)
     t = tmpdir.mkdir("buffer-handling").join("apprise")
@@ -267,27 +267,21 @@
         ConfigFile(path=str(te)), ConfigFile(path=str(t)))) is True
 
     # don't support the adding of invalid content
     assert ac.add(configs=(object(), object())) is False
     assert ac.add(configs=object()) is False
 
     # Try to pop an element out of range
-    try:
+    with pytest.raises(IndexError):
         ac.server_pop(len(ac.servers()))
-        # We should have thrown an exception here
-        assert False
-
-    except IndexError:
-        # We expect to be here
-        assert True
 
     # Pop our elements
     while len(ac.servers()) > 0:
         assert isinstance(
-            ac.server_pop(len(ac.servers()) - 1), NotifyBase) is True
+            ac.server_pop(len(ac.servers()) - 1), NotifyBase)
 
 
 def test_apprise_add_config():
     """
     API AppriseConfig.add_config()
 
     """
@@ -619,70 +613,57 @@
     assert a.add(servers=[object(), object()]) is False
 
     # Our length is unchanged
     assert len(a) == 5
 
     # reference index 0 of our list
     ref = a[0]
-    assert isinstance(ref, NotifyBase) is True
+    assert isinstance(ref, NotifyBase)
 
     # Our length is unchanged
     assert len(a) == 5
 
     # pop the index
     ref_popped = a.pop(0)
 
     # Verify our response
-    assert isinstance(ref_popped, NotifyBase) is True
+    assert isinstance(ref_popped, NotifyBase)
 
     # Our length drops by 1
     assert len(a) == 4
 
     # Content popped is the same as one referenced by index
     # earlier
     assert ref == ref_popped
 
     # pop an index out of range
-    try:
+    with pytest.raises(IndexError):
         a.pop(len(a))
-        # We'll thrown an IndexError and not make it this far
-        assert False
-
-    except IndexError:
-        # As expected
-        assert True
 
     # Our length remains unchanged
     assert len(a) == 4
 
     # Reference content out of range
-    try:
+    with pytest.raises(IndexError):
         a[len(a)]
 
-        # We'll thrown an IndexError and not make it this far
-        assert False
-
-    except IndexError:
-        # As expected
-        assert True
-
     # reference index at the end of our list
     ref = a[len(a) - 1]
 
     # Verify our response
-    assert isinstance(ref, NotifyBase) is True
+    assert isinstance(ref, NotifyBase)
 
     # Our length stays the same
     assert len(a) == 4
 
     # We can pop from the back of the list without a problem too
     ref_popped = a.pop(len(a) - 1)
 
     # Verify our response
-    assert isinstance(ref_popped, NotifyBase) is True
+    assert isinstance(ref_popped, NotifyBase)
 
     # Content popped is the same as one referenced by index
     # earlier
     assert ref == ref_popped
 
     # Our length drops by 1
     assert len(a) == 3
@@ -699,32 +680,32 @@
     # Our length increases by 4 (2 entries in the config file, + 2 others)
     assert len(a) == 7
 
     # reference index at the end of our list
     ref = a[len(a) - 1]
 
     # Verify our response
-    assert isinstance(ref, NotifyBase) is True
+    assert isinstance(ref, NotifyBase)
 
     # We can pop from the back of the list without a problem too
     ref_popped = a.pop(len(a) - 1)
 
     # Verify our response
-    assert isinstance(ref_popped, NotifyBase) is True
+    assert isinstance(ref_popped, NotifyBase)
 
     # Content popped is the same as one referenced by index
     # earlier
     assert ref == ref_popped
 
     # Our length drops by 1
     assert len(a) == 6
 
     # pop our list
     while len(a) > 0:
-        assert isinstance(a.pop(len(a) - 1), NotifyBase) is True
+        assert isinstance(a.pop(len(a) - 1), NotifyBase)
 
 
 def test_recursive_config_inclusion(tmpdir):
     """
     API: Apprise() Recursive Config Inclusion
 
     """
```

### Comparing `apprise-1.7.6/test/test_apprise_emojis.py` & `apprise-1.8.0/test/test_apprise_emojis.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/test_apprise_pickle.py` & `apprise-1.8.0/test/test_apprise_pickle.py`

 * *Files 1% similar despite different names*

```diff
@@ -57,15 +57,15 @@
     for key in keys:
         assert getattr(asset, key) == getattr(new_asset, key)
 
 
 def test_apprise_pickle_locale(tmpdir):
     """pickle: AppriseLocale
     """
-    _locale = AppriseLocale.AppriseLocale()
+    _locale = AppriseLocale()
     serialized = pickle.dumps(_locale)
     new_locale = pickle.loads(serialized)
 
     assert _locale.lang == new_locale.lang
 
     # Ensure internal functions still call in new object
     new_locale.detect_language()
```

### Comparing `apprise-1.7.6/test/test_apprise_utils.py` & `apprise-1.8.0/test/test_apprise_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import re
 import os
 import sys
 from inspect import cleandoc
 from urllib.parse import unquote
 
 from apprise import utils
-from apprise.NotificationManager import NotificationManager
+from apprise.manager_plugins import NotificationManager
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Ensure we don't create .pyc files for these tests
 sys.dont_write_bytecode = True
@@ -46,15 +46,15 @@
 N_MGR = NotificationManager()
 
 
 def test_parse_qsd():
     "utils: parse_qsd() testing """
 
     result = utils.parse_qsd('a=1&b=&c&d=abcd')
-    assert isinstance(result, dict) is True
+    assert isinstance(result, dict)
     assert len(result) == 4
     assert 'qsd' in result
     assert 'qsd+' in result
     assert 'qsd-' in result
     assert 'qsd:' in result
 
     assert len(result['qsd']) == 4
@@ -715,14 +715,46 @@
     assert result['query'] == 'jack.json'
     assert unquote(result['url']) == 'crazy://:@/_/@^&/jack.json'
     assert result['qsd'] == {}
     assert result['qsd-'] == {}
     assert result['qsd+'] == {}
     assert result['qsd:'] == {}
 
+    # Sanitizing
+    result = utils.parse_url(
+        'hTTp://hostname/?+KeY=ValueA&-kEy=ValueB&KEY=Value%20+C&:cOlON=YeS',
+        sanitize=False)
+
+    assert len(result['qsd-']) == 1
+    assert len(result['qsd+']) == 1
+    assert len(result['qsd']) == 4
+    assert len(result['qsd:']) == 1
+
+    assert result['schema'] == 'http'
+    assert result['host'] == 'hostname'
+    assert result['port'] is None
+    assert result['user'] is None
+    assert result['password'] is None
+    assert result['fullpath'] == '/'
+    assert result['path'] == '/'
+    assert result['query'] is None
+    assert result['url'] == 'http://hostname/'
+    assert '+KeY' in result['qsd']
+    assert '-kEy' in result['qsd']
+    assert ':cOlON' in result['qsd']
+    assert result['qsd:']['cOlON'] == 'YeS'
+    assert 'key' not in result['qsd']
+    assert 'KeY' in result['qsd+']
+    assert result['qsd+']['KeY'] == 'ValueA'
+    assert 'kEy' in result['qsd-']
+    assert result['qsd-']['kEy'] == 'ValueB'
+    assert result['qsd']['KEY'] == 'Value +C'
+    assert result['qsd']['+KeY'] == result['qsd+']['KeY']
+    assert result['qsd']['-kEy'] == result['qsd-']['kEy']
+
 
 def test_parse_url_simple():
     "utils: parse_url() testing """
 
     result = utils.parse_url('http://hostname', simple=True)
     assert len(result) == 3
     assert result['schema'] == 'http'
@@ -2603,47 +2635,47 @@
     """utils: apply_template() testing
     """
 
     template = "Hello {{fname}}, How are you {{whence}}?"
 
     result = utils.apply_template(
         template, **{'fname': 'Chris', 'whence': 'this morning'})
-    assert isinstance(result, str) is True
+    assert isinstance(result, str)
     assert result == "Hello Chris, How are you this morning?"
 
     # In this example 'whence' isn't provided, so it isn't swapped
     result = utils.apply_template(
         template, **{'fname': 'Chris'})
-    assert isinstance(result, str) is True
+    assert isinstance(result, str)
     assert result == "Hello Chris, How are you {{whence}}?"
 
     # white space won't cause any ill affects:
     template = "Hello {{ fname }}, How are you {{   whence}}?"
     result = utils.apply_template(
         template, **{'fname': 'Chris', 'whence': 'this morning'})
-    assert isinstance(result, str) is True
+    assert isinstance(result, str)
     assert result == "Hello Chris, How are you this morning?"
 
     # No arguments won't cause any problems
     template = "Hello {{fname}}, How are you {{whence}}?"
     result = utils.apply_template(template)
-    assert isinstance(result, str) is True
+    assert isinstance(result, str)
     assert result == template
 
     # Wrong elements are simply ignored
     result = utils.apply_template(
         template,
         **{'fname': 'l2g', 'whence': 'this evening', 'ignore': 'me'})
-    assert isinstance(result, str) is True
+    assert isinstance(result, str)
     assert result == "Hello l2g, How are you this evening?"
 
     # Empty template makes things easy
     result = utils.apply_template(
         "", **{'fname': 'l2g', 'whence': 'this evening'})
-    assert isinstance(result, str) is True
+    assert isinstance(result, str)
     assert result == ""
 
     # Regular expressions are safely escapped and act as normal
     # tokens:
     template = "Hello {{.*}}, How are you {{[A-Z0-9]+}}?"
     result = utils.apply_template(
         template, **{'.*': 'l2g', '[A-Z0-9]+': 'this afternoon'})
```

### Comparing `apprise-1.7.6/test/test_asyncio.py` & `apprise-1.8.0/test/test_asyncio.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import sys
 import pytest
 from apprise import Apprise
 from apprise import NotifyBase
 from apprise import NotifyFormat
-from apprise.NotificationManager import NotificationManager
+from apprise.manager_plugins import NotificationManager
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
```

### Comparing `apprise-1.7.6/test/test_attach_base.py` & `apprise-1.8.0/test/test_attach_base.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 from unittest import mock
-from apprise.attachment.AttachBase import AttachBase
+from apprise.attachment.base import AttachBase
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 
 def test_mimetype_initialization():
```

### Comparing `apprise-1.7.6/test/test_attach_file.py` & `apprise-1.8.0/test/test_attach_file.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,16 +29,16 @@
 import re
 import time
 import urllib
 from unittest import mock
 
 from os.path import dirname
 from os.path import join
-from apprise.attachment.AttachBase import AttachBase
-from apprise.attachment.AttachFile import AttachFile
+from apprise.attachment.base import AttachBase
+from apprise.attachment.file import AttachFile
 from apprise import AppriseAttachment
 from apprise.common import ContentLocation
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_attach_http.py` & `apprise-1.8.0/test/test_attach_http.py`

 * *Files 2% similar despite different names*

```diff
@@ -30,18 +30,18 @@
 from unittest import mock
 
 import requests
 import mimetypes
 from os.path import join
 from os.path import dirname
 from os.path import getsize
-from apprise.attachment.AttachHTTP import AttachHTTP
+from apprise.attachment.http import AttachHTTP
 from apprise import Apprise, AppriseAttachment
-from apprise.NotificationManager import NotificationManager
-from apprise.plugins.NotifyBase import NotifyBase
+from apprise.manager_plugins import NotificationManager
+from apprise.plugins import NotifyBase
 from apprise.common import ContentLocation
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 TEST_VAR_DIR = join(dirname(__file__), 'var')
@@ -186,30 +186,34 @@
 
     # Prepare Mock
     dummy_response = DummyResponse()
     mock_get.return_value = dummy_response
 
     # Test custom url get parameters
     results = AttachHTTP.parse_url(
-        'http://user:pass@localhost/apprise.gif?dl=1&cache=300')
+        'http://user:pass@localhost/apprise.gif?DL=1&cache=300')
     assert isinstance(results, dict)
     attachment = AttachHTTP(**results)
     assert isinstance(attachment.url(), str) is True
 
     # Test that our extended variables are passed along
     assert mock_get.call_count == 0
     assert attachment
     assert mock_get.call_count == 1
     assert 'params' in mock_get.call_args_list[0][1]
-    assert 'dl' in mock_get.call_args_list[0][1]['params']
+    assert 'DL' in mock_get.call_args_list[0][1]['params']
 
     # Verify that arguments that are reserved for apprise are not
     # passed along
     assert 'cache' not in mock_get.call_args_list[0][1]['params']
 
+    with mock.patch('os.unlink', side_effect=OSError()):
+        # Test invalidation with exception thrown
+        attachment.invalidate()
+
     results = AttachHTTP.parse_url(
         'http://user:pass@localhost/apprise.gif?+key=value&cache=True')
     assert isinstance(results, dict)
     attachment = AttachHTTP(**results)
     assert isinstance(attachment.url(), str) is True
     # No mime-type and/or filename over-ride was specified, so therefore it
     # won't show up in the generated URL
```

### Comparing `apprise-1.7.6/test/test_config_base.py` & `apprise-1.8.0/test/test_config_base.py`

 * *Files 1% similar despite different names*

```diff
@@ -23,25 +23,25 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
-from apprise.AppriseAsset import AppriseAsset
-from apprise.config.ConfigBase import ConfigBase
+from apprise import AppriseAsset
+from apprise.config import ConfigBase
 from apprise import Apprise
 from apprise import ConfigFormat
 from inspect import cleandoc
 import yaml
 
 # Disable logging for a cleaner testing output
 import logging
 
-from apprise.plugins.NotifyEmail import NotifyEmail
+from apprise.plugins.email import NotifyEmail
 
 logging.disable(logging.CRITICAL)
 
 
 def test_config_base():
     """
     API: ConfigBase() object
@@ -976,17 +976,17 @@
     # Boolean types stay boolean
     assert asset.async_mode is False
 
     # the theme was not updated and remains the same as it was
     assert asset.theme == AppriseAsset().theme
 
     # Empty string assignment
-    assert isinstance(asset.image_url_mask, str) is True
+    assert isinstance(asset.image_url_mask, str)
     assert asset.image_url_mask == ""
-    assert isinstance(asset.image_url_logo, str) is True
+    assert isinstance(asset.image_url_logo, str)
     assert asset.image_url_logo == ""
 
     # For on-lookers looking through this file; here is a perfectly formatted
     # YAML configuration file for your reference so you can see it without
     # all of the errors like the ones identified above
     result, config = ConfigBase.config_parse_yaml("""
 # if no version is specified then version 1 is presumed. Thus this is a
```

### Comparing `apprise-1.7.6/test/test_config_file.py` & `apprise-1.8.0/test/test_config_file.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,17 +24,17 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
-from apprise.config.ConfigFile import ConfigFile
-from apprise.plugins.NotifyBase import NotifyBase
-from apprise.AppriseAsset import AppriseAsset
+from apprise.config.file import ConfigFile
+from apprise.plugins import NotifyBase
+from apprise import AppriseAsset
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 
 def test_config_file(tmpdir):
```

### Comparing `apprise-1.7.6/test/test_config_http.py` & `apprise-1.8.0/test/test_config_http.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,17 +28,17 @@
 
 import time
 import pytest
 from unittest import mock
 
 import requests
 from apprise.common import ConfigFormat
-from apprise.config.ConfigHTTP import ConfigHTTP
-from apprise.plugins.NotifyBase import NotifyBase
-from apprise.NotificationManager import NotificationManager
+from apprise.config.http import ConfigHTTP
+from apprise.plugins import NotifyBase
+from apprise.manager_plugins import NotificationManager
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
```

### Comparing `apprise-1.7.6/test/test_config_memory.py` & `apprise-1.8.0/test/test_config_memory.py`

 * *Files 4% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.config.ConfigMemory import ConfigMemory
+from apprise.config.memory import ConfigMemory
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 
 def test_config_memory():
@@ -44,22 +44,22 @@
     # Initialize our object
     cm = ConfigMemory(content="json://localhost", format='text')
 
     # one entry added
     assert len(cm) == 1
 
     # Test general functions
-    assert isinstance(cm.url(), str) is True
-    assert isinstance(cm.read(), str) is True
+    assert isinstance(cm.url(), str)
+    assert isinstance(cm.read(), str)
 
     # Test situation where an auto-detect is required:
     cm = ConfigMemory(content="json://localhost")
 
     # one entry added
     assert len(cm) == 1
 
     # Test general functions
-    assert isinstance(cm.url(), str) is True
-    assert isinstance(cm.read(), str) is True
+    assert isinstance(cm.url(), str)
+    assert isinstance(cm.read(), str)
 
     # Test situation where we can not detect the data
     assert len(ConfigMemory(content="garbage")) == 0
```

### Comparing `apprise-1.7.6/test/test_conversion.py` & `apprise-1.8.0/test/test_conversion.py`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/test_escapes.py` & `apprise-1.8.0/test/test_escapes.py`

 * *Ordering differences only*

 * *Files 0% similar despite different names*

```diff
@@ -22,16 +22,16 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from json import loads
 import requests
+from json import loads
 from unittest import mock
 
 import apprise
 
 
 @mock.patch('requests.post')
 def test_apprise_interpret_escapes(mock_post):
```

### Comparing `apprise-1.7.6/test/test_logger.py` & `apprise-1.8.0/test/test_logger.py`

 * *Files 0% similar despite different names*

```diff
@@ -377,15 +377,15 @@
     a = Apprise(asset=asset)
 
     with LogCapture(level=logging.DEBUG) as stream:
         # add a test server
         assert a.add("json://user:pass1$-3!@localhost") is True
 
         # Our servers should carry this flag
-        a[0].asset.secure_logging is True
+        assert a[0].asset.secure_logging is True
 
         logs = re.split(r'\r*\n', stream.getvalue().rstrip())
         assert len(logs) == 1
         entry = re.split(r'\s-\s', logs[0])
         assert len(entry) == 3
         assert entry[1] == 'DEBUG'
         assert entry[2].startswith(
```

### Comparing `apprise-1.7.6/test/test_notification_manager.py` & `apprise-1.8.0/test/test_notification_manager.py`

 * *Files 8% similar despite different names*

```diff
@@ -29,16 +29,16 @@
 import re
 import pytest
 import types
 import threading
 from inspect import cleandoc
 
 from apprise import Apprise
-from apprise.NotificationManager import NotificationManager
-from apprise.plugins.NotifyBase import NotifyBase
+from apprise.manager_plugins import NotificationManager
+from apprise.plugins import NotifyBase
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Grant access to our Notification Manager Singleton
 N_MGR = NotificationManager()
@@ -63,15 +63,15 @@
     N_MGR.unload_modules()
     iter(N_MGR)
     iter(N_MGR)
 
     N_MGR.unload_modules()
     assert bool(N_MGR) is False
     assert len([x for x in iter(N_MGR)]) > 0
-    assert bool(N_MGR) is True
+    assert bool(N_MGR)
 
     N_MGR.unload_modules()
     assert isinstance(N_MGR.plugins(), types.GeneratorType)
     assert len([x for x in N_MGR.plugins()]) > 0
     N_MGR.unload_modules(disable_native=True)
     assert isinstance(N_MGR.plugins(), types.GeneratorType)
     assert len([x for x in N_MGR.plugins()]) == 0
@@ -342,25 +342,25 @@
     # Prepare ourselves a file to work with
     notify_base = tmpdir.mkdir('plugins')
     notify_test = notify_base.join('NotifyTest.py')
     notify_test.write(cleandoc("""
     #
     # Bare Minimum Valid Object
     #
-    from apprise.plugins.NotifyBase import NotifyBase
+    from apprise.plugins import NotifyBase
     from apprise.common import NotifyType
 
     class NotifyTest(NotifyBase):
 
         service_name = 'Test'
 
         # The services URL
         service_url = 'https://github.com/caronc/apprise/'
 
-        # All boxcar notifications are secure
+        # Define our protocol
         secure_protocol = 'mytest'
 
         # A URL that takes you to the setup/help of the specific protocol
         setup_url = 'https://github.com/caronc/apprise/wiki/Notify_mytest'
 
         # Define object templates
         templates = (
@@ -378,62 +378,22 @@
     """))
     assert 'mytest' not in N_MGR
     N_MGR.load_modules(path=str(notify_base))
     assert 'mytest' in N_MGR
     del N_MGR['mytest']
     assert 'mytest' not in N_MGR
 
-    # Prepare ourselves a file to work with
-    notify_test = notify_base.join('NotifyNoAlign.py')
-    notify_test.write(cleandoc("""
-    #
-    # Bare Minimum Valid Object
-    #
-    from apprise.plugins.NotifyBase import NotifyBase
-    from apprise.common import NotifyType
-
-    class NotifyDifferentName(NotifyBase):
-
-        service_name = 'Unloadable'
-
-        # The services URL
-        service_url = 'https://github.com/caronc/apprise/'
-
-        # All boxcar notifications are secure
-        secure_protocol = 'noload'
-
-        # A URL that takes you to the setup/help of the specific protocol
-        setup_url = 'https://github.com/caronc/apprise/wiki/Notify_mytest'
-
-        # Define object templates
-        templates = (
-            '{schema}://',
-        )
-
-        def __init__(self, **kwargs):
-            super().__init__(**kwargs)
-
-        def send(self, body, title='', notify_type=NotifyType.INFO, **kwargs):
-            return True
-
-        def url(self):
-            return 'mytest://'
-    """))
     assert 'mytest' not in N_MGR
     N_MGR.load_modules(path=str(notify_base))
 
     # It's still not loaded because the path has already been scanned
     assert 'mytest' not in N_MGR
     N_MGR.load_modules(path=str(notify_base), force=True)
     assert 'mytest' in N_MGR
 
-    # Could not be loaded because the filename did not align with the class
-    # name.
-    assert 'noload' not in N_MGR
-
     # Double load will test section of code that prevents a notification
     # From reloading if previously already loaded
     N_MGR.load_modules(path=str(notify_base))
     # Our item is still loaded as expected
     assert 'mytest' in N_MGR
 
     # Simple test to make sure we can handle duplicate entries loaded
```

### Comparing `apprise-1.7.6/test/test_notify_base.py` & `apprise-1.8.0/test/test_notify_base.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 from datetime import datetime
 from datetime import timedelta
 
-from apprise.plugins.NotifyBase import NotifyBase
+from apprise.plugins import NotifyBase
 from apprise import NotifyType
 from apprise import NotifyImageSize
 from timeit import default_timer
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
@@ -60,23 +60,19 @@
 
     nb = NotifyBase(port=10)
     assert nb.port == 10
 
     assert isinstance(nb.url(), str)
     assert str(nb) == nb.url()
 
-    try:
-        nb.send('test message')
-        assert False
-
-    except NotImplementedError:
+    with pytest.raises(NotImplementedError):
         # Each sub-module is that inherits this as a parent is required to
         # over-ride this function. So direct calls to this throws a not
         # implemented error intentionally
-        assert True
+        nb.send('test message')
 
     # Throttle overrides..
     nb = NotifyBase()
     nb.request_rate_per_sec = 0.0
     start_time = default_timer()
     nb.throttle()
     elapsed = default_timer() - start_time
@@ -204,53 +200,53 @@
     # Test invalid data
     assert NotifyBase.parse_list(None) == []
     assert NotifyBase.parse_list(object()) == []
     assert NotifyBase.parse_list(42) == []
 
     result = NotifyBase.parse_list(
         ',path,?name=Dr%20Disrespect', unquote=False)
-    assert isinstance(result, list) is True
+    assert isinstance(result, list)
     assert len(result) == 2
     assert 'path' in result
     assert '?name=Dr%20Disrespect' in result
 
     result = NotifyBase.parse_list(',path,?name=Dr%20Disrespect', unquote=True)
-    assert isinstance(result, list) is True
+    assert isinstance(result, list)
     assert len(result) == 2
     assert 'path' in result
     assert '?name=Dr Disrespect' in result
 
     # by parse_list while additional concatinated slashes are ignored
     # FYI: %2F = /
     # In this lit there are actually 4 entries, however parse_list
     # eliminates duplicates in addition to unquoting content by default
     result = NotifyBase.parse_list(
         ',%2F,%2F%2F, , , ,%2F%2F%2F, %2F', unquote=True)
-    assert isinstance(result, list) is True
+    assert isinstance(result, list)
     assert len(result) == 3
     assert '/' in result
     assert '//' in result
     assert '///' in result
 
     # Phone number parsing
     assert NotifyBase.parse_phone_no(None) == []
     assert NotifyBase.parse_phone_no(object()) == []
     assert NotifyBase.parse_phone_no(42) == []
 
     result = NotifyBase.parse_phone_no(
         '+1-800-123-1234,(800) 123-4567', unquote=False)
-    assert isinstance(result, list) is True
+    assert isinstance(result, list)
     assert len(result) == 2
     assert '+1-800-123-1234' in result
     assert '(800) 123-4567' in result
 
     # %2B == +
     result = NotifyBase.parse_phone_no(
         '%2B1-800-123-1234,%2B1%20800%20123%204567', unquote=True)
-    assert isinstance(result, list) is True
+    assert isinstance(result, list)
     assert len(result) == 2
     assert '+1-800-123-1234' in result
     assert '+1 800 123 4567' in result
 
     # Give nothing, get nothing
     assert NotifyBase.escape_html("") == ""
     assert NotifyBase.escape_html(None) == ""
```

### Comparing `apprise-1.7.6/test/test_plugin_apprise_api.py` & `apprise-1.8.0/test/test_plugin_apprise_api.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 from unittest import mock
-from apprise.plugins.NotifyAppriseAPI import NotifyAppriseAPI
+from apprise.plugins.apprise_api import NotifyAppriseAPI
 from helpers import AppriseURLTester
 import requests
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
@@ -66,14 +66,20 @@
     }),
     # A valid URL with Token
     ('apprise://localhost/%s' % ('a' * 32), {
         'instance': NotifyAppriseAPI,
         # Our expected url(privacy=True) startswith() response:
         'privacy_url': 'apprise://localhost/a...a/',
     }),
+    # A valid URL with long Token
+    ('apprise://localhost/%s' % ('a' * 128), {
+        'instance': NotifyAppriseAPI,
+        # Our expected url(privacy=True) startswith() response:
+        'privacy_url': 'apprise://localhost/a...a/',
+    }),
     # A valid URL with Token (using port)
     ('apprise://localhost:8080/%s' % ('b' * 32), {
         'instance': NotifyAppriseAPI,
         # Our expected url(privacy=True) startswith() response:
         'privacy_url': 'apprise://localhost:8080/b...b/',
     }),
     # A secure (https://) reference
```

### Comparing `apprise-1.7.6/test/test_plugin_aprs.py` & `apprise-1.8.0/test/test_plugin_aprs.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 import socket
 import apprise
-from apprise.plugins.NotifyAprs import NotifyAprs
+from apprise.plugins.aprs import NotifyAprs
 
 # Disable logging for a cleaner testing output
 import logging
 
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_bark.py` & `apprise-1.8.0/test/test_plugin_bark.py`

 * *Files 2% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyBark import NotifyBark
+from apprise.plugins.bark import NotifyBark
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_boxcar.py` & `apprise-1.8.0/test/test_plugin_boxcar.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 from unittest import mock
 
-from apprise.plugins.NotifyBoxcar import NotifyBoxcar
+from apprise.plugins.boxcar import NotifyBoxcar
 from helpers import AppriseURLTester
 from apprise import NotifyType
 import requests
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_bulksms.py` & `apprise-1.8.0/test/test_plugin_bulksms.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 from json import loads
 from apprise import Apprise
-from apprise.plugins.NotifyBulkSMS import NotifyBulkSMS
+from apprise.plugins.bulksms import NotifyBulkSMS
 from helpers import AppriseURLTester
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_bulkvs.py` & `apprise-1.8.0/test/test_plugin_bulkvs.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 from json import loads
 from apprise import Apprise
-from apprise.plugins.NotifyBulkVS import NotifyBulkVS
+from apprise.plugins.bulkvs import NotifyBulkVS
 from helpers import AppriseURLTester
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_burstsms.py` & `apprise-1.8.0/test/test_plugin_burstsms.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 import pytest
 import requests
 from json import dumps
 
-from apprise.plugins.NotifyBurstSMS import NotifyBurstSMS
+from apprise.plugins.burstsms import NotifyBurstSMS
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_chantify.py` & `apprise-1.8.0/test/test_plugin_chantify.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyChantify import NotifyChantify
+from apprise.plugins.chantify import NotifyChantify
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_clicksend.py` & `apprise-1.8.0/test/test_plugin_clicksend.py`

 * *Files 2% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyClickSend import NotifyClickSend
+from apprise.plugins.clicksend import NotifyClickSend
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -58,14 +58,18 @@
         # Our expected url(privacy=True) startswith() response:
         'privacy_url': 'clicksend://user:****',
     }),
     ('clicksend://user:pass@{}?batch=no'.format('3' * 14), {
         # valid number - no batch
         'instance': NotifyClickSend,
     }),
+    ('clicksend://user@{}?batch=no&key=abc123'.format('3' * 14), {
+        # valid number - no batch
+        'instance': NotifyClickSend,
+    }),
     ('clicksend://user:pass@{}'.format('3' * 14), {
         'instance': NotifyClickSend,
         # throw a bizzare code forcing us to fail to look it up
         'response': False,
         'requests_response_code': 999,
     }),
     ('clicksend://user:pass@{}'.format('3' * 14), {
```

### Comparing `apprise-1.7.6/test/test_plugin_custom_form.py` & `apprise-1.8.0/test/test_plugin_custom_form.py`

 * *Files 0% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 from unittest import mock
 
 import requests
 
-from apprise.plugins.NotifyForm import NotifyForm
+from apprise.plugins.custom_form import NotifyForm
 from helpers import AppriseURLTester
 from apprise import Apprise
 from apprise import NotifyType
 from apprise import AppriseAttachment
 
 # Disable logging for a cleaner testing output
 import logging
```

### Comparing `apprise-1.7.6/test/test_plugin_custom_json.py` & `apprise-1.8.0/test/test_plugin_custom_json.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,15 +31,15 @@
 from unittest import mock
 
 import requests
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
 
-from apprise.plugins.NotifyJSON import NotifyJSON
+from apprise.plugins.custom_json import NotifyJSON
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
@@ -183,15 +183,15 @@
     assert results['port'] == 8080
     assert results['host'] == 'localhost'
     assert results['fullpath'] == '/command'
     assert results['path'] == '/'
     assert results['query'] == 'command'
     assert results['schema'] == 'json'
     assert results['url'] == 'json://localhost:8080/command'
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
     assert results['qsd:']['message'] == 'msg'
     # empty special mapping
     assert results['qsd:']['type'] == ''
 
     instance = NotifyJSON(**results)
     assert isinstance(instance, NotifyJSON)
 
@@ -317,15 +317,15 @@
     assert results['port'] == 8081
     assert results['host'] == 'localhost'
     assert results['fullpath'] == '/webapi/entry.cgi'
     assert results['path'] == '/webapi/'
     assert results['query'] == 'entry.cgi'
     assert results['schema'] == 'jsons'
     assert results['url'] == 'jsons://localhost:8081/webapi/entry.cgi'
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
     # Header Entries
     assert results['qsd-']['api'] == 'SYNO.Chat.External'
     assert results['qsd-']['method'] == 'incoming'
     assert results['qsd-']['version'] == '2'
     assert results['qsd-']['token'] == 'abc123'
 
     instance = NotifyJSON(**results)
```

### Comparing `apprise-1.7.6/test/test_plugin_custom_xml.py` & `apprise-1.8.0/test/test_plugin_custom_xml.py`

 * *Files 2% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 import re
 from unittest import mock
 
 import requests
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
-from apprise.plugins.NotifyXML import NotifyXML
+from apprise.plugins.custom_xml import NotifyXML
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
@@ -256,15 +256,15 @@
     assert results['port'] == 8080
     assert results['host'] == 'localhost'
     assert results['fullpath'] == '/command'
     assert results['path'] == '/'
     assert results['query'] == 'command'
     assert results['schema'] == 'xml'
     assert results['url'] == 'xml://localhost:8080/command'
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
     assert results['qsd:']['Message'] == 'Body'
     assert results['qsd:']['Key'] == 'value'
     assert results['qsd:'][','] == 'invalid'
 
     instance = NotifyXML(**results)
     assert isinstance(instance, NotifyXML)
 
@@ -312,15 +312,15 @@
     assert results['port'] == 8081
     assert results['host'] == 'localhost'
     assert results['fullpath'] == '/command'
     assert results['path'] == '/'
     assert results['query'] == 'command'
     assert results['schema'] == 'xml'
     assert results['url'] == 'xml://localhost:8081/command'
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
     assert results['qsd:']['New'] == 'Value'
 
     instance = NotifyXML(**results)
     assert isinstance(instance, NotifyXML)
 
     # XSD URL is disabled due to custom formatting
     assert instance.xsd_url is None
@@ -360,15 +360,15 @@
     assert results['port'] is None
     assert results['host'] == 'localhost'
     assert results['fullpath'] is None
     assert results['path'] is None
     assert results['query'] is None
     assert results['schema'] == 'xmls'
     assert results['url'] == 'xmls://localhost'
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
     assert results['qsd:']['Version'] == ''
     assert results['qsd:']['Message'] == 'Body'
     assert results['qsd:']['Subject'] == 'Title'
 
     instance = NotifyXML(**results)
     assert isinstance(instance, NotifyXML)
```

### Comparing `apprise-1.7.6/test/test_plugin_d7networks.py` & `apprise-1.8.0/test/test_plugin_d7networks.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from json import loads
 from unittest import mock
-from apprise.plugins.NotifyD7Networks import NotifyD7Networks
+from apprise.plugins.d7networks import NotifyD7Networks
 from helpers import AppriseURLTester
 from apprise import Apprise
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_dapnet.py` & `apprise-1.8.0/test/test_plugin_dapnet.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from unittest import mock
 
 import apprise
-from apprise.plugins.NotifyDapnet import DapnetPriority, NotifyDapnet
+from apprise.plugins.dapnet import DapnetPriority, NotifyDapnet
 from helpers import AppriseURLTester
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_dingtalk.py` & `apprise-1.8.0/test/test_plugin_dingtalk.py`

 * *Files 2% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyDingTalk import NotifyDingTalk
+from apprise.plugins.dingtalk import NotifyDingTalk
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_discord.py` & `apprise-1.8.0/test/test_plugin_discord.py`

 * *Files 0% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 from unittest import mock
 from datetime import datetime, timedelta
 from datetime import timezone
 import pytest
 import requests
 from json import loads
 
-from apprise.plugins.NotifyDiscord import NotifyDiscord
+from apprise.plugins.discord import NotifyDiscord
 from helpers import AppriseURLTester
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
 from apprise import NotifyFormat
 from apprise.common import OverflowMode
```

### Comparing `apprise-1.7.6/test/test_plugin_email.py` & `apprise-1.8.0/test/test_plugin_email.py`

 * *Files 2% similar despite different names*

```diff
@@ -35,19 +35,19 @@
 
 import smtplib
 from email.header import decode_header
 
 from apprise import NotifyType, NotifyBase
 from apprise import Apprise
 from apprise import AttachBase
-from apprise.AppriseAsset import AppriseAsset
-from apprise.config.ConfigBase import ConfigBase
+from apprise import AppriseAsset
+from apprise.config import ConfigBase
 from apprise import AppriseAttachment
-from apprise.plugins.NotifyEmail import NotifyEmail
-from apprise.plugins import NotifyEmail as NotifyEmailModule
+from apprise.plugins.email import NotifyEmail
+from apprise.plugins import email as NotifyEmailModule
 
 # Disable logging for a cleaner testing output
 logging.disable(logging.CRITICAL)
 
 
 # Attachment Directory
 TEST_VAR_DIR = os.path.join(os.path.dirname(__file__), 'var')
@@ -342,22 +342,22 @@
                     url, str(obj)))
                 assert False
 
             assert isinstance(obj, instance)
 
             if isinstance(obj, NotifyBase):
                 # We loaded okay; now lets make sure we can reverse this url
-                assert isinstance(obj.url(), str) is True
+                assert isinstance(obj.url(), str)
 
                 # Verify we can acquire a target count as an integer
                 assert isinstance(len(obj), int)
 
                 # Test url() with privacy=True
                 assert isinstance(
-                    obj.url(privacy=True), str) is True
+                    obj.url(privacy=True), str)
 
                 # Some Simple Invalid Instance Testing
                 assert instance.parse_url(None) is None
                 assert instance.parse_url(object) is None
                 assert instance.parse_url(42) is None
 
                 if privacy_url:
@@ -375,20 +375,18 @@
                     # these tests work. Just printing before throwing our
                     # assertion failure makes things easier to debug later on
                     print('TEST FAIL: {} regenerated as {}'.format(
                         url, obj.url()))
                     assert False
 
                 # Verify there is no change from the old and the new
-                if len(obj) != len(obj_cmp):
-                    print('%d targets found in %s' % (
-                        len(obj), obj.url(privacy=True)))
-                    print('But %d targets found in %s' % (
-                        len(obj_cmp), obj_cmp.url(privacy=True)))
-                    raise AssertionError("Target miscount %d != %d")
+                assert len(obj) == len(obj_cmp), (
+                    '%d targets found in %s, But %d targets found in %s'
+                    % (len(obj), obj.url(privacy=True), len(obj_cmp),
+                       obj_cmp.url(privacy=True)))
 
             if self:
                 # Iterate over our expected entries inside of our object
                 for key, val in self.items():
                     # Test that our object has the desired key
                     assert hasattr(key, obj)
                     assert getattr(key, obj) == val
@@ -707,25 +705,25 @@
     # Basically we want to check that ' ' equates to %20 and % equates to %25
     # So the above translates to ' %20' (a space in front of %20).  We want
     # to verify the handling of the password escaping and when it happens.
     # a very bad response would be '  ' (double space)
     obj = NotifyEmail.parse_url(
         'mailto://user:{}@gmail.com?format=text'.format(passwd))
 
-    assert isinstance(obj, dict) is True
+    assert isinstance(obj, dict)
     assert 'password' in obj
 
     # Escaping doesn't happen at this stage because we want to leave this to
     # the plugins discretion
     assert obj.get('password') == '%20%2520'
 
     obj = Apprise.instantiate(
         'mailto://user:{}@gmail.com?format=text'.format(passwd),
         suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     # The password is escaped only 'once'
     assert obj.password == ' %20'
 
 
 def test_plugin_email_url_variations():
     """
@@ -735,15 +733,15 @@
     # Test variations of username required to be an email address
     # user@example.com
     obj = Apprise.instantiate(
         'mailto://{user}:{passwd}@example.com?smtp=example.com'.format(
             user='apprise%40example21.ca',
             passwd='abcd123'),
         suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert obj.password == 'abcd123'
     assert obj.user == 'apprise@example21.ca'
 
     # No from= used in the above
     assert re.match(r'.*from=.*', obj.url()) is None
     # No mode= as this isn't a secure connection
@@ -758,15 +756,15 @@
     # test username specified in the url body (as an argument)
     # this always over-rides the entry at the front of the url
     obj = Apprise.instantiate(
         'mailto://_:{passwd}@example.com?user={user}'.format(
             user='apprise%40example21.ca',
             passwd='abcd123'),
         suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert obj.password == 'abcd123'
     assert obj.user == 'apprise@example21.ca'
 
     # No from= used in the above
     assert re.match(r'.*from=.*', obj.url()) is None
     # No mode= as this isn't a secure connection
@@ -780,15 +778,15 @@
     # test user and password specified in the url body (as an argument)
     # this always over-rides the entries at the front of the url
     obj = Apprise.instantiate(
         'mailtos://_:_@example.com?user={user}&pass={passwd}'.format(
             user='apprise%40example21.ca',
             passwd='abcd123'),
         suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert obj.password == 'abcd123'
     assert obj.user == 'apprise@example21.ca'
     assert len(obj.targets) == 1
     assert (False, 'apprise@example.com') in obj.targets
     assert obj.from_addr[0] == obj.app_id
     assert obj.from_addr[1] == 'apprise@example.com'
@@ -810,15 +808,15 @@
     # this is similar to the previous test except we're only specifying
     # this information in the kwargs
     obj = Apprise.instantiate(
         'mailto://example.com?user={user}&pass={passwd}'.format(
             user='apprise%40example21.ca',
             passwd='abcd123'),
         suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert obj.password == 'abcd123'
     assert obj.user == 'apprise@example21.ca'
     assert len(obj.targets) == 1
     assert (False, 'apprise@example.com') in obj.targets
     assert obj.from_addr[0] == obj.app_id
     assert obj.from_addr[1] == 'apprise@example.com'
@@ -844,15 +842,15 @@
             passwd='abcd123',
             host='example.com',
             port=1234,
             this='from@example.jp',
             that='to@example.jp',
             smtp_host='smtp.example.edu'),
         suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert obj.password == 'abcd123'
     assert obj.user == 'apprise@example21.ca'
     assert obj.host == 'example.com'
     assert obj.port == 1234
     assert obj.smtp_host == 'smtp.example.edu'
     assert len(obj.targets) == 1
@@ -866,15 +864,15 @@
     for toaddr in ('/john.smith+mytag@domain.com',
                    '?to=john.smith+mytag@domain.com',
                    '/john.smith%2Bmytag@domain.com',
                    '?to=john.smith%2Bmytag@domain.com'):
 
         obj = Apprise.instantiate(
             'mailto://user:pass@domain.com{}'.format(toaddr))
-        assert isinstance(obj, NotifyEmail) is True
+        assert isinstance(obj, NotifyEmail)
         assert obj.password == 'pass'
         assert obj.user == 'user'
         assert obj.host == 'domain.com'
         assert obj.from_addr[0] == obj.app_id
         assert obj.from_addr[1] == 'user@domain.com'
         assert len(obj.targets) == 1
         assert obj.targets[0][0] is False
@@ -889,15 +887,15 @@
     # Test variations of username required to be an email address
     # user@example.com
     obj = Apprise.instantiate({
         'schema': 'mailto',
         'user': 'apprise@example.com',
         'password': 'abd123',
         'host': 'example.com'}, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
 
 @mock.patch('smtplib.SMTP_SSL')
 @mock.patch('smtplib.SMTP')
 def test_plugin_email_url_parsing(mock_smtp, mock_smtp_ssl):
     """
     NotifyEmail() Test email url parsing
@@ -919,15 +917,15 @@
     assert 'user' == results['user']
     assert 444 == results['port']
     assert 'hotmail.com' == results['host']
     assert 'pass123' == results['password']
     assert 'user2@yahoo.com' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert obj.notify("test") is True
     assert mock_smtp.call_count == 1
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 1
@@ -967,15 +965,15 @@
     assert 'test name' == results['from_addr']
     assert 'user' == results['user']
     assert 'hotmail.com' == results['host']
     assert 'pass123' == results['password']
     assert 'user2@yahoo.com' in results['targets']
     assert 'ssl' == results['secure_mode']
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert obj.notify("test") is True
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 1
     assert response.starttls.call_count == 0
@@ -1013,15 +1011,15 @@
 
     #
     # Test outlook/hotmail lookups
     #
     results = NotifyEmail.parse_url(
         'mailtos://user:pass123@hotmail.com')
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     assert obj.smtp_host == 'smtp-mail.outlook.com'
     # No entries in the reply_to
     assert not obj.reply_to
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 0
@@ -1039,15 +1037,15 @@
     mock_smtp.reset_mock()
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         'mailtos://user:pass123@outlook.com')
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     assert obj.smtp_host == 'smtp.outlook.com'
     # No entries in the reply_to
     assert not obj.reply_to
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 0
@@ -1065,15 +1063,15 @@
     mock_smtp.reset_mock()
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         'mailtos://user:pass123@outlook.com.au')
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     assert obj.smtp_host == 'smtp.outlook.com'
     # No entries in the reply_to
     assert not obj.reply_to
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 0
@@ -1093,15 +1091,15 @@
     response.reset_mock()
 
     # Consisitency Checks
     results = NotifyEmail.parse_url(
         'mailtos://outlook.com?smtp=smtp.outlook.com'
         '&user=user@outlook.com&pass=app.pw')
     obj1 = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj1, NotifyEmail) is True
+    assert isinstance(obj1, NotifyEmail)
     assert obj1.smtp_host == 'smtp.outlook.com'
     assert obj1.user == 'user@outlook.com'
     assert obj1.password == 'app.pw'
     assert obj1.secure_mode == 'starttls'
     assert obj1.port == 587
 
     assert mock_smtp.call_count == 0
@@ -1121,15 +1119,15 @@
     mock_smtp.reset_mock()
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         'mailtos://user:app.pw@outlook.com')
     obj2 = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj2, NotifyEmail) is True
+    assert isinstance(obj2, NotifyEmail)
     assert obj2.smtp_host == obj1.smtp_host
     assert obj2.user == obj1.user
     assert obj2.password == obj1.password
     assert obj2.secure_mode == obj1.secure_mode
     assert obj2.port == obj1.port
 
     assert mock_smtp.call_count == 0
@@ -1149,15 +1147,15 @@
     mock_smtp.reset_mock()
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         'mailto://user:pass@comcast.net')
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     assert obj.smtp_host == 'smtp.comcast.net'
     assert obj.user == 'user@comcast.net'
     assert obj.password == 'pass'
     assert obj.secure_mode == 'ssl'
     assert obj.port == 465
 
     assert mock_smtp.call_count == 0
@@ -1177,15 +1175,15 @@
     mock_smtp.reset_mock()
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         'mailtos://user:pass123@live.com')
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     # No entries in the reply_to
     assert not obj.reply_to
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 0
     assert obj.notify("test") is True
@@ -1202,15 +1200,15 @@
     mock_smtp.reset_mock()
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         'mailtos://user:pass123@hotmail.com')
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     # No entries in the reply_to
     assert not obj.reply_to
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 0
     assert obj.notify("test") is True
@@ -1231,15 +1229,15 @@
     #
     # Test Port Over-Riding
     #
     results = NotifyEmail.parse_url(
         "mailtos://abc:password@xyz.cn:465?"
         "smtp=smtp.exmail.qq.com&mode=ssl")
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     # Verify our over-rides are in place
     assert obj.smtp_host == 'smtp.exmail.qq.com'
     assert obj.port == 465
     assert obj.from_addr[0] == obj.app_id
     assert obj.from_addr[1] == 'abc@xyz.cn'
     assert obj.secure_mode == 'ssl'
@@ -1275,15 +1273,15 @@
     mock_smtp_ssl.reset_mock()
     response.reset_mock()
 
     results = NotifyEmail.parse_url(
         "mailtos://abc:password@xyz.cn?"
         "smtp=smtp.exmail.qq.com&mode=ssl&port=465")
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     # Verify our over-rides are in place
     assert obj.smtp_host == 'smtp.exmail.qq.com'
     assert obj.port == 465
     assert obj.from_addr[0] == obj.app_id
     assert obj.from_addr[1] == 'abc@xyz.cn'
     assert obj.secure_mode == 'ssl'
@@ -1310,15 +1308,15 @@
 
     #
     # Test Reply-To Email
     #
     results = NotifyEmail.parse_url(
         "mailtos://user:pass@example.com?reply=noreply@example.com")
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     # Verify our over-rides are in place
     assert obj.smtp_host == 'example.com'
     assert obj.from_addr[0] == obj.app_id
     assert obj.from_addr[1] == 'user@example.com'
     assert obj.secure_mode == 'starttls'
     assert obj.url().startswith(
         'mailtos://user:pass@example.com')
@@ -1345,15 +1343,15 @@
 
     #
     # Test Reply-To Email with Name Inline
     #
     results = NotifyEmail.parse_url(
         "mailtos://user:pass@example.com?reply=Chris<noreply@example.ca>")
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     # Verify our over-rides are in place
     assert obj.smtp_host == 'example.com'
     assert obj.from_addr[0] == obj.app_id
     assert obj.from_addr[1] == 'user@example.com'
     assert obj.secure_mode == 'starttls'
     assert obj.url().startswith(
         'mailtos://user:pass@example.com')
@@ -1393,15 +1391,15 @@
     assert 'joe@mydomain.nl' == results['user']
     assert results['port'] is None
     assert 'fastmail.com' == results['host']
     assert 'abc123' == results['password']
     assert 'hello@concordium-explorer.nl' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert obj.notify("test") is True
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 1
     assert response.starttls.call_count == 0
@@ -1443,15 +1441,15 @@
     assert results['from_addr'] == ''
     assert results['port'] is None
     assert 'fastmail.com' == results['host']
     assert 'password123' == results['password']
     assert results['smtp_host'] == ''
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     # During instantiation, our variables get detected
     assert obj.smtp_host == 'smtp.fastmail.com'
     assert obj.from_addr == ['Apprise', 'username@customdomain.com']
     assert obj.host == 'customdomain.com'
     # detected from
     assert (False, 'username@customdomain.com') in obj.targets
 
@@ -1494,15 +1492,15 @@
     assert results['from_addr'] == 'Custom'
     assert results['port'] is None
     assert 'fastmail.com' == results['host']
     assert 'password123' == results['password']
     assert results['smtp_host'] == ''
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
     # During instantiation, our variables get detected
     assert obj.smtp_host == 'smtp.fastmail.com'
     assert obj.from_addr == ['Custom', 'username@customdomain.com']
     assert obj.host == 'customdomain.com'
     # detected from
     assert (False, 'username@customdomain.com') in obj.targets
 
@@ -1551,15 +1549,15 @@
     assert 'admin@mail-domain.com' == results['user']
     assert results['port'] == 587
     assert 'domain.subdomain.com' == results['host']
     assert 'PASSWORD' == results['password']
     assert 'mail@mail-domain.com' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     # Not that our from_address takes on 'admin@domain.subdomain.com'
     assert obj.from_addr == ['Apprise', 'admin@domain.subdomain.com']
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert response.starttls.call_count == 0
@@ -1608,15 +1606,15 @@
     assert 'user' == results['user']
     assert 'gmail.com' == results['host']
     assert 'pass123' == results['password']
     assert results['port'] is None
     assert 'Plus Support<test+notification@gmail.com>' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert len(obj.targets) == 1
     assert ('Plus Support', 'test+notification@gmail.com') in obj.targets
     assert obj.smtp_host == 'smtp.gmail.com'
     assert obj.from_addr == ['Apprise', 'user@gmail.com']
     assert obj.host == 'gmail.com'
 
@@ -1656,15 +1654,15 @@
     assert 'user' == results['user']
     assert 'gmail.com' == results['host']
     assert 'pass123' == results['password']
     assert results['port'] is None
     assert 'test+notification@gmail.com' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert len(obj.targets) == 1
     assert (False, 'test+notification@gmail.com') in obj.targets
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert obj.notify("test") is True
@@ -1700,15 +1698,15 @@
     assert 'user' == results['user']
     assert 'gmail.com' == results['host']
     assert 'pass123' == results['password']
     assert results['port'] is None
     assert 'test+notification@gmail.com' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert len(obj.targets) == 1
     assert (False, 'test+notification@gmail.com') in obj.targets
 
     assert mock_smtp.call_count == 0
     assert mock_smtp_ssl.call_count == 0
     assert obj.notify("test") is True
@@ -1756,15 +1754,15 @@
     assert 'mail.local.mydomain.com' == results['smtp_host']
     assert 'mypassword' == results['password']
     assert 'ssl' == results['secure_mode']
     assert '465' == results['port']
     assert 'me@mydomain.com' in results['targets']
 
     obj = Apprise.instantiate(results, suppress_exceptions=False)
-    assert isinstance(obj, NotifyEmail) is True
+    assert isinstance(obj, NotifyEmail)
 
     assert len(obj.targets) == 1
     assert (False, 'me@mydomain.com') in obj.targets
 
 
 def test_plugin_email_variables_1087():
     """
@@ -2002,7 +2000,49 @@
     _to = response.sendmail.call_args[0][1]
     _msg = response.sendmail.call_args[0][2]
     assert _from == 'name@spectrum.net'
     assert isinstance(_to, list)
     assert len(_to) == 1
     assert _to[0] == 'john@yahoo.ca'
     assert _msg.split('\n')[-3] == 'body'
+
+
+@mock.patch('smtplib.SMTP_SSL')
+@mock.patch('smtplib.SMTP')
+def test_plugin_email_by_ipaddr_1113(mock_smtp, mock_smtp_ssl):
+    """
+    NotifyEmail() GitHub Issue 1113
+    https://github.com/caronc/apprise/issues/1113
+    Email with ip addresses not working
+
+    """
+
+    response = mock.Mock()
+    mock_smtp_ssl.return_value = response
+    mock_smtp.return_value = response
+
+    results = NotifyEmail.parse_url(
+        'mailto://10.0.0.195:25/?to=alerts@example.com&'
+        'from=sender@example.com')
+
+    assert isinstance(results, dict)
+    assert results['user'] is None
+    assert results['password'] is None
+    assert results['host'] == '10.0.0.195'
+    assert results['from_addr'] == 'sender@example.com'
+    assert isinstance(results['targets'], list)
+    assert len(results['targets']) == 1
+    assert results['targets'][0] == 'alerts@example.com'
+    assert results['port'] == 25
+
+    email = Apprise.instantiate(results, suppress_exceptions=False)
+    assert isinstance(email, NotifyEmail) is True
+
+    assert len(email.targets) == 1
+    assert (False, 'alerts@example.com') in email.targets
+
+    assert email.from_addr == (False, 'sender@example.com')
+    assert email.user is None
+    assert email.password is None
+    assert email.smtp_host == '10.0.0.195'
+    assert email.port == 25
+    assert email.targets == [(False, 'alerts@example.com')]
```

### Comparing `apprise-1.7.6/test/test_plugin_emby.py` & `apprise-1.8.0/test/test_plugin_emby.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 from json import dumps
 from apprise import Apprise
 import requests
 
-from apprise.plugins.NotifyEmby import NotifyEmby
+from apprise.plugins.emby import NotifyEmby
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -82,17 +82,17 @@
 
     """
 
     # Run our general tests
     AppriseURLTester(tests=apprise_url_tests).run_all()
 
 
-@mock.patch('apprise.plugins.NotifyEmby.NotifyEmby.sessions')
-@mock.patch('apprise.plugins.NotifyEmby.NotifyEmby.login')
-@mock.patch('apprise.plugins.NotifyEmby.NotifyEmby.logout')
+@mock.patch('apprise.plugins.emby.NotifyEmby.sessions')
+@mock.patch('apprise.plugins.emby.NotifyEmby.login')
+@mock.patch('apprise.plugins.emby.NotifyEmby.logout')
 @mock.patch('requests.get')
 @mock.patch('requests.post')
 def test_plugin_emby_general(mock_post, mock_get, mock_logout,
                              mock_login, mock_sessions):
     """
     NotifyEmby General Tests
 
@@ -272,16 +272,16 @@
 
     # Login
     assert obj.login() is True
     assert obj.user_id == 'abcd123'
     assert obj.access_token == '0000-0000-0000-0000'
 
 
-@mock.patch('apprise.plugins.NotifyEmby.NotifyEmby.login')
-@mock.patch('apprise.plugins.NotifyEmby.NotifyEmby.logout')
+@mock.patch('apprise.plugins.emby.NotifyEmby.login')
+@mock.patch('apprise.plugins.emby.NotifyEmby.logout')
 @mock.patch('requests.get')
 @mock.patch('requests.post')
 def test_plugin_emby_sessions(mock_post, mock_get, mock_logout, mock_login):
     """
     NotifyEmby() sessions()
 
     """
@@ -368,15 +368,15 @@
     obj.user_id = None
     mock_login.return_value = False
     sessions = obj.sessions()
     assert isinstance(sessions, dict) is True
     assert len(sessions) == 0
 
 
-@mock.patch('apprise.plugins.NotifyEmby.NotifyEmby.login')
+@mock.patch('apprise.plugins.emby.NotifyEmby.login')
 @mock.patch('requests.get')
 @mock.patch('requests.post')
 def test_plugin_emby_logout(mock_post, mock_get, mock_login):
     """
     NotifyEmby() logout()
 
     """
```

### Comparing `apprise-1.7.6/test/test_plugin_enigma2.py` & `apprise-1.8.0/test/test_plugin_enigma2.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyEnigma2 import NotifyEnigma2
+from apprise.plugins.enigma2 import NotifyEnigma2
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_fcm.py` & `apprise-1.8.0/test/test_plugin_fcm.py`

 * *Files 1% similar despite different names*

```diff
@@ -36,23 +36,23 @@
 import sys
 from unittest import mock
 
 import pytest
 import requests
 import json
 from apprise import Apprise
-from apprise.plugins.NotifyFCM import NotifyFCM
+from apprise.plugins.fcm import NotifyFCM
 from helpers import AppriseURLTester
 
 try:
-    from apprise.plugins.NotifyFCM.oauth import GoogleOAuth
-    from apprise.plugins.NotifyFCM.common import FCM_MODES
-    from apprise.plugins.NotifyFCM.priority import (
+    from apprise.plugins.fcm.oauth import GoogleOAuth
+    from apprise.plugins.fcm.common import FCM_MODES
+    from apprise.plugins.fcm.priority import (
         FCMPriorityManager, FCM_PRIORITIES)
-    from apprise.plugins.NotifyFCM.color import FCMColorManager
+    from apprise.plugins.fcm.color import FCMColorManager
     from cryptography.exceptions import UnsupportedAlgorithm
 
 except ImportError:
     # No problem; there is no cryptography support
     pass
 
 
@@ -869,39 +869,39 @@
     # Starts with has symbol
     assert instance.get()[0] == '#'
     # We'll return that we are defined but using default configuration
     assert str(instance) == 'yes'
 
     # We will be `true` because we can acquire a color based on what was
     # passed in
-    assert bool(instance) is True
+    assert bool(instance)
 
     # Custom color
     instance = FCMColorManager('#A2B3A4')
     assert isinstance(instance.get(), str)
     assert instance.get() == '#a2b3a4'
-    assert bool(instance) is True
+    assert bool(instance)
     # str() response does not include hashtag
     assert str(instance) == 'a2b3a4'
 
     # Custom color (no hashtag)
     instance = FCMColorManager('A2B3A4')
     assert isinstance(instance.get(), str)
     # Hashtag is always part of output
     assert instance.get() == '#a2b3a4'
-    assert bool(instance) is True
+    assert bool(instance)
     # str() response does not include hashtag
     assert str(instance) == 'a2b3a4'
 
     # Custom color (no hashtag) but only using 3 letter rgb values
     instance = FCMColorManager('AC4')
     assert isinstance(instance.get(), str)
     # Hashtag is always part of output
     assert instance.get() == '#aacc44'
-    assert bool(instance) is True
+    assert bool(instance)
     # str() response does not include hashtag
     assert str(instance) == 'aacc44'
 
 
 @pytest.mark.skipif(
     'cryptography' in sys.modules,
     reason="Requires that cryptography NOT be installed")
```

### Comparing `apprise-1.7.6/test/test_plugin_feishu.py` & `apprise-1.8.0/test/test_plugin_feishu.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyFeishu import NotifyFeishu
+from apprise.plugins.feishu import NotifyFeishu
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_flock.py` & `apprise-1.8.0/test/test_plugin_flock.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyFlock import NotifyFlock
+from apprise.plugins.flock import NotifyFlock
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_freemobile.py` & `apprise-1.8.0/test/test_plugin_freemobile.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyFreeMobile import NotifyFreeMobile
+from apprise.plugins.freemobile import NotifyFreeMobile
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_glib.py` & `apprise-1.8.0/test/test_plugin_glib.py`

 * *Files 4% similar despite different names*

```diff
@@ -45,15 +45,15 @@
 
 # Skip tests when Python environment does not provide the `dbus` package.
 if 'dbus' not in sys.modules:
     pytest.skip("Skipping dbus-python based tests", allow_module_level=True)
 
 
 from dbus import DBusException  # noqa E402
-from apprise.plugins.NotifyDBus import DBusUrgency, NotifyDBus  # noqa E402
+from apprise.plugins.dbus import DBusUrgency, NotifyDBus  # noqa E402
 
 
 def setup_glib_environment():
     """
     Setup a heavily mocked Glib environment.
     """
     mock_mainloop = Mock()
@@ -110,15 +110,15 @@
     mock_mainloop.glib.NativeMainLoop.side_effect = ImportError()
     sys.modules['dbus.mainloop.glib'] = mock_mainloop.glib
     mock_mainloop.glib.DBusGMainLoop.side_effect = None
     mock_mainloop.glib.NativeMainLoop.side_effect = None
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
-    reload_plugin('NotifyDBus')
+    reload_plugin('dbus')
 
 
 @pytest.fixture
 def dbus_environment(mocker):
     """
     Fixture to provide a mocked Dbus environment to test case functions.
     """
@@ -149,28 +149,28 @@
     NotifyDBus() general tests
 
     Test class loading using different arguments, provided via URL.
     """
 
     # Create our instance (identify all supported types)
     obj = apprise.Apprise.instantiate('dbus://', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.url().startswith('dbus://_/')
     obj = apprise.Apprise.instantiate('kde://', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.url().startswith('kde://_/')
     obj = apprise.Apprise.instantiate('qt://', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.url().startswith('qt://_/')
     obj = apprise.Apprise.instantiate('glib://', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.url().startswith('glib://_/')
     obj.duration = 0
 
     # Set our X and Y coordinate and try the notification
     assert NotifyDBus(
         x_axis=0, y_axis=0, **{'schema': 'dbus'})\
         .notify(title='', body='body',
@@ -185,97 +185,97 @@
     assert obj.notify(
         title='', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     # Test our arguments through the instantiate call
     obj = apprise.Apprise.instantiate(
         'dbus://_/?image=True', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.url().startswith('dbus://_/')
     assert re.search('image=yes', obj.url())
 
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'dbus://_/?image=False', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.url().startswith('dbus://_/')
     assert re.search('image=no', obj.url())
 
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     # Test priority (alias to urgency) handling
     obj = apprise.Apprise.instantiate(
         'dbus://_/?priority=invalid', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'dbus://_/?priority=high', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'dbus://_/?priority=2', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     # Test urgency handling
     obj = apprise.Apprise.instantiate(
         'dbus://_/?urgency=invalid', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'dbus://_/?urgency=high', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'dbus://_/?urgency=2', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'dbus://_/?urgency=', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     # Test x/y
     obj = apprise.Apprise.instantiate(
         'dbus://_/?x=5&y=5', suppress_exceptions=False)
-    assert isinstance(obj, NotifyDBus) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyDBus)
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
 
 def test_plugin_dbus_general_failure(dbus_glib_environment):
     """
@@ -411,15 +411,15 @@
 
     # Make `require_version` function raise an ImportError.
     gi = importlib.import_module("gi")
     gi.require_version.side_effect = ImportError()
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
-    reload_plugin('NotifyDBus')
+    reload_plugin('dbus')
 
     # Create the instance.
     obj = apprise.Apprise.instantiate('glib://', suppress_exceptions=False)
     assert isinstance(obj, NotifyDBus) is True
     obj.duration = 0
 
     # Test url() call.
@@ -438,15 +438,15 @@
 
     # Make `require_version` function raise a ValueError.
     gi = importlib.import_module("gi")
     gi.require_version.side_effect = ValueError("Something failed")
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
-    reload_plugin('NotifyDBus')
+    reload_plugin('dbus')
 
     # Create instance.
     obj = apprise.Apprise.instantiate('glib://', suppress_exceptions=False)
     assert isinstance(obj, NotifyDBus) is True
     obj.duration = 0
 
     # Test url() call.
@@ -465,15 +465,15 @@
 
     # Make importing `dbus` raise an ImportError.
     mocker.patch.dict(
         sys.modules, {'dbus': compile('raise ImportError()', 'dbus', 'exec')})
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
-    reload_plugin('NotifyDBus')
+    reload_plugin('dbus')
 
     # Verify plugin is not available.
     obj = apprise.Apprise.instantiate('glib://', suppress_exceptions=False)
     assert obj is None
 
 
 def test_plugin_dbus_session_croaks(mocker, dbus_glib_environment):
```

### Comparing `apprise-1.7.6/test/test_plugin_gnome.py` & `apprise-1.8.0/test/test_plugin_gnome.py`

 * *Files 2% similar despite different names*

```diff
@@ -32,15 +32,15 @@
 import types
 from unittest import mock
 from unittest.mock import Mock, call, ANY
 
 import pytest
 
 import apprise
-from apprise.plugins.NotifyGnome import GnomeUrgency, NotifyGnome
+from apprise.plugins.gnome import GnomeUrgency, NotifyGnome
 from helpers import reload_plugin
 
 # Disable logging for a cleaner testing output
 logging.disable(logging.CRITICAL)
 
 
 def setup_glib_environment():
@@ -55,15 +55,15 @@
     # we can handle cases when the library simply isn't available
 
     if gi_name in sys.modules:
         # Test cases where the gi library exists; we want to remove it
         # for the purpose of testing and capture the handling of the
         # library when it is missing
         del sys.modules[gi_name]
-        reload_plugin('NotifyGnome')
+        reload_plugin('gnome')
 
     # We need to fake our gnome environment for testing purposes since
     # the gi library isn't available on CI
     gi = types.ModuleType(gi_name)
     gi.repository = types.ModuleType(gi_name + '.repository')
     gi.module = types.ModuleType(gi_name + '.module')
 
@@ -93,15 +93,15 @@
     notify_obj.set_image_from_pixbuf.return_value = True
     notify_obj.show.return_value = True
     mock_notify.new.return_value = notify_obj
     mock_pixbuf.new_from_file.return_value = True
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
-    reload_plugin('NotifyGnome')
+    reload_plugin('gnome')
 
 
 @pytest.fixture
 def glib_environment():
     """
     Fixture to provide a mocked Glib environment to test case functions.
     """
@@ -340,15 +340,15 @@
         gi = importlib.import_module("gi")
     except ModuleNotFoundError:
         raise pytest.skip("`gi` package not installed")
     gi.require_version.side_effect = ValueError("Something failed")
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
-    reload_plugin('NotifyGnome')
+    reload_plugin('gnome')
 
     # Create instance.
     obj = apprise.Apprise.instantiate('gnome://', suppress_exceptions=False)
 
     # The notifier is marked disabled.
     assert obj is None
```

### Comparing `apprise-1.7.6/test/test_plugin_google_chat.py` & `apprise-1.8.0/test/test_plugin_google_chat.py`

 * *Files 2% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 import pytest
 from apprise import Apprise
-from apprise.plugins.NotifyGoogleChat import NotifyGoogleChat
+from apprise.plugins.google_chat import NotifyGoogleChat
 from helpers import AppriseURLTester
 from unittest import mock
 from apprise import NotifyType
 from json import loads
 
 # Disable logging for a cleaner testing output
 import logging
```

### Comparing `apprise-1.7.6/test/test_plugin_gotify.py` & `apprise-1.8.0/test/test_plugin_gotify.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 import apprise
-from apprise.plugins.NotifyGotify import GotifyPriority, NotifyGotify
+from apprise.plugins.gotify import GotifyPriority, NotifyGotify
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_growl.py` & `apprise-1.8.0/test/test_plugin_growl.py`

 * *Files 0% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 import sys
 from unittest import mock
 
 import pytest
 import apprise
 from apprise import NotifyBase
-from apprise.plugins.NotifyGrowl import GrowlPriority, NotifyGrowl
+from apprise.plugins.growl import GrowlPriority, NotifyGrowl
 
 try:
     from gntp import errors
 
     TEST_GROWL_EXCEPTIONS = (
         errors.NetworkError(
             0, 'gntp.ParseError() not handled'),
```

### Comparing `apprise-1.7.6/test/test_plugin_guilded.py` & `apprise-1.8.0/test/test_plugin_guilded.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 import os
 from unittest import mock
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyGuilded import NotifyGuilded
+from apprise.plugins.guilded import NotifyGuilded
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
@@ -179,8 +179,8 @@
 
     obj = NotifyGuilded(
         webhook_id=webhook_id,
         webhook_token=webhook_token,
         footer=True, thumbnail=False)
 
     # Test that we get a string response
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
```

### Comparing `apprise-1.7.6/test/test_plugin_homeassistant.py` & `apprise-1.8.0/test/test_plugin_homeassistant.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 from apprise import Apprise
-from apprise.plugins.NotifyHomeAssistant import NotifyHomeAssistant
+from apprise.plugins.home_assistant import NotifyHomeAssistant
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_httpsms.py` & `apprise-1.8.0/test/test_plugin_httpsms.py`

 * *Files 0% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 from json import loads
 from apprise import Apprise
-from apprise.plugins.NotifyHttpSMS import NotifyHttpSMS
+from apprise.plugins.httpsms import NotifyHttpSMS
 from helpers import AppriseURLTester
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_ifttt.py` & `apprise-1.8.0/test/test_plugin_ifttt.py`

 * *Files 3% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 from unittest import mock
 
 import requests
 from apprise import NotifyType
-from apprise.plugins.NotifyIFTTT import NotifyIFTTT
+from apprise.plugins.ifttt import NotifyIFTTT
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -146,36 +146,36 @@
         NotifyIFTTT(webhook_id="   ", events=events)
 
     # No events specified
     with pytest.raises(TypeError):
         NotifyIFTTT(webhook_id=webhook_id, events=None)
 
     obj = NotifyIFTTT(webhook_id=webhook_id, events=events)
-    assert isinstance(obj, NotifyIFTTT) is True
+    assert isinstance(obj, NotifyIFTTT)
 
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
 
     # Test the addition of tokens
     obj = NotifyIFTTT(
         webhook_id=webhook_id, events=events,
         add_tokens={'Test': 'ValueA', 'Test2': 'ValueB'})
 
-    assert isinstance(obj, NotifyIFTTT) is True
+    assert isinstance(obj, NotifyIFTTT)
 
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
 
     # Invalid del_tokens entry
     with pytest.raises(TypeError):
         NotifyIFTTT(
             webhook_id=webhook_id, events=events,
             del_tokens=NotifyIFTTT.ifttt_default_title_key)
 
-    assert isinstance(obj, NotifyIFTTT) is True
+    assert isinstance(obj, NotifyIFTTT)
 
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
 
     # Test removal of tokens by a list
     obj = NotifyIFTTT(
         webhook_id=webhook_id, events=events,
@@ -183,15 +183,15 @@
             'MyKey': 'MyValue'
         },
         del_tokens=(
             NotifyIFTTT.ifttt_default_title_key,
             NotifyIFTTT.ifttt_default_body_key,
             NotifyIFTTT.ifttt_default_type_key))
 
-    assert isinstance(obj, NotifyIFTTT) is True
+    assert isinstance(obj, NotifyIFTTT)
 
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
 
     # Test removal of tokens as dict
     obj = NotifyIFTTT(
         webhook_id=webhook_id, events=events,
@@ -199,8 +199,8 @@
             'MyKey': 'MyValue'
         },
         del_tokens={
             NotifyIFTTT.ifttt_default_title_key: None,
             NotifyIFTTT.ifttt_default_body_key: None,
             NotifyIFTTT.ifttt_default_type_key: None})
 
-    assert isinstance(obj, NotifyIFTTT) is True
+    assert isinstance(obj, NotifyIFTTT)
```

### Comparing `apprise-1.7.6/test/test_plugin_join.py` & `apprise-1.8.0/test/test_plugin_join.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 from unittest import mock
 
 import pytest
 import requests
 import apprise
 from apprise import NotifyType
 from helpers import AppriseURLTester
-from apprise.plugins.NotifyJoin import JoinPriority, NotifyJoin
+from apprise.plugins.join import JoinPriority, NotifyJoin
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
 apprise_url_tests = (
```

### Comparing `apprise-1.7.6/test/test_plugin_kavenegar.py` & `apprise-1.8.0/test/test_plugin_kavenegar.py`

 * *Files 1% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyKavenegar import NotifyKavenegar
+from apprise.plugins.kavenegar import NotifyKavenegar
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_kumulos.py` & `apprise-1.8.0/test/test_plugin_kumulos.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyKumulos import NotifyKumulos
+from apprise.plugins.kumulos import NotifyKumulos
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_lametric.py` & `apprise-1.8.0/test/test_plugin_lametric.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
-from apprise.plugins.NotifyLametric import NotifyLametric
+from apprise.plugins.lametric import NotifyLametric
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_line.py` & `apprise-1.8.0/test/test_plugin_line.py`

 * *Files 2% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyLine import NotifyLine
+from apprise.plugins.line import NotifyLine
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_lunasea.py` & `apprise-1.8.0/test/test_plugin_lunasea.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import os
 from unittest import mock
 from json import loads
 
 import requests
 from helpers import AppriseURLTester
 
-from apprise.plugins.NotifyLunaSea import NotifyLunaSea
+from apprise.plugins.lunasea import NotifyLunaSea
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
 TEST_VAR_DIR = os.path.join(os.path.dirname(__file__), 'var')
@@ -177,15 +177,15 @@
     assert results['port'] is None
     assert results['host'] == 'userA,+device1,~~,,'
     assert results['fullpath'] is None
     assert results['path'] is None
     assert results['query'] is None
     assert results['schema'] == 'lsea'
     assert results['url'] == 'lsea://user:pass@userA,+device1,~~,,'
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
 
     instance = NotifyLunaSea(**results)
     assert isinstance(instance, NotifyLunaSea)
     assert len(instance.targets) == 2
     assert ('@', 'userA') in instance.targets
     assert ('+', 'device1') in instance.targets
 
@@ -241,15 +241,15 @@
     assert (
         results['url'] ==
         'lseas://user:pass@myhost:3222/%40userA%2C%2Bdevice1%2C~~%2C%2C' or
         # Compatible with RHEL8 (Python v3.6.8)
         results['url'] ==
         'lseas://user:pass@myhost:3222/%40userA%2C%2Bdevice1%2C%7E%7E%2C%2C'
     )
-    assert isinstance(results['qsd:'], dict) is True
+    assert isinstance(results['qsd:'], dict)
 
     instance = NotifyLunaSea(**results)
     assert isinstance(instance, NotifyLunaSea)
     assert len(instance.targets) == 2
     assert ('@', 'userA') in instance.targets
     assert ('+', 'device1') in instance.targets
```

### Comparing `apprise-1.7.6/test/test_plugin_macosx.py` & `apprise-1.8.0/test/test_plugin_macosx.py`

 * *Files 2% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 import os
 import sys
 from unittest.mock import Mock
 
 import pytest
 
 import apprise
-from apprise.plugins.NotifyMacOSX import NotifyMacOSX
+from apprise.plugins.macosx import NotifyMacOSX
 from helpers import reload_plugin
 
 
 # Disable logging for a cleaner testing output.
 logging.disable(logging.CRITICAL)
 
 
@@ -52,30 +52,30 @@
     """
     Fixture to simulate a macOS environment.
     """
     mocker.patch("platform.system", return_value="Darwin")
     mocker.patch("platform.mac_ver", return_value=('10.8', ('', '', ''), ''))
 
     # Reload plugin module, in order to re-run module-level code.
-    reload_plugin("NotifyMacOSX")
+    reload_plugin("macosx")
 
 
 @pytest.fixture
 def terminal_notifier(mocker, tmp_path):
     """
     Fixture for providing a surrogate for the `terminal-notifier` program.
     """
     notifier_program = tmp_path.joinpath("terminal-notifier")
     notifier_program.write_text('#!/bin/sh\n\necho hello')
 
     # Set execute bit.
     os.chmod(notifier_program, 0o755)
 
     # Make the notifier use the temporary file instead of `terminal-notifier`.
-    mocker.patch("apprise.plugins.NotifyMacOSX.NotifyMacOSX.notify_paths",
+    mocker.patch("apprise.plugins.macosx.NotifyMacOSX.notify_paths",
                  (str(notifier_program),))
 
     yield notifier_program
 
 
 @pytest.fixture
 def macos_notify_environment(pretend_macos, terminal_notifier):
@@ -192,15 +192,15 @@
     """
     The notification object is disabled when pretending to run on Linux.
     """
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
     mocker.patch("platform.system", return_value="Linux")
-    reload_plugin("NotifyMacOSX")
+    reload_plugin("macosx")
 
     # Our object is disabled.
     obj = apprise.Apprise.instantiate('macosx://', suppress_exceptions=False)
     assert obj is None
 
 
 @pytest.mark.parametrize("macos_version", ["9.12", "10.7"])
@@ -209,11 +209,11 @@
     The notification object is disabled when pretending to run on older macOS.
     """
 
     # When patching something which has a side effect on the module-level code
     # of a plugin, make sure to reload it.
     mocker.patch("platform.mac_ver",
                  return_value=(macos_version, ('', '', ''), ''))
-    reload_plugin("NotifyMacOSX")
+    reload_plugin("macosx")
 
     obj = apprise.Apprise.instantiate('macosx://', suppress_exceptions=False)
     assert obj is None
```

### Comparing `apprise-1.7.6/test/test_plugin_mailgun.py` & `apprise-1.8.0/test/test_plugin_mailgun.py`

 * *Files 4% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 from unittest import mock
 
 import requests
 
-from apprise.plugins.NotifyMailgun import NotifyMailgun
+from apprise.plugins.mailgun import NotifyMailgun
 from helpers import AppriseURLTester
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
@@ -327,15 +327,15 @@
 
     # API Key
     apikey = 'abc123'
 
     obj = Apprise.instantiate(
         'mailgun://user@localhost.localdomain/{}'.format(apikey))
     assert isinstance(obj, NotifyMailgun)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # No calls made yet
     assert mock_post.call_count == 0
 
     # Send our notification
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
@@ -354,15 +354,15 @@
     # Reset our mock object
     mock_post.reset_mock()
 
     obj = Apprise.instantiate(
         'mailgun://user@localhost.localdomain/'
         '{}?from=Luke%20Skywalker'.format(apikey))
     assert isinstance(obj, NotifyMailgun)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # No calls made yet
     assert mock_post.call_count == 0
 
     # Send our notification
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
@@ -377,15 +377,15 @@
     # Reset our mock object
     mock_post.reset_mock()
 
     obj = Apprise.instantiate(
         'mailgun://user@localhost.localdomain/{}'
         '?from=Luke%20Skywalker<luke@rebels.com>'.format(apikey))
     assert isinstance(obj, NotifyMailgun)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # No calls made yet
     assert mock_post.call_count == 0
 
     # Send our notification
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
@@ -400,15 +400,15 @@
     # Reset our mock object
     mock_post.reset_mock()
 
     obj = Apprise.instantiate(
         'mailgun://user@localhost.localdomain/{}'
         '?from=luke@rebels.com'.format(apikey))
     assert isinstance(obj, NotifyMailgun)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # No calls made yet
     assert mock_post.call_count == 0
 
     # Send our notification
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
```

### Comparing `apprise-1.7.6/test/test_plugin_mastodon.py` & `apprise-1.8.0/test/test_plugin_mastodon.py`

 * *Files 1% similar despite different names*

```diff
@@ -32,15 +32,15 @@
 import requests
 from json import dumps, loads
 from datetime import datetime
 from datetime import timezone
 from apprise import Apprise
 from apprise import NotifyType
 from apprise import AppriseAttachment
-from apprise.plugins.NotifyMastodon import NotifyMastodon
+from apprise.plugins.mastodon import NotifyMastodon
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
@@ -186,16 +186,16 @@
     # Prepare Mock
     mock_get.return_value = request
     mock_post.return_value = request
 
     # Instantiate our object
     obj = NotifyMastodon(token=token, host=host)
 
-    assert isinstance(obj, NotifyMastodon) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyMastodon)
+    assert isinstance(obj.url(), str)
 
     # apprise room was found
     assert obj.send(body="test") is True
 
     # Change our status code and try again
     request.status_code = 403
     assert obj.send(body="test") is False
@@ -264,15 +264,15 @@
     assert obj.send(body="test") is True
 
     # Return it to a parseable string
     request.content = '{}'
 
     results = NotifyMastodon.parse_url(
         'mastodon://{}@{}/@user?visbility=direct'.format(token, host))
-    assert isinstance(results, dict) is True
+    assert isinstance(results, dict)
     assert '@user' in results['targets']
 
     # cause a json parsing issue now
     response_obj = None
     assert obj.send(body="test") is True
 
     response_obj = '{'
```

### Comparing `apprise-1.7.6/test/test_plugin_matrix.py` & `apprise-1.8.0/test/test_plugin_matrix.py`

 * *Files 2% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 from unittest import mock
 import os
 import requests
 import pytest
 from apprise import Apprise, AppriseAsset, AppriseAttachment, NotifyType
 from json import dumps
 
-from apprise.plugins.NotifyMatrix import NotifyMatrix
+from apprise.plugins.matrix import NotifyMatrix
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 MATRIX_GOOD_RESPONSE = dumps({
@@ -250,71 +250,71 @@
     # Prepare Mock
     mock_get.return_value = request
     mock_post.return_value = request
     mock_put.return_value = request
 
     # Variation Initializations
     obj = NotifyMatrix(host='host', targets='#abcd')
-    assert isinstance(obj, NotifyMatrix) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyMatrix)
+    assert isinstance(obj.url(), str)
     # Registration successful
     assert obj.send(body="test") is True
 
     obj = NotifyMatrix(host='host', user='user', targets='#abcd')
-    assert isinstance(obj, NotifyMatrix) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyMatrix)
+    assert isinstance(obj.url(), str)
     # Registration successful
     assert obj.send(body="test") is True
 
     obj = NotifyMatrix(host='host', password='passwd', targets='#abcd')
-    assert isinstance(obj, NotifyMatrix) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyMatrix)
+    assert isinstance(obj.url(), str)
     # A username gets automatically generated in these cases
     assert obj.send(body="test") is True
 
     obj = NotifyMatrix(
         host='host', user='user', password='passwd', targets='#abcd')
-    assert isinstance(obj.url(), str) is True
-    assert isinstance(obj, NotifyMatrix) is True
+    assert isinstance(obj.url(), str)
+    assert isinstance(obj, NotifyMatrix)
     # Registration Successful
     assert obj.send(body="test") is True
 
     # Test sending other format types
     kwargs = NotifyMatrix.parse_url(
         'matrix://user:passwd@hostname/#abcd?format=html')
     obj = NotifyMatrix(**kwargs)
-    assert isinstance(obj.url(), str) is True
-    assert isinstance(obj, NotifyMatrix) is True
-    obj.send(body="test") is True
-    obj.send(title="title", body="test") is True
+    assert isinstance(obj.url(), str)
+    assert isinstance(obj, NotifyMatrix)
+    assert obj.send(body="test") is True
+    assert obj.send(title="title", body="test") is True
 
     kwargs = NotifyMatrix.parse_url(
         'matrix://user:passwd@hostname/#abcd/#abcd:localhost?format=markdown')
     obj = NotifyMatrix(**kwargs)
-    assert isinstance(obj.url(), str) is True
-    assert isinstance(obj, NotifyMatrix) is True
-    obj.send(body="test") is True
-    obj.send(title="title", body="test") is True
+    assert isinstance(obj.url(), str)
+    assert isinstance(obj, NotifyMatrix)
+    assert obj.send(body="test") is True
+    assert obj.send(title="title", body="test") is True
 
     kwargs = NotifyMatrix.parse_url(
         'matrix://user:passwd@hostname/#abcd/!abcd:localhost?format=text')
     obj = NotifyMatrix(**kwargs)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     assert isinstance(obj, NotifyMatrix) is True
     obj.send(body="test") is True
     obj.send(title="title", body="test") is True
 
     # Test notice type notifications
     kwargs = NotifyMatrix.parse_url(
         'matrix://user:passwd@hostname/#abcd?msgtype=notice')
     obj = NotifyMatrix(**kwargs)
     assert isinstance(obj.url(), str) is True
     assert isinstance(obj, NotifyMatrix) is True
-    obj.send(body="test") is True
-    obj.send(title="title", body="test") is True
+    assert obj.send(body="test") is True
+    assert obj.send(title="title", body="test") is True
 
     with pytest.raises(TypeError):
         # invalid message type specified
         kwargs = NotifyMatrix.parse_url(
             'matrix://user:passwd@hostname/#abcd?msgtype=invalid')
         obj = NotifyMatrix(**kwargs)
```

### Comparing `apprise-1.7.6/test/test_plugin_mattermost.py` & `apprise-1.8.0/test/test_plugin_mattermost.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyMattermost import NotifyMattermost
+from apprise.plugins.mattermost import NotifyMattermost
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_messagebird.py` & `apprise-1.8.0/test/test_plugin_messagebird.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyMessageBird import NotifyMessageBird
+from apprise.plugins.messagebird import NotifyMessageBird
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_misskey.py` & `apprise-1.8.0/test/test_plugin_misskey.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import os
 
-from apprise.plugins.NotifyMisskey import NotifyMisskey
+from apprise.plugins.misskey import NotifyMisskey
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_mqtt.py` & `apprise-1.8.0/test/test_plugin_mqtt.py`

 * *Files 1% similar despite different names*

```diff
@@ -31,15 +31,15 @@
 import sys
 import ssl
 from unittest.mock import call, Mock, ANY
 
 import pytest
 
 import apprise
-from apprise.plugins.NotifyMQTT import NotifyMQTT
+from apprise.plugins.mqtt import NotifyMQTT
 
 # Disable logging for a cleaner testing output
 logging.disable(logging.CRITICAL)
 
 
 @pytest.fixture
 def mqtt_client_mock(mocker):
```

### Comparing `apprise-1.7.6/test/test_plugin_msg91.py` & `apprise-1.8.0/test/test_plugin_msg91.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 import pytest
 import requests
 from json import loads
 from apprise import Apprise
-from apprise.plugins.NotifyMSG91 import NotifyMSG91
+from apprise.plugins.msg91 import NotifyMSG91
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -159,16 +159,16 @@
 
     message_contents = "test"
 
     # Variation of initialization without API key
     obj = Apprise.instantiate(
         'msg91://{}@{}/{}?:key=value&:mobiles=ignored'
         .format(template, authkey, target))
-    assert isinstance(obj, NotifyMSG91) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyMSG91)
+    assert isinstance(obj.url(), str)
 
     # Send Notification
     assert obj.send(body=message_contents) is True
 
     # Validate expected call parameters
     assert mock_post.call_count == 1
     first_call = mock_post.call_args_list[0]
@@ -188,16 +188,16 @@
     assert response['recipients'][0]['key'] == 'value'
 
     mock_post.reset_mock()
 
     # Play with mapping
     obj = Apprise.instantiate(
         'msg91://{}@{}/{}?:body&:type=cat'.format(template, authkey, target))
-    assert isinstance(obj, NotifyMSG91) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyMSG91)
+    assert isinstance(obj.url(), str)
 
     # Send Notification
     assert obj.send(body=message_contents) is True
 
     # Validate expected call parameters
     assert mock_post.call_count == 1
     first_call = mock_post.call_args_list[0]
```

### Comparing `apprise-1.7.6/test/test_plugin_msteams.py` & `apprise-1.8.0/test/test_plugin_msteams.py`

 * *Files 0% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 
 import json
 import requests
 import pytest
 from apprise import Apprise
 from apprise import AppriseConfig
 from apprise import NotifyType
-from apprise.plugins.NotifyMSTeams import NotifyMSTeams
+from apprise.plugins.msteams import NotifyMSTeams
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_nextcloud.py` & `apprise-1.8.0/test/test_plugin_nextcloud.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 from apprise import Apprise
 from apprise import NotifyType
 import requests
-from apprise.plugins.NotifyNextcloud import NotifyNextcloud
+from apprise.plugins.nextcloud import NotifyNextcloud
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 apprise_url_tests = (
```

### Comparing `apprise-1.7.6/test/test_plugin_nextcloudtalk.py` & `apprise-1.8.0/test/test_plugin_nextcloudtalk.py`

 * *Files 1% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 from apprise import Apprise
 from apprise import NotifyType
 import requests
-from apprise.plugins.NotifyNextcloudTalk import NotifyNextcloudTalk
+from apprise.plugins.nextcloudtalk import NotifyNextcloudTalk
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 apprise_url_tests = (
```

### Comparing `apprise-1.7.6/test/test_plugin_notica.py` & `apprise-1.8.0/test/test_plugin_notica.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyNotica import NotifyNotica
+from apprise.plugins.notica import NotifyNotica
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_notifiarr.py` & `apprise-1.8.0/test/test_plugin_notifiarr.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyNotifiarr import NotifyNotifiarr
+from apprise.plugins.notifiarr import NotifyNotifiarr
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_notifico.py` & `apprise-1.8.0/test/test_plugin_notifico.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyNotifico import NotifyNotifico
+from apprise.plugins.notifico import NotifyNotifico
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_ntfy.py` & `apprise-1.8.0/test/test_plugin_ntfy.py`

 * *Files 0% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 import json
 from unittest import mock
 
 import requests
 import apprise
 from helpers import AppriseURLTester
 
-from apprise.plugins.NotifyNtfy import NtfyPriority, NotifyNtfy
+from apprise.plugins.ntfy import NtfyPriority, NotifyNtfy
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
 TEST_VAR_DIR = os.path.join(os.path.dirname(__file__), 'var')
```

### Comparing `apprise-1.7.6/test/test_plugin_office365.py` & `apprise-1.8.0/test/test_plugin_office365.py`

 * *Files 0% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 from unittest import mock
 
 import pytest
 import requests
 from datetime import datetime
 from json import dumps
 from apprise import Apprise
-from apprise.plugins.NotifyOffice365 import NotifyOffice365
+from apprise.plugins.office365 import NotifyOffice365
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_onesignal.py` & `apprise-1.8.0/test/test_plugin_onesignal.py`

 * *Files 0% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyOneSignal import NotifyOneSignal
+from apprise.plugins.one_signal import NotifyOneSignal
 from helpers import AppriseURLTester
 from apprise import Apprise
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_opsgenie.py` & `apprise-1.8.0/test/test_plugin_opsgenie.py`

 * *Files 0% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 import apprise
-from apprise.plugins.NotifyOpsgenie import NotifyOpsgenie, OpsgeniePriority
+from apprise.plugins.opsgenie import NotifyOpsgenie, OpsgeniePriority
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_pagerduty.py` & `apprise-1.8.0/test/test_plugin_pagerduty.py`

 * *Files 1% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyPagerDuty import NotifyPagerDuty
+from apprise.plugins.pagerduty import NotifyPagerDuty
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_pagertree.py` & `apprise-1.8.0/test/test_plugin_pagertree.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from unittest import mock
 import pytest
 
-from apprise.plugins.NotifyPagerTree import NotifyPagerTree
+from apprise.plugins.pagertree import NotifyPagerTree
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_parse_platform.py` & `apprise-1.8.0/test/test_plugin_parse_platform.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyParsePlatform import NotifyParsePlatform
+from apprise.plugins.parseplatform import NotifyParsePlatform
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_popcorn_notify.py` & `apprise-1.8.0/test/test_plugin_popcorn_notify.py`

 * *Files 3% similar despite different names*

```diff
@@ -23,15 +23,15 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
-from apprise.plugins.NotifyPopcornNotify import NotifyPopcornNotify
+from apprise.plugins.popcorn_notify import NotifyPopcornNotify
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_prowl.py` & `apprise-1.8.0/test/test_plugin_prowl.py`

 * *Files 0% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 import apprise
-from apprise.plugins.NotifyProwl import NotifyProwl, ProwlPriority
+from apprise.plugins.prowl import NotifyProwl, ProwlPriority
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_pushbullet.py` & `apprise-1.8.0/test/test_plugin_pushbullet.py`

 * *Files 0% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 from unittest import mock
 
 import pytest
 import requests
 from json import dumps
 from apprise import Apprise
 from apprise import AppriseAttachment
-from apprise.plugins.NotifyPushBullet import NotifyPushBullet
+from apprise.plugins.pushbullet import NotifyPushBullet
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_pushdeer.py` & `apprise-1.8.0/test/test_plugin_pushdeer.py`

 * *Files 3% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 from apprise import Apprise
-from apprise.plugins.NotifyPushDeer import NotifyPushDeer
+from apprise.plugins.pushdeer import NotifyPushDeer
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -106,16 +106,16 @@
     response.status_code = requests.codes.ok
 
     # Prepare Mock
     mock_post.return_value = response
 
     # Variation Initializations
     obj = Apprise.instantiate('pushdeer://localhost/pushKey')
-    assert isinstance(obj, NotifyPushDeer) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyPushDeer)
+    assert isinstance(obj.url(), str)
 
     # Send Notification
     assert obj.send(body="test") is True
 
     assert mock_post.call_count == 1
     assert mock_post.call_args_list[0][0][0] == \
         'http://localhost:80/message/push?pushkey=pushKey'
```

### Comparing `apprise-1.7.6/test/test_plugin_pushed.py` & `apprise-1.8.0/test/test_plugin_pushed.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyPushed import NotifyPushed
+from apprise.plugins.pushed import NotifyPushed
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_pushjet.py` & `apprise-1.8.0/test/test_plugin_pushjet.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyPushjet import NotifyPushjet
+from apprise.plugins.pushjet import NotifyPushjet
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_pushme.py` & `apprise-1.8.0/test/test_plugin_pushme.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyPushMe import NotifyPushMe
+from apprise.plugins.pushme import NotifyPushMe
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_pushover.py` & `apprise-1.8.0/test/test_plugin_pushover.py`

 * *Files 0% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 import os
 from unittest import mock
 
 import requests
 import pytest
 from json import dumps
-from apprise.plugins.NotifyPushover import PushoverPriority, NotifyPushover
+from apprise.plugins.pushover import PushoverPriority, NotifyPushover
 import apprise
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
@@ -336,37 +336,37 @@
 
     # No webhook id specified
     with pytest.raises(TypeError):
         NotifyPushover(user_key=user_key, webhook_id=None)
 
     obj = NotifyPushover(
         user_key=user_key, token=token, targets=devices)
-    assert isinstance(obj, NotifyPushover) is True
+    assert isinstance(obj, NotifyPushover)
     # Our invalid device is ignored
     assert len(obj.targets) == 2
 
     # We notify the 2 devices loaded
     assert obj.notify(
         body='body', title='title',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = NotifyPushover(user_key=user_key, token=token)
-    assert isinstance(obj, NotifyPushover) is True
+    assert isinstance(obj, NotifyPushover)
     # Default is to send to all devices, so there will be a
     # device defined here
     assert len(obj.targets) == 1
 
     # This call succeeds because all of the devices are valid
     assert obj.notify(
         body='body', title='title',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = NotifyPushover(
         user_key=user_key, token=token, targets=set())
-    assert isinstance(obj, NotifyPushover) is True
+    assert isinstance(obj, NotifyPushover)
     # Default is to send to all devices, so there will be a
     # device defined here
     assert len(obj.targets) == 1
 
     # No User Key specified
     with pytest.raises(TypeError):
         NotifyPushover(user_key=None, token="abcd")
```

### Comparing `apprise-1.7.6/test/test_plugin_pushsafer.py` & `apprise-1.8.0/test/test_plugin_pushsafer.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 import pytest
 from unittest import mock
 
 import requests
 from json import dumps
 from apprise import AppriseAttachment
 from apprise import NotifyType
-from apprise.plugins.NotifyPushSafer import NotifyPushSafer
+from apprise.plugins.pushsafer import NotifyPushSafer
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_pushy.py` & `apprise-1.8.0/test/test_plugin_pushy.py`

 * *Files 1% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyPushy import NotifyPushy
+from apprise.plugins.pushy import NotifyPushy
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_reddit.py` & `apprise-1.8.0/test/test_plugin_reddit.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyReddit import NotifyReddit
+from apprise.plugins.reddit import NotifyReddit
 from helpers import AppriseURLTester
 from unittest import mock
 
 from json import dumps
 from datetime import datetime
 from datetime import timedelta
 from datetime import timezone
@@ -270,16 +270,16 @@
     }
 
     # Prepare Mock
     mock_post.return_value = good_response
 
     # Variation Initializations
     obj = NotifyReddit(**kwargs)
-    assert isinstance(obj, NotifyReddit) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyReddit)
+    assert isinstance(obj.url(), str)
 
     # Dynamically pick up on a link
     assert obj.send(body="http://hostname") is True
 
     bad_response = mock.Mock()
     bad_response.content = ''
     bad_response.status_code = 401
```

### Comparing `apprise-1.7.6/test/test_plugin_revolt.py` & `apprise-1.8.0/test/test_plugin_revolt.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import os
 from unittest import mock
 from datetime import datetime, timedelta
 from json import dumps
 import pytest
 import requests
 
-from apprise.plugins.NotifyRevolt import NotifyRevolt
+from apprise.plugins.revolt import NotifyRevolt
 from helpers import AppriseURLTester
 from apprise import Apprise
 from apprise import NotifyType
 from apprise import NotifyFormat
 from apprise.common import OverflowMode
 
 from random import choice
@@ -315,15 +315,15 @@
 
     obj = NotifyRevolt(
         bot_token=bot_token,
         targets=channel_id)
     assert obj.ratelimit_remaining == 1
 
     # Test that we get a string response
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # This call includes an image with it's payload:
     assert obj.notify(
         body='body', title='title', notify_type=NotifyType.INFO) is True
 
     # Force a case where there are no more remaining posts allowed
     mock_post.return_value.headers = {
```

### Comparing `apprise-1.7.6/test/test_plugin_rocket_chat.py` & `apprise-1.8.0/test/test_plugin_rocket_chat.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
 from apprise import NotifyType
-from apprise.plugins.NotifyRocketChat import NotifyRocketChat
+from apprise.plugins.rocketchat import NotifyRocketChat
 from helpers import AppriseURLTester
 from unittest import mock
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_rsyslog.py` & `apprise-1.8.0/test/test_plugin_rsyslog.py`

 * *Files 0% similar despite different names*

```diff
@@ -33,15 +33,15 @@
 import apprise
 import socket
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
-from apprise.plugins.NotifyRSyslog import NotifyRSyslog  # noqa E402
+from apprise.plugins.rsyslog import NotifyRSyslog  # noqa E402
 
 
 @mock.patch('socket.socket')
 @mock.patch('os.getpid')
 def test_plugin_rsyslog_by_url(mock_getpid, mock_socket):
     """
     NotifyRSyslog() Apprise URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_ryver.py` & `apprise-1.8.0/test/test_plugin_ryver.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyRyver import NotifyRyver
+from apprise.plugins.ryver import NotifyRyver
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_sendgrid.py` & `apprise-1.8.0/test/test_plugin_sendgrid.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 
-from apprise.plugins.NotifySendGrid import NotifySendGrid
+from apprise.plugins.sendgrid import NotifySendGrid
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_serverchan.py` & `apprise-1.8.0/test/test_plugin_serverchan.py`

 * *Files 1% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyServerChan import NotifyServerChan
+from apprise.plugins.serverchan import NotifyServerChan
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_ses.py` & `apprise-1.8.0/test/test_plugin_ses.py`

 * *Files 0% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 import sys
 from unittest import mock
 
 import pytest
 import requests
 from apprise import Apprise
 from apprise import AppriseAttachment
-from apprise.plugins.NotifySES import NotifySES
+from apprise.plugins.ses import NotifySES
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 if hasattr(sys, "pypy_version_info"):
```

### Comparing `apprise-1.7.6/test/test_plugin_signal.py` & `apprise-1.8.0/test/test_plugin_signal.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,19 +30,19 @@
 from json import loads
 from unittest import mock
 from inspect import cleandoc
 
 import pytest
 import requests
 from apprise import Apprise
-from apprise.plugins.NotifySignalAPI import NotifySignalAPI
+from apprise.plugins.signal_api import NotifySignalAPI
 from helpers import AppriseURLTester
 from apprise import AppriseAttachment
 from apprise import NotifyType
-from apprise.config.ConfigBase import ConfigBase
+from apprise.config import ConfigBase
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
 TEST_VAR_DIR = os.path.join(os.path.dirname(__file__), 'var')
```

### Comparing `apprise-1.7.6/test/test_plugin_simplepush.py` & `apprise-1.8.0/test/test_plugin_simplepush.py`

 * *Files 2% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import sys
 from unittest import mock
 
 import pytest
 import requests
 import json
 from apprise import Apprise
-from apprise.plugins.NotifySimplePush import NotifySimplePush
+from apprise.plugins.simplepush import NotifySimplePush
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_sinch.py` & `apprise-1.8.0/test/test_plugin_sinch.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 import pytest
 import requests
 from json import dumps
 
-from apprise.plugins.NotifySinch import NotifySinch
+from apprise.plugins.sinch import NotifySinch
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_slack.py` & `apprise-1.8.0/test/test_plugin_slack.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,15 +31,15 @@
 from inspect import cleandoc
 
 import pytest
 import requests
 from apprise import Apprise
 from apprise import NotifyType
 from apprise import AppriseAttachment
-from apprise.plugins.NotifySlack import NotifySlack
+from apprise.plugins.slack import NotifySlack
 from helpers import AppriseURLTester
 
 from json import loads, dumps
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_sms_manager.py` & `apprise-1.8.0/test/test_plugin_sms_manager.py`

 * *Files 0% similar despite different names*

```diff
@@ -26,15 +26,15 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import requests
 from apprise import Apprise
-from apprise.plugins.NotifySMSManager import NotifySMSManager
+from apprise.plugins.smsmanager import NotifySMSManager
 from helpers import AppriseURLTester
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_smseagle.py` & `apprise-1.8.0/test/test_plugin_smseagle.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 import os
 from json import loads, dumps
 from unittest import mock
 
 import requests
 from apprise import Apprise
-from apprise.plugins.NotifySMSEagle import NotifySMSEagle
+from apprise.plugins.smseagle import NotifySMSEagle
 from helpers import AppriseURLTester
 from apprise import AppriseAttachment
 from apprise import NotifyType
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
```

### Comparing `apprise-1.7.6/test/test_plugin_smtp2go.py` & `apprise-1.8.0/test/test_plugin_smtp2go.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import os
 from unittest import mock
 
 import requests
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
-from apprise.plugins.NotifySMTP2Go import NotifySMTP2Go
+from apprise.plugins.smtp2go import NotifySMTP2Go
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_sns.py` & `apprise-1.8.0/test/test_plugin_sns.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 from apprise import Apprise
-from apprise.plugins.NotifySNS import NotifySNS
+from apprise.plugins.sns import NotifySNS
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 
@@ -109,41 +109,41 @@
 # we don't want it sending any notifications upstream
 @mock.patch('requests.post')
 def test_plugin_sns_edge_cases(mock_post):
     """
     NotifySNS() Edge Cases
 
     """
-
+    target = '+1800555999'
     # Initializes the plugin with a valid access, but invalid access key
     with pytest.raises(TypeError):
         # No access_key_id specified
         NotifySNS(
             access_key_id=None,
             secret_access_key=TEST_ACCESS_KEY_SECRET,
             region_name=TEST_REGION,
-            targets='+1800555999',
+            targets=target,
         )
 
     with pytest.raises(TypeError):
         # No secret_access_key specified
         NotifySNS(
             access_key_id=TEST_ACCESS_KEY_ID,
             secret_access_key=None,
             region_name=TEST_REGION,
-            targets='+1800555999',
+            targets=target,
         )
 
     with pytest.raises(TypeError):
         # No region_name specified
         NotifySNS(
             access_key_id=TEST_ACCESS_KEY_ID,
             secret_access_key=TEST_ACCESS_KEY_SECRET,
             region_name=None,
-            targets='+1800555999',
+            targets=target,
         )
 
     # No recipients
     obj = NotifySNS(
         access_key_id=TEST_ACCESS_KEY_ID,
         secret_access_key=TEST_ACCESS_KEY_SECRET,
         region_name=TEST_REGION,
@@ -196,28 +196,30 @@
     assert 'region_name' in results
     assert TEST_REGION == results['region_name']
     assert 'access_key_id' in results
     assert TEST_ACCESS_KEY_ID == results['access_key_id']
     assert 'secret_access_key' in results
     assert TEST_ACCESS_KEY_SECRET == results['secret_access_key']
 
+    target = '+18001234567'
+    topic = 'MyTopic'
     # Detect recipients
     results = NotifySNS.parse_url('sns://%s/%s/%s/%s/%s/' % (
         TEST_ACCESS_KEY_ID,
         TEST_ACCESS_KEY_SECRET,
         # Uppercase Region won't break anything
         TEST_REGION.upper(),
-        '+18001234567',
-        'MyTopic')
+        target,
+        topic)
     )
 
     # Confirm that our recipients were found
     assert len(results['targets']) == 2
-    assert '+18001234567' in results['targets']
-    assert 'MyTopic' in results['targets']
+    assert target in results['targets']
+    assert topic in results['targets']
     assert 'region_name' in results
     assert TEST_REGION == results['region_name']
     assert 'access_key_id' in results
     assert TEST_ACCESS_KEY_ID == results['access_key_id']
     assert 'secret_access_key' in results
     assert TEST_ACCESS_KEY_SECRET == results['secret_access_key']
```

### Comparing `apprise-1.7.6/test/test_plugin_sparkpost.py` & `apprise-1.8.0/test/test_plugin_sparkpost.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,15 +31,15 @@
 from unittest import mock
 
 import requests
 from json import dumps
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import NotifyType
-from apprise.plugins.NotifySparkPost import NotifySparkPost
+from apprise.plugins.sparkpost import NotifySparkPost
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_streamlabs.py` & `apprise-1.8.0/test/test_plugin_streamlabs.py`

 * *Files 0% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-from apprise.plugins.NotifyStreamlabs import NotifyStreamlabs
+from apprise.plugins.streamlabs import NotifyStreamlabs
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_synology.py` & `apprise-1.8.0/test/test_plugin_synology.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from unittest import mock
 
-from apprise.plugins.NotifySynology import NotifySynology
+from apprise.plugins.synology import NotifySynology
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_syslog.py` & `apprise-1.8.0/test/test_plugin_syslog.py`

 * *Files 6% similar despite different names*

```diff
@@ -37,15 +37,15 @@
 import logging
 logging.disable(logging.CRITICAL)
 
 # Skip tests when Python environment does not provide the `syslog` package.
 if 'syslog' not in sys.modules:
     pytest.skip("Skipping syslog based tests", allow_module_level=True)
 
-from apprise.plugins.NotifySyslog import NotifySyslog  # noqa E402
+from apprise.plugins.syslog import NotifySyslog  # noqa E402
 
 
 @mock.patch('syslog.syslog')
 @mock.patch('syslog.openlog')
 def test_plugin_syslog_by_url(openlog, syslog):
     """
     NotifySyslog() Apprise URLs
@@ -53,76 +53,76 @@
     """
     # an invalid URL
     assert NotifySyslog.parse_url(object) is None
     assert NotifySyslog.parse_url(42) is None
     assert NotifySyslog.parse_url(None) is None
 
     obj = apprise.Apprise.instantiate('syslog://')
-    assert obj.url().startswith('syslog://user') is True
+    assert obj.url().startswith('syslog://user')
     assert re.search(r'logpid=yes', obj.url()) is not None
     assert re.search(r'logperror=no', obj.url()) is not None
 
     assert isinstance(
         apprise.Apprise.instantiate(
             'syslog://:@/'), NotifySyslog)
 
     obj = apprise.Apprise.instantiate('syslog://?logpid=no&logperror=yes')
     assert isinstance(obj, NotifySyslog)
-    assert obj.url().startswith('syslog://user') is True
+    assert obj.url().startswith('syslog://user')
     assert re.search(r'logpid=no', obj.url()) is not None
     assert re.search(r'logperror=yes', obj.url()) is not None
 
     # Test sending a notification
     assert obj.notify("body") is True
     assert obj.notify(title="title", body="body") is True
 
     # Invalid Notification Type
     assert obj.notify("body", notify_type='invalid') is False
 
     obj = apprise.Apprise.instantiate('syslog://_/?facility=local5')
     assert isinstance(obj, NotifySyslog)
-    assert obj.url().startswith('syslog://local5') is True
+    assert obj.url().startswith('syslog://local5')
     assert re.search(r'logpid=yes', obj.url()) is not None
     assert re.search(r'logperror=no', obj.url()) is not None
 
     # Invalid instantiation
     assert apprise.Apprise.instantiate('syslog://_/?facility=invalid') is None
 
     # j will cause a search to take place and match to daemon
     obj = apprise.Apprise.instantiate('syslog://_/?facility=d')
     assert isinstance(obj, NotifySyslog)
-    assert obj.url().startswith('syslog://daemon') is True
+    assert obj.url().startswith('syslog://daemon')
     assert re.search(r'logpid=yes', obj.url()) is not None
     assert re.search(r'logperror=no', obj.url()) is not None
 
     # Facility can also be specified on the url as a hostname
     obj = apprise.Apprise.instantiate('syslog://kern?logpid=no&logperror=y')
     assert isinstance(obj, NotifySyslog)
-    assert obj.url().startswith('syslog://kern') is True
+    assert obj.url().startswith('syslog://kern')
     assert re.search(r'logpid=no', obj.url()) is not None
     assert re.search(r'logperror=yes', obj.url()) is not None
 
     # Facilities specified as an argument always over-ride host
     obj = apprise.Apprise.instantiate('syslog://kern?facility=d')
     assert isinstance(obj, NotifySyslog)
-    assert obj.url().startswith('syslog://daemon') is True
+    assert obj.url().startswith('syslog://daemon')
 
 
 @mock.patch('syslog.syslog')
 @mock.patch('syslog.openlog')
 def test_plugin_syslog_edge_cases(openlog, syslog):
     """
     NotifySyslog() Edge Cases
 
     """
 
     # Default
     obj = NotifySyslog(facility=None)
     assert isinstance(obj, NotifySyslog)
-    assert obj.url().startswith('syslog://user') is True
+    assert obj.url().startswith('syslog://user')
     assert re.search(r'logpid=yes', obj.url()) is not None
     assert re.search(r'logperror=no', obj.url()) is not None
 
     # Exception should be thrown about the fact no bot token was specified
     with pytest.raises(TypeError):
         NotifySyslog(facility='invalid')
```

### Comparing `apprise-1.7.6/test/test_plugin_techululs_push.py` & `apprise-1.8.0/test/test_plugin_techululs_push.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyTechulusPush import NotifyTechulusPush
+from apprise.plugins.techuluspush import NotifyTechulusPush
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # a test UUID we can use
```

### Comparing `apprise-1.7.6/test/test_plugin_telegram.py` & `apprise-1.8.0/test/test_plugin_telegram.py`

 * *Files 0% similar despite different names*

```diff
@@ -34,15 +34,15 @@
 from unittest import mock
 
 from apprise import Apprise
 from apprise import AppriseAttachment
 from apprise import AppriseAsset
 from apprise import NotifyType
 from apprise import NotifyFormat
-from apprise.plugins.NotifyTelegram import NotifyTelegram
+from apprise.plugins.telegram import NotifyTelegram
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
```

### Comparing `apprise-1.7.6/test/test_plugin_threema.py` & `apprise-1.8.0/test/test_plugin_threema.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,15 +27,15 @@
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyThreema import NotifyThreema
+from apprise.plugins.threema import NotifyThreema
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -149,17 +149,17 @@
     assert results['port'] is None
     assert results['host'] == ''
     assert results['fullpath'] == '/'
     assert results['path'] == '/'
     assert results['query'] is None
     assert results['schema'] == 'threema'
     assert results['url'] == 'threema:///'
-    assert isinstance(results['targets'], list) is True
+    assert isinstance(results['targets'], list)
     assert len(results['targets']) == 1
-    assert results['targets'][0] == '+1 (555) 123-9876'
+    assert results['targets'][0] == targets
 
     instance = NotifyThreema(**results)
     assert len(instance.targets) == 1
     assert instance.targets[0] == ('phone', '15551239876')
     assert isinstance(instance, NotifyThreema)
 
     response = instance.send(title='title', body='body 😊')
```

### Comparing `apprise-1.7.6/test/test_plugin_title_maxlen.py` & `apprise-1.8.0/test/test_plugin_title_maxlen.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 import os
 from json import loads
 from inspect import cleandoc
 
 import pytest
 import requests
 from apprise import Apprise
-from apprise.config.ConfigBase import ConfigBase
+from apprise.config import ConfigBase
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
 TEST_VAR_DIR = os.path.join(os.path.dirname(__file__), 'var')
```

### Comparing `apprise-1.7.6/test/test_plugin_twilio.py` & `apprise-1.8.0/test/test_plugin_twilio.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 import requests
 import pytest
 from json import dumps
 from apprise import Apprise
-from apprise.plugins.NotifyTwilio import NotifyTwilio
+from apprise.plugins.twilio import NotifyTwilio
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -154,26 +154,26 @@
     dest = '+1 (555) 987-6543'
     message_contents = "test"
 
     # Variation of initialization without API key
     obj = Apprise.instantiate(
         'twilio://{}:{}@{}/{}'
         .format(account_sid, auth_token, source, dest))
-    assert isinstance(obj, NotifyTwilio) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyTwilio)
+    assert isinstance(obj.url(), str)
 
     # Send Notification
     assert obj.send(body=message_contents) is True
 
     # Variation of initialization with API key
     obj = Apprise.instantiate(
         'twilio://{}:{}@{}/{}?apikey={}'
         .format(account_sid, auth_token, source, dest, apikey))
-    assert isinstance(obj, NotifyTwilio) is True
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj, NotifyTwilio)
+    assert isinstance(obj.url(), str)
 
     # Send Notification
     assert obj.send(body=message_contents) is True
 
     # Validate expected call parameters
     assert mock_post.call_count == 2
     first_call = mock_post.call_args_list[0]
```

### Comparing `apprise-1.7.6/test/test_plugin_twist.py` & `apprise-1.8.0/test/test_plugin_twist.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,18 +24,19 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from unittest import mock
 
+import pytest
 import requests
 from json import dumps
 from apprise import Apprise
-from apprise.plugins.NotifyTwist import NotifyTwist
+from apprise.plugins.twist import NotifyTwist
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
@@ -107,27 +108,19 @@
 
 
 def test_plugin_twist_init():
     """
     NotifyTwist() init()
 
     """
-    try:
+    with pytest.raises(TypeError):
         NotifyTwist(email='invalid', targets=None)
-        assert False
-    except TypeError:
-        # Invalid email address
-        assert True
 
-    try:
+    with pytest.raises(TypeError):
         NotifyTwist(email='user@domain', targets=None)
-        assert False
-    except TypeError:
-        # No password was specified
-        assert True
 
     # Simple object initialization
     result = NotifyTwist(
         password='abc123', email='user@domain.com', targets=None)
     assert result.user == 'user'
     assert result.host == 'domain.com'
     assert result.password == 'abc123'
```

### Comparing `apprise-1.7.6/test/test_plugin_twitter.py` & `apprise-1.8.0/test/test_plugin_twitter.py`

 * *Files 0% similar despite different names*

```diff
@@ -35,15 +35,15 @@
 
 import pytest
 import requests
 
 from apprise import Apprise
 from apprise import NotifyType
 from apprise import AppriseAttachment
-from apprise.plugins.NotifyTwitter import NotifyTwitter
+from apprise.plugins.twitter import NotifyTwitter
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 logging.disable(logging.CRITICAL)
 
 # Attachment Directory
 TEST_VAR_DIR = os.path.join(os.path.dirname(__file__), 'var')
```

### Comparing `apprise-1.7.6/test/test_plugin_voipms.py` & `apprise-1.8.0/test/test_plugin_voipms.py`

 * *Files 1% similar despite different names*

```diff
@@ -29,15 +29,15 @@
 from unittest import mock
 
 import pytest
 import requests
 from json import dumps
 from apprise import Apprise
 
-from apprise.plugins.NotifyVoipms import NotifyVoipms
+from apprise.plugins.voipms import NotifyVoipms
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_vonage.py` & `apprise-1.8.0/test/test_plugin_vonage.py`

 * *Files 0% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 import pytest
 import requests
 from json import dumps
 
-from apprise.plugins.NotifyVonage import NotifyVonage
+from apprise.plugins.vonage import NotifyVonage
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_webex_teams.py` & `apprise-1.8.0/test/test_plugin_webex_teams.py`

 * *Files 4% similar despite different names*

```diff
@@ -23,15 +23,15 @@
 # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
-from apprise.plugins.NotifyWebexTeams import NotifyWebexTeams
+from apprise.plugins.webexteams import NotifyWebexTeams
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_wecombot.py` & `apprise-1.8.0/test/test_plugin_wecombot.py`

 * *Files 3% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 
-from apprise.plugins.NotifyWeComBot import NotifyWeComBot
+from apprise.plugins.wecombot import NotifyWeComBot
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_whatsapp.py` & `apprise-1.8.0/test/test_plugin_whatsapp.py`

 * *Files 0% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 
 from unittest import mock
 
 import requests
 import pytest
 from json import dumps, loads
 from apprise import Apprise
-from apprise.plugins.NotifyWhatsApp import NotifyWhatsApp
+from apprise.plugins.whatsapp import NotifyWhatsApp
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_windows.py` & `apprise-1.8.0/test/test_plugin_windows.py`

 * *Files 6% similar despite different names*

```diff
@@ -105,15 +105,15 @@
     reload(apprise)
 
     # Create our instance
     obj = apprise.Apprise.instantiate('windows://', suppress_exceptions=False)
     obj.duration = 0
 
     # Test URL functionality
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # Check that it found our mocked environments
     assert obj.enabled is True
 
     # _on_destroy check
     obj._on_destroy(0, '', 0, 0)
 
@@ -121,30 +121,30 @@
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'windows://_/?image=True', suppress_exceptions=False)
     obj.duration = 0
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'windows://_/?image=False', suppress_exceptions=False)
     obj.duration = 0
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'windows://_/?duration=1', suppress_exceptions=False)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     # loads okay
     assert obj.duration == 1
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
@@ -207,15 +207,15 @@
     """
 
     # Create our instance
     obj = apprise.Apprise.instantiate('windows://', suppress_exceptions=False)
     obj.duration = 0
 
     # Test URL functionality
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
 
     # Check that it found our mocked environments
     assert obj.enabled is True
 
     # _on_destroy check
     obj._on_destroy(0, '', 0, 0)
 
@@ -223,30 +223,30 @@
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'windows://_/?image=True', suppress_exceptions=False)
     obj.duration = 0
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'windows://_/?image=False', suppress_exceptions=False)
     obj.duration = 0
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
 
     obj = apprise.Apprise.instantiate(
         'windows://_/?duration=1', suppress_exceptions=False)
-    assert isinstance(obj.url(), str) is True
+    assert isinstance(obj.url(), str)
     assert obj.notify(
         title='title', body='body',
         notify_type=apprise.NotifyType.INFO) is True
     # loads okay
     assert obj.duration == 1
 
     obj = apprise.Apprise.instantiate(
```

### Comparing `apprise-1.7.6/test/test_plugin_xbmc_kodi.py` & `apprise-1.8.0/test/test_plugin_xbmc_kodi.py`

 * *Files 0% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import requests
 from apprise import NotifyType
-from apprise.plugins.NotifyXBMC import NotifyXBMC
+from apprise.plugins.xbmc import NotifyXBMC
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_plugin_zulip.py` & `apprise-1.8.0/test/test_plugin_zulip.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 # CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 import pytest
 import requests
 
-from apprise.plugins.NotifyZulip import NotifyZulip
+from apprise.plugins.zulip import NotifyZulip
 from helpers import AppriseURLTester
 
 # Disable logging for a cleaner testing output
 import logging
 logging.disable(logging.CRITICAL)
 
 # Our Testing URLs
```

### Comparing `apprise-1.7.6/test/test_rest_plugins.py` & `apprise-1.8.0/test/test_rest_plugins.py`

 * *Files 0% similar despite different names*

```diff
@@ -97,8688 +97,8686 @@
 00000600: 2069 6d70 6f72 7420 6173 6369 695f 7570   import ascii_up
 00000610: 7065 7263 6173 6520 6173 2073 7472 5f61  percase as str_a
 00000620: 6c70 6861 0a66 726f 6d20 7374 7269 6e67  lpha.from string
 00000630: 2069 6d70 6f72 7420 6469 6769 7473 2061   import digits a
 00000640: 7320 7374 725f 6e75 6d0a 0a66 726f 6d20  s str_num..from 
 00000650: 6170 7072 6973 6520 696d 706f 7274 204e  apprise import N
 00000660: 6f74 6966 7942 6173 650a 6672 6f6d 2061  otifyBase.from a
-00000670: 7070 7269 7365 2e63 6f6d 6d6f 6e20 696d  pprise.common im
-00000680: 706f 7274 204e 6f74 6966 7946 6f72 6d61  port NotifyForma
-00000690: 740a 6672 6f6d 2061 7070 7269 7365 2e63  t.from apprise.c
-000006a0: 6f6d 6d6f 6e20 696d 706f 7274 204f 7665  ommon import Ove
-000006b0: 7266 6c6f 774d 6f64 650a 6672 6f6d 2061  rflowMode.from a
-000006c0: 7070 7269 7365 2e41 7070 7269 7365 4173  pprise.AppriseAs
-000006d0: 7365 7420 696d 706f 7274 2041 7070 7269  set import Appri
-000006e0: 7365 4173 7365 740a 6672 6f6d 2061 7070  seAsset.from app
-000006f0: 7269 7365 2e41 7070 7269 7365 2069 6d70  rise.Apprise imp
-00000700: 6f72 7420 4170 7072 6973 650a 0a23 2044  ort Apprise..# D
-00000710: 6973 6162 6c65 206c 6f67 6769 6e67 2066  isable logging f
-00000720: 6f72 2061 2063 6c65 616e 6572 2074 6573  or a cleaner tes
-00000730: 7469 6e67 206f 7574 7075 740a 696d 706f  ting output.impo
-00000740: 7274 206c 6f67 6769 6e67 0a6c 6f67 6769  rt logging.loggi
-00000750: 6e67 2e64 6973 6162 6c65 286c 6f67 6769  ng.disable(loggi
-00000760: 6e67 2e43 5249 5449 4341 4c29 0a0a 0a64  ng.CRITICAL)...d
-00000770: 6566 2074 6573 745f 6e6f 7469 6679 5f6f  ef test_notify_o
-00000780: 7665 7266 6c6f 775f 7472 756e 6361 7465  verflow_truncate
-00000790: 5f77 6974 685f 616d 616c 6761 6d61 7469  _with_amalgamati
-000007a0: 6f6e 2829 3a0a 2020 2020 2222 220a 2020  on():.    """.  
-000007b0: 2020 4150 493a 204f 7665 7266 6c6f 7720    API: Overflow 
-000007c0: 5769 7468 2041 6d61 6c67 616d 6174 696f  With Amalgamatio
-000007d0: 6e20 5472 756e 6361 7465 2046 756e 6374  n Truncate Funct
-000007e0: 696f 6e61 6c69 7479 2054 6573 7469 6e67  ionality Testing
-000007f0: 0a0a 2020 2020 2222 220a 2020 2020 230a  ..    """.    #.
-00000800: 2020 2020 2320 4120 6c69 7474 6c65 2070      # A little p
-00000810: 7265 7061 7261 7469 6f6e 0a20 2020 2023  reparation.    #
-00000820: 0a0a 2020 2020 2320 4e75 6d62 6572 206f  ..    # Number o
-00000830: 6620 6368 6172 6163 7465 7273 2070 6572  f characters per
-00000840: 206c 696e 650a 2020 2020 726f 7720 3d20   line.    row = 
-00000850: 3234 0a0a 2020 2020 2320 536f 6d65 2076  24..    # Some v
-00000860: 6172 6961 626c 6573 2077 6520 7573 6520  ariables we use 
-00000870: 746f 2063 6f6e 7472 6f6c 2074 6865 2064  to control the d
-00000880: 6174 6120 7765 2077 6f72 6b20 7769 7468  ata we work with
-00000890: 0a20 2020 2062 6f64 795f 6c65 6e20 3d20  .    body_len = 
-000008a0: 3130 3234 0a20 2020 2074 6974 6c65 5f6c  1024.    title_l
-000008b0: 656e 203d 2031 3032 340a 0a20 2020 2023  en = 1024..    #
-000008c0: 2043 7265 6174 6520 6120 6c61 7267 6520   Create a large 
-000008d0: 626f 6479 2061 6e64 2074 6974 6c65 2077  body and title w
-000008e0: 6974 6820 7261 6e64 6f6d 2064 6174 610a  ith random data.
-000008f0: 2020 2020 626f 6479 203d 2027 272e 6a6f      body = ''.jo
-00000900: 696e 2863 686f 6963 6528 7374 725f 616c  in(choice(str_al
-00000910: 7068 6120 2b20 7374 725f 6e75 6d20 2b20  pha + str_num + 
-00000920: 2720 2729 2066 6f72 205f 2069 6e20 7261  ' ') for _ in ra
-00000930: 6e67 6528 626f 6479 5f6c 656e 2929 0a20  nge(body_len)). 
-00000940: 2020 2062 6f64 7920 3d20 275c 725c 6e27     body = '\r\n'
-00000950: 2e6a 6f69 6e28 5b62 6f64 795b 693a 2069  .join([body[i: i
-00000960: 202b 2072 6f77 5d20 666f 7220 6920 696e   + row] for i in
-00000970: 2072 616e 6765 2830 2c20 6c65 6e28 626f   range(0, len(bo
-00000980: 6479 292c 2072 6f77 295d 290a 0a20 2020  dy), row)])..   
-00000990: 2023 2074 6865 206e 6577 206c 696e 6573   # the new lines
-000009a0: 2061 6464 2061 206c 6172 6765 2061 6d6f   add a large amo
-000009b0: 756e 7420 746f 206f 7572 2062 6f64 793b  unt to our body;
-000009c0: 206c 6574 7320 666f 7263 6520 7468 6520   lets force the 
-000009d0: 636f 6e74 656e 740a 2020 2020 2320 6261  content.    # ba
-000009e0: 636b 2074 6f20 6265 696e 6720 3130 3234  ck to being 1024
-000009f0: 2063 6861 7261 6374 6572 732e 0a20 2020   characters..   
-00000a00: 2062 6f64 7920 3d20 626f 6479 5b30 3a31   body = body[0:1
-00000a10: 3032 345d 0a0a 2020 2020 2320 4372 6561  024]..    # Crea
-00000a20: 7465 206f 7572 2074 6974 6c65 2075 7369  te our title usi
-00000a30: 6e67 2072 616e 646f 6d20 6461 7461 0a20  ng random data. 
-00000a40: 2020 2074 6974 6c65 203d 2027 272e 6a6f     title = ''.jo
-00000a50: 696e 2863 686f 6963 6528 7374 725f 616c  in(choice(str_al
-00000a60: 7068 6120 2b20 7374 725f 6e75 6d29 2066  pha + str_num) f
-00000a70: 6f72 205f 2069 6e20 7261 6e67 6528 7469  or _ in range(ti
-00000a80: 746c 655f 6c65 6e29 290a 0a20 2020 2023  tle_len))..    #
-00000a90: 0a20 2020 2023 2046 6972 7374 2054 6573  .    # First Tes
-00000aa0: 743a 2054 7275 6e63 6174 6564 2054 6974  t: Truncated Tit
-00000ab0: 6c65 0a20 2020 2023 0a20 2020 2063 6c61  le.    #.    cla
-00000ac0: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
-00000ad0: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
-00000ae0: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
-00000af0: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
-00000b00: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
-00000b10: 6d61 786c 656e 203d 2031 300a 0a20 2020  maxlen = 10..   
-00000b20: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
-00000b30: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
-00000b40: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
-00000b50: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
-00000b60: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
-00000b70: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-00000b80: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00000b90: 2020 2020 2020 2020 2020 2020 7375 7065              supe
-00000ba0: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
-00000bb0: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
-00000bc0: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
-00000bd0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00000be0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00000bf0: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
-00000c00: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
-00000c10: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00000c20: 7275 650a 0a20 2020 2023 2057 6520 7368  rue..    # We sh
-00000c30: 6f75 6c64 2074 6872 6f77 2061 6e20 6578  ould throw an ex
-00000c40: 6365 7074 696f 6e20 6265 6361 7573 6520  ception because 
-00000c50: 6f75 7220 7370 6563 6966 6965 6420 6f76  our specified ov
-00000c60: 6572 666c 6f77 2069 7320 7772 6f6e 672e  erflow is wrong.
-00000c70: 0a20 2020 2077 6974 6820 7079 7465 7374  .    with pytest
-00000c80: 2e72 6169 7365 7328 5479 7065 4572 726f  .raises(TypeErro
-00000c90: 7229 3a0a 2020 2020 2020 2020 2320 4c6f  r):.        # Lo
-00000ca0: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
-00000cb0: 2020 2020 2020 6f62 6a20 3d20 5465 7374        obj = Test
-00000cc0: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
-00000cd0: 7266 6c6f 773d 2769 6e76 616c 6964 2729  rflow='invalid')
-00000ce0: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
-00000cf0: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
-00000d00: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
-00000d10: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
-00000d20: 666c 6f77 4d6f 6465 2e54 5255 4e43 4154  flowMode.TRUNCAT
-00000d30: 4529 0a20 2020 2061 7373 6572 7420 6f62  E).    assert ob
-00000d40: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
-00000d50: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
-00000d60: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
-00000d70: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
-00000d80: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
-00000d90: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
-00000da0: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
-00000db0: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
-00000dc0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-00000dd0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00000de0: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
-00000df0: 6974 6c65 2c20 6f76 6572 666c 6f77 3d4e  itle, overflow=N
-00000e00: 6f6e 6529 0a20 2020 2063 6875 6e6b 7320  one).    chunks 
-00000e10: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00000e20: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-00000e30: 6974 6c65 3d22 222c 206f 7665 7266 6c6f  itle="", overflo
-00000e40: 773d 4e6f 6e65 290a 2020 2020 6368 756e  w=None).    chun
-00000e50: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00000e60: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-00000e70: 6479 2c20 7469 746c 653d 2222 2c20 6f76  dy, title="", ov
-00000e80: 6572 666c 6f77 3d4e 6f6e 6529 0a20 2020  erflow=None).   
-00000e90: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00000ea0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00000eb0: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-00000ec0: 6974 6c65 2c20 6f76 6572 666c 6f77 3d4e  itle, overflow=N
-00000ed0: 6f6e 6529 0a20 2020 2063 6875 6e6b 7320  one).    chunks 
-00000ee0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00000ef0: 7266 6c6f 7728 0a20 2020 2020 2020 2062  rflow(.        b
-00000f00: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
-00000f10: 7469 746c 652c 206f 7665 7266 6c6f 773d  title, overflow=
-00000f20: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
-00000f30: 4954 290a 2020 2020 6173 7365 7274 206c  IT).    assert l
-00000f40: 656e 2863 6875 6e6b 7329 203d 3d20 310a  en(chunks) == 1.
-00000f50: 2020 2020 6173 7365 7274 2062 6f64 792e      assert body.
-00000f60: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-00000f70: 5c78 3063 2729 2e72 7374 7269 7028 2920  \x0c').rstrip() 
-00000f80: 3d3d 2063 6875 6e6b 735b 305d 2e67 6574  == chunks[0].get
-00000f90: 2827 626f 6479 2729 0a20 2020 2061 7373  ('body').    ass
-00000fa0: 6572 7420 7469 746c 655b 303a 6f62 6a2e  ert title[0:obj.
-00000fb0: 7469 746c 655f 6d61 786c 656e 5d20 3d3d  title_maxlen] ==
-00000fc0: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
-00000fd0: 7469 746c 6527 290a 0a20 2020 2023 0a20  title')..    #. 
-00000fe0: 2020 2023 204e 6578 7420 5465 7374 3a20     # Next Test: 
-00000ff0: 4c69 6e65 2043 6f75 6e74 2043 6f6e 7472  Line Count Contr
-00001000: 6f6c 0a20 2020 2023 0a0a 2020 2020 636c  ol.    #..    cl
-00001010: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
-00001020: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
-00001030: 3a0a 0a20 2020 2020 2020 2023 2054 6573  :..        # Tes
-00001040: 7420 7469 746c 6520 6d61 7820 6c65 6e67  t title max leng
-00001050: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
-00001060: 5f6d 6178 6c65 6e20 3d20 350a 0a20 2020  _maxlen = 5..   
-00001070: 2020 2020 2023 204d 6178 696d 756d 206e       # Maximum n
-00001080: 756d 6265 7220 6f66 206c 696e 6573 0a20  umber of lines. 
-00001090: 2020 2020 2020 2062 6f64 795f 6d61 785f         body_max_
-000010a0: 6c69 6e65 5f63 6f75 6e74 203d 2035 0a0a  line_count = 5..
-000010b0: 2020 2020 2020 2020 2320 5769 7468 2061          # With a
-000010c0: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
-000010d0: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
-000010e0: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
-000010f0: 5472 7565 0a0a 2020 2020 2020 2020 6465  True..        de
-00001100: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00001110: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00001120: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00001130: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
-00001140: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
-00001150: 2020 2064 6566 206e 6f74 6966 7928 7365     def notify(se
-00001160: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-00001170: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
-00001180: 2020 2320 5072 6574 656e 6420 6576 6572    # Pretend ever
-00001190: 7974 6869 6e67 2069 7320 6f6b 6179 0a20  ything is okay. 
-000011a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000011b0: 6e20 5472 7565 0a0a 2020 2020 2320 4c6f  n True..    # Lo
-000011c0: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
-000011d0: 2020 6f62 6a20 3d20 5465 7374 4e6f 7469    obj = TestNoti
-000011e0: 6669 6361 7469 6f6e 286f 7665 7266 6c6f  fication(overflo
-000011f0: 773d 4f76 6572 666c 6f77 4d6f 6465 2e54  w=OverflowMode.T
-00001200: 5255 4e43 4154 4529 0a20 2020 2061 7373  RUNCATE).    ass
-00001210: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
-00001220: 6f6e 650a 0a20 2020 2023 2056 6572 6966  one..    # Verif
-00001230: 7920 7468 6174 2077 6520 6272 6561 6b20  y that we break 
-00001240: 7468 6520 7469 746c 6520 746f 2061 206d  the title to a m
-00001250: 6178 206c 656e 6774 6820 6f66 206f 7572  ax length of our
-00001260: 2074 6974 6c65 5f6d 6178 0a20 2020 2023   title_max.    #
-00001270: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
-00001280: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
-00001290: 6368 6564 0a20 2020 2063 6875 6e6b 7320  ched.    chunks 
-000012a0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-000012b0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-000012c0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-000012d0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-000012e0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-000012f0: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
-00001300: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00001310: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00001320: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-00001330: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-00001340: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-00001350: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
-00001360: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-00001370: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-00001380: 756e 6b73 2920 3d3d 2031 0a20 2020 2061  unks) == 1.    a
-00001390: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
-000013a0: 5b30 5d2e 6765 7428 2762 6f64 7927 292e  [0].get('body').
-000013b0: 7370 6c69 7428 275c 6e27 2929 203d 3d20  split('\n')) == 
-000013c0: 6f62 6a2e 626f 6479 5f6d 6178 5f6c 696e  obj.body_max_lin
-000013d0: 655f 636f 756e 740a 2020 2020 6173 7365  e_count.    asse
-000013e0: 7274 2074 6974 6c65 5b30 3a6f 626a 2e74  rt title[0:obj.t
-000013f0: 6974 6c65 5f6d 6178 6c65 6e5d 203d 3d20  itle_maxlen] == 
-00001400: 6368 756e 6b73 5b30 5d2e 6765 7428 2774  chunks[0].get('t
-00001410: 6974 6c65 2729 0a0a 2020 2020 230a 2020  itle')..    #.  
-00001420: 2020 2320 4e65 7874 2054 6573 743a 2054    # Next Test: T
-00001430: 7275 6e63 6174 6564 2062 6f64 790a 2020  runcated body.  
-00001440: 2020 230a 0a20 2020 2063 6c61 7373 2054    #..    class T
-00001450: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-00001460: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
-00001470: 2020 2020 2020 2320 5465 7374 2074 6974        # Test tit
-00001480: 6c65 206d 6178 206c 656e 6774 680a 2020  le max length.  
-00001490: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
-000014a0: 656e 203d 2074 6974 6c65 5f6c 656e 0a0a  en = title_len..
-000014b0: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
-000014c0: 6520 6120 626f 6479 206c 656e 6774 6820  e a body length 
-000014d0: 6f66 206a 7573 7420 3130 0a20 2020 2020  of just 10.     
-000014e0: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
-000014f0: 2031 300a 0a20 2020 2020 2020 2023 2057   10..        # W
-00001500: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-00001510: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-00001520: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-00001530: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-00001540: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00001550: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00001560: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00001570: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00001580: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-00001590: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-000015a0: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-000015b0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-000015c0: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-000015d0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-000015e0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-000015f0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00001600: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-00001610: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-00001620: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-00001630: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-00001640: 6f64 652e 5452 554e 4341 5445 290a 2020  ode.TRUNCATE).  
-00001650: 2020 6173 7365 7274 206f 626a 2069 7320    assert obj is 
-00001660: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 2320  not None..    # 
-00001670: 5665 7269 6679 2074 6861 7420 7765 2062  Verify that we b
-00001680: 7265 616b 2074 6865 2074 6974 6c65 2074  reak the title t
-00001690: 6f20 6120 6d61 7820 6c65 6e67 7468 206f  o a max length o
-000016a0: 6620 6f75 7220 7469 746c 655f 6d61 780a  f our title_max.
-000016b0: 2020 2020 2320 616e 6420 7468 6174 2074      # and that t
-000016c0: 6865 2062 6f64 7920 7265 6d61 696e 7320  he body remains 
-000016d0: 756e 746f 7563 6865 640a 2020 2020 6368  untouched.    ch
-000016e0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-000016f0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00001700: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
-00001710: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00001720: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00001730: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00001740: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-00001750: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00001760: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-00001770: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-00001780: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00001790: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-000017a0: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
-000017b0: 6c65 290a 2020 2020 6173 7365 7274 206c  le).    assert l
-000017c0: 656e 2863 6875 6e6b 7329 203d 3d20 310a  en(chunks) == 1.
-000017d0: 2020 2020 2320 426f 6479 2069 7320 6c6f      # Body is lo
-000017e0: 7374 2061 7320 7468 6520 7469 746c 6520  st as the title 
-000017f0: 7072 6576 6169 6c73 206f 7665 7220 6576  prevails over ev
-00001800: 6572 7974 6869 6e67 0a20 2020 2061 7373  erything.    ass
-00001810: 6572 7420 6368 756e 6b73 5b30 5d2e 6765  ert chunks[0].ge
-00001820: 7428 2762 6f64 7927 2920 3d3d 2027 270a  t('body') == ''.
-00001830: 2020 2020 2320 5469 746c 6520 6973 206e      # Title is n
-00001840: 6f74 206c 6f6e 6765 7220 7468 656e 2074  ot longer then t
-00001850: 6865 206d 6178 696d 756d 2073 697a 6520  he maximum size 
-00001860: 7468 6520 626f 6479 2063 616e 2062 6520  the body can be 
-00001870: 6475 6520 746f 0a20 2020 2023 2061 6d61  due to.    # ama
-00001880: 6c67 616d 6174 696f 6e66 6c61 673a 0a20  lgamationflag:. 
-00001890: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-000018a0: 3a6f 626a 2e62 6f64 795f 6d61 786c 656e  :obj.body_maxlen
-000018b0: 5d20 3d3d 2063 6875 6e6b 735b 305d 2e67  ] == chunks[0].g
-000018c0: 6574 2827 7469 746c 6527 290a 0a20 2020  et('title')..   
-000018d0: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
-000018e0: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
-000018f0: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
-00001900: 5465 7374 2074 6974 6c65 206d 6178 206c  Test title max l
-00001910: 656e 6774 680a 2020 2020 2020 2020 7469  ength.        ti
-00001920: 746c 655f 6d61 786c 656e 203d 2074 6974  tle_maxlen = tit
-00001930: 6c65 5f6c 656e 0a0a 2020 2020 2020 2020  le_len..        
-00001940: 2320 456e 666f 7263 6520 6120 626f 6479  # Enforce a body
-00001950: 206c 656e 6774 6820 6f66 206a 7573 7420   length of just 
-00001960: 3130 0a20 2020 2020 2020 2062 6f64 795f  10.        body_
-00001970: 6d61 786c 656e 203d 2031 300a 0a20 2020  maxlen = 10..   
-00001980: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
-00001990: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
-000019a0: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
-000019b0: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
-000019c0: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
-000019d0: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-000019e0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-000019f0: 2020 2020 2020 2020 2020 2020 7375 7065              supe
-00001a00: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
-00001a10: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
-00001a20: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
-00001a30: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00001a40: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00001a50: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
-00001a60: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
-00001a70: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00001a80: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
-00001a90: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
-00001aa0: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
-00001ab0: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
-00001ac0: 7665 7266 6c6f 774d 6f64 652e 5452 554e  verflowMode.TRUN
-00001ad0: 4341 5445 290a 2020 2020 6173 7365 7274  CATE).    assert
-00001ae0: 206f 626a 2069 7320 6e6f 7420 4e6f 6e65   obj is not None
-00001af0: 0a0a 2020 2020 2320 5665 7269 6679 2074  ..    # Verify t
-00001b00: 6861 7420 7765 2062 7265 616b 2074 6865  hat we break the
-00001b10: 2074 6974 6c65 2074 6f20 6120 6d61 7820   title to a max 
-00001b20: 6c65 6e67 7468 206f 6620 6f75 7220 7469  length of our ti
-00001b30: 746c 655f 6d61 780a 2020 2020 2320 616e  tle_max.    # an
-00001b40: 6420 7468 6174 2074 6865 2062 6f64 7920  d that the body 
-00001b50: 7265 6d61 696e 7320 756e 746f 7563 6865  remains untouche
-00001b60: 640a 2020 2020 6368 756e 6b73 203d 206f  d.    chunks = o
-00001b70: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00001b80: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-00001b90: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
-00001ba0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-00001bb0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-00001bc0: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
-00001bd0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00001be0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00001bf0: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
-00001c00: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-00001c10: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00001c20: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-00001c30: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-00001c40: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-00001c50: 7329 203d 3d20 310a 0a20 2020 2061 7373  s) == 1..    ass
-00001c60: 6572 7420 6368 756e 6b73 5b30 5d2e 6765  ert chunks[0].ge
-00001c70: 7428 2762 6f64 7927 2920 3d3d 2027 270a  t('body') == ''.
-00001c80: 2020 2020 2320 626f 6479 5f6d 6178 6c65      # body_maxle
-00001c90: 6e20 7072 6576 6169 6c73 2064 7565 2074  n prevails due t
-00001ca0: 6f20 6974 2062 6569 6e67 2073 6d61 6c6c  o it being small
-00001cb0: 6572 2061 6e64 2061 6d61 6c67 616d 6174  er and amalgamat
-00001cc0: 696f 6e20 666c 6167 2073 6574 0a20 2020  ion flag set.   
-00001cd0: 2061 7373 6572 7420 7469 746c 655b 303a   assert title[0:
-00001ce0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e5d  obj.body_maxlen]
-00001cf0: 203d 3d20 6368 756e 6b73 5b30 5d2e 6765   == chunks[0].ge
-00001d00: 7428 2774 6974 6c65 2729 0a0a 2020 2020  t('title')..    
-00001d10: 230a 2020 2020 2320 4e65 7874 2054 6573  #.    # Next Tes
-00001d20: 743a 2041 7070 656e 6420 7469 746c 6520  t: Append title 
-00001d30: 746f 2062 6f64 7920 2b20 5472 756e 6361  to body + Trunca
-00001d40: 7465 6420 626f 6479 0a20 2020 2023 0a0a  ted body.    #..
-00001d50: 2020 2020 636c 6173 7320 5465 7374 4e6f      class TestNo
-00001d60: 7469 6669 6361 7469 6f6e 284e 6f74 6966  tification(Notif
-00001d70: 7942 6173 6529 3a0a 0a20 2020 2020 2020  yBase):..       
-00001d80: 2023 2045 6e66 6f72 6365 206e 6f20 7469   # Enforce no ti
-00001d90: 746c 650a 2020 2020 2020 2020 7469 746c  tle.        titl
-00001da0: 655f 6d61 786c 656e 203d 2030 0a0a 2020  e_maxlen = 0..  
-00001db0: 2020 2020 2020 2320 456e 666f 7263 6520        # Enforce 
-00001dc0: 6120 626f 6479 206c 656e 6774 6820 6f66  a body length of
-00001dd0: 206a 7573 7420 3130 300a 2020 2020 2020   just 100.      
-00001de0: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
-00001df0: 3130 300a 0a20 2020 2020 2020 2023 2057  100..        # W
-00001e00: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-00001e10: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-00001e20: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-00001e30: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-00001e40: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00001e50: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00001e60: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00001e70: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00001e80: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-00001e90: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-00001ea0: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-00001eb0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00001ec0: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-00001ed0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-00001ee0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-00001ef0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00001f00: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-00001f10: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-00001f20: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-00001f30: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-00001f40: 6f64 652e 5452 554e 4341 5445 290a 2020  ode.TRUNCATE).  
-00001f50: 2020 6173 7365 7274 206f 626a 2069 7320    assert obj is 
-00001f60: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 2320  not None..    # 
-00001f70: 5665 7269 6679 2074 6861 7420 7765 2062  Verify that we b
-00001f80: 7265 616b 2074 6865 2074 6974 6c65 2074  reak the title t
-00001f90: 6f20 6120 6d61 7820 6c65 6e67 7468 206f  o a max length o
-00001fa0: 6620 6f75 7220 7469 746c 655f 6d61 780a  f our title_max.
-00001fb0: 2020 2020 2320 616e 6420 7468 6174 2074      # and that t
-00001fc0: 6865 2062 6f64 7920 7265 6d61 696e 7320  he body remains 
-00001fd0: 756e 746f 7563 6865 640a 0a20 2020 206f  untouched..    o
-00001fe0: 626a 2e6e 6f74 6966 795f 666f 726d 6174  bj.notify_format
-00001ff0: 203d 204e 6f74 6966 7946 6f72 6d61 742e   = NotifyFormat.
-00002000: 4854 4d4c 0a20 2020 2063 6875 6e6b 7320  HTML.    chunks 
-00002010: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00002020: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-00002030: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-00002040: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00002050: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00002060: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
-00002070: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00002080: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00002090: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-000020a0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-000020b0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-000020c0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
-000020d0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-000020e0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-000020f0: 756e 6b73 2920 3d3d 2031 0a0a 2020 2020  unks) == 1..    
-00002100: 6f62 6a2e 6e6f 7469 6679 5f66 6f72 6d61  obj.notify_forma
-00002110: 7420 3d20 4e6f 7469 6679 466f 726d 6174  t = NotifyFormat
-00002120: 2e4d 4152 4b44 4f57 4e0a 2020 2020 6368  .MARKDOWN.    ch
-00002130: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00002140: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00002150: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
-00002160: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00002170: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00002180: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00002190: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-000021a0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-000021b0: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-000021c0: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-000021d0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-000021e0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-000021f0: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
-00002200: 6c65 290a 2020 2020 6173 7365 7274 206c  le).    assert l
-00002210: 656e 2863 6875 6e6b 7329 203d 3d20 310a  en(chunks) == 1.
-00002220: 0a20 2020 206f 626a 2e6e 6f74 6966 795f  .    obj.notify_
-00002230: 666f 726d 6174 203d 204e 6f74 6966 7946  format = NotifyF
-00002240: 6f72 6d61 742e 5445 5854 0a20 2020 2063  ormat.TEXT.    c
-00002250: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00002260: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00002270: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
-00002280: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00002290: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-000022a0: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-000022b0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-000022c0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-000022d0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
-000022e0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-000022f0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00002300: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00002310: 793d 626f 6479 2c20 7469 746c 653d 7469  y=body, title=ti
-00002320: 746c 6529 0a20 2020 2061 7373 6572 7420  tle).    assert 
-00002330: 6c65 6e28 6368 756e 6b73 2920 3d3d 2031  len(chunks) == 1
-00002340: 0a0a 2020 2020 2320 5468 6520 6265 6c6f  ..    # The belo
-00002350: 7720 6c69 6e65 2073 686f 756c 6420 6265  w line should be
-00002360: 2072 6561 6420 6361 7265 6675 6c6c 792e   read carefully.
-00002370: 2e2e 2057 6527 7265 2061 6374 7561 6c6c  .. We're actuall
-00002380: 7920 7465 7374 696e 6720 746f 2073 6565  y testing to see
-00002390: 0a20 2020 2023 2074 6861 7420 6f75 7220  .    # that our 
-000023a0: 7469 746c 6520 6973 206d 6174 6368 6564  title is matched
-000023b0: 2061 6761 696e 7374 206f 7572 2062 6f64   against our bod
-000023c0: 792e 2042 6568 696e 6420 7468 6520 7363  y. Behind the sc
-000023d0: 656e 6573 2c20 7468 6520 7469 746c 650a  enes, the title.
-000023e0: 2020 2020 2320 7761 7320 6170 7065 6e64      # was append
-000023f0: 6564 2074 6f20 7468 6520 626f 6479 2e20  ed to the body. 
-00002400: 5468 6520 626f 6479 2077 6173 2074 6865  The body was the
-00002410: 6e20 7472 756e 6361 7465 6420 746f 2074  n truncated to t
-00002420: 6865 206d 6178 6c65 6e2e 0a20 2020 2023  he maxlen..    #
-00002430: 2054 6865 2074 6869 6e67 2069 732c 2073   The thing is, s
-00002440: 696e 6365 2074 6865 2074 6974 6c65 2069  ince the title i
-00002450: 7320 736f 206c 6172 6765 2c20 616c 6c20  s so large, all 
-00002460: 6f66 2074 6865 2062 6f64 7920 7761 7320  of the body was 
-00002470: 6c6f 7374 0a20 2020 2023 2061 6e64 2061  lost.    # and a
-00002480: 2067 6f6f 6420 6368 756e 6b20 6f66 2074   good chunk of t
-00002490: 6865 2074 6974 6c65 2077 6173 2074 6f6f  he title was too
-000024a0: 2e20 2054 6865 206d 6573 7361 6765 2073  .  The message s
-000024b0: 656e 7420 7769 6c6c 206a 7573 7420 6265  ent will just be
-000024c0: 2061 0a20 2020 2023 2073 6d61 6c6c 2070   a.    # small p
-000024d0: 6f72 7469 6f6e 206f 6620 7468 6520 7469  ortion of the ti
-000024e0: 746c 650a 2020 2020 6173 7365 7274 206c  tle.    assert l
-000024f0: 656e 2863 6875 6e6b 735b 305d 2e67 6574  en(chunks[0].get
-00002500: 2827 626f 6479 2729 2920 3d3d 206f 626a  ('body')) == obj
-00002510: 2e62 6f64 795f 6d61 786c 656e 0a20 2020  .body_maxlen.   
-00002520: 2061 7373 6572 7420 7469 746c 655b 303a   assert title[0:
-00002530: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e5d  obj.body_maxlen]
-00002540: 203d 3d20 6368 756e 6b73 5b30 5d2e 6765   == chunks[0].ge
-00002550: 7428 2762 6f64 7927 290a 0a0a 6465 6620  t('body')...def 
-00002560: 7465 7374 5f6e 6f74 6966 795f 6f76 6572  test_notify_over
-00002570: 666c 6f77 5f74 7275 6e63 6174 655f 6e6f  flow_truncate_no
-00002580: 5f61 6d61 6c67 616d 6174 696f 6e28 293a  _amalgamation():
-00002590: 0a20 2020 2022 2222 0a20 2020 2041 5049  .    """.    API
-000025a0: 3a20 4f76 6572 666c 6f77 204e 6f20 416d  : Overflow No Am
-000025b0: 616c 6761 6d61 7469 6f6e 2054 7275 6e63  algamation Trunc
-000025c0: 6174 6520 4675 6e63 7469 6f6e 616c 6974  ate Functionalit
-000025d0: 7920 5465 7374 696e 670a 0a20 2020 2022  y Testing..    "
-000025e0: 2222 0a20 2020 2023 0a20 2020 2023 2041  "".    #.    # A
-000025f0: 206c 6974 746c 6520 7072 6570 6172 6174   little preparat
-00002600: 696f 6e0a 2020 2020 230a 0a20 2020 2023  ion.    #..    #
-00002610: 204e 756d 6265 7220 6f66 2063 6861 7261   Number of chara
-00002620: 6374 6572 7320 7065 7220 6c69 6e65 0a20  cters per line. 
-00002630: 2020 2072 6f77 203d 2032 340a 0a20 2020     row = 24..   
-00002640: 2023 2053 6f6d 6520 7661 7269 6162 6c65   # Some variable
-00002650: 7320 7765 2075 7365 2074 6f20 636f 6e74  s we use to cont
-00002660: 726f 6c20 7468 6520 6461 7461 2077 6520  rol the data we 
-00002670: 776f 726b 2077 6974 680a 2020 2020 626f  work with.    bo
-00002680: 6479 5f6c 656e 203d 2031 3032 340a 2020  dy_len = 1024.  
-00002690: 2020 7469 746c 655f 6c65 6e20 3d20 3130    title_len = 10
-000026a0: 3234 0a0a 2020 2020 2320 4372 6561 7465  24..    # Create
-000026b0: 2061 206c 6172 6765 2062 6f64 7920 616e   a large body an
-000026c0: 6420 7469 746c 6520 7769 7468 2072 616e  d title with ran
-000026d0: 646f 6d20 6461 7461 0a20 2020 2062 6f64  dom data.    bod
-000026e0: 7920 3d20 2727 2e6a 6f69 6e28 6368 6f69  y = ''.join(choi
-000026f0: 6365 2873 7472 5f61 6c70 6861 202b 2073  ce(str_alpha + s
-00002700: 7472 5f6e 756d 202b 2027 2027 2920 666f  tr_num + ' ') fo
-00002710: 7220 5f20 696e 2072 616e 6765 2862 6f64  r _ in range(bod
-00002720: 795f 6c65 6e29 290a 2020 2020 626f 6479  y_len)).    body
-00002730: 203d 2027 5c72 5c6e 272e 6a6f 696e 285b   = '\r\n'.join([
-00002740: 626f 6479 5b69 3a20 6920 2b20 726f 775d  body[i: i + row]
-00002750: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00002760: 302c 206c 656e 2862 6f64 7929 2c20 726f  0, len(body), ro
-00002770: 7729 5d29 0a0a 2020 2020 2320 7468 6520  w)])..    # the 
-00002780: 6e65 7720 6c69 6e65 7320 6164 6420 6120  new lines add a 
-00002790: 6c61 7267 6520 616d 6f75 6e74 2074 6f20  large amount to 
-000027a0: 6f75 7220 626f 6479 3b20 6c65 7473 2066  our body; lets f
-000027b0: 6f72 6365 2074 6865 2063 6f6e 7465 6e74  orce the content
-000027c0: 0a20 2020 2023 2062 6163 6b20 746f 2062  .    # back to b
-000027d0: 6569 6e67 2031 3032 3420 6368 6172 6163  eing 1024 charac
-000027e0: 7465 7273 2e0a 2020 2020 626f 6479 203d  ters..    body =
-000027f0: 2062 6f64 795b 303a 3130 3234 5d0a 0a20   body[0:1024].. 
-00002800: 2020 2023 2043 7265 6174 6520 6f75 7220     # Create our 
-00002810: 7469 746c 6520 7573 696e 6720 7261 6e64  title using rand
-00002820: 6f6d 2064 6174 610a 2020 2020 7469 746c  om data.    titl
-00002830: 6520 3d20 2727 2e6a 6f69 6e28 6368 6f69  e = ''.join(choi
-00002840: 6365 2873 7472 5f61 6c70 6861 202b 2073  ce(str_alpha + s
-00002850: 7472 5f6e 756d 2920 666f 7220 5f20 696e  tr_num) for _ in
-00002860: 2072 616e 6765 2874 6974 6c65 5f6c 656e   range(title_len
-00002870: 2929 0a0a 2020 2020 230a 2020 2020 2320  ))..    #.    # 
-00002880: 4669 7273 7420 5465 7374 3a20 5472 756e  First Test: Trun
-00002890: 6361 7465 6420 5469 746c 650a 2020 2020  cated Title.    
-000028a0: 230a 2020 2020 636c 6173 7320 5465 7374  #.    class Test
-000028b0: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
-000028c0: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
-000028d0: 2020 2023 2054 6573 7420 7469 746c 6520     # Test title 
-000028e0: 6d61 7820 6c65 6e67 7468 0a20 2020 2020  max length.     
-000028f0: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
-00002900: 3d20 3130 0a0a 2020 2020 2020 2020 2320  = 10..        # 
-00002910: 4e6f 2061 6d61 6c67 616d 6174 696f 6e0a  No amalgamation.
-00002920: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-00002930: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
-00002940: 6520 3d20 4661 6c73 650a 0a20 2020 2020  e = False..     
-00002950: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00002960: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00002970: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00002980: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00002990: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-000029a0: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-000029b0: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-000029c0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-000029d0: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-000029e0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-000029f0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-00002a00: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00002a10: 2023 2057 6520 7368 6f75 6c64 2074 6872   # We should thr
-00002a20: 6f77 2061 6e20 6578 6365 7074 696f 6e20  ow an exception 
-00002a30: 6265 6361 7573 6520 6f75 7220 7370 6563  because our spec
-00002a40: 6966 6965 6420 6f76 6572 666c 6f77 2069  ified overflow i
-00002a50: 7320 7772 6f6e 672e 0a20 2020 2077 6974  s wrong..    wit
-00002a60: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-00002a70: 5479 7065 4572 726f 7229 3a0a 2020 2020  TypeError):.    
-00002a80: 2020 2020 2320 4c6f 6164 206f 7572 206f      # Load our o
-00002a90: 626a 6563 740a 2020 2020 2020 2020 6f62  bject.        ob
-00002aa0: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
-00002ab0: 7469 6f6e 286f 7665 7266 6c6f 773d 2769  tion(overflow='i
-00002ac0: 6e76 616c 6964 2729 0a0a 2020 2020 2320  nvalid')..    # 
-00002ad0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
-00002ae0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
-00002af0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
-00002b00: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
-00002b10: 2e54 5255 4e43 4154 4529 0a20 2020 2061  .TRUNCATE).    a
-00002b20: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-00002b30: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-00002b40: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-00002b50: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-00002b60: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-00002b70: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-00002b80: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-00002b90: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-00002ba0: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-00002bb0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00002bc0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00002bd0: 2074 6974 6c65 3d74 6974 6c65 2c20 6f76   title=title, ov
-00002be0: 6572 666c 6f77 3d4e 6f6e 6529 0a20 2020  erflow=None).   
-00002bf0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00002c00: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00002c10: 6479 3d22 222c 2074 6974 6c65 3d22 222c  dy="", title="",
-00002c20: 206f 7665 7266 6c6f 773d 4e6f 6e65 290a   overflow=None).
-00002c30: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00002c40: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00002c50: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-00002c60: 653d 2222 2c20 6f76 6572 666c 6f77 3d4e  e="", overflow=N
-00002c70: 6f6e 6529 0a20 2020 2063 6875 6e6b 7320  one).    chunks 
-00002c80: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00002c90: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-00002ca0: 2074 6974 6c65 3d74 6974 6c65 2c20 6f76   title=title, ov
-00002cb0: 6572 666c 6f77 3d4e 6f6e 6529 0a20 2020  erflow=None).   
-00002cc0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00002cd0: 7070 6c79 5f6f 7665 7266 6c6f 7728 0a20  pply_overflow(. 
-00002ce0: 2020 2020 2020 2062 6f64 793d 626f 6479         body=body
-00002cf0: 2c20 7469 746c 653d 7469 746c 652c 206f  , title=title, o
-00002d00: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
-00002d10: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
-00002d20: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-00002d30: 7329 203d 3d20 310a 2020 2020 6173 7365  s) == 1.    asse
-00002d40: 7274 2062 6f64 792e 6c73 7472 6970 2827  rt body.lstrip('
-00002d50: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
-00002d60: 7374 7269 7028 2920 3d3d 2063 6875 6e6b  strip() == chunk
-00002d70: 735b 305d 2e67 6574 2827 626f 6479 2729  s[0].get('body')
-00002d80: 0a20 2020 2061 7373 6572 7420 7469 746c  .    assert titl
-00002d90: 655b 303a 6f62 6a2e 7469 746c 655f 6d61  e[0:obj.title_ma
-00002da0: 786c 656e 5d20 3d3d 2063 6875 6e6b 735b  xlen] == chunks[
-00002db0: 305d 2e67 6574 2827 7469 746c 6527 290a  0].get('title').
-00002dc0: 0a20 2020 2023 0a20 2020 2023 204e 6578  .    #.    # Nex
-00002dd0: 7420 5465 7374 3a20 4c69 6e65 2043 6f75  t Test: Line Cou
-00002de0: 6e74 2043 6f6e 7472 6f6c 0a20 2020 2023  nt Control.    #
-00002df0: 0a0a 2020 2020 636c 6173 7320 5465 7374  ..    class Test
-00002e00: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
-00002e10: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
-00002e20: 2020 2023 2054 6573 7420 7469 746c 6520     # Test title 
-00002e30: 6d61 7820 6c65 6e67 7468 0a20 2020 2020  max length.     
-00002e40: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
-00002e50: 3d20 350a 0a20 2020 2020 2020 2023 204d  = 5..        # M
-00002e60: 6178 696d 756d 206e 756d 6265 7220 6f66  aximum number of
-00002e70: 206c 696e 6573 0a20 2020 2020 2020 2062   lines.        b
-00002e80: 6f64 795f 6d61 785f 6c69 6e65 5f63 6f75  ody_max_line_cou
-00002e90: 6e74 203d 2035 0a0a 2020 2020 2020 2020  nt = 5..        
-00002ea0: 2320 4e6f 2061 6d61 6c67 616d 6174 696f  # No amalgamatio
-00002eb0: 6e0a 2020 2020 2020 2020 6f76 6572 666c  n.        overfl
-00002ec0: 6f77 5f61 6d61 6c67 616d 6174 655f 7469  ow_amalgamate_ti
-00002ed0: 746c 6520 3d20 4661 6c73 650a 0a20 2020  tle = False..   
-00002ee0: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
-00002ef0: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
-00002f00: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00002f10: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-00002f20: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
-00002f30: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
-00002f40: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
-00002f50: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00002f60: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
-00002f70: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
-00002f80: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
-00002f90: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00002fa0: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
-00002fb0: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
-00002fc0: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-00002fd0: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
-00002fe0: 774d 6f64 652e 5452 554e 4341 5445 290a  wMode.TRUNCATE).
-00002ff0: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
-00003000: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
-00003010: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
-00003020: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
-00003030: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
-00003040: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
-00003050: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
-00003060: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-00003070: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-00003080: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00003090: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-000030a0: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-000030b0: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-000030c0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-000030d0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-000030e0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-000030f0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00003100: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-00003110: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-00003120: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00003130: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00003140: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-00003150: 6974 6c65 290a 2020 2020 6173 7365 7274  itle).    assert
-00003160: 206c 656e 2863 6875 6e6b 7329 203d 3d20   len(chunks) == 
-00003170: 310a 2020 2020 6173 7365 7274 206c 656e  1.    assert len
-00003180: 2863 6875 6e6b 735b 305d 2e67 6574 2827  (chunks[0].get('
-00003190: 626f 6479 2729 2e73 706c 6974 2827 5c6e  body').split('\n
-000031a0: 2729 2920 3d3d 206f 626a 2e62 6f64 795f  ')) == obj.body_
-000031b0: 6d61 785f 6c69 6e65 5f63 6f75 6e74 0a20  max_line_count. 
-000031c0: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-000031d0: 303a 6f62 6a2e 7469 746c 655f 6d61 786c  0:obj.title_maxl
-000031e0: 656e 5d20 3d3d 2063 6875 6e6b 735b 305d  en] == chunks[0]
-000031f0: 2e67 6574 2827 7469 746c 6527 290a 0a20  .get('title').. 
-00003200: 2020 2023 0a20 2020 2023 204e 6578 7420     #.    # Next 
-00003210: 5465 7374 3a20 5472 756e 6361 7465 6420  Test: Truncated 
-00003220: 626f 6479 0a20 2020 2023 0a0a 2020 2020  body.    #..    
-00003230: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
-00003240: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-00003250: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
-00003260: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
-00003270: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
-00003280: 6c65 5f6d 6178 6c65 6e20 3d20 7469 746c  le_maxlen = titl
-00003290: 655f 6c65 6e0a 0a20 2020 2020 2020 2023  e_len..        #
-000032a0: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
-000032b0: 6c65 6e67 7468 206f 6620 6a75 7374 2031  length of just 1
-000032c0: 300a 2020 2020 2020 2020 626f 6479 5f6d  0.        body_m
-000032d0: 6178 6c65 6e20 3d20 3130 0a0a 2020 2020  axlen = 10..    
-000032e0: 2020 2020 2320 4e6f 2061 6d61 6c67 616d      # No amalgam
-000032f0: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
-00003300: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
-00003310: 655f 7469 746c 6520 3d20 4661 6c73 650a  e_title = False.
-00003320: 0a20 2020 2020 2020 2064 6566 205f 5f69  .        def __i
-00003330: 6e69 745f 5f28 7365 6c66 2c20 2a61 7267  nit__(self, *arg
-00003340: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-00003350: 2020 2020 2020 2020 2020 7375 7065 7228            super(
-00003360: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7761  ).__init__(**kwa
-00003370: 7267 7329 0a0a 2020 2020 2020 2020 6465  rgs)..        de
-00003380: 6620 6e6f 7469 6679 2873 656c 662c 202a  f notify(self, *
-00003390: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-000033a0: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
-000033b0: 7265 7465 6e64 2065 7665 7279 7468 696e  retend everythin
-000033c0: 6720 6973 206f 6b61 790a 2020 2020 2020  g is okay.      
-000033d0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-000033e0: 650a 0a20 2020 2023 204c 6f61 6420 6f75  e..    # Load ou
-000033f0: 7220 6f62 6a65 6374 0a20 2020 206f 626a  r object.    obj
-00003400: 203d 2054 6573 744e 6f74 6966 6963 6174   = TestNotificat
-00003410: 696f 6e28 6f76 6572 666c 6f77 3d4f 7665  ion(overflow=Ove
-00003420: 7266 6c6f 774d 6f64 652e 5452 554e 4341  rflowMode.TRUNCA
-00003430: 5445 290a 2020 2020 6173 7365 7274 206f  TE).    assert o
-00003440: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
-00003450: 2020 2020 2320 5665 7269 6679 2074 6861      # Verify tha
-00003460: 7420 7765 2062 7265 616b 2074 6865 2074  t we break the t
-00003470: 6974 6c65 2074 6f20 6120 6d61 7820 6c65  itle to a max le
-00003480: 6e67 7468 206f 6620 6f75 7220 7469 746c  ngth of our titl
-00003490: 655f 6d61 780a 2020 2020 2320 616e 6420  e_max.    # and 
-000034a0: 7468 6174 2074 6865 2062 6f64 7920 7265  that the body re
-000034b0: 6d61 696e 7320 756e 746f 7563 6865 640a  mains untouched.
-000034c0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-000034d0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-000034e0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-000034f0: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
-00003500: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00003510: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00003520: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-00003530: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00003540: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00003550: 3d62 6f64 792c 2074 6974 6c65 3d22 2229  =body, title="")
-00003560: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00003570: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00003580: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
-00003590: 6c65 3d74 6974 6c65 290a 2020 2020 6173  le=title).    as
-000035a0: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
-000035b0: 203d 3d20 310a 2020 2020 6173 7365 7274   == 1.    assert
-000035c0: 2062 6f64 795b 303a 6f62 6a2e 626f 6479   body[0:obj.body
-000035d0: 5f6d 6178 6c65 6e5d 5c0a 2020 2020 2020  _maxlen]\.      
-000035e0: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
-000035f0: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
-00003600: 2829 203d 3d20 6368 756e 6b73 5b30 5d2e  () == chunks[0].
-00003610: 6765 7428 2762 6f64 7927 290a 2020 2020  get('body').    
-00003620: 6173 7365 7274 2074 6974 6c65 203d 3d20  assert title == 
-00003630: 6368 756e 6b73 5b30 5d2e 6765 7428 2774  chunks[0].get('t
-00003640: 6974 6c65 2729 0a0a 2020 2020 636c 6173  itle')..    clas
-00003650: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
-00003660: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
-00003670: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
-00003680: 7469 746c 6520 6d61 7820 6c65 6e67 7468  title max length
-00003690: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
-000036a0: 6178 6c65 6e20 3d20 7469 746c 655f 6c65  axlen = title_le
-000036b0: 6e0a 0a20 2020 2020 2020 2023 2045 6e66  n..        # Enf
-000036c0: 6f72 6365 2061 2062 6f64 7920 6c65 6e67  orce a body leng
-000036d0: 7468 206f 6620 6a75 7374 2031 300a 2020  th of just 10.  
-000036e0: 2020 2020 2020 626f 6479 5f6d 6178 6c65        body_maxle
-000036f0: 6e20 3d20 3130 0a0a 2020 2020 2020 2020  n = 10..        
-00003700: 2320 4e6f 2061 6d61 6c67 616d 6174 696f  # No amalgamatio
-00003710: 6e0a 2020 2020 2020 2020 6f76 6572 666c  n.        overfl
-00003720: 6f77 5f61 6d61 6c67 616d 6174 655f 7469  ow_amalgamate_ti
-00003730: 746c 6520 3d20 4661 6c73 650a 0a20 2020  tle = False..   
-00003740: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
-00003750: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
-00003760: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00003770: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-00003780: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
-00003790: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
-000037a0: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
-000037b0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-000037c0: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
-000037d0: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
-000037e0: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
-000037f0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00003800: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
-00003810: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
-00003820: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-00003830: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
-00003840: 774d 6f64 652e 5452 554e 4341 5445 290a  wMode.TRUNCATE).
-00003850: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
-00003860: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
-00003870: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
-00003880: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
-00003890: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
-000038a0: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
-000038b0: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
-000038c0: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-000038d0: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-000038e0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-000038f0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00003900: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-00003910: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-00003920: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00003930: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00003940: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-00003950: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00003960: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-00003970: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-00003980: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00003990: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-000039a0: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-000039b0: 6974 6c65 290a 2020 2020 6173 7365 7274  itle).    assert
-000039c0: 206c 656e 2863 6875 6e6b 7329 203d 3d20   len(chunks) == 
-000039d0: 310a 2020 2020 2320 4e6f 2061 6d61 6c67  1.    # No amalg
-000039e0: 616d 6174 696f 6e20 7365 7420 736f 206f  amation set so o
-000039f0: 7572 2062 6f64 7920 616c 6967 6e73 2069  ur body aligns i
-00003a00: 6e20 7369 7a65 2028 6e6f 202d 3220 6c69  n size (no -2 li
-00003a10: 6b65 2070 7265 7669 6f75 730a 2020 2020  ke previous.    
-00003a20: 2320 7465 7374 290a 2020 2020 6173 7365  # test).    asse
-00003a30: 7274 2062 6f64 795b 303a 6f62 6a2e 626f  rt body[0:obj.bo
-00003a40: 6479 5f6d 6178 6c65 6e5d 5c0a 2020 2020  dy_maxlen]\.    
-00003a50: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-00003a60: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-00003a70: 6970 2829 203d 3d20 6368 756e 6b73 5b30  ip() == chunks[0
-00003a80: 5d2e 6765 7428 2762 6f64 7927 290a 2020  ].get('body').  
-00003a90: 2020 6173 7365 7274 2074 6974 6c65 203d    assert title =
-00003aa0: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
-00003ab0: 2774 6974 6c65 2729 0a0a 2020 2020 230a  'title')..    #.
-00003ac0: 2020 2020 2320 4e65 7874 2054 6573 743a      # Next Test:
-00003ad0: 2041 7070 656e 6420 7469 746c 6520 746f   Append title to
-00003ae0: 2062 6f64 7920 2b20 5472 756e 6361 7465   body + Truncate
-00003af0: 6420 626f 6479 0a20 2020 2023 0a0a 2020  d body.    #..  
-00003b00: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
-00003b10: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
-00003b20: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
-00003b30: 2045 6e66 6f72 6365 206e 6f20 7469 746c   Enforce no titl
-00003b40: 650a 2020 2020 2020 2020 7469 746c 655f  e.        title_
-00003b50: 6d61 786c 656e 203d 2030 0a0a 2020 2020  maxlen = 0..    
-00003b60: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
-00003b70: 626f 6479 206c 656e 6774 6820 6f66 206a  body length of j
-00003b80: 7573 7420 3130 300a 2020 2020 2020 2020  ust 100.        
-00003b90: 626f 6479 5f6d 6178 6c65 6e20 3d20 3130  body_maxlen = 10
-00003ba0: 300a 0a20 2020 2020 2020 2023 204e 6f20  0..        # No 
-00003bb0: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
-00003bc0: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
-00003bd0: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
-00003be0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00003bf0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00003c00: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00003c10: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-00003c20: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00003c30: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
-00003c40: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
-00003c50: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00003c60: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00003c70: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
-00003c80: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
-00003c90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003ca0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
-00003cb0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
-00003cc0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
-00003cd0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
-00003ce0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
-00003cf0: 2e54 5255 4e43 4154 4529 0a20 2020 2061  .TRUNCATE).    a
-00003d00: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-00003d10: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-00003d20: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-00003d30: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-00003d40: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-00003d50: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-00003d60: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-00003d70: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-00003d80: 6f75 6368 6564 0a0a 2020 2020 6f62 6a2e  ouched..    obj.
-00003d90: 6e6f 7469 6679 5f66 6f72 6d61 7420 3d20  notify_format = 
-00003da0: 4e6f 7469 6679 466f 726d 6174 2e48 544d  NotifyFormat.HTM
-00003db0: 4c0a 2020 2020 6368 756e 6b73 203d 206f  L.    chunks = o
-00003dc0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00003dd0: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-00003de0: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
-00003df0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-00003e00: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-00003e10: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
-00003e20: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00003e30: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00003e40: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
-00003e50: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-00003e60: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00003e70: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-00003e80: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-00003e90: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-00003ea0: 7329 203d 3d20 310a 0a20 2020 206f 626a  s) == 1..    obj
-00003eb0: 2e6e 6f74 6966 795f 666f 726d 6174 203d  .notify_format =
-00003ec0: 204e 6f74 6966 7946 6f72 6d61 742e 4d41   NotifyFormat.MA
-00003ed0: 524b 444f 574e 0a20 2020 2063 6875 6e6b  RKDOWN.    chunk
-00003ee0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00003ef0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00003f00: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00003f10: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00003f20: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00003f30: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00003f40: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00003f50: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00003f60: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-00003f70: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00003f80: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00003f90: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-00003fa0: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-00003fb0: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00003fc0: 6368 756e 6b73 2920 3d3d 2031 0a0a 2020  chunks) == 1..  
-00003fd0: 2020 6f62 6a2e 6e6f 7469 6679 5f66 6f72    obj.notify_for
-00003fe0: 6d61 7420 3d20 4e6f 7469 6679 466f 726d  mat = NotifyForm
-00003ff0: 6174 2e54 4558 540a 2020 2020 6368 756e  at.TEXT.    chun
-00004000: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00004010: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-00004020: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-00004030: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-00004040: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00004050: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
-00004060: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-00004070: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00004080: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-00004090: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-000040a0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-000040b0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-000040c0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-000040d0: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
-000040e0: 2863 6875 6e6b 7329 203d 3d20 310a 0a20  (chunks) == 1.. 
-000040f0: 2020 2023 2054 6865 2062 656c 6f77 206c     # The below l
-00004100: 696e 6520 7368 6f75 6c64 2062 6520 7265  ine should be re
-00004110: 6164 2063 6172 6566 756c 6c79 2e2e 2e20  ad carefully... 
-00004120: 5765 2772 6520 6163 7475 616c 6c79 2074  We're actually t
-00004130: 6573 7469 6e67 2074 6f20 7365 650a 2020  esting to see.  
-00004140: 2020 2320 7468 6174 206f 7572 2074 6974    # that our tit
-00004150: 6c65 2069 7320 6d61 7463 6865 6420 6167  le is matched ag
-00004160: 6169 6e73 7420 6f75 7220 626f 6479 2e20  ainst our body. 
-00004170: 4265 6869 6e64 2074 6865 2073 6365 6e65  Behind the scene
-00004180: 732c 2074 6865 2074 6974 6c65 0a20 2020  s, the title.   
-00004190: 2023 2077 6173 2061 7070 656e 6465 6420   # was appended 
-000041a0: 746f 2074 6865 2062 6f64 792e 2054 6865  to the body. The
-000041b0: 2062 6f64 7920 7761 7320 7468 656e 2074   body was then t
-000041c0: 7275 6e63 6174 6564 2074 6f20 7468 6520  runcated to the 
-000041d0: 6d61 786c 656e 2e0a 2020 2020 2320 5468  maxlen..    # Th
-000041e0: 6520 7468 696e 6720 6973 2c20 7369 6e63  e thing is, sinc
-000041f0: 6520 7468 6520 7469 746c 6520 6973 2073  e the title is s
-00004200: 6f20 6c61 7267 652c 2061 6c6c 206f 6620  o large, all of 
-00004210: 7468 6520 626f 6479 2077 6173 206c 6f73  the body was los
-00004220: 740a 2020 2020 2320 616e 6420 6120 676f  t.    # and a go
-00004230: 6f64 2063 6875 6e6b 206f 6620 7468 6520  od chunk of the 
-00004240: 7469 746c 6520 7761 7320 746f 6f2e 2020  title was too.  
-00004250: 5468 6520 6d65 7373 6167 6520 7365 6e74  The message sent
-00004260: 2077 696c 6c20 6a75 7374 2062 6520 610a   will just be a.
-00004270: 2020 2020 2320 736d 616c 6c20 706f 7274      # small port
-00004280: 696f 6e20 6f66 2074 6865 2074 6974 6c65  ion of the title
-00004290: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-000042a0: 6368 756e 6b73 5b30 5d2e 6765 7428 2762  chunks[0].get('b
-000042b0: 6f64 7927 2929 203d 3d20 6f62 6a2e 626f  ody')) == obj.bo
-000042c0: 6479 5f6d 6178 6c65 6e0a 2020 2020 6173  dy_maxlen.    as
-000042d0: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
-000042e0: 2e62 6f64 795f 6d61 786c 656e 5d20 3d3d  .body_maxlen] ==
-000042f0: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
-00004300: 626f 6479 2729 0a0a 0a64 6566 2074 6573  body')...def tes
-00004310: 745f 6e6f 7469 6679 5f6f 7665 7266 6c6f  t_notify_overflo
-00004320: 775f 7370 6c69 745f 7769 7468 5f61 6d61  w_split_with_ama
-00004330: 6c67 616d 6174 696f 6e28 293a 0a20 2020  lgamation():.   
-00004340: 2022 2222 0a20 2020 2041 5049 3a20 4f76   """.    API: Ov
-00004350: 6572 666c 6f77 2057 6974 6820 416d 616c  erflow With Amal
-00004360: 6761 6d61 7469 6f6e 2053 706c 6974 7320  gamation Splits 
-00004370: 4675 6e63 7469 6f6e 616c 6974 7920 5465  Functionality Te
-00004380: 7374 696e 670a 0a20 2020 2022 2222 0a0a  sting..    """..
-00004390: 2020 2020 230a 2020 2020 2320 4120 6c69      #.    # A li
-000043a0: 7474 6c65 2070 7265 7061 7261 7469 6f6e  ttle preparation
-000043b0: 0a20 2020 2023 0a0a 2020 2020 2320 4e75  .    #..    # Nu
-000043c0: 6d62 6572 206f 6620 6368 6172 6163 7465  mber of characte
-000043d0: 7273 2070 6572 206c 696e 650a 2020 2020  rs per line.    
-000043e0: 726f 7720 3d20 3234 0a0a 2020 2020 2320  row = 24..    # 
-000043f0: 536f 6d65 2076 6172 6961 626c 6573 2077  Some variables w
-00004400: 6520 7573 6520 746f 2063 6f6e 7472 6f6c  e use to control
-00004410: 2074 6865 2064 6174 6120 7765 2077 6f72   the data we wor
-00004420: 6b20 7769 7468 0a20 2020 2062 6f64 795f  k with.    body_
-00004430: 6c65 6e20 3d20 3130 3234 0a20 2020 2074  len = 1024.    t
-00004440: 6974 6c65 5f6c 656e 203d 2031 3032 340a  itle_len = 1024.
-00004450: 0a20 2020 2023 2043 7265 6174 6520 6120  .    # Create a 
-00004460: 6c61 7267 6520 626f 6479 2061 6e64 2074  large body and t
-00004470: 6974 6c65 2077 6974 6820 7261 6e64 6f6d  itle with random
-00004480: 2064 6174 610a 2020 2020 626f 6479 203d   data.    body =
-00004490: 2027 272e 6a6f 696e 2863 686f 6963 6528   ''.join(choice(
-000044a0: 7374 725f 616c 7068 6120 2b20 7374 725f  str_alpha + str_
-000044b0: 6e75 6d29 2066 6f72 205f 2069 6e20 7261  num) for _ in ra
-000044c0: 6e67 6528 626f 6479 5f6c 656e 2929 0a20  nge(body_len)). 
-000044d0: 2020 2062 6f64 7920 3d20 275c 725c 6e27     body = '\r\n'
-000044e0: 2e6a 6f69 6e28 5b62 6f64 795b 693a 2069  .join([body[i: i
-000044f0: 202b 2072 6f77 5d20 666f 7220 6920 696e   + row] for i in
-00004500: 2072 616e 6765 2830 2c20 6c65 6e28 626f   range(0, len(bo
-00004510: 6479 292c 2072 6f77 295d 290a 0a20 2020  dy), row)])..   
-00004520: 2023 2074 6865 206e 6577 206c 696e 6573   # the new lines
-00004530: 2061 6464 2061 206c 6172 6765 2061 6d6f   add a large amo
-00004540: 756e 7420 746f 206f 7572 2062 6f64 793b  unt to our body;
-00004550: 206c 6574 7320 666f 7263 6520 7468 6520   lets force the 
-00004560: 636f 6e74 656e 740a 2020 2020 2320 6261  content.    # ba
-00004570: 636b 2074 6f20 6265 696e 6720 3130 3234  ck to being 1024
-00004580: 2063 6861 7261 6374 6572 732e 0a20 2020   characters..   
-00004590: 2062 6f64 7920 3d20 626f 6479 5b30 3a31   body = body[0:1
-000045a0: 3032 345d 0a0a 2020 2020 2320 4372 6561  024]..    # Crea
-000045b0: 7465 206f 7572 2074 6974 6c65 2075 7369  te our title usi
-000045c0: 6e67 2072 616e 646f 6d20 6461 7461 0a20  ng random data. 
-000045d0: 2020 2074 6974 6c65 203d 2027 272e 6a6f     title = ''.jo
-000045e0: 696e 2863 686f 6963 6528 7374 725f 616c  in(choice(str_al
-000045f0: 7068 6120 2b20 7374 725f 6e75 6d29 2066  pha + str_num) f
-00004600: 6f72 205f 2069 6e20 7261 6e67 6528 7469  or _ in range(ti
-00004610: 746c 655f 6c65 6e29 290a 0a20 2020 2023  tle_len))..    #
-00004620: 0a20 2020 2023 2046 6972 7374 2054 6573  .    # First Tes
-00004630: 743a 2054 7275 6e63 6174 6564 2054 6974  t: Truncated Tit
-00004640: 6c65 0a20 2020 2023 0a20 2020 2063 6c61  le.    #.    cla
-00004650: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
-00004660: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
-00004670: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
-00004680: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
-00004690: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
-000046a0: 6d61 786c 656e 203d 2031 300a 0a20 2020  maxlen = 10..   
-000046b0: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
-000046c0: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
-000046d0: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
-000046e0: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
-000046f0: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
-00004700: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-00004710: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00004720: 2020 2020 2020 2020 2020 2020 7375 7065              supe
-00004730: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
-00004740: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
-00004750: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
-00004760: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00004770: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00004780: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
-00004790: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
-000047a0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-000047b0: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
-000047c0: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
-000047d0: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
-000047e0: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
-000047f0: 7665 7266 6c6f 774d 6f64 652e 5350 4c49  verflowMode.SPLI
-00004800: 5429 0a20 2020 2061 7373 6572 7420 6f62  T).    assert ob
-00004810: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
-00004820: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
-00004830: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
-00004840: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
-00004850: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
-00004860: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
-00004870: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
-00004880: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
-00004890: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-000048a0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-000048b0: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
-000048c0: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
-000048d0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-000048e0: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
-000048f0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-00004900: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00004910: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00004920: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
-00004930: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00004940: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00004950: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-00004960: 653d 7469 746c 6529 0a20 2020 2061 7373  e=title).    ass
-00004970: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
-00004980: 3d3d 2031 0a20 2020 2061 7373 6572 7420  == 1.    assert 
-00004990: 626f 6479 2e6c 7374 7269 7028 275c 725c  body.lstrip('\r\
-000049a0: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-000049b0: 6970 2829 203d 3d20 6368 756e 6b73 5b30  ip() == chunks[0
-000049c0: 5d2e 6765 7428 2762 6f64 7927 290a 2020  ].get('body').  
-000049d0: 2020 6173 7365 7274 2074 6974 6c65 5b30    assert title[0
-000049e0: 3a6f 626a 2e74 6974 6c65 5f6d 6178 6c65  :obj.title_maxle
-000049f0: 6e5d 203d 3d20 6368 756e 6b73 5b30 5d2e  n] == chunks[0].
-00004a00: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
-00004a10: 2020 230a 2020 2020 2320 4e65 7874 2054    #.    # Next T
-00004a20: 6573 743a 204c 696e 6520 436f 756e 7420  est: Line Count 
-00004a30: 436f 6e74 726f 6c0a 2020 2020 230a 0a20  Control.    #.. 
-00004a40: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
-00004a50: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
-00004a60: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
-00004a70: 2320 5465 7374 2074 6974 6c65 206d 6178  # Test title max
-00004a80: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
-00004a90: 7469 746c 655f 6d61 786c 656e 203d 2035  title_maxlen = 5
-00004aa0: 0a0a 2020 2020 2020 2020 2320 4d61 7869  ..        # Maxi
-00004ab0: 6d75 6d20 6e75 6d62 6572 206f 6620 6c69  mum number of li
-00004ac0: 6e65 730a 2020 2020 2020 2020 626f 6479  nes.        body
-00004ad0: 5f6d 6178 5f6c 696e 655f 636f 756e 7420  _max_line_count 
-00004ae0: 3d20 350a 0a20 2020 2020 2020 2023 2057  = 5..        # W
-00004af0: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-00004b00: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-00004b10: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-00004b20: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-00004b30: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00004b40: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00004b50: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00004b60: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00004b70: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-00004b80: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-00004b90: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-00004ba0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00004bb0: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-00004bc0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-00004bd0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-00004be0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00004bf0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-00004c00: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-00004c10: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-00004c20: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-00004c30: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
-00004c40: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-00004c50: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-00004c60: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-00004c70: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-00004c80: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-00004c90: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-00004ca0: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-00004cb0: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-00004cc0: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-00004cd0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00004ce0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00004cf0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00004d00: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00004d10: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00004d20: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00004d30: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00004d40: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00004d50: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-00004d60: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00004d70: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00004d80: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-00004d90: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-00004da0: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00004db0: 6368 756e 6b73 2920 3d3d 2031 0a20 2020  chunks) == 1.   
-00004dc0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00004dd0: 6b73 5b30 5d2e 6765 7428 2762 6f64 7927  ks[0].get('body'
-00004de0: 292e 7370 6c69 7428 275c 6e27 2929 203d  ).split('\n')) =
-00004df0: 3d20 6f62 6a2e 626f 6479 5f6d 6178 5f6c  = obj.body_max_l
-00004e00: 696e 655f 636f 756e 740a 2020 2020 6173  ine_count.    as
-00004e10: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
-00004e20: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
-00004e30: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
-00004e40: 2774 6974 6c65 2729 0a0a 2020 2020 230a  'title')..    #.
-00004e50: 2020 2020 2320 4e65 7874 2054 6573 743a      # Next Test:
-00004e60: 2053 706c 6974 2062 6f64 790a 2020 2020   Split body.    
-00004e70: 230a 0a20 2020 2063 6c61 7373 2054 6573  #..    class Tes
-00004e80: 744e 6f74 6966 6963 6174 696f 6e28 4e6f  tNotification(No
-00004e90: 7469 6679 4261 7365 293a 0a0a 2020 2020  tifyBase):..    
-00004ea0: 2020 2020 2320 5465 7374 2074 6974 6c65      # Test title
-00004eb0: 206d 6178 206c 656e 6774 680a 2020 2020   max length.    
-00004ec0: 2020 2020 7469 746c 655f 6d61 786c 656e      title_maxlen
-00004ed0: 203d 2074 6974 6c65 5f6c 656e 0a0a 2020   = title_len..  
-00004ee0: 2020 2020 2020 2320 456e 666f 7263 6520        # Enforce 
-00004ef0: 6120 626f 6479 206c 656e 6774 682e 204d  a body length. M
-00004f00: 616b 6520 7375 7265 2069 7427 7320 616e  ake sure it's an
-00004f10: 2069 6e74 2e0a 2020 2020 2020 2020 626f   int..        bo
-00004f20: 6479 5f6d 6178 6c65 6e20 3d20 696e 7428  dy_maxlen = int(
-00004f30: 626f 6479 5f6c 656e 202f 2034 290a 0a20  body_len / 4).. 
-00004f40: 2020 2020 2020 2023 2057 6974 6820 616d         # With am
-00004f50: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
-00004f60: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
-00004f70: 6761 6d61 7465 5f74 6974 6c65 203d 2054  gamate_title = T
-00004f80: 7275 650a 0a20 2020 2020 2020 2064 6566  rue..        def
-00004f90: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00004fa0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00004fb0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
-00004fc0: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
-00004fd0: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-00004fe0: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
-00004ff0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00005000: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-00005010: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
-00005020: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
-00005030: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00005040: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
-00005050: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
-00005060: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
-00005070: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
-00005080: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
-00005090: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
-000050a0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
-000050b0: 0a20 2020 2023 2056 6572 6966 7920 7468  .    # Verify th
-000050c0: 6174 2077 6520 6272 6561 6b20 7468 6520  at we break the 
-000050d0: 7469 746c 6520 746f 2061 206d 6178 206c  title to a max l
-000050e0: 656e 6774 6820 6f66 206f 7572 2074 6974  ength of our tit
-000050f0: 6c65 5f6d 6178 0a20 2020 2023 2061 6e64  le_max.    # and
-00005100: 2074 6861 7420 7468 6520 626f 6479 2072   that the body r
-00005110: 656d 6169 6e73 2075 6e74 6f75 6368 6564  emains untouched
-00005120: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00005130: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00005140: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00005150: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
-00005160: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00005170: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-00005180: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-00005190: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-000051a0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-000051b0: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
-000051c0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-000051d0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-000051e0: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-000051f0: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
-00005200: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
-00005210: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
-00005220: 203d 3d20 350a 2020 2020 666f 7220 6964   == 5.    for id
-00005230: 782c 2063 6875 6e6b 2069 6e20 656e 756d  x, chunk in enum
-00005240: 6572 6174 6528 6368 756e 6b73 2c20 7374  erate(chunks, st
-00005250: 6172 743d 3129 3a0a 2020 2020 2020 2020  art=1):.        
-00005260: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
-00005270: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-00005280: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
-00005290: 6c65 2729 2920 3c3d 206f 626a 2e74 6974  le')) <= obj.tit
-000052a0: 6c65 5f6d 6178 6c65 6e0a 2020 2020 2020  le_maxlen.      
-000052b0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-000052c0: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
-000052d0: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
-000052e0: 656e 0a0a 2020 2020 2020 2020 2320 4e6f  en..        # No
-000052f0: 2063 6f75 6e74 6572 2069 7320 6469 7370   counter is disp
-00005300: 6c61 7965 6420 6265 6361 7573 6520 6f75  layed because ou
-00005310: 7220 7469 746c 6520 6973 2073 6f20 656e  r title is so en
-00005320: 6f72 6d6f 7573 0a20 2020 2020 2020 2023  ormous.        #
-00005330: 2057 6520 7377 6974 6368 2074 6f20 6120   We switch to a 
-00005340: 6469 7370 6c61 7920 7469 746c 6520 6f6e  display title on
-00005350: 2066 6972 7374 206d 6573 7361 6765 206f   first message o
-00005360: 6e6c 790a 2020 2020 2020 2020 6966 2069  nly.        if i
-00005370: 6478 203e 2031 3a0a 2020 2020 2020 2020  dx > 1:.        
-00005380: 2020 2020 2320 456d 7074 7920 286e 6f20      # Empty (no 
-00005390: 7469 746c 6520 6469 7370 6c61 7965 6420  title displayed 
-000053a0: 6f6e 2066 6f6c 6c6f 7769 6e67 2065 6e74  on following ent
-000053b0: 7269 6573 0a20 2020 2020 2020 2020 2020  ries.           
-000053c0: 2061 7373 6572 7420 6368 756e 6b2e 6765   assert chunk.ge
-000053d0: 7428 2774 6974 6c65 2729 203d 3d20 2222  t('title') == ""
-000053e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000053f0: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-00005400: 206c 656e 6774 6820 6f66 2074 6865 2062   length of the b
-00005410: 6f64 7920 7072 6576 6169 6c73 206f 7572  ody prevails our
-00005420: 2074 6974 6c65 2064 7565 2074 6f20 6974   title due to it
-00005430: 2062 6569 6e67 0a20 2020 2020 2020 2020   being.         
-00005440: 2020 2023 2073 6f20 6d75 6368 2073 6d61     # so much sma
-00005450: 6c6c 6572 2074 6865 6e20 6f75 7220 7469  ller then our ti
-00005460: 746c 6520 6c65 6e67 7468 0a20 2020 2020  tle length.     
-00005470: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-00005480: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
-00005490: 6c65 2729 2920 3d3d 206f 626a 2e62 6f64  le')) == obj.bod
-000054a0: 795f 6d61 786c 656e 0a20 2020 2020 2020  y_maxlen.       
-000054b0: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
-000054c0: 655b 3a6f 626a 2e62 6f64 795f 6d61 786c  e[:obj.body_maxl
-000054d0: 656e 5d20 3d3d 2063 6875 6e6b 2e67 6574  en] == chunk.get
-000054e0: 2827 7469 746c 6527 290a 0a20 2020 2020  ('title')..     
-000054f0: 2020 2023 204f 7572 2062 6f64 7920 6973     # Our body is
-00005500: 206f 6e6c 7920 6272 6f6b 656e 2075 703b   only broken up;
-00005510: 206e 6f74 206c 6f73 740a 2020 2020 2020   not lost.      
-00005520: 2020 5f62 6f64 7920 3d20 6368 756e 6b2e    _body = chunk.
-00005530: 6765 7428 2762 6f64 7927 290a 2020 2020  get('body').    
-00005540: 2020 2020 6173 7365 7274 2062 6f64 795b      assert body[
-00005550: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-00005560: 7929 202b 206f 6666 7365 745d 5c0a 2020  y) + offset]\.  
-00005570: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-00005580: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-00005590: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
-000055a0: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
-000055b0: 6574 202b 3d20 6c65 6e28 5f62 6f64 7929  et += len(_body)
-000055c0: 0a0a 2020 2020 2320 416e 6f74 6865 7220  ..    # Another 
-000055d0: 6564 6765 2063 6173 6520 7768 6572 6520  edge case where 
-000055e0: 7468 6520 7469 746c 6520 6a75 7374 2069  the title just i
-000055f0: 736e 2774 2074 6861 7420 6c6f 6e67 206c  sn't that long l
-00005600: 6561 7669 6e67 0a20 2020 2023 2061 206c  eaving.    # a l
-00005610: 6f74 206f 6620 7370 6163 6520 666f 7220  ot of space for 
-00005620: 7468 6520 5b78 782f 7878 5d20 656e 7472  the [xx/xx] entr
-00005630: 6965 7320 286e 6f20 7472 756e 6361 7469  ies (no truncati
-00005640: 6f6e 206e 6565 6465 6429 0a20 2020 2063  on needed).    c
-00005650: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00005660: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00005670: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
-00005680: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00005690: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-000056a0: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-000056b0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-000056c0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-000056d0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
-000056e0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-000056f0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00005700: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00005710: 793d 626f 6479 2c20 7469 746c 653d 7469  y=body, title=ti
-00005720: 746c 655b 3a32 305d 290a 2020 2020 6f66  tle[:20]).    of
-00005730: 6673 6574 203d 2030 0a20 2020 2063 5f6c  fset = 0.    c_l
-00005740: 656e 203d 206c 656e 2827 205b 582f 585d  en = len(' [X/X]
-00005750: 2729 0a20 2020 2061 7373 6572 7420 6c65  ').    assert le
-00005760: 6e28 6368 756e 6b73 2920 3d3d 2035 0a20  n(chunks) == 5. 
-00005770: 2020 2066 6f72 2069 6478 2c20 6368 756e     for idx, chun
-00005780: 6b20 696e 2065 6e75 6d65 7261 7465 2863  k in enumerate(c
-00005790: 6875 6e6b 732c 2073 7461 7274 3d31 293a  hunks, start=1):
-000057a0: 0a20 2020 2020 2020 2023 2056 6572 6966  .        # Verif
-000057b0: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
-000057c0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-000057d0: 2e67 6574 2827 7469 746c 6527 2929 203c  .get('title')) <
-000057e0: 3d20 6f62 6a2e 7469 746c 655f 6d61 786c  = obj.title_maxl
-000057f0: 656e 0a20 2020 2020 2020 2061 7373 6572  en.        asser
-00005800: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-00005810: 2762 6f64 7927 2929 203c 3d20 6f62 6a2e  'body')) <= obj.
-00005820: 626f 6479 5f6d 6178 6c65 6e0a 0a20 2020  body_maxlen..   
-00005830: 2020 2020 2023 204f 7572 2074 6974 6c65       # Our title
-00005840: 2068 6173 2061 2063 6f75 6e74 6572 2061   has a counter a
-00005850: 6464 6564 2074 6f20 6974 0a20 2020 2020  dded to it.     
-00005860: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-00005870: 3a32 305d 203d 3d20 6368 756e 6b2e 6765  :20] == chunk.ge
-00005880: 7428 2774 6974 6c65 2729 5b3a 2d63 5f6c  t('title')[:-c_l
-00005890: 656e 5d0a 2020 2020 2020 2020 6173 7365  en].        asse
-000058a0: 7274 2063 6875 6e6b 2e67 6574 2827 7469  rt chunk.get('ti
-000058b0: 746c 6527 295b 2d63 5f6c 656e 3a5d 203d  tle')[-c_len:] =
-000058c0: 3d20 5c0a 2020 2020 2020 2020 2020 2020  = \.            
-000058d0: 2720 5b7b 3a30 317d 2f7b 3a30 317d 5d27  ' [{:01}/{:01}]'
-000058e0: 2e66 6f72 6d61 7428 6964 782c 206c 656e  .format(idx, len
-000058f0: 2863 6875 6e6b 7329 290a 2020 2020 2020  (chunks)).      
-00005900: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-00005910: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-00005920: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-00005930: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-00005940: 6574 2827 626f 6479 2729 0a20 2020 2020  et('body').     
-00005950: 2020 2061 7373 6572 7420 626f 6479 5b6f     assert body[o
-00005960: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00005970: 2920 2b20 6f66 6673 6574 5d5c 0a20 2020  ) + offset]\.   
-00005980: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-00005990: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-000059a0: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
-000059b0: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
-000059c0: 7420 2b3d 206c 656e 285f 626f 6479 290a  t += len(_body).
-000059d0: 0a20 2020 2023 0a20 2020 2023 2054 6573  .    #.    # Tes
-000059e0: 7420 666f 7263 696e 6720 6f76 6572 666c  t forcing overfl
-000059f0: 6f77 5f64 6973 706c 6179 5f74 6974 6c65  ow_display_title
-00005a00: 5f6f 6e63 650a 2020 2020 230a 2020 2020  _once.    #.    
-00005a10: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
-00005a20: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-00005a30: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
-00005a40: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
-00005a50: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
-00005a60: 6c65 5f6d 6178 6c65 6e20 3d20 7469 746c  le_maxlen = titl
-00005a70: 655f 6c65 6e0a 0a20 2020 2020 2020 2023  e_len..        #
-00005a80: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
-00005a90: 6c65 6e67 7468 2e20 4d61 6b65 2073 7572  length. Make sur
-00005aa0: 6520 6974 2773 2061 6e20 696e 742e 0a20  e it's an int.. 
-00005ab0: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
-00005ac0: 656e 203d 2069 6e74 2862 6f64 795f 6c65  en = int(body_le
-00005ad0: 6e20 2f20 3429 0a0a 2020 2020 2020 2020  n / 4)..        
-00005ae0: 2320 5769 7468 2061 6d61 6c67 616d 6174  # With amalgamat
-00005af0: 696f 6e0a 2020 2020 2020 2020 6f76 6572  ion.        over
-00005b00: 666c 6f77 5f61 6d61 6c67 616d 6174 655f  flow_amalgamate_
-00005b10: 7469 746c 6520 3d20 5472 7565 0a0a 2020  title = True..  
-00005b20: 2020 2020 2020 2320 204f 6e6c 7920 6469        #  Only di
-00005b30: 7370 6c61 7920 7469 746c 6520 6f6e 6365  splay title once
-00005b40: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-00005b50: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
-00005b60: 6f6e 6365 203d 2054 7275 650a 0a20 2020  once = True..   
-00005b70: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
-00005b80: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
-00005b90: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00005ba0: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-00005bb0: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
-00005bc0: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
-00005bd0: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
-00005be0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00005bf0: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
-00005c00: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
-00005c10: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
-00005c20: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00005c30: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
-00005c40: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
-00005c50: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-00005c60: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
-00005c70: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
-00005c80: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
-00005c90: 6f74 204e 6f6e 650a 0a20 2020 2063 6875  ot None..    chu
-00005ca0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-00005cb0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-00005cc0: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
-00005cd0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00005ce0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00005cf0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-00005d00: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-00005d10: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-00005d20: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-00005d30: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-00005d40: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00005d50: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00005d60: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
-00005d70: 6529 0a20 2020 206f 6666 7365 7420 3d20  e).    offset = 
-00005d80: 300a 2020 2020 6173 7365 7274 206c 656e  0.    assert len
-00005d90: 2863 6875 6e6b 7329 203d 3d20 350a 2020  (chunks) == 5.  
-00005da0: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
-00005db0: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
-00005dc0: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
-00005dd0: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
-00005de0: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
-00005df0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-00005e00: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
-00005e10: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-00005e20: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-00005e30: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-00005e40: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
-00005e50: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
-00005e60: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
-00005e70: 6861 7320 6e6f 2063 6f75 6e74 6572 2061  has no counter a
-00005e80: 6464 6564 2074 6f20 6974 0a20 2020 2020  dded to it.     
-00005e90: 2020 2069 6620 6964 7820 3e20 313a 0a20     if idx > 1:. 
-00005ea0: 2020 2020 2020 2020 2020 2023 2045 6d70             # Emp
-00005eb0: 7479 2028 6e6f 2074 6974 6c65 2064 6973  ty (no title dis
-00005ec0: 706c 6179 6564 206f 6e20 666f 6c6c 6f77  played on follow
-00005ed0: 696e 6720 656e 7472 6965 730a 2020 2020  ing entries.    
-00005ee0: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-00005ef0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-00005f00: 2920 3d3d 2022 220a 2020 2020 2020 2020  ) == "".        
-00005f10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00005f20: 2020 2320 5468 6520 626f 6479 206c 656e    # The body len
-00005f30: 6774 6820 7072 6576 6169 6c73 2064 7565  gth prevails due
-00005f40: 2074 6f20 6f75 7220 616d 616c 6761 6d61   to our amalgama
-00005f50: 7469 6f6e 2066 6c61 670a 2020 2020 2020  tion flag.      
-00005f60: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00005f70: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
-00005f80: 6527 2929 203d 3d20 6f62 6a2e 626f 6479  e')) == obj.body
-00005f90: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
-00005fa0: 2020 2020 6173 7365 7274 2074 6974 6c65      assert title
-00005fb0: 5b3a 6f62 6a2e 626f 6479 5f6d 6178 6c65  [:obj.body_maxle
-00005fc0: 6e5d 203d 3d20 6368 756e 6b2e 6765 7428  n] == chunk.get(
-00005fd0: 2774 6974 6c65 2729 0a0a 2020 2020 2020  'title')..      
-00005fe0: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-00005ff0: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-00006000: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-00006010: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-00006020: 6574 2827 626f 6479 2729 0a20 2020 2020  et('body').     
-00006030: 2020 2061 7373 6572 7420 626f 6479 5b6f     assert body[o
-00006040: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00006050: 2920 2b20 6f66 6673 6574 5d5c 0a20 2020  ) + offset]\.   
-00006060: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-00006070: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-00006080: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
-00006090: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
-000060a0: 7420 2b3d 206c 656e 285f 626f 6479 290a  t += len(_body).
-000060b0: 0a20 2020 2023 2054 6573 7420 6c61 7267  .    # Test larg
-000060c0: 6572 206d 6573 7361 6765 730a 2020 2020  er messages.    
-000060d0: 2320 616e 6420 7468 6174 2074 6865 2062  # and that the b
-000060e0: 6f64 7920 7265 6d61 696e 7320 756e 746f  ody remains unto
-000060f0: 7563 6865 640a 2020 2020 636c 6173 7320  uched.    class 
-00006100: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
-00006110: 284e 6f74 6966 7942 6173 6529 3a0a 0a20  (NotifyBase):.. 
-00006120: 2020 2020 2020 2023 2054 6573 7420 7469         # Test ti
-00006130: 746c 6520 6d61 7820 6c65 6e67 7468 0a20  tle max length. 
-00006140: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
-00006150: 6c65 6e20 3d20 3135 300a 0a20 2020 2020  len = 150..     
-00006160: 2020 2023 2045 6e66 6f72 6365 2061 2062     # Enforce a b
-00006170: 6f64 7920 6c65 6e67 7468 2e20 4d61 6b65  ody length. Make
-00006180: 2073 7572 6520 6974 2773 2061 6e20 696e   sure it's an in
-00006190: 742e 0a20 2020 2020 2020 2062 6f64 795f  t..        body_
-000061a0: 6d61 786c 656e 203d 2034 3030 0a0a 2020  maxlen = 400..  
-000061b0: 2020 2020 2020 2320 5769 7468 2061 6d61        # With ama
-000061c0: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
-000061d0: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
-000061e0: 616d 6174 655f 7469 746c 6520 3d20 5472  amate_title = Tr
-000061f0: 7565 0a0a 2020 2020 2020 2020 6465 6620  ue..        def 
-00006200: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
-00006210: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00006220: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
-00006230: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
-00006240: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
-00006250: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
-00006260: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00006270: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00006280: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
-00006290: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
-000062a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000062b0: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
-000062c0: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
-000062d0: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
-000062e0: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
-000062f0: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
-00006300: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
-00006310: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
-00006320: 2020 2020 6e65 775f 626f 6479 203d 2028      new_body = (
-00006330: 626f 6479 202a 2035 3030 290a 2020 2020  body * 500).    
-00006340: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00006350: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00006360: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-00006370: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-00006380: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00006390: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-000063a0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-000063b0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-000063c0: 7665 7266 6c6f 7728 626f 6479 3d6e 6577  verflow(body=new
-000063d0: 5f62 6f64 792c 2074 6974 6c65 3d22 2229  _body, title="")
-000063e0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-000063f0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00006400: 7728 626f 6479 3d6e 6577 5f62 6f64 792c  w(body=new_body,
-00006410: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00006420: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
-00006430: 2063 5f6c 656e 203d 206c 656e 2827 205b   c_len = len(' [
-00006440: 5858 5858 2f58 5858 585d 2729 0a20 2020  XXXX/XXXX]').   
-00006450: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00006460: 6b73 2920 3d3d 2032 3034 380a 2020 2020  ks) == 2048.    
-00006470: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-00006480: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-00006490: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-000064a0: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-000064b0: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-000064c0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-000064d0: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-000064e0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-000064f0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00006500: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-00006510: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-00006520: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-00006530: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
-00006540: 7320 6120 636f 756e 7465 7220 6164 6465  s a counter adde
-00006550: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
-00006560: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
-00006570: 6a2e 7469 746c 655f 6d61 786c 656e 5d5b  j.title_maxlen][
-00006580: 3a2d 635f 6c65 6e5d 203d 3d20 6368 756e  :-c_len] == chun
-00006590: 6b2e 6765 7428 2774 6974 6c65 2729 5b3a  k.get('title')[:
-000065a0: 2d63 5f6c 656e 5d0a 2020 2020 2020 2020  -c_len].        
-000065b0: 6173 7365 7274 2063 6875 6e6b 2e67 6574  assert chunk.get
-000065c0: 2827 7469 746c 6527 295b 2d63 5f6c 656e  ('title')[-c_len
-000065d0: 3a5d 203d 3d20 5c0a 2020 2020 2020 2020  :] == \.        
-000065e0: 2020 2020 2720 5b7b 3a30 347d 2f7b 3a30      ' [{:04}/{:0
-000065f0: 347d 5d27 2e66 6f72 6d61 7428 6964 782c  4}]'.format(idx,
-00006600: 206c 656e 2863 6875 6e6b 7329 290a 0a20   len(chunks)).. 
-00006610: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
-00006620: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
-00006630: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
-00006640: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
-00006650: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
-00006660: 0a20 2020 2020 2020 2023 2055 6e2d 7573  .        # Un-us
-00006670: 6564 2077 6869 7465 7370 6163 6520 6973  ed whitespace is
-00006680: 2061 6c77 6179 7320 636c 6561 6e65 6420   always cleaned 
-00006690: 7570 3b20 6d61 6b65 2073 7572 6520 7765  up; make sure we
-000066a0: 2061 6363 6f75 6e74 2066 6f72 0a20 2020   account for.   
-000066b0: 2020 2020 2023 2074 6869 7320 696e 206f       # this in o
-000066c0: 7572 206e 6577 2063 616c 6375 6c61 7469  ur new calculati
-000066d0: 6f6e 0a20 2020 2020 2020 2077 735f 6469  on.        ws_di
-000066e0: 6666 203d 206c 656e 286e 6577 5f62 6f64  ff = len(new_bod
-000066f0: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-00006700: 6f64 7929 202b 206f 6666 7365 745d 2920  ody) + offset]) 
-00006710: 2d20 5c0a 2020 2020 2020 2020 2020 2020  - \.            
-00006720: 6c65 6e28 6e65 775f 626f 6479 5b6f 6666  len(new_body[off
-00006730: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-00006740: 2b20 6f66 6673 6574 5d0a 2020 2020 2020  + offset].      
-00006750: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-00006760: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-00006770: 292e 7273 7472 6970 2829 290a 0a20 2020  ).rstrip())..   
-00006780: 2020 2020 2061 7373 6572 7420 6e65 775f       assert new_
-00006790: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
-000067a0: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-000067b0: 202b 2077 735f 6469 6666 5d5c 0a20 2020   + ws_diff]\.   
-000067c0: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-000067d0: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-000067e0: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
-000067f0: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
-00006800: 7420 2b3d 2028 6c65 6e28 5f62 6f64 7929  t += (len(_body)
-00006810: 202b 2077 735f 6469 6666 290a 0a20 2020   + ws_diff)..   
-00006820: 2023 2042 6f64 7920 6368 756e 6b20 6973   # Body chunk is
-00006830: 2062 6579 6f6e 6420 3420 6469 6769 7473   beyond 4 digits
-00006840: 2c20 736f 205b 5858 5858 2f58 5858 585d  , so [XXXX/XXXX]
-00006850: 2069 7320 7475 726e 6564 206f 6666 0a20   is turned off. 
-00006860: 2020 206e 6577 5f62 6f64 7920 3d20 2862     new_body = (b
-00006870: 6f64 7920 2a20 3235 3030 290a 2020 2020  ody * 2500).    
-00006880: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00006890: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-000068a0: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-000068b0: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-000068c0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-000068d0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-000068e0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-000068f0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00006900: 7665 7266 6c6f 7728 626f 6479 3d6e 6577  verflow(body=new
-00006910: 5f62 6f64 792c 2074 6974 6c65 3d22 2229  _body, title="")
-00006920: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00006930: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00006940: 7728 626f 6479 3d6e 6577 5f62 6f64 792c  w(body=new_body,
-00006950: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00006960: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
-00006970: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00006980: 6b73 2920 3d3d 2031 3032 3430 0a20 2020  ks) == 10240.   
-00006990: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-000069a0: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-000069b0: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-000069c0: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-000069d0: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-000069e0: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-000069f0: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-00006a00: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-00006a10: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00006a20: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-00006a30: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-00006a40: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
-00006a50: 2020 2023 204f 7572 2074 6974 6c65 2068     # Our title h
-00006a60: 6173 206e 6f20 636f 756e 7465 7220 6164  as no counter ad
-00006a70: 6465 6420 746f 2069 740a 2020 2020 2020  ded to it.      
-00006a80: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
-00006a90: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-00006aa0: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
-00006ab0: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
-00006ac0: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
-00006ad0: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
-00006ae0: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
-00006af0: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
-00006b00: 7428 2762 6f64 7927 290a 0a20 2020 2020  t('body')..     
-00006b10: 2020 2023 2055 6e2d 7573 6564 2077 6869     # Un-used whi
-00006b20: 7465 7370 6163 6520 6973 2061 6c77 6179  tespace is alway
-00006b30: 7320 636c 6561 6e65 6420 7570 3b20 6d61  s cleaned up; ma
-00006b40: 6b65 2073 7572 6520 7765 2061 6363 6f75  ke sure we accou
-00006b50: 6e74 2066 6f72 0a20 2020 2020 2020 2023  nt for.        #
-00006b60: 2074 6869 7320 696e 206f 7572 206e 6577   this in our new
-00006b70: 2063 616c 6375 6c61 7469 6f6e 0a20 2020   calculation.   
-00006b80: 2020 2020 2077 735f 6469 6666 203d 206c       ws_diff = l
-00006b90: 656e 286e 6577 5f62 6f64 795b 6f66 6673  en(new_body[offs
-00006ba0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
-00006bb0: 206f 6666 7365 745d 2920 2d20 5c0a 2020   offset]) - \.  
-00006bc0: 2020 2020 2020 2020 2020 6c65 6e28 6e65            len(ne
-00006bd0: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
-00006be0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00006bf0: 6574 5d0a 2020 2020 2020 2020 2020 2020  et].            
-00006c00: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-00006c10: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-00006c20: 6970 2829 290a 0a20 2020 2020 2020 2061  ip())..        a
-00006c30: 7373 6572 7420 6e65 775f 626f 6479 5b6f  ssert new_body[o
-00006c40: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00006c50: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
-00006c60: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
-00006c70: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
-00006c80: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
-00006c90: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
-00006ca0: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
-00006cb0: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
-00006cc0: 6469 6666 290a 0a20 2020 2023 2054 6573  diff)..    # Tes
-00006cd0: 7420 6c61 7267 6572 206d 6573 7361 6765  t larger message
-00006ce0: 730a 2020 2020 2320 616e 6420 7468 6174  s.    # and that
-00006cf0: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-00006d00: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-00006d10: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
-00006d20: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-00006d30: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
-00006d40: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
-00006d50: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
-00006d60: 6c65 5f6d 6178 6c65 6e20 3d20 3135 300a  le_maxlen = 150.
-00006d70: 0a20 2020 2020 2020 2023 2045 6e66 6f72  .        # Enfor
-00006d80: 6365 2061 2062 6f64 7920 6c65 6e67 7468  ce a body length
-00006d90: 2e20 4d61 6b65 2073 7572 6520 6974 2773  . Make sure it's
-00006da0: 2061 6e20 696e 742e 0a20 2020 2020 2020   an int..       
-00006db0: 2062 6f64 795f 6d61 786c 656e 203d 2031   body_maxlen = 1
-00006dc0: 3530 0a0a 2020 2020 2020 2020 2320 5769  50..        # Wi
-00006dd0: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
-00006de0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-00006df0: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
-00006e00: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
-00006e10: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00006e20: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00006e30: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-00006e40: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
-00006e50: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
-00006e60: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
-00006e70: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
-00006e80: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00006e90: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
-00006ea0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
-00006eb0: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
-00006ec0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00006ed0: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
-00006ee0: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
-00006ef0: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
-00006f00: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
-00006f10: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
-00006f20: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
-00006f30: 4e6f 6e65 0a0a 2020 2020 6e65 775f 626f  None..    new_bo
-00006f40: 6479 203d 2028 626f 6479 202a 2035 290a  dy = (body * 5).
-00006f50: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00006f60: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00006f70: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-00006f80: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
-00006f90: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00006fa0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00006fb0: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-00006fc0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00006fd0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00006fe0: 3d6e 6577 5f62 6f64 792c 2074 6974 6c65  =new_body, title
-00006ff0: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-00007000: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00007010: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
-00007020: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-00007030: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-00007040: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00007050: 6368 756e 6b73 2920 3d3d 2033 360a 2020  chunks) == 36.  
-00007060: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
-00007070: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
-00007080: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
-00007090: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
-000070a0: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
-000070b0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-000070c0: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
-000070d0: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-000070e0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-000070f0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-00007100: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
-00007110: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
-00007120: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
-00007130: 6861 7320 6e6f 2063 6f75 6e74 6572 2061  has no counter a
-00007140: 6464 6564 2074 6f20 6974 0a20 2020 2020  dded to it.     
-00007150: 2020 2069 6620 6964 7820 3e20 313a 0a20     if idx > 1:. 
-00007160: 2020 2020 2020 2020 2020 2023 2045 6d70             # Emp
-00007170: 7479 2028 6e6f 2074 6974 6c65 2064 6973  ty (no title dis
-00007180: 706c 6179 6564 206f 6e20 666f 6c6c 6f77  played on follow
-00007190: 696e 6720 656e 7472 6965 730a 2020 2020  ing entries.    
-000071a0: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-000071b0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-000071c0: 2920 3d3d 2022 220a 2020 2020 2020 2020  ) == "".        
-000071d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000071e0: 2020 2320 4265 6361 7573 6520 3135 3020    # Because 150 
-000071f0: 6973 2077 6861 7420 7765 2073 6574 2074  is what we set t
-00007200: 6865 2074 6974 6c65 206c 696d 6974 2074  he title limit t
-00007210: 6f0a 2020 2020 2020 2020 2020 2020 6173  o.            as
-00007220: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-00007230: 6574 2827 7469 746c 6527 2929 203d 3d20  et('title')) == 
-00007240: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-00007250: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-00007260: 6572 7420 7469 746c 655b 3a6f 626a 2e74  ert title[:obj.t
-00007270: 6974 6c65 5f6d 6178 6c65 6e5d 203d 3d20  itle_maxlen] == 
-00007280: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-00007290: 2729 0a0a 2020 2020 2020 2020 2320 4f75  ')..        # Ou
-000072a0: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
-000072b0: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
-000072c0: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
-000072d0: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
-000072e0: 6479 2729 0a0a 2020 2020 2020 2020 2320  dy')..        # 
-000072f0: 556e 2d75 7365 6420 7768 6974 6573 7061  Un-used whitespa
-00007300: 6365 2069 7320 616c 7761 7973 2063 6c65  ce is always cle
-00007310: 616e 6564 2075 703b 206d 616b 6520 7375  aned up; make su
-00007320: 7265 2077 6520 6163 636f 756e 7420 666f  re we account fo
-00007330: 720a 2020 2020 2020 2020 2320 7468 6973  r.        # this
-00007340: 2069 6e20 6f75 7220 6e65 7720 6361 6c63   in our new calc
-00007350: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
-00007360: 7773 5f64 6966 6620 3d20 6c65 6e28 6e65  ws_diff = len(ne
-00007370: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
-00007380: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00007390: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
-000073a0: 2020 2020 206c 656e 286e 6577 5f62 6f64       len(new_bod
-000073b0: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-000073c0: 6f64 7929 202b 206f 6666 7365 745d 0a20  ody) + offset]. 
-000073d0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-000073e0: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-000073f0: 5c78 3063 2729 2e72 7374 7269 7028 2929  \x0c').rstrip())
-00007400: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-00007410: 206e 6577 5f62 6f64 795b 6f66 6673 6574   new_body[offset
-00007420: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-00007430: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
-00007440: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
-00007450: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-00007460: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
-00007470: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
-00007480: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
-00007490: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
-000074a0: 0a0a 2020 2020 230a 2020 2020 2320 4e65  ..    #.    # Ne
-000074b0: 7874 2054 6573 743a 2041 7070 656e 6420  xt Test: Append 
-000074c0: 7469 746c 6520 746f 2062 6f64 7920 2b20  title to body + 
-000074d0: 7370 6c69 7420 626f 6479 0a20 2020 2023  split body.    #
-000074e0: 0a0a 2020 2020 636c 6173 7320 5465 7374  ..    class Test
-000074f0: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
-00007500: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
-00007510: 2020 2023 2045 6e66 6f72 6365 206e 6f20     # Enforce no 
-00007520: 7469 746c 650a 2020 2020 2020 2020 7469  title.        ti
-00007530: 746c 655f 6d61 786c 656e 203d 2030 0a0a  tle_maxlen = 0..
-00007540: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
-00007550: 6520 6120 626f 6479 206c 656e 6774 6820  e a body length 
-00007560: 6261 7365 6420 6f6e 2074 6865 2074 6974  based on the tit
-00007570: 6c65 2e20 4d61 6b65 2073 7572 6520 6974  le. Make sure it
-00007580: 2773 2061 6e20 696e 742e 0a20 2020 2020  's an int..     
-00007590: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
-000075a0: 2069 6e74 2874 6974 6c65 5f6c 656e 202f   int(title_len /
-000075b0: 2034 290a 0a20 2020 2020 2020 2023 2057   4)..        # W
-000075c0: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-000075d0: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-000075e0: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-000075f0: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-00007600: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00007610: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00007620: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00007630: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00007640: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-00007650: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-00007660: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-00007670: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00007680: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-00007690: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-000076a0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-000076b0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-000076c0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-000076d0: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-000076e0: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-000076f0: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-00007700: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
-00007710: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-00007720: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-00007730: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-00007740: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-00007750: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-00007760: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-00007770: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-00007780: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-00007790: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-000077a0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-000077b0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-000077c0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-000077d0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-000077e0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-000077f0: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00007800: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00007810: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00007820: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-00007830: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00007840: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00007850: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-00007860: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-00007870: 0a0a 2020 2020 2320 4f75 7220 6669 6e61  ..    # Our fina
-00007880: 6c20 7072 6f64 7563 7420 6973 2074 6861  l product is tha
-00007890: 7420 6f75 7220 7469 746c 6520 6861 7320  t our title has 
-000078a0: 6265 656e 2061 7070 656e 6465 6420 746f  been appended to
-000078b0: 206f 7572 2062 6f64 7920 746f 0a20 2020   our body to.   
-000078c0: 2023 2063 7265 6174 6520 6f6e 6520 6772   # create one gr
-000078d0: 6561 7420 6269 6720 626f 6479 2e20 4173  eat big body. As
-000078e0: 2061 2072 6573 756c 7420 7765 276c 6c20   a result we'll 
-000078f0: 6765 7420 7175 6974 6520 6120 6665 7720  get quite a few 
-00007900: 6c69 6e65 7320 6261 636b 0a20 2020 2023  lines back.    #
-00007910: 206e 6f77 2e0a 2020 2020 6f66 6673 6574   now..    offset
-00007920: 203d 2030 0a0a 2020 2020 2320 4f75 7220   = 0..    # Our 
-00007930: 626f 6479 2077 696c 6c20 6c6f 6f6b 206c  body will look l
-00007940: 696b 6520 7468 6973 2069 6e20 736d 616c  ike this in smal
-00007950: 6c20 6368 756e 6b73 2061 7420 7468 6520  l chunks at the 
-00007960: 656e 6420 6f66 2074 6865 2064 6179 0a20  end of the day. 
-00007970: 2020 2062 756c 6b20 3d20 7469 746c 6520     bulk = title 
-00007980: 2b20 275c 725c 6e27 202b 2062 6f64 790a  + '\r\n' + body.
-00007990: 0a20 2020 2023 2044 7565 2074 6f20 7468  .    # Due to th
-000079a0: 6520 6e65 7720 6c69 6e65 2061 6464 6564  e new line added
-000079b0: 2074 6f20 7468 6520 656e 640a 2020 2020   to the end.    
-000079c0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-000079d0: 7329 203d 3d20 280a 2020 2020 2020 2020  s) == (.        
-000079e0: 2320 7772 6170 2064 6976 6973 696f 6e20  # wrap division 
-000079f0: 696e 2069 6e74 2829 2073 6f20 5079 7468  in int() so Pyth
-00007a00: 6f6e 2033 2064 6f65 736e 2774 2063 6f6e  on 3 doesn't con
-00007a10: 7665 7274 2069 7420 746f 2061 2066 6c6f  vert it to a flo
-00007a20: 6174 206f 6e0a 2020 2020 2020 2020 2320  at on.        # 
-00007a30: 7573 0a20 2020 2020 2020 2069 6e74 286c  us.        int(l
-00007a40: 656e 2862 756c 6b29 202f 206f 626a 2e62  en(bulk) / obj.b
-00007a50: 6f64 795f 6d61 786c 656e 2920 2b0a 2020  ody_maxlen) +.  
-00007a60: 2020 2020 2020 2831 2069 6620 6c65 6e28        (1 if len(
-00007a70: 6275 6c6b 2920 2520 6f62 6a2e 626f 6479  bulk) % obj.body
-00007a80: 5f6d 6178 6c65 6e20 656c 7365 2030 2929  _maxlen else 0))
-00007a90: 0a0a 2020 2020 666f 7220 6368 756e 6b20  ..    for chunk 
-00007aa0: 696e 2063 6875 6e6b 733a 0a20 2020 2020  in chunks:.     
-00007ab0: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
-00007ac0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-00007ad0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-00007ae0: 7469 746c 6527 2929 203d 3d20 300a 2020  title')) == 0.  
-00007af0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00007b00: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
-00007b10: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
-00007b20: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
-00007b30: 2320 4f75 7220 7469 746c 6520 6973 2065  # Our title is e
-00007b40: 6d70 7479 2065 7665 7279 2074 696d 650a  mpty every time.
-00007b50: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-00007b60: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-00007b70: 2920 3d3d 2027 270a 2020 2020 2020 2020  ) == ''.        
-00007b80: 2320 4f75 7220 626f 6479 2069 7320 6f6e  # Our body is on
-00007b90: 6c79 2062 726f 6b65 6e20 7570 3b20 6e6f  ly broken up; no
-00007ba0: 7420 6c6f 7374 0a20 2020 2020 2020 205f  t lost.        _
-00007bb0: 626f 6479 203d 2063 6875 6e6b 2e67 6574  body = chunk.get
-00007bc0: 2827 626f 6479 2729 0a0a 2020 2020 2020  ('body')..      
-00007bd0: 2020 2320 556e 2d75 7365 6420 7768 6974    # Un-used whit
-00007be0: 6573 7061 6365 2069 7320 616c 7761 7973  espace is always
-00007bf0: 2063 6c65 616e 6564 2075 703b 206d 616b   cleaned up; mak
-00007c00: 6520 7375 7265 2077 6520 6163 636f 756e  e sure we accoun
-00007c10: 7420 666f 720a 2020 2020 2020 2020 2320  t for.        # 
-00007c20: 7468 6973 2069 6e20 6f75 7220 6e65 7720  this in our new 
-00007c30: 6361 6c63 756c 6174 696f 6e0a 2020 2020  calculation.    
-00007c40: 2020 2020 7773 5f64 6966 6620 3d20 6c65      ws_diff = le
-00007c50: 6e28 6275 6c6b 5b6f 6666 7365 743a 206c  n(bulk[offset: l
-00007c60: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00007c70: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
-00007c80: 2020 2020 206c 656e 2862 756c 6b5b 6f66       len(bulk[of
-00007c90: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-00007ca0: 202b 206f 6666 7365 745d 0a20 2020 2020   + offset].     
-00007cb0: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-00007cc0: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-00007cd0: 2729 2e72 7374 7269 7028 2929 0a0a 2020  ').rstrip())..  
-00007ce0: 2020 2020 2020 6173 7365 7274 2062 756c        assert bul
-00007cf0: 6b5b 6f66 6673 6574 3a20 6c65 6e28 5f62  k[offset: len(_b
-00007d00: 6f64 7929 202b 206f 6666 7365 7420 2b20  ody) + offset + 
-00007d10: 7773 5f64 6966 665d 5c0a 2020 2020 2020  ws_diff]\.      
-00007d20: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
-00007d30: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-00007d40: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
-00007d50: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
-00007d60: 3d20 286c 656e 285f 626f 6479 2920 2b20  = (len(_body) + 
-00007d70: 7773 5f64 6966 6629 0a0a 2020 2020 230a  ws_diff)..    #.
-00007d80: 2020 2020 2320 5465 7374 2063 6173 6520      # Test case 
-00007d90: 7768 6572 6520 6f75 7220 7469 746c 655f  where our title_
-00007da0: 6c65 6e20 6973 2073 686f 7274 6572 2074  len is shorter t
-00007db0: 6865 6e20 7468 6520 7661 6c75 650a 2020  hen the value.  
-00007dc0: 2020 2320 7468 6174 2077 6f75 6c64 206f    # that would o
-00007dd0: 7468 6572 7769 7365 2074 7269 6767 6572  therwise trigger
-00007de0: 2074 6865 205b 5858 2f58 585d 2065 6c65   the [XX/XX] ele
-00007df0: 6d65 6e74 730a 2020 2020 230a 0a20 2020  ments.    #..   
-00007e00: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
-00007e10: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
-00007e20: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
-00007e30: 5365 7420 6120 736d 616c 6c20 7469 746c  Set a small titl
-00007e40: 6520 6c65 6e67 7468 0a20 2020 2020 2020  e length.       
-00007e50: 2074 6974 6c65 5f6d 6178 6c65 6e20 3d20   title_maxlen = 
-00007e60: 3130 300a 0a20 2020 2020 2020 2023 2045  100..        # E
-00007e70: 6e66 6f72 6365 2061 2062 6f64 7920 6c65  nforce a body le
-00007e80: 6e67 7468 2e20 4d61 6b65 2073 7572 6520  ngth. Make sure 
-00007e90: 6974 2773 2061 6e20 696e 742e 0a20 2020  it's an int..   
-00007ea0: 2020 2020 2062 6f64 795f 6d61 786c 656e       body_maxlen
-00007eb0: 203d 2069 6e74 2862 6f64 795f 6c65 6e20   = int(body_len 
-00007ec0: 2f20 3429 0a0a 2020 2020 2020 2020 2320  / 4)..        # 
-00007ed0: 5769 7468 2061 6d61 6c67 616d 6174 696f  With amalgamatio
-00007ee0: 6e0a 2020 2020 2020 2020 6f76 6572 666c  n.        overfl
-00007ef0: 6f77 5f61 6d61 6c67 616d 6174 655f 7469  ow_amalgamate_ti
-00007f00: 746c 6520 3d20 5472 7565 0a0a 2020 2020  tle = True..    
-00007f10: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00007f20: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-00007f30: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00007f40: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00007f50: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
-00007f60: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
-00007f70: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
-00007f80: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00007f90: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
-00007fa0: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
-00007fb0: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
-00007fc0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-00007fd0: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
-00007fe0: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
-00007ff0: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
-00008000: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
-00008010: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
-00008020: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
-00008030: 7420 4e6f 6e65 0a0a 2020 2020 2320 5665  t None..    # Ve
-00008040: 7269 6679 2074 6861 7420 7765 2062 7265  rify that we bre
-00008050: 616b 2074 6865 2074 6974 6c65 2074 6f20  ak the title to 
-00008060: 6120 6d61 7820 6c65 6e67 7468 206f 6620  a max length of 
-00008070: 6f75 7220 7469 746c 655f 6d61 780a 2020  our title_max.  
-00008080: 2020 2320 616e 6420 7468 6174 2074 6865    # and that the
-00008090: 2062 6f64 7920 7265 6d61 696e 7320 756e   body remains un
-000080a0: 746f 7563 6865 640a 2020 2020 6368 756e  touched.    chun
-000080b0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-000080c0: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-000080d0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-000080e0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-000080f0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00008100: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
-00008110: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-00008120: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00008130: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-00008140: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-00008150: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-00008160: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-00008170: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-00008180: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-00008190: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-000081a0: 6368 756e 6b73 2920 3d3d 2037 0a20 2020  chunks) == 7.   
-000081b0: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-000081c0: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-000081d0: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-000081e0: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-000081f0: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-00008200: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-00008210: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-00008220: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-00008230: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00008240: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-00008250: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-00008260: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
-00008270: 2020 2023 204f 7572 2074 6974 6c65 2069     # Our title i
-00008280: 7320 7472 756e 6361 7465 6420 616e 6420  s truncated and 
-00008290: 6e6f 2063 6f75 6e74 6572 2061 6464 6564  no counter added
-000082a0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000082b0: 7469 746c 655b 3a6f 626a 2e74 6974 6c65  title[:obj.title
-000082c0: 5f6d 6178 6c65 6e5d 203d 3d20 6368 756e  _maxlen] == chun
-000082d0: 6b2e 6765 7428 2774 6974 6c65 2729 0a0a  k.get('title')..
-000082e0: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
-000082f0: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
-00008300: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
-00008310: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
-00008320: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
-00008330: 0a0a 2020 2020 2020 2020 2320 556e 2d75  ..        # Un-u
-00008340: 7365 6420 7768 6974 6573 7061 6365 2069  sed whitespace i
-00008350: 7320 616c 7761 7973 2063 6c65 616e 6564  s always cleaned
-00008360: 2075 703b 206d 616b 6520 7375 7265 2077   up; make sure w
-00008370: 6520 6163 636f 756e 7420 666f 720a 2020  e account for.  
-00008380: 2020 2020 2020 2320 7468 6973 2069 6e20        # this in 
-00008390: 6f75 7220 6e65 7720 6361 6c63 756c 6174  our new calculat
-000083a0: 696f 6e0a 2020 2020 2020 2020 7773 5f64  ion.        ws_d
-000083b0: 6966 6620 3d20 6c65 6e28 626f 6479 5b6f  iff = len(body[o
-000083c0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-000083d0: 2920 2b20 6f66 6673 6574 5d29 202d 205c  ) + offset]) - \
-000083e0: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-000083f0: 2862 6f64 795b 6f66 6673 6574 3a20 6c65  (body[offset: le
-00008400: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-00008410: 745d 0a20 2020 2020 2020 2020 2020 2020  t].             
-00008420: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
-00008430: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
-00008440: 7028 2929 0a0a 2020 2020 2020 2020 6173  p())..        as
-00008450: 7365 7274 2062 6f64 795b 6f66 6673 6574  sert body[offset
-00008460: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-00008470: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
-00008480: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
-00008490: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-000084a0: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
-000084b0: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
-000084c0: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
-000084d0: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
-000084e0: 0a0a 2020 2020 230a 2020 2020 2320 5363  ..    #.    # Sc
-000084f0: 656e 6172 696f 2077 6865 7265 2074 6865  enario where the
-00008500: 2074 6974 6c65 206c 656e 6774 6820 6973   title length is
-00008510: 206c 6172 6765 7220 7468 616e 2074 6865   larger than the
-00008520: 2062 6f64 790a 2020 2020 230a 0a20 2020   body.    #..   
-00008530: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
-00008540: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
-00008550: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
-00008560: 5365 7420 6120 736d 616c 6c20 7469 746c  Set a small titl
-00008570: 6520 6c65 6e67 7468 0a20 2020 2020 2020  e length.       
-00008580: 2074 6974 6c65 5f6d 6178 6c65 6e20 3d20   title_maxlen = 
-00008590: 3130 300a 0a20 2020 2020 2020 2023 2045  100..        # E
-000085a0: 6e66 6f72 6365 2061 2062 6f64 7920 6c65  nforce a body le
-000085b0: 6e67 7468 2e20 4d61 6b65 2073 7572 6520  ngth. Make sure 
-000085c0: 6974 2773 2061 6e20 696e 742e 0a20 2020  it's an int..   
-000085d0: 2020 2020 2062 6f64 795f 6d61 786c 656e       body_maxlen
-000085e0: 203d 2035 300a 0a20 2020 2020 2020 2023   = 50..        #
-000085f0: 2057 6974 6820 616d 616c 6761 6d61 7469   With amalgamati
-00008600: 6f6e 0a20 2020 2020 2020 206f 7665 7266  on.        overf
-00008610: 6c6f 775f 616d 616c 6761 6d61 7465 5f74  low_amalgamate_t
-00008620: 6974 6c65 203d 2054 7275 650a 0a20 2020  itle = True..   
-00008630: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
-00008640: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
-00008650: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00008660: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-00008670: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
-00008680: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
-00008690: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
-000086a0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-000086b0: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
-000086c0: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
-000086d0: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
-000086e0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-000086f0: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
-00008700: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
-00008710: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-00008720: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
-00008730: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
-00008740: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
-00008750: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
-00008760: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
-00008770: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
-00008780: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
-00008790: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
-000087a0: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
-000087b0: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
-000087c0: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
-000087d0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-000087e0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-000087f0: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
-00008800: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00008810: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00008820: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-00008830: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-00008840: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-00008850: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-00008860: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-00008870: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00008880: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00008890: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
-000088a0: 6529 0a20 2020 206f 6666 7365 7420 3d20  e).    offset = 
-000088b0: 300a 2020 2020 6173 7365 7274 206c 656e  0.    assert len
-000088c0: 2863 6875 6e6b 7329 203d 3d20 3232 0a20  (chunks) == 22. 
-000088d0: 2020 2066 6f72 2069 6478 2c20 6368 756e     for idx, chun
-000088e0: 6b20 696e 2065 6e75 6d65 7261 7465 2863  k in enumerate(c
-000088f0: 6875 6e6b 732c 2073 7461 7274 3d31 293a  hunks, start=1):
-00008900: 0a20 2020 2020 2020 2023 2056 6572 6966  .        # Verif
-00008910: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
-00008920: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-00008930: 2e67 6574 2827 7469 746c 6527 2929 203c  .get('title')) <
-00008940: 3d20 6f62 6a2e 7469 746c 655f 6d61 786c  = obj.title_maxl
-00008950: 656e 0a20 2020 2020 2020 2061 7373 6572  en.        asser
-00008960: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-00008970: 2762 6f64 7927 2929 203c 3d20 6f62 6a2e  'body')) <= obj.
-00008980: 626f 6479 5f6d 6178 6c65 6e0a 0a20 2020  body_maxlen..   
-00008990: 2020 2020 2023 204f 7572 2074 6974 6c65       # Our title
-000089a0: 2068 6173 206e 6f20 636f 756e 7465 7220   has no counter 
-000089b0: 6164 6465 6420 746f 2069 7420 6475 6520  added to it due 
-000089c0: 746f 2069 7427 7320 6c65 6e67 7468 0a20  to it's length. 
-000089d0: 2020 2020 2020 2069 6620 6964 7820 3e20         if idx > 
-000089e0: 313a 0a20 2020 2020 2020 2020 2020 2023  1:.            #
-000089f0: 2045 6d70 7479 2028 6e6f 2074 6974 6c65   Empty (no title
-00008a00: 2064 6973 706c 6179 6564 206f 6e20 666f   displayed on fo
-00008a10: 6c6c 6f77 696e 6720 656e 7472 6965 730a  llowing entries.
-00008a20: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00008a30: 7274 2063 6875 6e6b 2e67 6574 2827 7469  rt chunk.get('ti
-00008a40: 746c 6527 2920 3d3d 2022 220a 2020 2020  tle') == "".    
-00008a50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00008a60: 2020 2020 2020 2320 4265 6361 7573 6520        # Because 
-00008a70: 3135 3020 6973 2077 6861 7420 7765 2073  150 is what we s
-00008a80: 6574 2074 6865 2074 6974 6c65 206c 696d  et the title lim
-00008a90: 6974 2074 6f20 3530 2064 7565 0a20 2020  it to 50 due.   
-00008aa0: 2020 2020 2020 2020 2023 2074 6f20 616d           # to am
-00008ab0: 616c 616d 6174 696f 6e2e 2020 5468 6520  alamation.  The 
-00008ac0: 6c6f 7765 7374 2076 616c 7565 2061 6c77  lowest value alw
-00008ad0: 6179 7320 7072 6576 6169 6c73 0a20 2020  ays prevails.   
-00008ae0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00008af0: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
-00008b00: 6974 6c65 2729 2920 3d3d 206f 626a 2e62  itle')) == obj.b
-00008b10: 6f64 795f 6d61 786c 656e 0a20 2020 2020  ody_maxlen.     
-00008b20: 2020 2020 2020 2061 7373 6572 7420 7469         assert ti
-00008b30: 746c 655b 3a6f 626a 2e62 6f64 795f 6d61  tle[:obj.body_ma
-00008b40: 786c 656e 5d20 3d3d 2063 6875 6e6b 2e67  xlen] == chunk.g
-00008b50: 6574 2827 7469 746c 6527 290a 0a20 2020  et('title')..   
-00008b60: 2020 2020 2023 204f 7572 2062 6f64 7920       # Our body 
-00008b70: 6973 206f 6e6c 7920 6272 6f6b 656e 2075  is only broken u
-00008b80: 703b 206e 6f74 206c 6f73 740a 2020 2020  p; not lost.    
-00008b90: 2020 2020 5f62 6f64 7920 3d20 6368 756e      _body = chun
-00008ba0: 6b2e 6765 7428 2762 6f64 7927 290a 0a20  k.get('body').. 
-00008bb0: 2020 2020 2020 2023 2055 6e2d 7573 6564         # Un-used
-00008bc0: 2077 6869 7465 7370 6163 6520 6973 2061   whitespace is a
-00008bd0: 6c77 6179 7320 636c 6561 6e65 6420 7570  lways cleaned up
-00008be0: 3b20 6d61 6b65 2073 7572 6520 7765 2061  ; make sure we a
-00008bf0: 6363 6f75 6e74 2066 6f72 0a20 2020 2020  ccount for.     
-00008c00: 2020 2023 2074 6869 7320 696e 206f 7572     # this in our
-00008c10: 206e 6577 2063 616c 6375 6c61 7469 6f6e   new calculation
-00008c20: 0a20 2020 2020 2020 2077 735f 6469 6666  .        ws_diff
-00008c30: 203d 206c 656e 2862 6f64 795b 6f66 6673   = len(body[offs
-00008c40: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
-00008c50: 206f 6666 7365 745d 2920 2d20 5c0a 2020   offset]) - \.  
-00008c60: 2020 2020 2020 2020 2020 6c65 6e28 626f            len(bo
-00008c70: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
-00008c80: 626f 6479 2920 2b20 6f66 6673 6574 5d0a  body) + offset].
-00008c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ca0: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
-00008cb0: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
-00008cc0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
-00008cd0: 7420 626f 6479 5b6f 6666 7365 743a 206c  t body[offset: l
-00008ce0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00008cf0: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
-00008d00: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-00008d10: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-00008d20: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
-00008d30: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
-00008d40: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
-00008d50: 7929 202b 2077 735f 6469 6666 290a 0a0a  y) + ws_diff)...
-00008d60: 6465 6620 7465 7374 5f6e 6f74 6966 795f  def test_notify_
-00008d70: 6f76 6572 666c 6f77 5f73 706c 6974 5f77  overflow_split_w
-00008d80: 6974 685f 616d 616c 6761 6d61 7469 6f6e  ith_amalgamation
-00008d90: 5f66 6f72 6365 5f74 6974 6c65 5f61 6c77  _force_title_alw
-00008da0: 6179 7328 293a 0a20 2020 2022 2222 0a20  ays():.    """. 
-00008db0: 2020 2041 5049 3a20 4f76 6572 666c 6f77     API: Overflow
-00008dc0: 2057 6974 6820 416d 616c 6761 6d61 7469   With Amalgamati
-00008dd0: 6f6e 2028 7469 746c 6520 616c 6177 6179  on (title alaway
-00008de0: 7320 5370 6c69 7420 4675 6e63 7469 6f6e  s Split Function
-00008df0: 616c 6974 7920 5465 7374 696e 670a 0a20  ality Testing.. 
-00008e00: 2020 2022 2222 0a0a 2020 2020 230a 2020     """..    #.  
-00008e10: 2020 2320 4120 6c69 7474 6c65 2070 7265    # A little pre
-00008e20: 7061 7261 7469 6f6e 0a20 2020 2023 0a0a  paration.    #..
-00008e30: 2020 2020 2320 4e75 6d62 6572 206f 6620      # Number of 
-00008e40: 6368 6172 6163 7465 7273 2070 6572 206c  characters per l
-00008e50: 696e 650a 2020 2020 726f 7720 3d20 3234  ine.    row = 24
-00008e60: 0a0a 2020 2020 2320 536f 6d65 2076 6172  ..    # Some var
-00008e70: 6961 626c 6573 2077 6520 7573 6520 746f  iables we use to
-00008e80: 2063 6f6e 7472 6f6c 2074 6865 2064 6174   control the dat
-00008e90: 6120 7765 2077 6f72 6b20 7769 7468 0a20  a we work with. 
-00008ea0: 2020 2062 6f64 795f 6c65 6e20 3d20 3130     body_len = 10
-00008eb0: 3234 0a20 2020 2074 6974 6c65 5f6c 656e  24.    title_len
-00008ec0: 203d 2031 3032 340a 0a20 2020 2023 2043   = 1024..    # C
-00008ed0: 7265 6174 6520 6120 6c61 7267 6520 626f  reate a large bo
-00008ee0: 6479 2061 6e64 2074 6974 6c65 2077 6974  dy and title wit
-00008ef0: 6820 7261 6e64 6f6d 2064 6174 610a 2020  h random data.  
-00008f00: 2020 626f 6479 203d 2027 272e 6a6f 696e    body = ''.join
-00008f10: 2863 686f 6963 6528 7374 725f 616c 7068  (choice(str_alph
-00008f20: 6120 2b20 7374 725f 6e75 6d29 2066 6f72  a + str_num) for
-00008f30: 205f 2069 6e20 7261 6e67 6528 626f 6479   _ in range(body
-00008f40: 5f6c 656e 2929 0a20 2020 2062 6f64 7920  _len)).    body 
-00008f50: 3d20 275c 725c 6e27 2e6a 6f69 6e28 5b62  = '\r\n'.join([b
-00008f60: 6f64 795b 693a 2069 202b 2072 6f77 5d20  ody[i: i + row] 
-00008f70: 666f 7220 6920 696e 2072 616e 6765 2830  for i in range(0
-00008f80: 2c20 6c65 6e28 626f 6479 292c 2072 6f77  , len(body), row
-00008f90: 295d 290a 0a20 2020 2023 2074 6865 206e  )])..    # the n
-00008fa0: 6577 206c 696e 6573 2061 6464 2061 206c  ew lines add a l
-00008fb0: 6172 6765 2061 6d6f 756e 7420 746f 206f  arge amount to o
-00008fc0: 7572 2062 6f64 793b 206c 6574 7320 666f  ur body; lets fo
-00008fd0: 7263 6520 7468 6520 636f 6e74 656e 740a  rce the content.
-00008fe0: 2020 2020 2320 6261 636b 2074 6f20 6265      # back to be
-00008ff0: 696e 6720 3130 3234 2063 6861 7261 6374  ing 1024 charact
-00009000: 6572 732e 0a20 2020 2062 6f64 7920 3d20  ers..    body = 
-00009010: 626f 6479 5b30 3a31 3032 345d 0a0a 2020  body[0:1024]..  
-00009020: 2020 2320 4372 6561 7465 206f 7572 2074    # Create our t
-00009030: 6974 6c65 2075 7369 6e67 2072 616e 646f  itle using rando
-00009040: 6d20 6461 7461 0a20 2020 2074 6974 6c65  m data.    title
-00009050: 203d 2027 272e 6a6f 696e 2863 686f 6963   = ''.join(choic
-00009060: 6528 7374 725f 616c 7068 6120 2b20 7374  e(str_alpha + st
-00009070: 725f 6e75 6d29 2066 6f72 205f 2069 6e20  r_num) for _ in 
-00009080: 7261 6e67 6528 7469 746c 655f 6c65 6e29  range(title_len)
-00009090: 290a 0a20 2020 2023 0a20 2020 2023 2046  )..    #.    # F
-000090a0: 6972 7374 2054 6573 743a 2054 7275 6e63  irst Test: Trunc
-000090b0: 6174 6564 2054 6974 6c65 0a20 2020 2023  ated Title.    #
-000090c0: 0a20 2020 2063 6c61 7373 2054 6573 744e  .    class TestN
-000090d0: 6f74 6966 6963 6174 696f 6e28 4e6f 7469  otification(Noti
-000090e0: 6679 4261 7365 293a 0a0a 2020 2020 2020  fyBase):..      
-000090f0: 2020 2320 5465 7374 2074 6974 6c65 206d    # Test title m
-00009100: 6178 206c 656e 6774 680a 2020 2020 2020  ax length.      
-00009110: 2020 7469 746c 655f 6d61 786c 656e 203d    title_maxlen =
-00009120: 2031 300a 0a20 2020 2020 2020 2023 2057   10..        # W
-00009130: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-00009140: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-00009150: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-00009160: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-00009170: 2020 2023 2046 6f72 6365 2074 6974 6c65     # Force title
-00009180: 2074 6f20 6265 2064 6973 706c 6179 6564   to be displayed
-00009190: 2061 6c77 6179 730a 2020 2020 2020 2020   always.        
-000091a0: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
-000091b0: 5f74 6974 6c65 5f6f 6e63 6520 3d20 4661  _title_once = Fa
-000091c0: 6c73 650a 0a20 2020 2020 2020 2064 6566  lse..        def
-000091d0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-000091e0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-000091f0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
-00009200: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
-00009210: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-00009220: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
-00009230: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00009240: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-00009250: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
-00009260: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
-00009270: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009280: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
-00009290: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
-000092a0: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
-000092b0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
-000092c0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
-000092d0: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
-000092e0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
-000092f0: 0a20 2020 2023 2056 6572 6966 7920 7468  .    # Verify th
-00009300: 6174 2077 6520 6272 6561 6b20 7468 6520  at we break the 
-00009310: 7469 746c 6520 746f 2061 206d 6178 206c  title to a max l
-00009320: 656e 6774 6820 6f66 206f 7572 2074 6974  ength of our tit
-00009330: 6c65 5f6d 6178 0a20 2020 2023 2061 6e64  le_max.    # and
-00009340: 2074 6861 7420 7468 6520 626f 6479 2072   that the body r
-00009350: 656d 6169 6e73 2075 6e74 6f75 6368 6564  emains untouched
-00009360: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00009370: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00009380: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00009390: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
-000093a0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-000093b0: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-000093c0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-000093d0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-000093e0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-000093f0: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
-00009400: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00009410: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00009420: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-00009430: 746c 653d 7469 746c 6529 0a20 2020 2061  tle=title).    a
-00009440: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
-00009450: 2920 3d3d 2031 0a20 2020 2061 7373 6572  ) == 1.    asser
-00009460: 7420 626f 6479 2e6c 7374 7269 7028 275c  t body.lstrip('\
-00009470: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-00009480: 7472 6970 2829 203d 3d20 6368 756e 6b73  trip() == chunks
-00009490: 5b30 5d2e 6765 7428 2762 6f64 7927 290a  [0].get('body').
-000094a0: 2020 2020 6173 7365 7274 2074 6974 6c65      assert title
-000094b0: 5b30 3a6f 626a 2e74 6974 6c65 5f6d 6178  [0:obj.title_max
-000094c0: 6c65 6e5d 203d 3d20 6368 756e 6b73 5b30  len] == chunks[0
-000094d0: 5d2e 6765 7428 2774 6974 6c65 2729 0a0a  ].get('title')..
-000094e0: 2020 2020 230a 2020 2020 2320 4e65 7874      #.    # Next
-000094f0: 2054 6573 743a 204c 696e 6520 436f 756e   Test: Line Coun
-00009500: 7420 436f 6e74 726f 6c0a 2020 2020 230a  t Control.    #.
-00009510: 0a20 2020 2063 6c61 7373 2054 6573 744e  .    class TestN
-00009520: 6f74 6966 6963 6174 696f 6e28 4e6f 7469  otification(Noti
-00009530: 6679 4261 7365 293a 0a0a 2020 2020 2020  fyBase):..      
-00009540: 2020 2320 5465 7374 2074 6974 6c65 206d    # Test title m
-00009550: 6178 206c 656e 6774 680a 2020 2020 2020  ax length.      
-00009560: 2020 7469 746c 655f 6d61 786c 656e 203d    title_maxlen =
-00009570: 2035 0a0a 2020 2020 2020 2020 2320 4d61   5..        # Ma
-00009580: 7869 6d75 6d20 6e75 6d62 6572 206f 6620  ximum number of 
-00009590: 6c69 6e65 730a 2020 2020 2020 2020 626f  lines.        bo
-000095a0: 6479 5f6d 6178 5f6c 696e 655f 636f 756e  dy_max_line_coun
-000095b0: 7420 3d20 350a 0a20 2020 2020 2020 2023  t = 5..        #
-000095c0: 2057 6974 6820 616d 616c 6761 6d61 7469   With amalgamati
-000095d0: 6f6e 0a20 2020 2020 2020 206f 7665 7266  on.        overf
-000095e0: 6c6f 775f 616d 616c 6761 6d61 7465 5f74  low_amalgamate_t
-000095f0: 6974 6c65 203d 2054 7275 650a 0a20 2020  itle = True..   
-00009600: 2020 2020 2023 2046 6f72 6365 2074 6974       # Force tit
-00009610: 6c65 2074 6f20 6265 2064 6973 706c 6179  le to be display
-00009620: 6564 2061 6c77 6179 730a 2020 2020 2020  ed always.      
-00009630: 2020 6f76 6572 666c 6f77 5f64 6973 706c    overflow_displ
-00009640: 6179 5f74 6974 6c65 5f6f 6e63 6520 3d20  ay_title_once = 
-00009650: 4661 6c73 650a 0a20 2020 2020 2020 2064  False..        d
-00009660: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00009670: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00009680: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00009690: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
-000096a0: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
-000096b0: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
-000096c0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-000096d0: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-000096e0: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
-000096f0: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
-00009700: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00009710: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
-00009720: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
-00009730: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
-00009740: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
-00009750: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
-00009760: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
-00009770: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
-00009780: 650a 0a20 2020 2023 2056 6572 6966 7920  e..    # Verify 
-00009790: 7468 6174 2077 6520 6272 6561 6b20 7468  that we break th
-000097a0: 6520 7469 746c 6520 746f 2061 206d 6178  e title to a max
-000097b0: 206c 656e 6774 6820 6f66 206f 7572 2074   length of our t
-000097c0: 6974 6c65 5f6d 6178 0a20 2020 2023 2061  itle_max.    # a
-000097d0: 6e64 2074 6861 7420 7468 6520 626f 6479  nd that the body
-000097e0: 2072 656d 6169 6e73 2075 6e74 6f75 6368   remains untouch
-000097f0: 6564 0a20 2020 2063 6875 6e6b 7320 3d20  ed.    chunks = 
-00009800: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00009810: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00009820: 6c65 3d74 6974 6c65 290a 2020 2020 6368  le=title).    ch
-00009830: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00009840: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00009850: 2222 2c20 7469 746c 653d 2222 290a 2020  "", title="").  
-00009860: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00009870: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00009880: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
-00009890: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-000098a0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-000098b0: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-000098c0: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
-000098d0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-000098e0: 6b73 2920 3d3d 2031 0a20 2020 2061 7373  ks) == 1.    ass
-000098f0: 6572 7420 6c65 6e28 6368 756e 6b73 5b30  ert len(chunks[0
-00009900: 5d2e 6765 7428 2762 6f64 7927 292e 7370  ].get('body').sp
-00009910: 6c69 7428 275c 6e27 2929 203d 3d20 6f62  lit('\n')) == ob
-00009920: 6a2e 626f 6479 5f6d 6178 5f6c 696e 655f  j.body_max_line_
-00009930: 636f 756e 740a 2020 2020 6173 7365 7274  count.    assert
-00009940: 2074 6974 6c65 5b30 3a6f 626a 2e74 6974   title[0:obj.tit
-00009950: 6c65 5f6d 6178 6c65 6e5d 203d 3d20 6368  le_maxlen] == ch
-00009960: 756e 6b73 5b30 5d2e 6765 7428 2774 6974  unks[0].get('tit
-00009970: 6c65 2729 0a0a 2020 2020 230a 2020 2020  le')..    #.    
-00009980: 2320 4e65 7874 2054 6573 743a 2053 706c  # Next Test: Spl
-00009990: 6974 2062 6f64 790a 2020 2020 230a 0a20  it body.    #.. 
-000099a0: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
-000099b0: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
-000099c0: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
-000099d0: 2320 5465 7374 2074 6974 6c65 206d 6178  # Test title max
-000099e0: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
-000099f0: 7469 746c 655f 6d61 786c 656e 203d 2074  title_maxlen = t
-00009a00: 6974 6c65 5f6c 656e 0a0a 2020 2020 2020  itle_len..      
-00009a10: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
-00009a20: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
-00009a30: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
-00009a40: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
-00009a50: 6178 6c65 6e20 3d20 696e 7428 626f 6479  axlen = int(body
-00009a60: 5f6c 656e 202f 2034 290a 0a20 2020 2020  _len / 4)..     
-00009a70: 2020 2023 2057 6974 6820 616d 616c 6761     # With amalga
-00009a80: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
-00009a90: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
-00009aa0: 7465 5f74 6974 6c65 203d 2054 7275 650a  te_title = True.
-00009ab0: 0a20 2020 2020 2020 2023 2046 6f72 6365  .        # Force
-00009ac0: 2074 6974 6c65 2074 6f20 6265 2064 6973   title to be dis
-00009ad0: 706c 6179 6564 2061 6c77 6179 730a 2020  played always.  
-00009ae0: 2020 2020 2020 6f76 6572 666c 6f77 5f64        overflow_d
-00009af0: 6973 706c 6179 5f74 6974 6c65 5f6f 6e63  isplay_title_onc
-00009b00: 6520 3d20 4661 6c73 650a 0a20 2020 2020  e = False..     
-00009b10: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00009b20: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00009b30: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00009b40: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00009b50: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-00009b60: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-00009b70: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-00009b80: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00009b90: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-00009ba0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-00009bb0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-00009bc0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00009bd0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-00009be0: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-00009bf0: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-00009c00: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-00009c10: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
-00009c20: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-00009c30: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-00009c40: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-00009c50: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-00009c60: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-00009c70: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-00009c80: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-00009c90: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-00009ca0: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-00009cb0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00009cc0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00009cd0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00009ce0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00009cf0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00009d00: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00009d10: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00009d20: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00009d30: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-00009d40: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00009d50: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00009d60: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-00009d70: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-00009d80: 0a20 2020 206f 6666 7365 7420 3d20 300a  .    offset = 0.
-00009d90: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-00009da0: 6875 6e6b 7329 203d 3d20 350a 2020 2020  hunks) == 5.    
-00009db0: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-00009dc0: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-00009dd0: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-00009de0: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-00009df0: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-00009e00: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-00009e10: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-00009e20: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-00009e30: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00009e40: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-00009e50: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-00009e60: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-00009e70: 2020 2320 4e6f 2063 6f75 6e74 6572 2069    # No counter i
-00009e80: 7320 6469 7370 6c61 7965 6420 6265 6361  s displayed beca
-00009e90: 7573 6520 6f75 7220 7469 746c 6520 6973  use our title is
-00009ea0: 2073 6f20 656e 6f72 6d6f 7573 0a20 2020   so enormous.   
-00009eb0: 2020 2020 2023 2057 6520 7377 6974 6368       # We switch
-00009ec0: 2074 6f20 6120 6469 7370 6c61 7920 7469   to a display ti
-00009ed0: 746c 6520 6f6e 2066 6972 7374 206d 6573  tle on first mes
-00009ee0: 7361 6765 206f 6e6c 790a 2020 2020 2020  sage only.      
-00009ef0: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-00009f00: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-00009f10: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-00009f20: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-00009f30: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-00009f40: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-00009f50: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-00009f60: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-00009f70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00009f80: 2023 2054 6865 206c 656e 6774 6820 6f66   # The length of
-00009f90: 2074 6865 2062 6f64 7920 7072 6576 6169   the body prevai
-00009fa0: 6c73 206f 7572 2074 6974 6c65 2064 7565  ls our title due
-00009fb0: 2074 6f20 6974 2062 6569 6e67 0a20 2020   to it being.   
-00009fc0: 2020 2020 2020 2020 2023 2073 6f20 6d75           # so mu
-00009fd0: 6368 2073 6d61 6c6c 6572 2074 6865 6e20  ch smaller then 
-00009fe0: 6f75 7220 7469 746c 6520 6c65 6e67 7468  our title length
-00009ff0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-0000a000: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0000a010: 7428 2774 6974 6c65 2729 2920 3d3d 206f  t('title')) == o
-0000a020: 626a 2e62 6f64 795f 6d61 786c 656e 0a20  bj.body_maxlen. 
-0000a030: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-0000a040: 7420 7469 746c 655b 3a6f 626a 2e62 6f64  t title[:obj.bod
-0000a050: 795f 6d61 786c 656e 5d20 3d3d 2063 6875  y_maxlen] == chu
-0000a060: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
-0000a070: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
-0000a080: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
-0000a090: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
-0000a0a0: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
-0000a0b0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0000a0c0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0000a0d0: 2062 6f64 795b 6f66 6673 6574 3a20 6c65   body[offset: le
-0000a0e0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0000a0f0: 745d 5c0a 2020 2020 2020 2020 2020 2020  t]\.            
-0000a100: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
-0000a110: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
-0000a120: 203d 3d20 5f62 6f64 790a 2020 2020 2020   == _body.      
-0000a130: 2020 6f66 6673 6574 202b 3d20 6c65 6e28    offset += len(
-0000a140: 5f62 6f64 7929 0a0a 2020 2020 2320 416e  _body)..    # An
-0000a150: 6f74 6865 7220 6564 6765 2063 6173 6520  other edge case 
-0000a160: 7768 6572 6520 7468 6520 7469 746c 6520  where the title 
-0000a170: 6a75 7374 2069 736e 2774 2074 6861 7420  just isn't that 
-0000a180: 6c6f 6e67 206c 6561 7669 6e67 0a20 2020  long leaving.   
-0000a190: 2023 2061 206c 6f74 206f 6620 7370 6163   # a lot of spac
-0000a1a0: 6520 666f 7220 7468 6520 5b78 782f 7878  e for the [xx/xx
-0000a1b0: 5d20 656e 7472 6965 7320 286e 6f20 7472  ] entries (no tr
-0000a1c0: 756e 6361 7469 6f6e 206e 6565 6465 6429  uncation needed)
-0000a1d0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-0000a1e0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-0000a1f0: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-0000a200: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
-0000a210: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0000a220: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-0000a230: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-0000a240: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000a250: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000a260: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
-0000a270: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0000a280: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0000a290: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-0000a2a0: 746c 653d 7469 746c 655b 3a32 305d 290a  tle=title[:20]).
-0000a2b0: 2020 2020 6f66 6673 6574 203d 2030 0a20      offset = 0. 
-0000a2c0: 2020 2063 5f6c 656e 203d 206c 656e 2827     c_len = len('
-0000a2d0: 205b 582f 585d 2729 0a20 2020 2061 7373   [X/X]').    ass
-0000a2e0: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
-0000a2f0: 3d3d 2035 0a20 2020 2066 6f72 2069 6478  == 5.    for idx
-0000a300: 2c20 6368 756e 6b20 696e 2065 6e75 6d65  , chunk in enume
-0000a310: 7261 7465 2863 6875 6e6b 732c 2073 7461  rate(chunks, sta
-0000a320: 7274 3d31 293a 0a20 2020 2020 2020 2023  rt=1):.        #
-0000a330: 2056 6572 6966 6963 6174 696f 6e0a 2020   Verification.  
-0000a340: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-0000a350: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
-0000a360: 6527 2929 203c 3d20 6f62 6a2e 7469 746c  e')) <= obj.titl
-0000a370: 655f 6d61 786c 656e 0a20 2020 2020 2020  e_maxlen.       
-0000a380: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-0000a390: 6b2e 6765 7428 2762 6f64 7927 2929 203c  k.get('body')) <
-0000a3a0: 3d20 6f62 6a2e 626f 6479 5f6d 6178 6c65  = obj.body_maxle
-0000a3b0: 6e0a 0a20 2020 2020 2020 2023 204f 7572  n..        # Our
-0000a3c0: 2074 6974 6c65 2068 6173 2061 2063 6f75   title has a cou
-0000a3d0: 6e74 6572 2061 6464 6564 2074 6f20 6974  nter added to it
-0000a3e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000a3f0: 7469 746c 655b 3a32 305d 203d 3d20 6368  title[:20] == ch
-0000a400: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0000a410: 5b3a 2d63 5f6c 656e 5d0a 2020 2020 2020  [:-c_len].      
-0000a420: 2020 6173 7365 7274 2063 6875 6e6b 2e67    assert chunk.g
-0000a430: 6574 2827 7469 746c 6527 295b 2d63 5f6c  et('title')[-c_l
-0000a440: 656e 3a5d 203d 3d20 5c0a 2020 2020 2020  en:] == \.      
-0000a450: 2020 2020 2020 2720 5b7b 3a30 317d 2f7b        ' [{:01}/{
-0000a460: 3a30 317d 5d27 2e66 6f72 6d61 7428 6964  :01}]'.format(id
-0000a470: 782c 206c 656e 2863 6875 6e6b 7329 290a  x, len(chunks)).
-0000a480: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
-0000a490: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
-0000a4a0: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
-0000a4b0: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
-0000a4c0: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
-0000a4d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000a4e0: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
-0000a4f0: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-0000a500: 5d5c 0a20 2020 2020 2020 2020 2020 202e  ]\.            .
-0000a510: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-0000a520: 5c78 3063 2729 2e72 7374 7269 7028 2920  \x0c').rstrip() 
-0000a530: 3d3d 205f 626f 6479 0a20 2020 2020 2020  == _body.       
-0000a540: 206f 6666 7365 7420 2b3d 206c 656e 285f   offset += len(_
-0000a550: 626f 6479 290a 0a20 2020 2023 0a20 2020  body)..    #.   
-0000a560: 2023 2054 6573 7420 666f 7263 696e 6720   # Test forcing 
-0000a570: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
-0000a580: 5f74 6974 6c65 5f6f 6e63 650a 2020 2020  _title_once.    
-0000a590: 230a 2020 2020 636c 6173 7320 5465 7374  #.    class Test
-0000a5a0: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
-0000a5b0: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
-0000a5c0: 2020 2023 2054 6573 7420 7469 746c 6520     # Test title 
-0000a5d0: 6d61 7820 6c65 6e67 7468 0a20 2020 2020  max length.     
-0000a5e0: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
-0000a5f0: 3d20 7469 746c 655f 6c65 6e0a 0a20 2020  = title_len..   
-0000a600: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
-0000a610: 2062 6f64 7920 6c65 6e67 7468 2e20 4d61   body length. Ma
-0000a620: 6b65 2073 7572 6520 6974 2773 2061 6e20  ke sure it's an 
-0000a630: 696e 742e 0a20 2020 2020 2020 2062 6f64  int..        bod
-0000a640: 795f 6d61 786c 656e 203d 2069 6e74 2862  y_maxlen = int(b
-0000a650: 6f64 795f 6c65 6e20 2f20 3429 0a0a 2020  ody_len / 4)..  
-0000a660: 2020 2020 2020 2320 5769 7468 2061 6d61        # With ama
-0000a670: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
-0000a680: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
-0000a690: 616d 6174 655f 7469 746c 6520 3d20 5472  amate_title = Tr
-0000a6a0: 7565 0a0a 2020 2020 2020 2020 2320 466f  ue..        # Fo
-0000a6b0: 7263 6520 7469 746c 6520 746f 2062 6520  rce title to be 
-0000a6c0: 6469 7370 6c61 7965 6420 616c 7761 7973  displayed always
-0000a6d0: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-0000a6e0: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
-0000a6f0: 6f6e 6365 203d 2046 616c 7365 0a0a 2020  once = False..  
-0000a700: 2020 2020 2020 6465 6620 5f5f 696e 6974        def __init
-0000a710: 5f5f 2873 656c 662c 202a 6172 6773 2c20  __(self, *args, 
-0000a720: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0000a730: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
-0000a740: 5f69 6e69 745f 5f28 2a2a 6b77 6172 6773  _init__(**kwargs
-0000a750: 290a 0a20 2020 2020 2020 2064 6566 206e  )..        def n
-0000a760: 6f74 6966 7928 7365 6c66 2c20 2a61 7267  otify(self, *arg
-0000a770: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-0000a780: 2020 2020 2020 2020 2020 2320 5072 6574            # Pret
-0000a790: 656e 6420 6576 6572 7974 6869 6e67 2069  end everything i
-0000a7a0: 7320 6f6b 6179 0a20 2020 2020 2020 2020  s okay.         
-0000a7b0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-0000a7c0: 2020 2020 2320 4c6f 6164 206f 7572 206f      # Load our o
-0000a7d0: 626a 6563 740a 2020 2020 6f62 6a20 3d20  bject.    obj = 
-0000a7e0: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
-0000a7f0: 286f 7665 7266 6c6f 773d 4f76 6572 666c  (overflow=Overfl
-0000a800: 6f77 4d6f 6465 2e53 504c 4954 290a 2020  owMode.SPLIT).  
-0000a810: 2020 6173 7365 7274 206f 626a 2069 7320    assert obj is 
-0000a820: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 6368  not None..    ch
-0000a830: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-0000a840: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-0000a850: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
-0000a860: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-0000a870: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-0000a880: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-0000a890: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-0000a8a0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-0000a8b0: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-0000a8c0: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-0000a8d0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-0000a8e0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-0000a8f0: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
-0000a900: 6c65 290a 2020 2020 6f66 6673 6574 203d  le).    offset =
-0000a910: 2030 0a20 2020 2061 7373 6572 7420 6c65   0.    assert le
-0000a920: 6e28 6368 756e 6b73 2920 3d3d 2035 0a20  n(chunks) == 5. 
-0000a930: 2020 2066 6f72 2069 6478 2c20 6368 756e     for idx, chun
-0000a940: 6b20 696e 2065 6e75 6d65 7261 7465 2863  k in enumerate(c
-0000a950: 6875 6e6b 732c 2073 7461 7274 3d31 293a  hunks, start=1):
-0000a960: 0a20 2020 2020 2020 2023 2056 6572 6966  .        # Verif
-0000a970: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
-0000a980: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-0000a990: 2e67 6574 2827 7469 746c 6527 2929 203c  .get('title')) <
-0000a9a0: 3d20 6f62 6a2e 7469 746c 655f 6d61 786c  = obj.title_maxl
-0000a9b0: 656e 0a20 2020 2020 2020 2061 7373 6572  en.        asser
-0000a9c0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-0000a9d0: 2762 6f64 7927 2929 203c 3d20 6f62 6a2e  'body')) <= obj.
-0000a9e0: 626f 6479 5f6d 6178 6c65 6e0a 0a20 2020  body_maxlen..   
-0000a9f0: 2020 2020 2023 204f 7572 2074 6974 6c65       # Our title
-0000aa00: 2068 6173 206e 6f20 636f 756e 7465 7220   has no counter 
-0000aa10: 6164 6465 6420 746f 2069 740a 2020 2020  added to it.    
-0000aa20: 2020 2020 6966 2069 6478 203e 2031 3a0a      if idx > 1:.
-0000aa30: 2020 2020 2020 2020 2020 2020 2320 456d              # Em
-0000aa40: 7074 7920 286e 6f20 7469 746c 6520 6469  pty (no title di
-0000aa50: 7370 6c61 7965 6420 6f6e 2066 6f6c 6c6f  splayed on follo
-0000aa60: 7769 6e67 2065 6e74 7269 6573 0a20 2020  wing entries.   
-0000aa70: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-0000aa80: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-0000aa90: 2729 203d 3d20 2222 0a20 2020 2020 2020  ') == "".       
-0000aaa0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000aab0: 2020 2023 2054 6865 2062 6f64 7920 6c65     # The body le
-0000aac0: 6e67 7468 2070 7265 7661 696c 7320 6475  ngth prevails du
-0000aad0: 6520 746f 206f 7572 2061 6d61 6c67 616d  e to our amalgam
-0000aae0: 6174 696f 6e20 666c 6167 0a20 2020 2020  ation flag.     
-0000aaf0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0000ab00: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
-0000ab10: 6c65 2729 2920 3d3d 206f 626a 2e62 6f64  le')) == obj.bod
-0000ab20: 795f 6d61 786c 656e 0a20 2020 2020 2020  y_maxlen.       
-0000ab30: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
-0000ab40: 655b 3a6f 626a 2e62 6f64 795f 6d61 786c  e[:obj.body_maxl
-0000ab50: 656e 5d20 3d3d 2063 6875 6e6b 2e67 6574  en] == chunk.get
-0000ab60: 2827 7469 746c 6527 290a 0a20 2020 2020  ('title')..     
-0000ab70: 2020 2023 204f 7572 2062 6f64 7920 6973     # Our body is
-0000ab80: 206f 6e6c 7920 6272 6f6b 656e 2075 703b   only broken up;
-0000ab90: 206e 6f74 206c 6f73 740a 2020 2020 2020   not lost.      
-0000aba0: 2020 5f62 6f64 7920 3d20 6368 756e 6b2e    _body = chunk.
-0000abb0: 6765 7428 2762 6f64 7927 290a 2020 2020  get('body').    
-0000abc0: 2020 2020 6173 7365 7274 2062 6f64 795b      assert body[
-0000abd0: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-0000abe0: 7929 202b 206f 6666 7365 745d 5c0a 2020  y) + offset]\.  
-0000abf0: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-0000ac00: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-0000ac10: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
-0000ac20: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
-0000ac30: 6574 202b 3d20 6c65 6e28 5f62 6f64 7929  et += len(_body)
-0000ac40: 0a0a 2020 2020 2320 5465 7374 206c 6172  ..    # Test lar
-0000ac50: 6765 7220 6d65 7373 6167 6573 0a20 2020  ger messages.   
-0000ac60: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-0000ac70: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-0000ac80: 6f75 6368 6564 0a20 2020 2063 6c61 7373  ouched.    class
-0000ac90: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-0000aca0: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
-0000acb0: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
-0000acc0: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
-0000acd0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
-0000ace0: 786c 656e 203d 2031 3530 0a0a 2020 2020  xlen = 150..    
-0000acf0: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
-0000ad00: 626f 6479 206c 656e 6774 682e 204d 616b  body length. Mak
-0000ad10: 6520 7375 7265 2069 7427 7320 616e 2069  e sure it's an i
-0000ad20: 6e74 2e0a 2020 2020 2020 2020 626f 6479  nt..        body
-0000ad30: 5f6d 6178 6c65 6e20 3d20 3430 300a 0a20  _maxlen = 400.. 
-0000ad40: 2020 2020 2020 2023 2057 6974 6820 616d         # With am
-0000ad50: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
-0000ad60: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
-0000ad70: 6761 6d61 7465 5f74 6974 6c65 203d 2054  gamate_title = T
-0000ad80: 7275 650a 0a20 2020 2020 2020 2023 2046  rue..        # F
-0000ad90: 6f72 6365 2074 6974 6c65 2074 6f20 6265  orce title to be
-0000ada0: 2064 6973 706c 6179 6564 2061 6c77 6179   displayed alway
-0000adb0: 730a 2020 2020 2020 2020 6f76 6572 666c  s.        overfl
-0000adc0: 6f77 5f64 6973 706c 6179 5f74 6974 6c65  ow_display_title
-0000add0: 5f6f 6e63 6520 3d20 4661 6c73 650a 0a20  _once = False.. 
-0000ade0: 2020 2020 2020 2064 6566 205f 5f69 6e69         def __ini
-0000adf0: 745f 5f28 7365 6c66 2c20 2a61 7267 732c  t__(self, *args,
-0000ae00: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0000ae10: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-0000ae20: 5f5f 696e 6974 5f5f 282a 2a6b 7761 7267  __init__(**kwarg
-0000ae30: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
-0000ae40: 6e6f 7469 6679 2873 656c 662c 202a 6172  notify(self, *ar
-0000ae50: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-0000ae60: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
-0000ae70: 7465 6e64 2065 7665 7279 7468 696e 6720  tend everything 
-0000ae80: 6973 206f 6b61 790a 2020 2020 2020 2020  is okay.        
-0000ae90: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-0000aea0: 0a20 2020 2023 204c 6f61 6420 6f75 7220  .    # Load our 
-0000aeb0: 6f62 6a65 6374 0a20 2020 206f 626a 203d  object.    obj =
-0000aec0: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-0000aed0: 6e28 6f76 6572 666c 6f77 3d4f 7665 7266  n(overflow=Overf
-0000aee0: 6c6f 774d 6f64 652e 5350 4c49 5429 0a20  lowMode.SPLIT). 
-0000aef0: 2020 2061 7373 6572 7420 6f62 6a20 6973     assert obj is
-0000af00: 206e 6f74 204e 6f6e 650a 0a20 2020 206e   not None..    n
-0000af10: 6577 5f62 6f64 7920 3d20 2862 6f64 7920  ew_body = (body 
-0000af20: 2a20 3530 3029 0a20 2020 2063 6875 6e6b  * 500).    chunk
-0000af30: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0000af40: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-0000af50: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-0000af60: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-0000af70: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-0000af80: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-0000af90: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0000afa0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0000afb0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
-0000afc0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-0000afd0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000afe0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000aff0: 793d 6e65 775f 626f 6479 2c20 7469 746c  y=new_body, titl
-0000b000: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
-0000b010: 7365 7420 3d20 300a 2020 2020 635f 6c65  set = 0.    c_le
-0000b020: 6e20 3d20 6c65 6e28 2720 5b58 5858 582f  n = len(' [XXXX/
-0000b030: 5858 5858 5d27 290a 2020 2020 6173 7365  XXXX]').    asse
-0000b040: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-0000b050: 3d20 3230 3438 0a20 2020 2066 6f72 2069  = 2048.    for i
-0000b060: 6478 2c20 6368 756e 6b20 696e 2065 6e75  dx, chunk in enu
-0000b070: 6d65 7261 7465 2863 6875 6e6b 732c 2073  merate(chunks, s
-0000b080: 7461 7274 3d31 293a 0a20 2020 2020 2020  tart=1):.       
-0000b090: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
-0000b0a0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0000b0b0: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
-0000b0c0: 746c 6527 2929 203c 3d20 6f62 6a2e 7469  tle')) <= obj.ti
-0000b0d0: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
-0000b0e0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-0000b0f0: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
-0000b100: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
-0000b110: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
-0000b120: 7572 2074 6974 6c65 2068 6173 2061 2063  ur title has a c
-0000b130: 6f75 6e74 6572 2061 6464 6564 2074 6f20  ounter added to 
-0000b140: 6974 0a20 2020 2020 2020 2061 7373 6572  it.        asser
-0000b150: 7420 7469 746c 655b 3a6f 626a 2e74 6974  t title[:obj.tit
-0000b160: 6c65 5f6d 6178 6c65 6e5d 5b3a 2d63 5f6c  le_maxlen][:-c_l
-0000b170: 656e 5d20 3d3d 2063 6875 6e6b 2e67 6574  en] == chunk.get
-0000b180: 2827 7469 746c 6527 295b 3a2d 635f 6c65  ('title')[:-c_le
-0000b190: 6e5d 0a20 2020 2020 2020 2061 7373 6572  n].        asser
-0000b1a0: 7420 6368 756e 6b2e 6765 7428 2774 6974  t chunk.get('tit
-0000b1b0: 6c65 2729 5b2d 635f 6c65 6e3a 5d20 3d3d  le')[-c_len:] ==
-0000b1c0: 205c 0a20 2020 2020 2020 2020 2020 2027   \.            '
-0000b1d0: 205b 7b3a 3034 7d2f 7b3a 3034 7d5d 272e   [{:04}/{:04}]'.
-0000b1e0: 666f 726d 6174 2869 6478 2c20 6c65 6e28  format(idx, len(
-0000b1f0: 6368 756e 6b73 2929 0a0a 2020 2020 2020  chunks))..      
-0000b200: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-0000b210: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-0000b220: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-0000b230: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-0000b240: 6574 2827 626f 6479 2729 0a0a 2020 2020  et('body')..    
-0000b250: 2020 2020 2320 556e 2d75 7365 6420 7768      # Un-used wh
-0000b260: 6974 6573 7061 6365 2069 7320 616c 7761  itespace is alwa
-0000b270: 7973 2063 6c65 616e 6564 2075 703b 206d  ys cleaned up; m
-0000b280: 616b 6520 7375 7265 2077 6520 6163 636f  ake sure we acco
-0000b290: 756e 7420 666f 720a 2020 2020 2020 2020  unt for.        
-0000b2a0: 2320 7468 6973 2069 6e20 6f75 7220 6e65  # this in our ne
-0000b2b0: 7720 6361 6c63 756c 6174 696f 6e0a 2020  w calculation.  
-0000b2c0: 2020 2020 2020 7773 5f64 6966 6620 3d20        ws_diff = 
-0000b2d0: 6c65 6e28 6e65 775f 626f 6479 5b6f 6666  len(new_body[off
-0000b2e0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-0000b2f0: 2b20 6f66 6673 6574 5d29 202d 205c 0a20  + offset]) - \. 
-0000b300: 2020 2020 2020 2020 2020 206c 656e 286e             len(n
-0000b310: 6577 5f62 6f64 795b 6f66 6673 6574 3a20  ew_body[offset: 
-0000b320: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
-0000b330: 7365 745d 0a20 2020 2020 2020 2020 2020  set].           
-0000b340: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
-0000b350: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
-0000b360: 7269 7028 2929 0a0a 2020 2020 2020 2020  rip())..        
-0000b370: 6173 7365 7274 206e 6577 5f62 6f64 795b  assert new_body[
-0000b380: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-0000b390: 7929 202b 206f 6666 7365 7420 2b20 7773  y) + offset + ws
-0000b3a0: 5f64 6966 665d 5c0a 2020 2020 2020 2020  _diff]\.        
-0000b3b0: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-0000b3c0: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-0000b3d0: 6970 2829 203d 3d20 5f62 6f64 790a 2020  ip() == _body.  
-0000b3e0: 2020 2020 2020 6f66 6673 6574 202b 3d20        offset += 
-0000b3f0: 286c 656e 285f 626f 6479 2920 2b20 7773  (len(_body) + ws
-0000b400: 5f64 6966 6629 0a0a 2020 2020 2320 426f  _diff)..    # Bo
-0000b410: 6479 2063 6875 6e6b 2069 7320 6265 796f  dy chunk is beyo
-0000b420: 6e64 2034 2064 6967 6974 732c 2073 6f20  nd 4 digits, so 
-0000b430: 5b58 5858 582f 5858 5858 5d20 6973 2074  [XXXX/XXXX] is t
-0000b440: 7572 6e65 6420 6f66 660a 2020 2020 6e65  urned off.    ne
-0000b450: 775f 626f 6479 203d 2028 626f 6479 202a  w_body = (body *
-0000b460: 2032 3530 3029 0a20 2020 2063 6875 6e6b   2500).    chunk
-0000b470: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0000b480: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-0000b490: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-0000b4a0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-0000b4b0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-0000b4c0: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-0000b4d0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0000b4e0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0000b4f0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
-0000b500: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-0000b510: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000b520: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000b530: 793d 6e65 775f 626f 6479 2c20 7469 746c  y=new_body, titl
-0000b540: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
-0000b550: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
-0000b560: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-0000b570: 3d20 3130 3234 300a 2020 2020 666f 7220  = 10240.    for 
-0000b580: 6964 782c 2063 6875 6e6b 2069 6e20 656e  idx, chunk in en
-0000b590: 756d 6572 6174 6528 6368 756e 6b73 2c20  umerate(chunks, 
-0000b5a0: 7374 6172 743d 3129 3a0a 2020 2020 2020  start=1):.      
-0000b5b0: 2020 2320 5665 7269 6669 6361 7469 6f6e    # Verification
-0000b5c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000b5d0: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
-0000b5e0: 6974 6c65 2729 2920 3c3d 206f 626a 2e74  itle')) <= obj.t
-0000b5f0: 6974 6c65 5f6d 6178 6c65 6e0a 2020 2020  itle_maxlen.    
-0000b600: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-0000b610: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
-0000b620: 2920 3c3d 206f 626a 2e62 6f64 795f 6d61  ) <= obj.body_ma
-0000b630: 786c 656e 0a0a 2020 2020 2020 2020 2320  xlen..        # 
-0000b640: 4f75 7220 7469 746c 6520 6861 7320 6e6f  Our title has no
-0000b650: 2063 6f75 6e74 6572 2061 6464 6564 2074   counter added t
-0000b660: 6f20 6974 0a20 2020 2020 2020 2061 7373  o it.        ass
-0000b670: 6572 7420 7469 746c 655b 3a6f 626a 2e74  ert title[:obj.t
-0000b680: 6974 6c65 5f6d 6178 6c65 6e5d 203d 3d20  itle_maxlen] == 
-0000b690: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-0000b6a0: 2729 0a0a 2020 2020 2020 2020 2320 4f75  ')..        # Ou
-0000b6b0: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
-0000b6c0: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
-0000b6d0: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
-0000b6e0: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
-0000b6f0: 6479 2729 0a0a 2020 2020 2020 2020 2320  dy')..        # 
-0000b700: 556e 2d75 7365 6420 7768 6974 6573 7061  Un-used whitespa
-0000b710: 6365 2069 7320 616c 7761 7973 2063 6c65  ce is always cle
-0000b720: 616e 6564 2075 703b 206d 616b 6520 7375  aned up; make su
-0000b730: 7265 2077 6520 6163 636f 756e 7420 666f  re we account fo
-0000b740: 720a 2020 2020 2020 2020 2320 7468 6973  r.        # this
-0000b750: 2069 6e20 6f75 7220 6e65 7720 6361 6c63   in our new calc
-0000b760: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
-0000b770: 7773 5f64 6966 6620 3d20 6c65 6e28 6e65  ws_diff = len(ne
-0000b780: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
-0000b790: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-0000b7a0: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
-0000b7b0: 2020 2020 206c 656e 286e 6577 5f62 6f64       len(new_bod
-0000b7c0: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-0000b7d0: 6f64 7929 202b 206f 6666 7365 745d 0a20  ody) + offset]. 
-0000b7e0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-0000b7f0: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-0000b800: 5c78 3063 2729 2e72 7374 7269 7028 2929  \x0c').rstrip())
-0000b810: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0000b820: 206e 6577 5f62 6f64 795b 6f66 6673 6574   new_body[offset
-0000b830: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-0000b840: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
-0000b850: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
-0000b860: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-0000b870: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
-0000b880: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
-0000b890: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
-0000b8a0: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
-0000b8b0: 0a0a 2020 2020 2320 5465 7374 206c 6172  ..    # Test lar
-0000b8c0: 6765 7220 6d65 7373 6167 6573 0a20 2020  ger messages.   
-0000b8d0: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-0000b8e0: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-0000b8f0: 6f75 6368 6564 0a20 2020 2063 6c61 7373  ouched.    class
-0000b900: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-0000b910: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
-0000b920: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
-0000b930: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
-0000b940: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
-0000b950: 786c 656e 203d 2031 3530 0a0a 2020 2020  xlen = 150..    
-0000b960: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
-0000b970: 626f 6479 206c 656e 6774 682e 204d 616b  body length. Mak
-0000b980: 6520 7375 7265 2069 7427 7320 616e 2069  e sure it's an i
-0000b990: 6e74 2e0a 2020 2020 2020 2020 626f 6479  nt..        body
-0000b9a0: 5f6d 6178 6c65 6e20 3d20 3135 300a 0a20  _maxlen = 150.. 
-0000b9b0: 2020 2020 2020 2023 2057 6974 6820 616d         # With am
-0000b9c0: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
-0000b9d0: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
-0000b9e0: 6761 6d61 7465 5f74 6974 6c65 203d 2054  gamate_title = T
-0000b9f0: 7275 650a 0a20 2020 2020 2020 2023 2046  rue..        # F
-0000ba00: 6f72 6365 2074 6974 6c65 2074 6f20 6265  orce title to be
-0000ba10: 2064 6973 706c 6179 6564 2061 6c77 6179   displayed alway
-0000ba20: 730a 2020 2020 2020 2020 6f76 6572 666c  s.        overfl
-0000ba30: 6f77 5f64 6973 706c 6179 5f74 6974 6c65  ow_display_title
-0000ba40: 5f6f 6e63 6520 3d20 4661 6c73 650a 0a20  _once = False.. 
-0000ba50: 2020 2020 2020 2064 6566 205f 5f69 6e69         def __ini
-0000ba60: 745f 5f28 7365 6c66 2c20 2a61 7267 732c  t__(self, *args,
-0000ba70: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0000ba80: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-0000ba90: 5f5f 696e 6974 5f5f 282a 2a6b 7761 7267  __init__(**kwarg
-0000baa0: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
-0000bab0: 6e6f 7469 6679 2873 656c 662c 202a 6172  notify(self, *ar
-0000bac0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-0000bad0: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
-0000bae0: 7465 6e64 2065 7665 7279 7468 696e 6720  tend everything 
-0000baf0: 6973 206f 6b61 790a 2020 2020 2020 2020  is okay.        
-0000bb00: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-0000bb10: 0a20 2020 2023 204c 6f61 6420 6f75 7220  .    # Load our 
-0000bb20: 6f62 6a65 6374 0a20 2020 206f 626a 203d  object.    obj =
-0000bb30: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-0000bb40: 6e28 6f76 6572 666c 6f77 3d4f 7665 7266  n(overflow=Overf
-0000bb50: 6c6f 774d 6f64 652e 5350 4c49 5429 0a20  lowMode.SPLIT). 
-0000bb60: 2020 2061 7373 6572 7420 6f62 6a20 6973     assert obj is
-0000bb70: 206e 6f74 204e 6f6e 650a 0a20 2020 206e   not None..    n
-0000bb80: 6577 5f62 6f64 7920 3d20 2862 6f64 7920  ew_body = (body 
-0000bb90: 2a20 3529 0a20 2020 2063 6875 6e6b 7320  * 5).    chunks 
-0000bba0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-0000bbb0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-0000bbc0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-0000bbd0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000bbe0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000bbf0: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
-0000bc00: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-0000bc10: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-0000bc20: 2862 6f64 793d 6e65 775f 626f 6479 2c20  (body=new_body, 
-0000bc30: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-0000bc40: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-0000bc50: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-0000bc60: 6e65 775f 626f 6479 2c20 7469 746c 653d  new_body, title=
-0000bc70: 7469 746c 6529 0a20 2020 206f 6666 7365  title).    offse
-0000bc80: 7420 3d20 300a 2020 2020 2320 6f76 6572  t = 0.    # over
-0000bc90: 666c 6f77 5f64 6973 706c 6179 5f74 6974  flow_display_tit
-0000bca0: 6c65 5f6f 6e63 6520 7768 6c65 2073 6574  le_once whle set
-0000bcb0: 2074 6f20 4661 6c73 6520 6973 2073 7469   to False is sti
-0000bcc0: 6c6c 2069 676e 6f72 6564 0a20 2020 2023  ll ignored.    #
-0000bcd0: 2062 6563 6175 7365 206f 7572 2074 6974   because our tit
-0000bce0: 6c65 5f6d 6178 6c65 6e20 3e20 626f 6479  le_maxlen > body
-0000bcf0: 5f6d 6178 6c65 6e20 616e 6420 6120 6675  _maxlen and a fu
-0000bd00: 6c6c 2074 6974 6c65 2077 6173 0a20 2020  ll title was.   
-0000bd10: 2023 2070 726f 7669 6465 640a 2020 2020   # provided.    
-0000bd20: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-0000bd30: 7329 203d 3d20 3336 0a20 2020 2066 6f72  s) == 36.    for
-0000bd40: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
-0000bd50: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
-0000bd60: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
-0000bd70: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
-0000bd80: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-0000bd90: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-0000bda0: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
-0000bdb0: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
-0000bdc0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0000bdd0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0000bde0: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
-0000bdf0: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
-0000be00: 204f 7572 2074 6974 6c65 2068 6173 206e   Our title has n
-0000be10: 6f20 636f 756e 7465 7220 6164 6465 6420  o counter added 
-0000be20: 746f 2069 740a 2020 2020 2020 2020 6966  to it.        if
-0000be30: 2069 6478 203e 2031 3a0a 2020 2020 2020   idx > 1:.      
-0000be40: 2020 2020 2020 2320 456d 7074 7920 286e        # Empty (n
-0000be50: 6f20 7469 746c 6520 6469 7370 6c61 7965  o title displaye
-0000be60: 6420 6f6e 2066 6f6c 6c6f 7769 6e67 2065  d on following e
-0000be70: 6e74 7269 6573 0a20 2020 2020 2020 2020  ntries.         
-0000be80: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
-0000be90: 6765 7428 2774 6974 6c65 2729 203d 3d20  get('title') == 
-0000bea0: 2222 0a20 2020 2020 2020 2065 6c73 653a  "".        else:
-0000beb0: 0a20 2020 2020 2020 2020 2020 2023 2042  .            # B
-0000bec0: 6563 6175 7365 2031 3530 2069 7320 7768  ecause 150 is wh
-0000bed0: 6174 2077 6520 7365 7420 7468 6520 7469  at we set the ti
-0000bee0: 746c 6520 6c69 6d69 7420 746f 0a20 2020  tle limit to.   
-0000bef0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-0000bf00: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
-0000bf10: 6974 6c65 2729 2920 3d3d 206f 626a 2e74  itle')) == obj.t
-0000bf20: 6974 6c65 5f6d 6178 6c65 6e0a 2020 2020  itle_maxlen.    
-0000bf30: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0000bf40: 6974 6c65 5b3a 6f62 6a2e 7469 746c 655f  itle[:obj.title_
-0000bf50: 6d61 786c 656e 5d20 3d3d 2063 6875 6e6b  maxlen] == chunk
-0000bf60: 2e67 6574 2827 7469 746c 6527 290a 0a20  .get('title').. 
-0000bf70: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
-0000bf80: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
-0000bf90: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
-0000bfa0: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
-0000bfb0: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
-0000bfc0: 0a20 2020 2020 2020 2023 2055 6e2d 7573  .        # Un-us
-0000bfd0: 6564 2077 6869 7465 7370 6163 6520 6973  ed whitespace is
-0000bfe0: 2061 6c77 6179 7320 636c 6561 6e65 6420   always cleaned 
-0000bff0: 7570 3b20 6d61 6b65 2073 7572 6520 7765  up; make sure we
-0000c000: 2061 6363 6f75 6e74 2066 6f72 0a20 2020   account for.   
-0000c010: 2020 2020 2023 2074 6869 7320 696e 206f       # this in o
-0000c020: 7572 206e 6577 2063 616c 6375 6c61 7469  ur new calculati
-0000c030: 6f6e 0a20 2020 2020 2020 2077 735f 6469  on.        ws_di
-0000c040: 6666 203d 206c 656e 286e 6577 5f62 6f64  ff = len(new_bod
-0000c050: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-0000c060: 6f64 7929 202b 206f 6666 7365 745d 2920  ody) + offset]) 
-0000c070: 2d20 5c0a 2020 2020 2020 2020 2020 2020  - \.            
-0000c080: 6c65 6e28 6e65 775f 626f 6479 5b6f 6666  len(new_body[off
-0000c090: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-0000c0a0: 2b20 6f66 6673 6574 5d0a 2020 2020 2020  + offset].      
-0000c0b0: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-0000c0c0: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-0000c0d0: 292e 7273 7472 6970 2829 290a 0a20 2020  ).rstrip())..   
-0000c0e0: 2020 2020 2061 7373 6572 7420 6e65 775f       assert new_
-0000c0f0: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
-0000c100: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-0000c110: 202b 2077 735f 6469 6666 5d5c 0a20 2020   + ws_diff]\.   
-0000c120: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-0000c130: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-0000c140: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
-0000c150: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
-0000c160: 7420 2b3d 2028 6c65 6e28 5f62 6f64 7929  t += (len(_body)
-0000c170: 202b 2077 735f 6469 6666 290a 0a20 2020   + ws_diff)..   
-0000c180: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0000c190: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0000c1a0: 6479 3d6e 6577 5f62 6f64 792c 2074 6974  dy=new_body, tit
-0000c1b0: 6c65 3d74 6974 6c65 290a 2020 2020 6f66  le=title).    of
-0000c1c0: 6673 6574 203d 2030 0a20 2020 2023 206f  fset = 0.    # o
-0000c1d0: 7665 7266 6c6f 775f 6469 7370 6c61 795f  verflow_display_
-0000c1e0: 7469 746c 655f 6f6e 6365 2077 686c 6520  title_once whle 
-0000c1f0: 7365 7420 746f 2046 616c 7365 2069 7320  set to False is 
-0000c200: 7374 696c 6c20 6967 6e6f 7265 640a 2020  still ignored.  
-0000c210: 2020 2320 6265 6361 7573 6520 6f75 7220    # because our 
-0000c220: 7469 746c 655f 6d61 786c 656e 203e 2062  title_maxlen > b
-0000c230: 6f64 795f 6d61 786c 656e 2061 6e64 2061  ody_maxlen and a
-0000c240: 2066 756c 6c20 7469 746c 6520 7761 730a   full title was.
-0000c250: 2020 2020 2320 7072 6f76 6964 6564 0a20      # provided. 
-0000c260: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-0000c270: 756e 6b73 2920 3d3d 2033 360a 2020 2020  unks) == 36.    
-0000c280: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-0000c290: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-0000c2a0: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-0000c2b0: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-0000c2c0: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-0000c2d0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0000c2e0: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-0000c2f0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-0000c300: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0000c310: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-0000c320: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-0000c330: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-0000c340: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
-0000c350: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
-0000c360: 6564 2074 6f20 6974 0a20 2020 2020 2020  ed to it.       
-0000c370: 2069 6620 6964 7820 3e20 313a 0a20 2020   if idx > 1:.   
-0000c380: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
-0000c390: 2028 6e6f 2074 6974 6c65 2064 6973 706c   (no title displ
-0000c3a0: 6179 6564 206f 6e20 666f 6c6c 6f77 696e  ayed on followin
-0000c3b0: 6720 656e 7472 6965 730a 2020 2020 2020  g entries.      
-0000c3c0: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
-0000c3d0: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
-0000c3e0: 3d3d 2022 220a 2020 2020 2020 2020 656c  == "".        el
-0000c3f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000c400: 2320 4265 6361 7573 6520 3135 3020 6973  # Because 150 is
-0000c410: 2077 6861 7420 7765 2073 6574 2074 6865   what we set the
-0000c420: 2074 6974 6c65 206c 696d 6974 2074 6f0a   title limit to.
-0000c430: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-0000c440: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
-0000c450: 2827 7469 746c 6527 2929 203d 3d20 6f62  ('title')) == ob
-0000c460: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
-0000c470: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-0000c480: 7420 7469 746c 655b 3a6f 626a 2e74 6974  t title[:obj.tit
-0000c490: 6c65 5f6d 6178 6c65 6e5d 203d 3d20 6368  le_maxlen] == ch
-0000c4a0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0000c4b0: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
-0000c4c0: 626f 6479 2069 7320 6f6e 6c79 2062 726f  body is only bro
-0000c4d0: 6b65 6e20 7570 3b20 6e6f 7420 6c6f 7374  ken up; not lost
-0000c4e0: 0a20 2020 2020 2020 205f 626f 6479 203d  .        _body =
-0000c4f0: 2063 6875 6e6b 2e67 6574 2827 626f 6479   chunk.get('body
-0000c500: 2729 0a0a 2020 2020 2020 2020 2320 556e  ')..        # Un
-0000c510: 2d75 7365 6420 7768 6974 6573 7061 6365  -used whitespace
-0000c520: 2069 7320 616c 7761 7973 2063 6c65 616e   is always clean
-0000c530: 6564 2075 703b 206d 616b 6520 7375 7265  ed up; make sure
-0000c540: 2077 6520 6163 636f 756e 7420 666f 720a   we account for.
-0000c550: 2020 2020 2020 2020 2320 7468 6973 2069          # this i
-0000c560: 6e20 6f75 7220 6e65 7720 6361 6c63 756c  n our new calcul
-0000c570: 6174 696f 6e0a 2020 2020 2020 2020 7773  ation.        ws
-0000c580: 5f64 6966 6620 3d20 6c65 6e28 6e65 775f  _diff = len(new_
-0000c590: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
-0000c5a0: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-0000c5b0: 5d29 202d 205c 0a20 2020 2020 2020 2020  ]) - \.         
-0000c5c0: 2020 206c 656e 286e 6577 5f62 6f64 795b     len(new_body[
-0000c5d0: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-0000c5e0: 7929 202b 206f 6666 7365 745d 0a20 2020  y) + offset].   
-0000c5f0: 2020 2020 2020 2020 2020 2020 202e 6c73               .ls
-0000c600: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
-0000c610: 3063 2729 2e72 7374 7269 7028 2929 0a0a  0c').rstrip())..
-0000c620: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
-0000c630: 6577 5f62 6f64 795b 6f66 6673 6574 3a20  ew_body[offset: 
-0000c640: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
-0000c650: 7365 7420 2b20 7773 5f64 6966 665d 5c0a  set + ws_diff]\.
-0000c660: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
-0000c670: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
-0000c680: 6327 292e 7273 7472 6970 2829 203d 3d20  c').rstrip() == 
-0000c690: 5f62 6f64 790a 2020 2020 2020 2020 6f66  _body.        of
-0000c6a0: 6673 6574 202b 3d20 286c 656e 285f 626f  fset += (len(_bo
-0000c6b0: 6479 2920 2b20 7773 5f64 6966 6629 0a0a  dy) + ws_diff)..
-0000c6c0: 2020 2020 230a 2020 2020 2320 5275 6e20      #.    # Run 
-0000c6d0: 6167 6169 6e20 6275 7420 7769 7468 2061  again but with a
-0000c6e0: 2073 6d61 6c6c 6572 2074 6974 6c65 0a20   smaller title. 
-0000c6f0: 2020 2023 0a20 2020 2063 6875 6e6b 7320     #.    chunks 
-0000c700: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-0000c710: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
-0000c720: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-0000c730: 5b3a 3330 5d29 0a20 2020 206f 6666 7365  [:30]).    offse
-0000c740: 7420 3d20 300a 2020 2020 2320 6f76 6572  t = 0.    # over
-0000c750: 666c 6f77 5f64 6973 706c 6179 5f74 6974  flow_display_tit
-0000c760: 6c65 5f6f 6e63 6520 7768 6c65 2073 6574  le_once whle set
-0000c770: 2074 6f20 4661 6c73 6520 6973 2073 7469   to False is sti
-0000c780: 6c6c 2069 676e 6f72 6564 0a20 2020 2023  ll ignored.    #
-0000c790: 2062 6563 6175 7365 206f 7572 2062 6f64   because our bod
-0000c7a0: 795f 6d61 786c 656e 2028 6166 7465 7220  y_maxlen (after 
-0000c7b0: 7469 746c 6520 6861 7320 6265 656e 2063  title has been c
-0000c7c0: 616c 6375 6c61 7465 6420 7769 7468 2069  alculated with i
-0000c7d0: 7429 0a20 2020 2023 2069 7320 6c65 7373  t).    # is less
-0000c7e0: 2074 6865 6e20 7468 6520 6f76 6572 666c   then the overfl
-0000c7f0: 6f77 5f64 6973 706c 6179 5f63 6f75 6e74  ow_display_count
-0000c800: 5f74 6872 6573 686f 6c64 3b20 6865 6e63  _threshold; henc
-0000c810: 6520 6120 6d65 7373 6167 650a 2020 2020  e a message.    
-0000c820: 2320 6d75 7374 2062 6520 6120 6365 7274  # must be a cert
-0000c830: 6169 6e20 6d69 6e69 6d75 6d20 7369 7a65  ain minimum size
-0000c840: 2069 6e20 6f72 6465 7220 746f 206b 6963   in order to kic
-0000c850: 6b20 696e 0a20 2020 2061 7373 6572 7420  k in.    assert 
-0000c860: 6c65 6e28 6368 756e 6b73 2920 3d3d 2034  len(chunks) == 4
-0000c870: 380a 2020 2020 666f 7220 6964 782c 2063  8.    for idx, c
-0000c880: 6875 6e6b 2069 6e20 656e 756d 6572 6174  hunk in enumerat
-0000c890: 6528 6368 756e 6b73 2c20 7374 6172 743d  e(chunks, start=
-0000c8a0: 3129 3a0a 2020 2020 2020 2020 2320 5665  1):.        # Ve
-0000c8b0: 7269 6669 6361 7469 6f6e 0a20 2020 2020  rification.     
-0000c8c0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-0000c8d0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0000c8e0: 2920 3c3d 206f 626a 2e74 6974 6c65 5f6d  ) <= obj.title_m
-0000c8f0: 6178 6c65 6e0a 2020 2020 2020 2020 6173  axlen.        as
-0000c900: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-0000c910: 6574 2827 626f 6479 2729 2920 3c3d 206f  et('body')) <= o
-0000c920: 626a 2e62 6f64 795f 6d61 786c 656e 0a0a  bj.body_maxlen..
-0000c930: 2020 2020 2020 2020 2320 4f75 7220 7469          # Our ti
-0000c940: 746c 6520 646f 6573 6e27 7420 6368 616e  tle doesn't chan
-0000c950: 6765 0a20 2020 2020 2020 2061 7373 6572  ge.        asser
-0000c960: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-0000c970: 2774 6974 6c65 2729 2920 3d3d 2033 300a  'title')) == 30.
-0000c980: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-0000c990: 6974 6c65 5b3a 3330 5d20 3d3d 2063 6875  itle[:30] == chu
-0000c9a0: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
-0000c9b0: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
-0000c9c0: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
-0000c9d0: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
-0000c9e0: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
-0000c9f0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0000ca00: 290a 0a20 2020 2020 2020 2023 2055 6e2d  )..        # Un-
-0000ca10: 7573 6564 2077 6869 7465 7370 6163 6520  used whitespace 
-0000ca20: 6973 2061 6c77 6179 7320 636c 6561 6e65  is always cleane
-0000ca30: 6420 7570 3b20 6d61 6b65 2073 7572 6520  d up; make sure 
-0000ca40: 7765 2061 6363 6f75 6e74 2066 6f72 0a20  we account for. 
-0000ca50: 2020 2020 2020 2023 2074 6869 7320 696e         # this in
-0000ca60: 206f 7572 206e 6577 2063 616c 6375 6c61   our new calcula
-0000ca70: 7469 6f6e 0a20 2020 2020 2020 2077 735f  tion.        ws_
-0000ca80: 6469 6666 203d 206c 656e 286e 6577 5f62  diff = len(new_b
-0000ca90: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-0000caa0: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
-0000cab0: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
-0000cac0: 2020 6c65 6e28 6e65 775f 626f 6479 5b6f    len(new_body[o
-0000cad0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-0000cae0: 2920 2b20 6f66 6673 6574 5d2e 7273 7472  ) + offset].rstr
-0000caf0: 6970 2829 290a 0a20 2020 2020 2020 2061  ip())..        a
-0000cb00: 7373 6572 7420 6e65 775f 626f 6479 5b6f  ssert new_body[o
-0000cb10: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-0000cb20: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
-0000cb30: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
-0000cb40: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
-0000cb50: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
-0000cb60: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
-0000cb70: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
-0000cb80: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
-0000cb90: 6469 6666 290a 0a20 2020 2023 0a20 2020  diff)..    #.   
-0000cba0: 2023 204e 6578 7420 5465 7374 3a20 4170   # Next Test: Ap
-0000cbb0: 7065 6e64 2074 6974 6c65 2074 6f20 626f  pend title to bo
-0000cbc0: 6479 202b 2073 706c 6974 2062 6f64 790a  dy + split body.
-0000cbd0: 2020 2020 230a 0a20 2020 2063 6c61 7373      #..    class
-0000cbe0: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-0000cbf0: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
-0000cc00: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
-0000cc10: 6520 6e6f 2074 6974 6c65 0a20 2020 2020  e no title.     
-0000cc20: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
-0000cc30: 3d20 300a 0a20 2020 2020 2020 2023 2045  = 0..        # E
-0000cc40: 6e66 6f72 6365 2061 2062 6f64 7920 6c65  nforce a body le
-0000cc50: 6e67 7468 2062 6173 6564 206f 6e20 7468  ngth based on th
-0000cc60: 6520 7469 746c 652e 204d 616b 6520 7375  e title. Make su
-0000cc70: 7265 2069 7427 7320 616e 2069 6e74 2e0a  re it's an int..
-0000cc80: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
-0000cc90: 6c65 6e20 3d20 696e 7428 7469 746c 655f  len = int(title_
-0000cca0: 6c65 6e20 2f20 3429 0a0a 2020 2020 2020  len / 4)..      
-0000ccb0: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
-0000ccc0: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
-0000ccd0: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
-0000cce0: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
-0000ccf0: 2020 2020 2020 2020 2320 466f 7263 6520          # Force 
-0000cd00: 7469 746c 6520 746f 2062 6520 6469 7370  title to be disp
-0000cd10: 6c61 7965 6420 616c 7761 7973 0a20 2020  layed always.   
-0000cd20: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
-0000cd30: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
-0000cd40: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-0000cd50: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-0000cd60: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-0000cd70: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-0000cd80: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
-0000cd90: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
-0000cda0: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
-0000cdb0: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
-0000cdc0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-0000cdd0: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
-0000cde0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
-0000cdf0: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
-0000ce00: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-0000ce10: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
-0000ce20: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
-0000ce30: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
-0000ce40: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
-0000ce50: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
-0000ce60: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
-0000ce70: 4e6f 6e65 0a0a 2020 2020 2320 5665 7269  None..    # Veri
-0000ce80: 6679 2074 6861 7420 7765 2062 7265 616b  fy that we break
-0000ce90: 2074 6865 2074 6974 6c65 2074 6f20 6120   the title to a 
-0000cea0: 6d61 7820 6c65 6e67 7468 206f 6620 6f75  max length of ou
-0000ceb0: 7220 7469 746c 655f 6d61 780a 2020 2020  r title_max.    
-0000cec0: 2320 616e 6420 7468 6174 2074 6865 2062  # and that the b
-0000ced0: 6f64 7920 7265 6d61 696e 7320 756e 746f  ody remains unto
-0000cee0: 7563 6865 640a 2020 2020 6368 756e 6b73  uched.    chunks
-0000cef0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-0000cf00: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
-0000cf10: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
-0000cf20: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0000cf30: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0000cf40: 6479 3d22 222c 2074 6974 6c65 3d22 2229  dy="", title="")
-0000cf50: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-0000cf60: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-0000cf70: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
-0000cf80: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-0000cf90: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0000cfa0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-0000cfb0: 792c 2074 6974 6c65 3d74 6974 6c65 290a  y, title=title).
-0000cfc0: 0a20 2020 2023 204f 7572 2066 696e 616c  .    # Our final
-0000cfd0: 2070 726f 6475 6374 2069 7320 7468 6174   product is that
-0000cfe0: 206f 7572 2074 6974 6c65 2068 6173 2062   our title has b
-0000cff0: 6565 6e20 6170 7065 6e64 6564 2074 6f20  een appended to 
-0000d000: 6f75 7220 626f 6479 2074 6f0a 2020 2020  our body to.    
-0000d010: 2320 6372 6561 7465 206f 6e65 2067 7265  # create one gre
-0000d020: 6174 2062 6967 2062 6f64 792e 2041 7320  at big body. As 
-0000d030: 6120 7265 7375 6c74 2077 6527 6c6c 2067  a result we'll g
-0000d040: 6574 2071 7569 7465 2061 2066 6577 206c  et quite a few l
-0000d050: 696e 6573 2062 6163 6b0a 2020 2020 2320  ines back.    # 
-0000d060: 6e6f 772e 0a20 2020 206f 6666 7365 7420  now..    offset 
-0000d070: 3d20 300a 0a20 2020 2023 204f 7572 2062  = 0..    # Our b
-0000d080: 6f64 7920 7769 6c6c 206c 6f6f 6b20 6c69  ody will look li
-0000d090: 6b65 2074 6869 7320 696e 2073 6d61 6c6c  ke this in small
-0000d0a0: 2063 6875 6e6b 7320 6174 2074 6865 2065   chunks at the e
-0000d0b0: 6e64 206f 6620 7468 6520 6461 790a 2020  nd of the day.  
-0000d0c0: 2020 6275 6c6b 203d 2074 6974 6c65 202b    bulk = title +
-0000d0d0: 2027 5c72 5c6e 2720 2b20 626f 6479 0a0a   '\r\n' + body..
-0000d0e0: 2020 2020 2320 4475 6520 746f 2074 6865      # Due to the
-0000d0f0: 206e 6577 206c 696e 6520 6164 6465 6420   new line added 
-0000d100: 746f 2074 6865 2065 6e64 0a20 2020 2061  to the end.    a
-0000d110: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
-0000d120: 2920 3d3d 2028 0a20 2020 2020 2020 2023  ) == (.        #
-0000d130: 2077 7261 7020 6469 7669 7369 6f6e 2069   wrap division i
-0000d140: 6e20 696e 7428 2920 736f 2050 7974 686f  n int() so Pytho
-0000d150: 6e20 3320 646f 6573 6e27 7420 636f 6e76  n 3 doesn't conv
-0000d160: 6572 7420 6974 2074 6f20 6120 666c 6f61  ert it to a floa
-0000d170: 7420 6f6e 0a20 2020 2020 2020 2023 2075  t on.        # u
-0000d180: 730a 2020 2020 2020 2020 696e 7428 6c65  s.        int(le
-0000d190: 6e28 6275 6c6b 2920 2f20 6f62 6a2e 626f  n(bulk) / obj.bo
-0000d1a0: 6479 5f6d 6178 6c65 6e29 202b 0a20 2020  dy_maxlen) +.   
-0000d1b0: 2020 2020 2028 3120 6966 206c 656e 2862       (1 if len(b
-0000d1c0: 756c 6b29 2025 206f 626a 2e62 6f64 795f  ulk) % obj.body_
-0000d1d0: 6d61 786c 656e 2065 6c73 6520 3029 290a  maxlen else 0)).
-0000d1e0: 0a20 2020 2066 6f72 2063 6875 6e6b 2069  .    for chunk i
-0000d1f0: 6e20 6368 756e 6b73 3a0a 2020 2020 2020  n chunks:.      
-0000d200: 2020 2320 5665 7269 6669 6361 7469 6f6e    # Verification
-0000d210: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000d220: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
-0000d230: 6974 6c65 2729 2920 3d3d 2030 0a20 2020  itle')) == 0.   
-0000d240: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0000d250: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0000d260: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
-0000d270: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
-0000d280: 204f 7572 2074 6974 6c65 2069 7320 656d   Our title is em
-0000d290: 7074 7920 6576 6572 7920 7469 6d65 0a20  pty every time. 
-0000d2a0: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-0000d2b0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0000d2c0: 203d 3d20 2727 0a20 2020 2020 2020 2023   == ''.        #
-0000d2d0: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
-0000d2e0: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
-0000d2f0: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
-0000d300: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
-0000d310: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
-0000d320: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
-0000d330: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
-0000d340: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
-0000d350: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
-0000d360: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
-0000d370: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
-0000d380: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
-0000d390: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
-0000d3a0: 2862 756c 6b5b 6f66 6673 6574 3a20 6c65  (bulk[offset: le
-0000d3b0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0000d3c0: 745d 2920 2d20 5c0a 2020 2020 2020 2020  t]) - \.        
-0000d3d0: 2020 2020 6c65 6e28 6275 6c6b 5b6f 6666      len(bulk[off
-0000d3e0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-0000d3f0: 2b20 6f66 6673 6574 5d0a 2020 2020 2020  + offset].      
-0000d400: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-0000d410: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-0000d420: 292e 7273 7472 6970 2829 290a 0a20 2020  ).rstrip())..   
-0000d430: 2020 2020 2061 7373 6572 7420 6275 6c6b       assert bulk
-0000d440: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-0000d450: 6479 2920 2b20 6f66 6673 6574 202b 2077  dy) + offset + w
-0000d460: 735f 6469 6666 5d5c 0a20 2020 2020 2020  s_diff]\.       
-0000d470: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
-0000d480: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
-0000d490: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
-0000d4a0: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
-0000d4b0: 2028 6c65 6e28 5f62 6f64 7929 202b 2077   (len(_body) + w
-0000d4c0: 735f 6469 6666 290a 0a20 2020 2023 0a20  s_diff)..    #. 
-0000d4d0: 2020 2023 2054 6573 7420 6361 7365 2077     # Test case w
-0000d4e0: 6865 7265 206f 7572 2074 6974 6c65 5f6c  here our title_l
-0000d4f0: 656e 2069 7320 7368 6f72 7465 7220 7468  en is shorter th
-0000d500: 656e 2074 6865 2076 616c 7565 0a20 2020  en the value.   
-0000d510: 2023 2074 6861 7420 776f 756c 6420 6f74   # that would ot
-0000d520: 6865 7277 6973 6520 7472 6967 6765 7220  herwise trigger 
-0000d530: 7468 6520 5b58 582f 5858 5d20 656c 656d  the [XX/XX] elem
-0000d540: 656e 7473 0a20 2020 2023 0a0a 2020 2020  ents.    #..    
-0000d550: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
-0000d560: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-0000d570: 6529 3a0a 0a20 2020 2020 2020 2023 2053  e):..        # S
-0000d580: 6574 2061 2073 6d61 6c6c 2074 6974 6c65  et a small title
-0000d590: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
-0000d5a0: 7469 746c 655f 6d61 786c 656e 203d 2031  title_maxlen = 1
-0000d5b0: 3030 0a0a 2020 2020 2020 2020 2320 456e  00..        # En
-0000d5c0: 666f 7263 6520 6120 626f 6479 206c 656e  force a body len
-0000d5d0: 6774 682e 204d 616b 6520 7375 7265 2069  gth. Make sure i
-0000d5e0: 7427 7320 616e 2069 6e74 2e0a 2020 2020  t's an int..    
-0000d5f0: 2020 2020 626f 6479 5f6d 6178 6c65 6e20      body_maxlen 
-0000d600: 3d20 696e 7428 626f 6479 5f6c 656e 202f  = int(body_len /
-0000d610: 2034 290a 0a20 2020 2020 2020 2023 2057   4)..        # W
-0000d620: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-0000d630: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-0000d640: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-0000d650: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-0000d660: 2020 2023 2046 6f72 6365 2074 6974 6c65     # Force title
-0000d670: 2074 6f20 6265 2064 6973 706c 6179 6564   to be displayed
-0000d680: 2061 6c77 6179 730a 2020 2020 2020 2020   always.        
-0000d690: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
-0000d6a0: 5f74 6974 6c65 5f6f 6e63 6520 3d20 4661  _title_once = Fa
-0000d6b0: 6c73 650a 0a20 2020 2020 2020 2064 6566  lse..        def
-0000d6c0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-0000d6d0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0000d6e0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
-0000d6f0: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
-0000d700: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-0000d710: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
-0000d720: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-0000d730: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-0000d740: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
-0000d750: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
-0000d760: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000d770: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
-0000d780: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
-0000d790: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
-0000d7a0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
-0000d7b0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
-0000d7c0: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
-0000d7d0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
-0000d7e0: 0a20 2020 2023 2056 6572 6966 7920 7468  .    # Verify th
-0000d7f0: 6174 2077 6520 6272 6561 6b20 7468 6520  at we break the 
-0000d800: 7469 746c 6520 746f 2061 206d 6178 206c  title to a max l
-0000d810: 656e 6774 6820 6f66 206f 7572 2074 6974  ength of our tit
-0000d820: 6c65 5f6d 6178 0a20 2020 2023 2061 6e64  le_max.    # and
-0000d830: 2074 6861 7420 7468 6520 626f 6479 2072   that the body r
-0000d840: 656d 6169 6e73 2075 6e74 6f75 6368 6564  emains untouched
-0000d850: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-0000d860: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-0000d870: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-0000d880: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
-0000d890: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0000d8a0: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-0000d8b0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-0000d8c0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000d8d0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000d8e0: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
-0000d8f0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0000d900: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0000d910: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-0000d920: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
-0000d930: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
-0000d940: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
-0000d950: 203d 3d20 370a 2020 2020 666f 7220 6964   == 7.    for id
-0000d960: 782c 2063 6875 6e6b 2069 6e20 656e 756d  x, chunk in enum
-0000d970: 6572 6174 6528 6368 756e 6b73 2c20 7374  erate(chunks, st
-0000d980: 6172 743d 3129 3a0a 2020 2020 2020 2020  art=1):.        
-0000d990: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
-0000d9a0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0000d9b0: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
-0000d9c0: 6c65 2729 2920 3c3d 206f 626a 2e74 6974  le')) <= obj.tit
-0000d9d0: 6c65 5f6d 6178 6c65 6e0a 2020 2020 2020  le_maxlen.      
-0000d9e0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-0000d9f0: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
-0000da00: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
-0000da10: 656e 0a0a 2020 2020 2020 2020 2320 4f75  en..        # Ou
-0000da20: 7220 7469 746c 6520 6973 2074 7275 6e63  r title is trunc
-0000da30: 6174 6564 2061 6e64 206e 6f20 636f 756e  ated and no coun
-0000da40: 7465 7220 6164 6465 640a 2020 2020 2020  ter added.      
-0000da50: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
-0000da60: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-0000da70: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
-0000da80: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
-0000da90: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
-0000daa0: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
-0000dab0: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
-0000dac0: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
-0000dad0: 7428 2762 6f64 7927 290a 0a20 2020 2020  t('body')..     
-0000dae0: 2020 2023 2055 6e2d 7573 6564 2077 6869     # Un-used whi
-0000daf0: 7465 7370 6163 6520 6973 2061 6c77 6179  tespace is alway
-0000db00: 7320 636c 6561 6e65 6420 7570 3b20 6d61  s cleaned up; ma
-0000db10: 6b65 2073 7572 6520 7765 2061 6363 6f75  ke sure we accou
-0000db20: 6e74 2066 6f72 0a20 2020 2020 2020 2023  nt for.        #
-0000db30: 2074 6869 7320 696e 206f 7572 206e 6577   this in our new
-0000db40: 2063 616c 6375 6c61 7469 6f6e 0a20 2020   calculation.   
-0000db50: 2020 2020 2077 735f 6469 6666 203d 206c       ws_diff = l
-0000db60: 656e 2862 6f64 795b 6f66 6673 6574 3a20  en(body[offset: 
-0000db70: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
-0000db80: 7365 745d 2920 2d20 5c0a 2020 2020 2020  set]) - \.      
-0000db90: 2020 2020 2020 6c65 6e28 626f 6479 5b6f        len(body[o
-0000dba0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-0000dbb0: 2920 2b20 6f66 6673 6574 5d0a 2020 2020  ) + offset].    
-0000dbc0: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
-0000dbd0: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
-0000dbe0: 6327 292e 7273 7472 6970 2829 290a 0a20  c').rstrip()).. 
-0000dbf0: 2020 2020 2020 2061 7373 6572 7420 626f         assert bo
-0000dc00: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
-0000dc10: 626f 6479 2920 2b20 6f66 6673 6574 202b  body) + offset +
-0000dc20: 2077 735f 6469 6666 5d5c 0a20 2020 2020   ws_diff]\.     
-0000dc30: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
-0000dc40: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
-0000dc50: 7374 7269 7028 2920 3d3d 205f 626f 6479  strip() == _body
-0000dc60: 0a20 2020 2020 2020 206f 6666 7365 7420  .        offset 
-0000dc70: 2b3d 2028 6c65 6e28 5f62 6f64 7929 202b  += (len(_body) +
-0000dc80: 2077 735f 6469 6666 290a 0a20 2020 2023   ws_diff)..    #
-0000dc90: 0a20 2020 2023 2053 6365 6e61 7269 6f20  .    # Scenario 
-0000dca0: 7768 6572 6520 7468 6520 7469 746c 6520  where the title 
-0000dcb0: 6c65 6e67 7468 2069 7320 6c61 7267 6572  length is larger
-0000dcc0: 2074 6861 6e20 7468 6520 626f 6479 0a20   than the body. 
-0000dcd0: 2020 2023 0a0a 2020 2020 636c 6173 7320     #..    class 
-0000dce0: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
-0000dcf0: 284e 6f74 6966 7942 6173 6529 3a0a 0a20  (NotifyBase):.. 
-0000dd00: 2020 2020 2020 2023 2053 6574 2061 2073         # Set a s
-0000dd10: 6d61 6c6c 2074 6974 6c65 206c 656e 6774  mall title lengt
-0000dd20: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
-0000dd30: 6d61 786c 656e 203d 2031 3030 0a0a 2020  maxlen = 100..  
-0000dd40: 2020 2020 2020 2320 456e 666f 7263 6520        # Enforce 
-0000dd50: 6120 626f 6479 206c 656e 6774 682e 204d  a body length. M
-0000dd60: 616b 6520 7375 7265 2069 7427 7320 616e  ake sure it's an
-0000dd70: 2069 6e74 2e0a 2020 2020 2020 2020 626f   int..        bo
-0000dd80: 6479 5f6d 6178 6c65 6e20 3d20 3530 0a0a  dy_maxlen = 50..
-0000dd90: 2020 2020 2020 2020 2320 5769 7468 2061          # With a
-0000dda0: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
-0000ddb0: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
-0000ddc0: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
-0000ddd0: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
-0000dde0: 466f 7263 6520 7469 746c 6520 746f 2062  Force title to b
-0000ddf0: 6520 6469 7370 6c61 7965 6420 616c 7761  e displayed alwa
-0000de00: 7973 0a20 2020 2020 2020 206f 7665 7266  ys.        overf
-0000de10: 6c6f 775f 6469 7370 6c61 795f 7469 746c  low_display_titl
-0000de20: 655f 6f6e 6365 203d 2046 616c 7365 0a0a  e_once = False..
-0000de30: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
-0000de40: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
-0000de50: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0000de60: 2020 2020 2020 2020 2073 7570 6572 2829           super()
-0000de70: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
-0000de80: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
-0000de90: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
-0000dea0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-0000deb0: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
-0000dec0: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
-0000ded0: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
-0000dee0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-0000def0: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
-0000df00: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
-0000df10: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
-0000df20: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
-0000df30: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
-0000df40: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
-0000df50: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
-0000df60: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
-0000df70: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
-0000df80: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
-0000df90: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
-0000dfa0: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
-0000dfb0: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-0000dfc0: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-0000dfd0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000dfe0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000dff0: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-0000e000: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-0000e010: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0000e020: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-0000e030: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-0000e040: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0000e050: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-0000e060: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-0000e070: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0000e080: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0000e090: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-0000e0a0: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
-0000e0b0: 203d 2030 0a0a 2020 2020 2320 6f76 6572   = 0..    # over
-0000e0c0: 666c 6f77 5f64 6973 706c 6179 5f74 6974  flow_display_tit
-0000e0d0: 6c65 5f6f 6e63 6520 7768 6c65 2073 6574  le_once whle set
-0000e0e0: 2074 6f20 4661 6c73 6520 6973 2073 7469   to False is sti
-0000e0f0: 6c6c 2069 676e 6f72 6564 0a20 2020 2023  ll ignored.    #
-0000e100: 2062 6563 6175 7365 206f 7572 2074 6974   because our tit
-0000e110: 6c65 5f6d 6178 6c65 6e20 3e20 626f 6479  le_maxlen > body
-0000e120: 5f6d 6178 6c65 6e20 616e 6420 6120 6675  _maxlen and a fu
-0000e130: 6c6c 2074 6974 6c65 2077 6173 0a20 2020  ll title was.   
-0000e140: 2023 2070 726f 7669 6465 640a 2020 2020   # provided.    
-0000e150: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-0000e160: 7329 203d 3d20 3232 0a20 2020 2066 6f72  s) == 22.    for
-0000e170: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
-0000e180: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
-0000e190: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
-0000e1a0: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
-0000e1b0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-0000e1c0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-0000e1d0: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
-0000e1e0: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
-0000e1f0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0000e200: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0000e210: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
-0000e220: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
-0000e230: 204f 7572 2074 6974 6c65 2068 6173 206e   Our title has n
-0000e240: 6f20 636f 756e 7465 7220 6164 6465 6420  o counter added 
-0000e250: 746f 2069 7420 6475 6520 746f 2069 7427  to it due to it'
-0000e260: 7320 6c65 6e67 7468 0a20 2020 2020 2020  s length.       
-0000e270: 2069 6620 6964 7820 3e20 313a 0a20 2020   if idx > 1:.   
-0000e280: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
-0000e290: 2028 6e6f 2074 6974 6c65 2064 6973 706c   (no title displ
-0000e2a0: 6179 6564 206f 6e20 666f 6c6c 6f77 696e  ayed on followin
-0000e2b0: 6720 656e 7472 6965 730a 2020 2020 2020  g entries.      
-0000e2c0: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
-0000e2d0: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
-0000e2e0: 3d3d 2022 220a 2020 2020 2020 2020 656c  == "".        el
-0000e2f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000e300: 2320 4265 6361 7573 6520 3135 3020 6973  # Because 150 is
-0000e310: 2077 6861 7420 7765 2073 6574 2074 6865   what we set the
-0000e320: 2074 6974 6c65 206c 696d 6974 2074 6f20   title limit to 
-0000e330: 3530 2064 7565 0a20 2020 2020 2020 2020  50 due.         
-0000e340: 2020 2023 2074 6f20 616d 616c 616d 6174     # to amalamat
-0000e350: 696f 6e2e 2020 5468 6520 6c6f 7765 7374  ion.  The lowest
-0000e360: 2076 616c 7565 2061 6c77 6179 7320 7072   value always pr
-0000e370: 6576 6169 6c73 0a20 2020 2020 2020 2020  evails.         
-0000e380: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-0000e390: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0000e3a0: 2920 3d3d 206f 626a 2e62 6f64 795f 6d61  ) == obj.body_ma
-0000e3b0: 786c 656e 0a20 2020 2020 2020 2020 2020  xlen.           
-0000e3c0: 2061 7373 6572 7420 7469 746c 655b 3a6f   assert title[:o
-0000e3d0: 626a 2e62 6f64 795f 6d61 786c 656e 5d20  bj.body_maxlen] 
-0000e3e0: 3d3d 2063 6875 6e6b 2e67 6574 2827 7469  == chunk.get('ti
-0000e3f0: 746c 6527 290a 0a20 2020 2020 2020 2023  tle')..        #
-0000e400: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
-0000e410: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
-0000e420: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
-0000e430: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
-0000e440: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
-0000e450: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
-0000e460: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
-0000e470: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
-0000e480: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
-0000e490: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
-0000e4a0: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
-0000e4b0: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
-0000e4c0: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
-0000e4d0: 2862 6f64 795b 6f66 6673 6574 3a20 6c65  (body[offset: le
-0000e4e0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0000e4f0: 745d 2920 2d20 5c0a 2020 2020 2020 2020  t]) - \.        
-0000e500: 2020 2020 6c65 6e28 626f 6479 5b6f 6666      len(body[off
-0000e510: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-0000e520: 2b20 6f66 6673 6574 5d0a 2020 2020 2020  + offset].      
-0000e530: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-0000e540: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-0000e550: 292e 7273 7472 6970 2829 290a 0a20 2020  ).rstrip())..   
-0000e560: 2020 2020 2061 7373 6572 7420 626f 6479       assert body
-0000e570: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-0000e580: 6479 2920 2b20 6f66 6673 6574 202b 2077  dy) + offset + w
-0000e590: 735f 6469 6666 5d5c 0a20 2020 2020 2020  s_diff]\.       
-0000e5a0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
-0000e5b0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
-0000e5c0: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
-0000e5d0: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
-0000e5e0: 2028 6c65 6e28 5f62 6f64 7929 202b 2077   (len(_body) + w
-0000e5f0: 735f 6469 6666 290a 0a0a 6465 6620 7465  s_diff)...def te
-0000e600: 7374 5f6e 6f74 6966 795f 6f76 6572 666c  st_notify_overfl
-0000e610: 6f77 5f73 706c 6974 5f77 6974 685f 616d  ow_split_with_am
-0000e620: 616c 6761 6d61 7469 6f6e 5f66 6f72 6365  algamation_force
-0000e630: 5f74 6974 6c65 5f6f 6e63 6528 293a 0a20  _title_once():. 
-0000e640: 2020 2022 2222 0a20 2020 2041 5049 3a20     """.    API: 
-0000e650: 4f76 6572 666c 6f77 2057 6974 6820 416d  Overflow With Am
-0000e660: 616c 6761 6d61 7469 6f6e 2028 7469 746c  algamation (titl
-0000e670: 6520 6f6e 6365 2920 5370 6c69 7420 4675  e once) Split Fu
-0000e680: 6e63 7469 6f6e 616c 6974 7920 5465 7374  nctionality Test
-0000e690: 696e 670a 0a20 2020 2022 2222 0a0a 2020  ing..    """..  
-0000e6a0: 2020 230a 2020 2020 2320 4120 6c69 7474    #.    # A litt
-0000e6b0: 6c65 2070 7265 7061 7261 7469 6f6e 0a20  le preparation. 
-0000e6c0: 2020 2023 0a0a 2020 2020 2320 4e75 6d62     #..    # Numb
-0000e6d0: 6572 206f 6620 6368 6172 6163 7465 7273  er of characters
-0000e6e0: 2070 6572 206c 696e 650a 2020 2020 726f   per line.    ro
-0000e6f0: 7720 3d20 3234 0a0a 2020 2020 2320 536f  w = 24..    # So
-0000e700: 6d65 2076 6172 6961 626c 6573 2077 6520  me variables we 
-0000e710: 7573 6520 746f 2063 6f6e 7472 6f6c 2074  use to control t
-0000e720: 6865 2064 6174 6120 7765 2077 6f72 6b20  he data we work 
-0000e730: 7769 7468 0a20 2020 2062 6f64 795f 6c65  with.    body_le
-0000e740: 6e20 3d20 3130 3234 0a20 2020 2074 6974  n = 1024.    tit
-0000e750: 6c65 5f6c 656e 203d 2031 3032 340a 0a20  le_len = 1024.. 
-0000e760: 2020 2023 2043 7265 6174 6520 6120 6c61     # Create a la
-0000e770: 7267 6520 626f 6479 2061 6e64 2074 6974  rge body and tit
-0000e780: 6c65 2077 6974 6820 7261 6e64 6f6d 2064  le with random d
-0000e790: 6174 610a 2020 2020 626f 6479 203d 2027  ata.    body = '
-0000e7a0: 272e 6a6f 696e 2863 686f 6963 6528 7374  '.join(choice(st
-0000e7b0: 725f 616c 7068 6120 2b20 7374 725f 6e75  r_alpha + str_nu
-0000e7c0: 6d29 2066 6f72 205f 2069 6e20 7261 6e67  m) for _ in rang
-0000e7d0: 6528 626f 6479 5f6c 656e 2929 0a20 2020  e(body_len)).   
-0000e7e0: 2062 6f64 7920 3d20 275c 725c 6e27 2e6a   body = '\r\n'.j
-0000e7f0: 6f69 6e28 5b62 6f64 795b 693a 2069 202b  oin([body[i: i +
-0000e800: 2072 6f77 5d20 666f 7220 6920 696e 2072   row] for i in r
-0000e810: 616e 6765 2830 2c20 6c65 6e28 626f 6479  ange(0, len(body
-0000e820: 292c 2072 6f77 295d 290a 0a20 2020 2023  ), row)])..    #
-0000e830: 2074 6865 206e 6577 206c 696e 6573 2061   the new lines a
-0000e840: 6464 2061 206c 6172 6765 2061 6d6f 756e  dd a large amoun
-0000e850: 7420 746f 206f 7572 2062 6f64 793b 206c  t to our body; l
-0000e860: 6574 7320 666f 7263 6520 7468 6520 636f  ets force the co
-0000e870: 6e74 656e 740a 2020 2020 2320 6261 636b  ntent.    # back
-0000e880: 2074 6f20 6265 696e 6720 3130 3234 2063   to being 1024 c
-0000e890: 6861 7261 6374 6572 732e 0a20 2020 2062  haracters..    b
-0000e8a0: 6f64 7920 3d20 626f 6479 5b30 3a31 3032  ody = body[0:102
-0000e8b0: 345d 0a0a 2020 2020 2320 4372 6561 7465  4]..    # Create
-0000e8c0: 206f 7572 2074 6974 6c65 2075 7369 6e67   our title using
-0000e8d0: 2072 616e 646f 6d20 6461 7461 0a20 2020   random data.   
-0000e8e0: 2074 6974 6c65 203d 2027 272e 6a6f 696e   title = ''.join
-0000e8f0: 2863 686f 6963 6528 7374 725f 616c 7068  (choice(str_alph
-0000e900: 6120 2b20 7374 725f 6e75 6d29 2066 6f72  a + str_num) for
-0000e910: 205f 2069 6e20 7261 6e67 6528 7469 746c   _ in range(titl
-0000e920: 655f 6c65 6e29 290a 0a20 2020 2023 0a20  e_len))..    #. 
-0000e930: 2020 2023 2046 6972 7374 2054 6573 743a     # First Test:
-0000e940: 2054 7275 6e63 6174 6564 2054 6974 6c65   Truncated Title
-0000e950: 0a20 2020 2023 0a20 2020 2063 6c61 7373  .    #.    class
-0000e960: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-0000e970: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
-0000e980: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
-0000e990: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
-0000e9a0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
-0000e9b0: 786c 656e 203d 2031 300a 0a20 2020 2020  xlen = 10..     
-0000e9c0: 2020 2023 2057 6974 6820 616d 616c 6761     # With amalga
-0000e9d0: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
-0000e9e0: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
-0000e9f0: 7465 5f74 6974 6c65 203d 2054 7275 650a  te_title = True.
-0000ea00: 0a20 2020 2020 2020 2023 2046 6f72 6365  .        # Force
-0000ea10: 2074 6974 6c65 2064 6973 706c 6179 6564   title displayed
-0000ea20: 206f 6e63 650a 2020 2020 2020 2020 6f76   once.        ov
-0000ea30: 6572 666c 6f77 5f64 6973 706c 6179 5f74  erflow_display_t
-0000ea40: 6974 6c65 5f6f 6e63 6520 3d20 5472 7565  itle_once = True
-0000ea50: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
-0000ea60: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
-0000ea70: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-0000ea80: 2020 2020 2020 2020 2020 2073 7570 6572             super
-0000ea90: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
-0000eaa0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
-0000eab0: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
-0000eac0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0000ead0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0000eae0: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
-0000eaf0: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
-0000eb00: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-0000eb10: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
-0000eb20: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
-0000eb30: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
-0000eb40: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
-0000eb50: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
-0000eb60: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
-0000eb70: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
-0000eb80: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
-0000eb90: 7765 2062 7265 616b 2074 6865 2074 6974  we break the tit
-0000eba0: 6c65 2074 6f20 6120 6d61 7820 6c65 6e67  le to a max leng
-0000ebb0: 7468 206f 6620 6f75 7220 7469 746c 655f  th of our title_
-0000ebc0: 6d61 780a 2020 2020 2320 616e 6420 7468  max.    # and th
-0000ebd0: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
-0000ebe0: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
-0000ebf0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-0000ec00: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-0000ec10: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
-0000ec20: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
-0000ec30: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-0000ec40: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-0000ec50: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-0000ec60: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0000ec70: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-0000ec80: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
-0000ec90: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0000eca0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0000ecb0: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
-0000ecc0: 3d74 6974 6c65 290a 2020 2020 6173 7365  =title).    asse
-0000ecd0: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-0000ece0: 3d20 310a 2020 2020 6173 7365 7274 2062  = 1.    assert b
-0000ecf0: 6f64 792e 6c73 7472 6970 2827 5c72 5c6e  ody.lstrip('\r\n
-0000ed00: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
-0000ed10: 7028 2920 3d3d 2063 6875 6e6b 735b 305d  p() == chunks[0]
-0000ed20: 2e67 6574 2827 626f 6479 2729 0a20 2020  .get('body').   
-0000ed30: 2061 7373 6572 7420 7469 746c 655b 303a   assert title[0:
-0000ed40: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-0000ed50: 5d20 3d3d 2063 6875 6e6b 735b 305d 2e67  ] == chunks[0].g
-0000ed60: 6574 2827 7469 746c 6527 290a 0a20 2020  et('title')..   
-0000ed70: 2023 0a20 2020 2023 204e 6578 7420 5465   #.    # Next Te
-0000ed80: 7374 3a20 4c69 6e65 2043 6f75 6e74 2043  st: Line Count C
-0000ed90: 6f6e 7472 6f6c 0a20 2020 2023 0a0a 2020  ontrol.    #..  
-0000eda0: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
-0000edb0: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
-0000edc0: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
-0000edd0: 2054 6573 7420 7469 746c 6520 6d61 7820   Test title max 
-0000ede0: 6c65 6e67 7468 0a20 2020 2020 2020 2074  length.        t
-0000edf0: 6974 6c65 5f6d 6178 6c65 6e20 3d20 350a  itle_maxlen = 5.
-0000ee00: 0a20 2020 2020 2020 2023 204d 6178 696d  .        # Maxim
-0000ee10: 756d 206e 756d 6265 7220 6f66 206c 696e  um number of lin
-0000ee20: 6573 0a20 2020 2020 2020 2062 6f64 795f  es.        body_
-0000ee30: 6d61 785f 6c69 6e65 5f63 6f75 6e74 203d  max_line_count =
-0000ee40: 2035 0a0a 2020 2020 2020 2020 2320 5769   5..        # Wi
-0000ee50: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
-0000ee60: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-0000ee70: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
-0000ee80: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
-0000ee90: 2020 2320 466f 7263 6520 7469 746c 6520    # Force title 
-0000eea0: 6469 7370 6c61 7965 6420 6f6e 6365 0a20  displayed once. 
-0000eeb0: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
-0000eec0: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
-0000eed0: 6365 203d 2054 7275 650a 0a20 2020 2020  ce = True..     
-0000eee0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0000eef0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-0000ef00: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-0000ef10: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-0000ef20: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-0000ef30: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-0000ef40: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-0000ef50: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0000ef60: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-0000ef70: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-0000ef80: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-0000ef90: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-0000efa0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-0000efb0: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-0000efc0: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-0000efd0: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-0000efe0: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
-0000eff0: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-0000f000: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-0000f010: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-0000f020: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-0000f030: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-0000f040: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-0000f050: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-0000f060: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-0000f070: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-0000f080: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0000f090: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-0000f0a0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-0000f0b0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-0000f0c0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-0000f0d0: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-0000f0e0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0000f0f0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0000f100: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-0000f110: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-0000f120: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0000f130: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-0000f140: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-0000f150: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-0000f160: 6368 756e 6b73 2920 3d3d 2031 0a20 2020  chunks) == 1.   
-0000f170: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-0000f180: 6b73 5b30 5d2e 6765 7428 2762 6f64 7927  ks[0].get('body'
-0000f190: 292e 7370 6c69 7428 275c 6e27 2929 203d  ).split('\n')) =
-0000f1a0: 3d20 6f62 6a2e 626f 6479 5f6d 6178 5f6c  = obj.body_max_l
-0000f1b0: 696e 655f 636f 756e 740a 2020 2020 6173  ine_count.    as
-0000f1c0: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
-0000f1d0: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
-0000f1e0: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
-0000f1f0: 2774 6974 6c65 2729 0a0a 2020 2020 230a  'title')..    #.
-0000f200: 2020 2020 2320 4e65 7874 2054 6573 743a      # Next Test:
-0000f210: 2053 706c 6974 2062 6f64 790a 2020 2020   Split body.    
-0000f220: 230a 0a20 2020 2063 6c61 7373 2054 6573  #..    class Tes
-0000f230: 744e 6f74 6966 6963 6174 696f 6e28 4e6f  tNotification(No
-0000f240: 7469 6679 4261 7365 293a 0a0a 2020 2020  tifyBase):..    
-0000f250: 2020 2020 2320 5465 7374 2074 6974 6c65      # Test title
-0000f260: 206d 6178 206c 656e 6774 680a 2020 2020   max length.    
-0000f270: 2020 2020 7469 746c 655f 6d61 786c 656e      title_maxlen
-0000f280: 203d 2074 6974 6c65 5f6c 656e 0a0a 2020   = title_len..  
-0000f290: 2020 2020 2020 2320 456e 666f 7263 6520        # Enforce 
-0000f2a0: 6120 626f 6479 206c 656e 6774 682e 204d  a body length. M
-0000f2b0: 616b 6520 7375 7265 2069 7427 7320 616e  ake sure it's an
-0000f2c0: 2069 6e74 2e0a 2020 2020 2020 2020 626f   int..        bo
-0000f2d0: 6479 5f6d 6178 6c65 6e20 3d20 696e 7428  dy_maxlen = int(
-0000f2e0: 626f 6479 5f6c 656e 202f 2034 290a 0a20  body_len / 4).. 
-0000f2f0: 2020 2020 2020 2023 2057 6974 6820 616d         # With am
-0000f300: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
-0000f310: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
-0000f320: 6761 6d61 7465 5f74 6974 6c65 203d 2054  gamate_title = T
-0000f330: 7275 650a 0a20 2020 2020 2020 2023 2046  rue..        # F
-0000f340: 6f72 6365 2074 6974 6c65 2064 6973 706c  orce title displ
-0000f350: 6179 6564 206f 6e63 650a 2020 2020 2020  ayed once.      
-0000f360: 2020 6f76 6572 666c 6f77 5f64 6973 706c    overflow_displ
-0000f370: 6179 5f74 6974 6c65 5f6f 6e63 6520 3d20  ay_title_once = 
-0000f380: 5472 7565 0a0a 2020 2020 2020 2020 6465  True..        de
-0000f390: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-0000f3a0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0000f3b0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-0000f3c0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
-0000f3d0: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
-0000f3e0: 2020 2064 6566 206e 6f74 6966 7928 7365     def notify(se
-0000f3f0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-0000f400: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
-0000f410: 2020 2320 5072 6574 656e 6420 6576 6572    # Pretend ever
-0000f420: 7974 6869 6e67 2069 7320 6f6b 6179 0a20  ything is okay. 
-0000f430: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000f440: 6e20 5472 7565 0a0a 2020 2020 2320 4c6f  n True..    # Lo
-0000f450: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
-0000f460: 2020 6f62 6a20 3d20 5465 7374 4e6f 7469    obj = TestNoti
-0000f470: 6669 6361 7469 6f6e 286f 7665 7266 6c6f  fication(overflo
-0000f480: 773d 4f76 6572 666c 6f77 4d6f 6465 2e53  w=OverflowMode.S
-0000f490: 504c 4954 290a 2020 2020 6173 7365 7274  PLIT).    assert
-0000f4a0: 206f 626a 2069 7320 6e6f 7420 4e6f 6e65   obj is not None
-0000f4b0: 0a0a 2020 2020 2320 5665 7269 6679 2074  ..    # Verify t
-0000f4c0: 6861 7420 7765 2062 7265 616b 2074 6865  hat we break the
-0000f4d0: 2074 6974 6c65 2074 6f20 6120 6d61 7820   title to a max 
-0000f4e0: 6c65 6e67 7468 206f 6620 6f75 7220 7469  length of our ti
-0000f4f0: 746c 655f 6d61 780a 2020 2020 2320 616e  tle_max.    # an
-0000f500: 6420 7468 6174 2074 6865 2062 6f64 7920  d that the body 
-0000f510: 7265 6d61 696e 7320 756e 746f 7563 6865  remains untouche
-0000f520: 640a 2020 2020 6368 756e 6b73 203d 206f  d.    chunks = o
-0000f530: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0000f540: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-0000f550: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
-0000f560: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0000f570: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-0000f580: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
-0000f590: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0000f5a0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0000f5b0: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
-0000f5c0: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-0000f5d0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0000f5e0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-0000f5f0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-0000f600: 6f66 6673 6574 203d 2030 0a20 2020 2061  offset = 0.    a
-0000f610: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
-0000f620: 2920 3d3d 2035 0a20 2020 2066 6f72 2069  ) == 5.    for i
-0000f630: 6478 2c20 6368 756e 6b20 696e 2065 6e75  dx, chunk in enu
-0000f640: 6d65 7261 7465 2863 6875 6e6b 732c 2073  merate(chunks, s
-0000f650: 7461 7274 3d31 293a 0a20 2020 2020 2020  tart=1):.       
-0000f660: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
-0000f670: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0000f680: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
-0000f690: 746c 6527 2929 203c 3d20 6f62 6a2e 7469  tle')) <= obj.ti
-0000f6a0: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
-0000f6b0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-0000f6c0: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
-0000f6d0: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
-0000f6e0: 6c65 6e0a 0a20 2020 2020 2020 2023 204e  len..        # N
-0000f6f0: 6f20 636f 756e 7465 7220 6973 2064 6973  o counter is dis
-0000f700: 706c 6179 6564 2062 6563 6175 7365 206f  played because o
-0000f710: 7572 2074 6974 6c65 2069 7320 736f 2065  ur title is so e
-0000f720: 6e6f 726d 6f75 730a 2020 2020 2020 2020  normous.        
-0000f730: 2320 5765 2073 7769 7463 6820 746f 2061  # We switch to a
-0000f740: 2064 6973 706c 6179 2074 6974 6c65 206f   display title o
-0000f750: 6e20 6669 7273 7420 6d65 7373 6167 6520  n first message 
-0000f760: 6f6e 6c79 0a20 2020 2020 2020 2069 6620  only.        if 
-0000f770: 6964 7820 3e20 313a 0a20 2020 2020 2020  idx > 1:.       
-0000f780: 2020 2020 2023 2045 6d70 7479 2028 6e6f       # Empty (no
-0000f790: 2074 6974 6c65 2064 6973 706c 6179 6564   title displayed
-0000f7a0: 206f 6e20 666f 6c6c 6f77 696e 6720 656e   on following en
-0000f7b0: 7472 6965 730a 2020 2020 2020 2020 2020  tries.          
-0000f7c0: 2020 6173 7365 7274 2063 6875 6e6b 2e67    assert chunk.g
-0000f7d0: 6574 2827 7469 746c 6527 2920 3d3d 2022  et('title') == "
-0000f7e0: 220a 2020 2020 2020 2020 656c 7365 3a0a  ".        else:.
-0000f7f0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-0000f800: 6520 6c65 6e67 7468 206f 6620 7468 6520  e length of the 
-0000f810: 626f 6479 2070 7265 7661 696c 7320 6f75  body prevails ou
-0000f820: 7220 7469 746c 6520 6475 6520 746f 2069  r title due to i
-0000f830: 7420 6265 696e 670a 2020 2020 2020 2020  t being.        
-0000f840: 2020 2020 2320 736f 206d 7563 6820 736d      # so much sm
-0000f850: 616c 6c65 7220 7468 656e 206f 7572 2074  aller then our t
-0000f860: 6974 6c65 206c 656e 6774 680a 2020 2020  itle length.    
-0000f870: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0000f880: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
-0000f890: 746c 6527 2929 203d 3d20 6f62 6a2e 626f  tle')) == obj.bo
-0000f8a0: 6479 5f6d 6178 6c65 6e0a 2020 2020 2020  dy_maxlen.      
-0000f8b0: 2020 2020 2020 6173 7365 7274 2074 6974        assert tit
-0000f8c0: 6c65 5b3a 6f62 6a2e 626f 6479 5f6d 6178  le[:obj.body_max
-0000f8d0: 6c65 6e5d 203d 3d20 6368 756e 6b2e 6765  len] == chunk.ge
-0000f8e0: 7428 2774 6974 6c65 2729 0a0a 2020 2020  t('title')..    
-0000f8f0: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
-0000f900: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
-0000f910: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
-0000f920: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
-0000f930: 2e67 6574 2827 626f 6479 2729 0a20 2020  .get('body').   
-0000f940: 2020 2020 2061 7373 6572 7420 626f 6479       assert body
-0000f950: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-0000f960: 6479 2920 2b20 6f66 6673 6574 5d5c 0a20  dy) + offset]\. 
-0000f970: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-0000f980: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-0000f990: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
-0000f9a0: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
-0000f9b0: 7365 7420 2b3d 206c 656e 285f 626f 6479  set += len(_body
-0000f9c0: 290a 0a20 2020 2023 2041 6e6f 7468 6572  )..    # Another
-0000f9d0: 2065 6467 6520 6361 7365 2077 6865 7265   edge case where
-0000f9e0: 2074 6865 2074 6974 6c65 206a 7573 7420   the title just 
-0000f9f0: 6973 6e27 7420 7468 6174 206c 6f6e 6720  isn't that long 
-0000fa00: 6c65 6176 696e 670a 2020 2020 2320 6120  leaving.    # a 
-0000fa10: 6c6f 7420 6f66 2073 7061 6365 2066 6f72  lot of space for
-0000fa20: 2074 6865 205b 7878 2f78 785d 2065 6e74   the [xx/xx] ent
-0000fa30: 7269 6573 2028 6e6f 2074 7275 6e63 6174  ries (no truncat
-0000fa40: 696f 6e20 6e65 6564 6564 290a 2020 2020  ion needed).    
-0000fa50: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0000fa60: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0000fa70: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-0000fa80: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-0000fa90: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0000faa0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-0000fab0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-0000fac0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0000fad0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-0000fae0: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-0000faf0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0000fb00: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0000fb10: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-0000fb20: 6974 6c65 5b3a 3230 5d29 0a20 2020 206f  itle[:20]).    o
-0000fb30: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
-0000fb40: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
-0000fb50: 203d 3d20 350a 2020 2020 666f 7220 6964   == 5.    for id
-0000fb60: 782c 2063 6875 6e6b 2069 6e20 656e 756d  x, chunk in enum
-0000fb70: 6572 6174 6528 6368 756e 6b73 2c20 7374  erate(chunks, st
-0000fb80: 6172 743d 3129 3a0a 2020 2020 2020 2020  art=1):.        
-0000fb90: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
-0000fba0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0000fbb0: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
-0000fbc0: 6c65 2729 2920 3c3d 206f 626a 2e74 6974  le')) <= obj.tit
-0000fbd0: 6c65 5f6d 6178 6c65 6e0a 2020 2020 2020  le_maxlen.      
-0000fbe0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-0000fbf0: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
-0000fc00: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
-0000fc10: 656e 0a0a 2020 2020 2020 2020 2320 4f75  en..        # Ou
-0000fc20: 7220 7469 746c 6520 6861 7320 6e6f 2063  r title has no c
-0000fc30: 6f75 6e74 6572 2061 6464 6564 2074 6f20  ounter added to 
-0000fc40: 6974 0a20 2020 2020 2020 2069 6620 6964  it.        if id
-0000fc50: 7820 3e20 313a 0a20 2020 2020 2020 2020  x > 1:.         
-0000fc60: 2020 2023 2045 6d70 7479 2028 6e6f 2074     # Empty (no t
-0000fc70: 6974 6c65 2064 6973 706c 6179 6564 206f  itle displayed o
-0000fc80: 6e20 666f 6c6c 6f77 696e 6720 656e 7472  n following entr
-0000fc90: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
-0000fca0: 6173 7365 7274 2063 6875 6e6b 2e67 6574  assert chunk.get
-0000fcb0: 2827 7469 746c 6527 2920 3d3d 2022 220a  ('title') == "".
-0000fcc0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000fcd0: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-0000fce0: 2062 6f64 7920 6c65 6e67 7468 2070 7265   body length pre
-0000fcf0: 7661 696c 7320 6475 6520 746f 206f 7572  vails due to our
-0000fd00: 2061 6d61 6c67 616d 6174 696f 6e20 666c   amalgamation fl
-0000fd10: 6167 0a20 2020 2020 2020 2020 2020 2061  ag.            a
-0000fd20: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-0000fd30: 6765 7428 2774 6974 6c65 2729 2920 3d3d  get('title')) ==
-0000fd40: 2032 300a 2020 2020 2020 2020 2020 2020   20.            
-0000fd50: 6173 7365 7274 2074 6974 6c65 5b3a 3230  assert title[:20
-0000fd60: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
-0000fd70: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
-0000fd80: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
-0000fd90: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
-0000fda0: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
-0000fdb0: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
-0000fdc0: 7428 2762 6f64 7927 290a 2020 2020 2020  t('body').      
-0000fdd0: 2020 6173 7365 7274 2062 6f64 795b 6f66    assert body[of
-0000fde0: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-0000fdf0: 202b 206f 6666 7365 745d 5c0a 2020 2020   + offset]\.    
-0000fe00: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
-0000fe10: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
-0000fe20: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
-0000fe30: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
-0000fe40: 202b 3d20 6c65 6e28 5f62 6f64 7929 0a0a   += len(_body)..
-0000fe50: 2020 2020 230a 2020 2020 2320 5465 7374      #.    # Test
-0000fe60: 2066 6f72 6369 6e67 206f 7665 7266 6c6f   forcing overflo
-0000fe70: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
-0000fe80: 6f6e 6365 0a20 2020 2023 0a20 2020 2063  once.    #.    c
-0000fe90: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
-0000fea0: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
-0000feb0: 293a 0a0a 2020 2020 2020 2020 2320 5465  ):..        # Te
-0000fec0: 7374 2074 6974 6c65 206d 6178 206c 656e  st title max len
-0000fed0: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
-0000fee0: 655f 6d61 786c 656e 203d 2074 6974 6c65  e_maxlen = title
-0000fef0: 5f6c 656e 0a0a 2020 2020 2020 2020 2320  _len..        # 
-0000ff00: 456e 666f 7263 6520 6120 626f 6479 206c  Enforce a body l
-0000ff10: 656e 6774 682e 204d 616b 6520 7375 7265  ength. Make sure
-0000ff20: 2069 7427 7320 616e 2069 6e74 2e0a 2020   it's an int..  
-0000ff30: 2020 2020 2020 626f 6479 5f6d 6178 6c65        body_maxle
-0000ff40: 6e20 3d20 696e 7428 626f 6479 5f6c 656e  n = int(body_len
-0000ff50: 202f 2034 290a 0a20 2020 2020 2020 2023   / 4)..        #
-0000ff60: 2057 6974 6820 616d 616c 6761 6d61 7469   With amalgamati
-0000ff70: 6f6e 0a20 2020 2020 2020 206f 7665 7266  on.        overf
-0000ff80: 6c6f 775f 616d 616c 6761 6d61 7465 5f74  low_amalgamate_t
-0000ff90: 6974 6c65 203d 2054 7275 650a 0a20 2020  itle = True..   
-0000ffa0: 2020 2020 2023 2020 4f6e 6c79 2064 6973       #  Only dis
-0000ffb0: 706c 6179 2074 6974 6c65 206f 6e63 650a  play title once.
-0000ffc0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-0000ffd0: 5f64 6973 706c 6179 5f74 6974 6c65 5f6f  _display_title_o
-0000ffe0: 6e63 6520 3d20 5472 7565 0a0a 2020 2020  nce = True..    
-0000fff0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00010000: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-00010010: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00010020: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00010030: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
-00010040: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
-00010050: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
-00010060: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00010070: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
-00010080: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
-00010090: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
-000100a0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-000100b0: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
-000100c0: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
-000100d0: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
-000100e0: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
-000100f0: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
-00010100: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
-00010110: 7420 4e6f 6e65 0a0a 2020 2020 6368 756e  t None..    chun
-00010120: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00010130: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-00010140: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-00010150: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-00010160: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00010170: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
-00010180: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-00010190: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-000101a0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-000101b0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-000101c0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-000101d0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-000101e0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-000101f0: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-00010200: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00010210: 6368 756e 6b73 2920 3d3d 2035 0a20 2020  chunks) == 5.   
-00010220: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-00010230: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-00010240: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-00010250: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-00010260: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-00010270: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-00010280: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-00010290: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-000102a0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000102b0: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-000102c0: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-000102d0: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
-000102e0: 2020 2023 204f 7572 2074 6974 6c65 2068     # Our title h
-000102f0: 6173 206e 6f20 636f 756e 7465 7220 6164  as no counter ad
-00010300: 6465 6420 746f 2069 740a 2020 2020 2020  ded to it.      
-00010310: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-00010320: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-00010330: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-00010340: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-00010350: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-00010360: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-00010370: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-00010380: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-00010390: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000103a0: 2023 2054 6865 2062 6f64 7920 6c65 6e67   # The body leng
-000103b0: 7468 2070 7265 7661 696c 7320 6475 6520  th prevails due 
-000103c0: 746f 206f 7572 2061 6d61 6c67 616d 6174  to our amalgamat
-000103d0: 696f 6e20 666c 6167 0a20 2020 2020 2020  ion flag.       
-000103e0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-000103f0: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-00010400: 2729 2920 3d3d 206f 626a 2e62 6f64 795f  ')) == obj.body_
-00010410: 6d61 786c 656e 0a20 2020 2020 2020 2020  maxlen.         
-00010420: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-00010430: 3a6f 626a 2e62 6f64 795f 6d61 786c 656e  :obj.body_maxlen
-00010440: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
-00010450: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
-00010460: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
-00010470: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
-00010480: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
-00010490: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
-000104a0: 7428 2762 6f64 7927 290a 2020 2020 2020  t('body').      
-000104b0: 2020 6173 7365 7274 2062 6f64 795b 6f66    assert body[of
-000104c0: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-000104d0: 202b 206f 6666 7365 745d 5c0a 2020 2020   + offset]\.    
-000104e0: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
-000104f0: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
-00010500: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
-00010510: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
-00010520: 202b 3d20 6c65 6e28 5f62 6f64 7929 0a0a   += len(_body)..
-00010530: 2020 2020 2320 5465 7374 206c 6172 6765      # Test large
-00010540: 7220 6d65 7373 6167 6573 0a20 2020 2023  r messages.    #
-00010550: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
-00010560: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
-00010570: 6368 6564 0a20 2020 2063 6c61 7373 2054  ched.    class T
-00010580: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-00010590: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
-000105a0: 2020 2020 2020 2320 5465 7374 2074 6974        # Test tit
-000105b0: 6c65 206d 6178 206c 656e 6774 680a 2020  le max length.  
-000105c0: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
-000105d0: 656e 203d 2031 3530 0a0a 2020 2020 2020  en = 150..      
-000105e0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
-000105f0: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
-00010600: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
-00010610: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
-00010620: 6178 6c65 6e20 3d20 3430 300a 0a20 2020  axlen = 400..   
-00010630: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
-00010640: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
-00010650: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
-00010660: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
-00010670: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
-00010680: 6365 2074 6974 6c65 2064 6973 706c 6179  ce title display
-00010690: 6564 206f 6e63 650a 2020 2020 2020 2020  ed once.        
-000106a0: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
-000106b0: 5f74 6974 6c65 5f6f 6e63 6520 3d20 5472  _title_once = Tr
-000106c0: 7565 0a0a 2020 2020 2020 2020 6465 6620  ue..        def 
-000106d0: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
-000106e0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-000106f0: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
-00010700: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
-00010710: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
-00010720: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
-00010730: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00010740: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00010750: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
-00010760: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
-00010770: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00010780: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
-00010790: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
-000107a0: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
-000107b0: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
-000107c0: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
-000107d0: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
-000107e0: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
-000107f0: 2020 2020 6e65 775f 626f 6479 203d 2028      new_body = (
-00010800: 626f 6479 202a 2035 3030 290a 2020 2020  body * 500).    
-00010810: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00010820: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00010830: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-00010840: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-00010850: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00010860: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00010870: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-00010880: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00010890: 7665 7266 6c6f 7728 626f 6479 3d6e 6577  verflow(body=new
-000108a0: 5f62 6f64 792c 2074 6974 6c65 3d22 2229  _body, title="")
-000108b0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-000108c0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-000108d0: 7728 626f 6479 3d6e 6577 5f62 6f64 792c  w(body=new_body,
-000108e0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-000108f0: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
-00010900: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00010910: 6b73 2920 3d3d 2031 3238 310a 2020 2020  ks) == 1281.    
-00010920: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-00010930: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-00010940: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-00010950: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-00010960: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-00010970: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-00010980: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-00010990: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-000109a0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-000109b0: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-000109c0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-000109d0: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-000109e0: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
-000109f0: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
-00010a00: 6564 2074 6f20 6974 0a20 2020 2020 2020  ed to it.       
-00010a10: 2069 6620 6964 7820 3e20 313a 0a20 2020   if idx > 1:.   
-00010a20: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
-00010a30: 2028 6e6f 2074 6974 6c65 2064 6973 706c   (no title displ
-00010a40: 6179 6564 206f 6e20 666f 6c6c 6f77 696e  ayed on followin
-00010a50: 6720 656e 7472 6965 730a 2020 2020 2020  g entries.      
-00010a60: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
-00010a70: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
-00010a80: 3d3d 2022 220a 2020 2020 2020 2020 656c  == "".        el
-00010a90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00010aa0: 2320 5468 6520 626f 6479 206c 656e 6774  # The body lengt
-00010ab0: 6820 7072 6576 6169 6c73 2064 7565 2074  h prevails due t
-00010ac0: 6f20 6f75 7220 616d 616c 6761 6d61 7469  o our amalgamati
-00010ad0: 6f6e 2066 6c61 670a 2020 2020 2020 2020  on flag.        
-00010ae0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-00010af0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-00010b00: 2929 203d 3d20 6f62 6a2e 7469 746c 655f  )) == obj.title_
-00010b10: 6d61 786c 656e 0a20 2020 2020 2020 2020  maxlen.         
-00010b20: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-00010b30: 3a6f 626a 2e74 6974 6c65 5f6d 6178 6c65  :obj.title_maxle
-00010b40: 6e5d 203d 3d20 6368 756e 6b2e 6765 7428  n] == chunk.get(
-00010b50: 2774 6974 6c65 2729 0a0a 2020 2020 2020  'title')..      
-00010b60: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-00010b70: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-00010b80: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-00010b90: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-00010ba0: 6574 2827 626f 6479 2729 0a0a 2020 2020  et('body')..    
-00010bb0: 2020 2020 2320 556e 2d75 7365 6420 7768      # Un-used wh
-00010bc0: 6974 6573 7061 6365 2069 7320 616c 7761  itespace is alwa
-00010bd0: 7973 2063 6c65 616e 6564 2075 703b 206d  ys cleaned up; m
-00010be0: 616b 6520 7375 7265 2077 6520 6163 636f  ake sure we acco
-00010bf0: 756e 7420 666f 720a 2020 2020 2020 2020  unt for.        
-00010c00: 2320 7468 6973 2069 6e20 6f75 7220 6e65  # this in our ne
-00010c10: 7720 6361 6c63 756c 6174 696f 6e0a 2020  w calculation.  
-00010c20: 2020 2020 2020 7773 5f64 6966 6620 3d20        ws_diff = 
-00010c30: 6c65 6e28 6e65 775f 626f 6479 5b6f 6666  len(new_body[off
-00010c40: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-00010c50: 2b20 6f66 6673 6574 5d29 202d 205c 0a20  + offset]) - \. 
-00010c60: 2020 2020 2020 2020 2020 206c 656e 286e             len(n
-00010c70: 6577 5f62 6f64 795b 6f66 6673 6574 3a20  ew_body[offset: 
-00010c80: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
-00010c90: 7365 745d 0a20 2020 2020 2020 2020 2020  set].           
-00010ca0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
-00010cb0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
-00010cc0: 7269 7028 2929 0a0a 2020 2020 2020 2020  rip())..        
-00010cd0: 6173 7365 7274 206e 6577 5f62 6f64 795b  assert new_body[
-00010ce0: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-00010cf0: 7929 202b 206f 6666 7365 7420 2b20 7773  y) + offset + ws
-00010d00: 5f64 6966 665d 5c0a 2020 2020 2020 2020  _diff]\.        
-00010d10: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-00010d20: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-00010d30: 6970 2829 203d 3d20 5f62 6f64 790a 2020  ip() == _body.  
-00010d40: 2020 2020 2020 6f66 6673 6574 202b 3d20        offset += 
-00010d50: 286c 656e 285f 626f 6479 2920 2b20 7773  (len(_body) + ws
-00010d60: 5f64 6966 6629 0a0a 2020 2020 2320 426f  _diff)..    # Bo
-00010d70: 6479 2063 6875 6e6b 2069 7320 6265 796f  dy chunk is beyo
-00010d80: 6e64 2034 2064 6967 6974 732c 2073 6f20  nd 4 digits, so 
-00010d90: 5b58 5858 582f 5858 5858 5d20 6973 2074  [XXXX/XXXX] is t
-00010da0: 7572 6e65 6420 6f66 660a 2020 2020 6e65  urned off.    ne
-00010db0: 775f 626f 6479 203d 2028 626f 6479 202a  w_body = (body *
-00010dc0: 2032 3530 3029 0a20 2020 2063 6875 6e6b   2500).    chunk
-00010dd0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00010de0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00010df0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00010e00: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00010e10: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00010e20: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00010e30: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00010e40: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00010e50: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
-00010e60: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-00010e70: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00010e80: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00010e90: 793d 6e65 775f 626f 6479 2c20 7469 746c  y=new_body, titl
-00010ea0: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
-00010eb0: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
-00010ec0: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-00010ed0: 3d20 3634 3031 0a20 2020 2066 6f72 2069  = 6401.    for i
-00010ee0: 6478 2c20 6368 756e 6b20 696e 2065 6e75  dx, chunk in enu
-00010ef0: 6d65 7261 7465 2863 6875 6e6b 732c 2073  merate(chunks, s
-00010f00: 7461 7274 3d31 293a 0a20 2020 2020 2020  tart=1):.       
-00010f10: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
-00010f20: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00010f30: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
-00010f40: 746c 6527 2929 203c 3d20 6f62 6a2e 7469  tle')) <= obj.ti
-00010f50: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
-00010f60: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-00010f70: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
-00010f80: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
-00010f90: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
-00010fa0: 7572 2074 6974 6c65 2068 6173 206e 6f20  ur title has no 
-00010fb0: 636f 756e 7465 7220 6164 6465 6420 746f  counter added to
-00010fc0: 2069 740a 2020 2020 2020 2020 6966 2069   it.        if i
-00010fd0: 6478 203e 2031 3a0a 2020 2020 2020 2020  dx > 1:.        
-00010fe0: 2020 2020 2320 456d 7074 7920 286e 6f20      # Empty (no 
-00010ff0: 7469 746c 6520 6469 7370 6c61 7965 6420  title displayed 
-00011000: 6f6e 2066 6f6c 6c6f 7769 6e67 2065 6e74  on following ent
-00011010: 7269 6573 0a20 2020 2020 2020 2020 2020  ries.           
-00011020: 2061 7373 6572 7420 6368 756e 6b2e 6765   assert chunk.ge
-00011030: 7428 2774 6974 6c65 2729 203d 3d20 2222  t('title') == ""
-00011040: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00011050: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-00011060: 2062 6f64 7920 6c65 6e67 7468 2070 7265   body length pre
-00011070: 7661 696c 7320 6475 6520 746f 206f 7572  vails due to our
-00011080: 2061 6d61 6c67 616d 6174 696f 6e20 666c   amalgamation fl
-00011090: 6167 0a20 2020 2020 2020 2020 2020 2061  ag.            a
-000110a0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-000110b0: 6765 7428 2774 6974 6c65 2729 2920 3d3d  get('title')) ==
-000110c0: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-000110d0: 6e0a 2020 2020 2020 2020 2020 2020 6173  n.            as
-000110e0: 7365 7274 2074 6974 6c65 5b3a 6f62 6a2e  sert title[:obj.
-000110f0: 7469 746c 655f 6d61 786c 656e 5d20 3d3d  title_maxlen] ==
-00011100: 2063 6875 6e6b 2e67 6574 2827 7469 746c   chunk.get('titl
-00011110: 6527 290a 0a20 2020 2020 2020 2023 204f  e')..        # O
-00011120: 7572 2062 6f64 7920 6973 206f 6e6c 7920  ur body is only 
-00011130: 6272 6f6b 656e 2075 703b 206e 6f74 206c  broken up; not l
-00011140: 6f73 740a 2020 2020 2020 2020 5f62 6f64  ost.        _bod
-00011150: 7920 3d20 6368 756e 6b2e 6765 7428 2762  y = chunk.get('b
-00011160: 6f64 7927 290a 0a20 2020 2020 2020 2023  ody')..        #
-00011170: 2055 6e2d 7573 6564 2077 6869 7465 7370   Un-used whitesp
-00011180: 6163 6520 6973 2061 6c77 6179 7320 636c  ace is always cl
-00011190: 6561 6e65 6420 7570 3b20 6d61 6b65 2073  eaned up; make s
-000111a0: 7572 6520 7765 2061 6363 6f75 6e74 2066  ure we account f
-000111b0: 6f72 0a20 2020 2020 2020 2023 2074 6869  or.        # thi
-000111c0: 7320 696e 206f 7572 206e 6577 2063 616c  s in our new cal
-000111d0: 6375 6c61 7469 6f6e 0a20 2020 2020 2020  culation.       
-000111e0: 2077 735f 6469 6666 203d 206c 656e 286e   ws_diff = len(n
-000111f0: 6577 5f62 6f64 795b 6f66 6673 6574 3a20  ew_body[offset: 
-00011200: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
-00011210: 7365 745d 2920 2d20 5c0a 2020 2020 2020  set]) - \.      
-00011220: 2020 2020 2020 6c65 6e28 6e65 775f 626f        len(new_bo
-00011230: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
-00011240: 626f 6479 2920 2b20 6f66 6673 6574 5d0a  body) + offset].
-00011250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011260: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
-00011270: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
-00011280: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
-00011290: 7420 6e65 775f 626f 6479 5b6f 6666 7365  t new_body[offse
-000112a0: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
-000112b0: 6f66 6673 6574 202b 2077 735f 6469 6666  offset + ws_diff
-000112c0: 5d5c 0a20 2020 2020 2020 2020 2020 202e  ]\.            .
-000112d0: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-000112e0: 5c78 3063 2729 2e72 7374 7269 7028 2920  \x0c').rstrip() 
-000112f0: 3d3d 205f 626f 6479 0a20 2020 2020 2020  == _body.       
-00011300: 206f 6666 7365 7420 2b3d 2028 6c65 6e28   offset += (len(
-00011310: 5f62 6f64 7929 202b 2077 735f 6469 6666  _body) + ws_diff
-00011320: 290a 0a20 2020 2023 2054 6573 7420 6c61  )..    # Test la
-00011330: 7267 6572 206d 6573 7361 6765 730a 2020  rger messages.  
-00011340: 2020 2320 616e 6420 7468 6174 2074 6865    # and that the
-00011350: 2062 6f64 7920 7265 6d61 696e 7320 756e   body remains un
-00011360: 746f 7563 6865 640a 2020 2020 636c 6173  touched.    clas
-00011370: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
-00011380: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
-00011390: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
-000113a0: 7469 746c 6520 6d61 7820 6c65 6e67 7468  title max length
-000113b0: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
-000113c0: 6178 6c65 6e20 3d20 3135 300a 0a20 2020  axlen = 150..   
-000113d0: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
-000113e0: 2062 6f64 7920 6c65 6e67 7468 2e20 4d61   body length. Ma
-000113f0: 6b65 2073 7572 6520 6974 2773 2061 6e20  ke sure it's an 
-00011400: 696e 742e 0a20 2020 2020 2020 2062 6f64  int..        bod
-00011410: 795f 6d61 786c 656e 203d 2031 3530 0a0a  y_maxlen = 150..
-00011420: 2020 2020 2020 2020 2320 5769 7468 2061          # With a
-00011430: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
-00011440: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
-00011450: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
-00011460: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
-00011470: 466f 7263 6520 7469 746c 6520 6469 7370  Force title disp
-00011480: 6c61 7965 6420 6f6e 6365 0a20 2020 2020  layed once.     
-00011490: 2020 206f 7665 7266 6c6f 775f 6469 7370     overflow_disp
-000114a0: 6c61 795f 7469 746c 655f 6f6e 6365 203d  lay_title_once =
-000114b0: 2054 7275 650a 0a20 2020 2020 2020 2064   True..        d
-000114c0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-000114d0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-000114e0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000114f0: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
-00011500: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
-00011510: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
-00011520: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00011530: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-00011540: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
-00011550: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
-00011560: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00011570: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
-00011580: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
-00011590: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
-000115a0: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
-000115b0: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
-000115c0: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
-000115d0: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
-000115e0: 650a 0a20 2020 206e 6577 5f62 6f64 7920  e..    new_body 
-000115f0: 3d20 2862 6f64 7920 2a20 3529 0a20 2020  = (body * 5).   
-00011600: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00011610: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00011620: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
-00011630: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
-00011640: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-00011650: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
-00011660: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00011670: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00011680: 6f76 6572 666c 6f77 2862 6f64 793d 6e65  overflow(body=ne
-00011690: 775f 626f 6479 2c20 7469 746c 653d 2222  w_body, title=""
-000116a0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-000116b0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-000116c0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
-000116d0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-000116e0: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
-000116f0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-00011700: 6e6b 7329 203d 3d20 3336 0a20 2020 2066  nks) == 36.    f
-00011710: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
-00011720: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
-00011730: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
-00011740: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
-00011750: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
-00011760: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
-00011770: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
-00011780: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
-00011790: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-000117a0: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
-000117b0: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
-000117c0: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
-000117d0: 2023 204f 7572 2074 6974 6c65 2068 6173   # Our title has
-000117e0: 206e 6f20 636f 756e 7465 7220 6164 6465   no counter adde
-000117f0: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
-00011800: 6966 2069 6478 203e 2031 3a0a 2020 2020  if idx > 1:.    
-00011810: 2020 2020 2020 2020 2320 456d 7074 7920          # Empty 
-00011820: 286e 6f20 7469 746c 6520 6469 7370 6c61  (no title displa
-00011830: 7965 6420 6f6e 2066 6f6c 6c6f 7769 6e67  yed on following
-00011840: 2065 6e74 7269 6573 0a20 2020 2020 2020   entries.       
-00011850: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
-00011860: 6b2e 6765 7428 2774 6974 6c65 2729 203d  k.get('title') =
-00011870: 3d20 2222 0a20 2020 2020 2020 2065 6c73  = "".        els
-00011880: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-00011890: 2042 6563 6175 7365 2031 3530 2069 7320   Because 150 is 
-000118a0: 7768 6174 2077 6520 7365 7420 7468 6520  what we set the 
-000118b0: 7469 746c 6520 6c69 6d69 7420 746f 0a20  title limit to. 
-000118c0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-000118d0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-000118e0: 2774 6974 6c65 2729 2920 3d3d 206f 626a  'title')) == obj
-000118f0: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
-00011900: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00011910: 2074 6974 6c65 5b3a 6f62 6a2e 7469 746c   title[:obj.titl
-00011920: 655f 6d61 786c 656e 5d20 3d3d 2063 6875  e_maxlen] == chu
-00011930: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
-00011940: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
-00011950: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
-00011960: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
-00011970: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
-00011980: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-00011990: 290a 0a20 2020 2020 2020 2023 2055 6e2d  )..        # Un-
-000119a0: 7573 6564 2077 6869 7465 7370 6163 6520  used whitespace 
-000119b0: 6973 2061 6c77 6179 7320 636c 6561 6e65  is always cleane
-000119c0: 6420 7570 3b20 6d61 6b65 2073 7572 6520  d up; make sure 
-000119d0: 7765 2061 6363 6f75 6e74 2066 6f72 0a20  we account for. 
-000119e0: 2020 2020 2020 2023 2074 6869 7320 696e         # this in
-000119f0: 206f 7572 206e 6577 2063 616c 6375 6c61   our new calcula
-00011a00: 7469 6f6e 0a20 2020 2020 2020 2077 735f  tion.        ws_
-00011a10: 6469 6666 203d 206c 656e 286e 6577 5f62  diff = len(new_b
-00011a20: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-00011a30: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
-00011a40: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
-00011a50: 2020 6c65 6e28 6e65 775f 626f 6479 5b6f    len(new_body[o
-00011a60: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00011a70: 2920 2b20 6f66 6673 6574 5d0a 2020 2020  ) + offset].    
-00011a80: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
-00011a90: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
-00011aa0: 6327 292e 7273 7472 6970 2829 290a 0a20  c').rstrip()).. 
-00011ab0: 2020 2020 2020 2061 7373 6572 7420 6e65         assert ne
-00011ac0: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
-00011ad0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00011ae0: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
-00011af0: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-00011b00: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-00011b10: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
-00011b20: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
-00011b30: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
-00011b40: 7929 202b 2077 735f 6469 6666 290a 0a20  y) + ws_diff).. 
-00011b50: 2020 2023 0a20 2020 2023 204e 6578 7420     #.    # Next 
-00011b60: 5465 7374 3a20 4170 7065 6e64 2074 6974  Test: Append tit
-00011b70: 6c65 2074 6f20 626f 6479 202b 2073 706c  le to body + spl
-00011b80: 6974 2062 6f64 790a 2020 2020 230a 0a20  it body.    #.. 
-00011b90: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
-00011ba0: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
-00011bb0: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
-00011bc0: 2320 456e 666f 7263 6520 6e6f 2074 6974  # Enforce no tit
-00011bd0: 6c65 0a20 2020 2020 2020 2074 6974 6c65  le.        title
-00011be0: 5f6d 6178 6c65 6e20 3d20 300a 0a20 2020  _maxlen = 0..   
-00011bf0: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
-00011c00: 2062 6f64 7920 6c65 6e67 7468 2062 6173   body length bas
-00011c10: 6564 206f 6e20 7468 6520 7469 746c 652e  ed on the title.
-00011c20: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
-00011c30: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
-00011c40: 626f 6479 5f6d 6178 6c65 6e20 3d20 696e  body_maxlen = in
-00011c50: 7428 7469 746c 655f 6c65 6e20 2f20 3429  t(title_len / 4)
-00011c60: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
-00011c70: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
-00011c80: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
-00011c90: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
-00011ca0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-00011cb0: 2320 466f 7263 6520 7469 746c 6520 6469  # Force title di
-00011cc0: 7370 6c61 7965 6420 6f6e 6365 0a20 2020  splayed once.   
-00011cd0: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
-00011ce0: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
-00011cf0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
-00011d00: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00011d10: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-00011d20: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
-00011d30: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
-00011d40: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
-00011d50: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
-00011d60: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-00011d70: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00011d80: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
-00011d90: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
-00011da0: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
-00011db0: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
-00011dc0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
-00011dd0: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
-00011de0: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
-00011df0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
-00011e00: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
-00011e10: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
-00011e20: 6f6e 650a 0a20 2020 2023 2056 6572 6966  one..    # Verif
-00011e30: 7920 7468 6174 2077 6520 6272 6561 6b20  y that we break 
-00011e40: 7468 6520 7469 746c 6520 746f 2061 206d  the title to a m
-00011e50: 6178 206c 656e 6774 6820 6f66 206f 7572  ax length of our
-00011e60: 2074 6974 6c65 5f6d 6178 0a20 2020 2023   title_max.    #
-00011e70: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
-00011e80: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
-00011e90: 6368 6564 0a20 2020 2063 6875 6e6b 7320  ched.    chunks 
-00011ea0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00011eb0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-00011ec0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
-00011ed0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00011ee0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00011ef0: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
-00011f00: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00011f10: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00011f20: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-00011f30: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-00011f40: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-00011f50: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
-00011f60: 2c20 7469 746c 653d 7469 746c 6529 0a0a  , title=title)..
-00011f70: 2020 2020 2320 4f75 7220 6669 6e61 6c20      # Our final 
-00011f80: 7072 6f64 7563 7420 6973 2074 6861 7420  product is that 
-00011f90: 6f75 7220 7469 746c 6520 6861 7320 6265  our title has be
-00011fa0: 656e 2061 7070 656e 6465 6420 746f 206f  en appended to o
-00011fb0: 7572 2062 6f64 7920 746f 0a20 2020 2023  ur body to.    #
-00011fc0: 2063 7265 6174 6520 6f6e 6520 6772 6561   create one grea
-00011fd0: 7420 6269 6720 626f 6479 2e20 4173 2061  t big body. As a
-00011fe0: 2072 6573 756c 7420 7765 276c 6c20 6765   result we'll ge
-00011ff0: 7420 7175 6974 6520 6120 6665 7720 6c69  t quite a few li
-00012000: 6e65 7320 6261 636b 0a20 2020 2023 206e  nes back.    # n
-00012010: 6f77 2e0a 2020 2020 6f66 6673 6574 203d  ow..    offset =
-00012020: 2030 0a0a 2020 2020 2320 4f75 7220 626f   0..    # Our bo
-00012030: 6479 2077 696c 6c20 6c6f 6f6b 206c 696b  dy will look lik
-00012040: 6520 7468 6973 2069 6e20 736d 616c 6c20  e this in small 
-00012050: 6368 756e 6b73 2061 7420 7468 6520 656e  chunks at the en
-00012060: 6420 6f66 2074 6865 2064 6179 0a20 2020  d of the day.   
-00012070: 2062 756c 6b20 3d20 7469 746c 6520 2b20   bulk = title + 
-00012080: 275c 725c 6e27 202b 2062 6f64 790a 0a20  '\r\n' + body.. 
-00012090: 2020 2023 2044 7565 2074 6f20 7468 6520     # Due to the 
-000120a0: 6e65 7720 6c69 6e65 2061 6464 6564 2074  new line added t
-000120b0: 6f20 7468 6520 656e 640a 2020 2020 6173  o the end.    as
-000120c0: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
-000120d0: 203d 3d20 280a 2020 2020 2020 2020 2320   == (.        # 
-000120e0: 7772 6170 2064 6976 6973 696f 6e20 696e  wrap division in
-000120f0: 2069 6e74 2829 2073 6f20 5079 7468 6f6e   int() so Python
-00012100: 2033 2064 6f65 736e 2774 2063 6f6e 7665   3 doesn't conve
-00012110: 7274 2069 7420 746f 2061 2066 6c6f 6174  rt it to a float
-00012120: 206f 6e0a 2020 2020 2020 2020 2320 7573   on.        # us
-00012130: 0a20 2020 2020 2020 2069 6e74 286c 656e  .        int(len
-00012140: 2862 756c 6b29 202f 206f 626a 2e62 6f64  (bulk) / obj.bod
-00012150: 795f 6d61 786c 656e 2920 2b0a 2020 2020  y_maxlen) +.    
-00012160: 2020 2020 2831 2069 6620 6c65 6e28 6275      (1 if len(bu
-00012170: 6c6b 2920 2520 6f62 6a2e 626f 6479 5f6d  lk) % obj.body_m
-00012180: 6178 6c65 6e20 656c 7365 2030 2929 0a0a  axlen else 0))..
-00012190: 2020 2020 666f 7220 6368 756e 6b20 696e      for chunk in
-000121a0: 2063 6875 6e6b 733a 0a20 2020 2020 2020   chunks:.       
-000121b0: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
-000121c0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-000121d0: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
-000121e0: 746c 6527 2929 203d 3d20 300a 2020 2020  tle')) == 0.    
-000121f0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-00012200: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
-00012210: 2920 3c3d 206f 626a 2e62 6f64 795f 6d61  ) <= obj.body_ma
-00012220: 786c 656e 0a0a 2020 2020 2020 2020 2320  xlen..        # 
-00012230: 4f75 7220 7469 746c 6520 6973 2065 6d70  Our title is emp
-00012240: 7479 2065 7665 7279 2074 696d 650a 2020  ty every time.  
-00012250: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
-00012260: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
-00012270: 3d3d 2027 270a 2020 2020 2020 2020 2320  == ''.        # 
-00012280: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
-00012290: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
-000122a0: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
-000122b0: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
-000122c0: 626f 6479 2729 0a0a 2020 2020 2020 2020  body')..        
-000122d0: 2320 556e 2d75 7365 6420 7768 6974 6573  # Un-used whites
-000122e0: 7061 6365 2069 7320 616c 7761 7973 2063  pace is always c
-000122f0: 6c65 616e 6564 2075 703b 206d 616b 6520  leaned up; make 
-00012300: 7375 7265 2077 6520 6163 636f 756e 7420  sure we account 
-00012310: 666f 720a 2020 2020 2020 2020 2320 7468  for.        # th
-00012320: 6973 2069 6e20 6f75 7220 6e65 7720 6361  is in our new ca
-00012330: 6c63 756c 6174 696f 6e0a 2020 2020 2020  lculation.      
-00012340: 2020 7773 5f64 6966 6620 3d20 6c65 6e28    ws_diff = len(
-00012350: 6275 6c6b 5b6f 6666 7365 743a 206c 656e  bulk[offset: len
-00012360: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-00012370: 5d29 202d 205c 0a20 2020 2020 2020 2020  ]) - \.         
-00012380: 2020 206c 656e 2862 756c 6b5b 6f66 6673     len(bulk[offs
-00012390: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
-000123a0: 206f 6666 7365 745d 0a20 2020 2020 2020   offset].       
-000123b0: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-000123c0: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-000123d0: 2e72 7374 7269 7028 2929 0a0a 2020 2020  .rstrip())..    
-000123e0: 2020 2020 6173 7365 7274 2062 756c 6b5b      assert bulk[
-000123f0: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-00012400: 7929 202b 206f 6666 7365 7420 2b20 7773  y) + offset + ws
-00012410: 5f64 6966 665d 5c0a 2020 2020 2020 2020  _diff]\.        
-00012420: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-00012430: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-00012440: 6970 2829 203d 3d20 5f62 6f64 790a 2020  ip() == _body.  
-00012450: 2020 2020 2020 6f66 6673 6574 202b 3d20        offset += 
-00012460: 286c 656e 285f 626f 6479 2920 2b20 7773  (len(_body) + ws
-00012470: 5f64 6966 6629 0a0a 2020 2020 230a 2020  _diff)..    #.  
-00012480: 2020 2320 5465 7374 2063 6173 6520 7768    # Test case wh
-00012490: 6572 6520 6f75 7220 7469 746c 655f 6c65  ere our title_le
-000124a0: 6e20 6973 2073 686f 7274 6572 2074 6865  n is shorter the
-000124b0: 6e20 7468 6520 7661 6c75 650a 2020 2020  n the value.    
-000124c0: 2320 7468 6174 2077 6f75 6c64 206f 7468  # that would oth
-000124d0: 6572 7769 7365 2074 7269 6767 6572 2074  erwise trigger t
-000124e0: 6865 205b 5858 2f58 585d 2065 6c65 6d65  he [XX/XX] eleme
-000124f0: 6e74 730a 2020 2020 230a 0a20 2020 2063  nts.    #..    c
-00012500: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
-00012510: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
-00012520: 293a 0a0a 2020 2020 2020 2020 2320 5365  ):..        # Se
-00012530: 7420 6120 736d 616c 6c20 7469 746c 6520  t a small title 
-00012540: 6c65 6e67 7468 0a20 2020 2020 2020 2074  length.        t
-00012550: 6974 6c65 5f6d 6178 6c65 6e20 3d20 3130  itle_maxlen = 10
-00012560: 300a 0a20 2020 2020 2020 2023 2045 6e66  0..        # Enf
-00012570: 6f72 6365 2061 2062 6f64 7920 6c65 6e67  orce a body leng
-00012580: 7468 2e20 4d61 6b65 2073 7572 6520 6974  th. Make sure it
-00012590: 2773 2061 6e20 696e 742e 0a20 2020 2020  's an int..     
-000125a0: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
-000125b0: 2069 6e74 2862 6f64 795f 6c65 6e20 2f20   int(body_len / 
-000125c0: 3429 0a0a 2020 2020 2020 2020 2320 5769  4)..        # Wi
-000125d0: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
-000125e0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-000125f0: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
-00012600: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
-00012610: 2020 2320 466f 7263 6520 7469 746c 6520    # Force title 
-00012620: 6469 7370 6c61 7965 6420 6f6e 6365 0a20  displayed once. 
-00012630: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
-00012640: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
-00012650: 6365 203d 2054 7275 650a 0a20 2020 2020  ce = True..     
-00012660: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00012670: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00012680: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00012690: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-000126a0: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-000126b0: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-000126c0: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-000126d0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-000126e0: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-000126f0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-00012700: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-00012710: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00012720: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-00012730: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-00012740: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-00012750: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-00012760: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
-00012770: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-00012780: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-00012790: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-000127a0: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-000127b0: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-000127c0: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-000127d0: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-000127e0: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-000127f0: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-00012800: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00012810: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00012820: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00012830: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00012840: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00012850: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00012860: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00012870: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00012880: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-00012890: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-000128a0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-000128b0: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-000128c0: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-000128d0: 0a20 2020 206f 6666 7365 7420 3d20 300a  .    offset = 0.
-000128e0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-000128f0: 6875 6e6b 7329 203d 3d20 350a 2020 2020  hunks) == 5.    
-00012900: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-00012910: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-00012920: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-00012930: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-00012940: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-00012950: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-00012960: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-00012970: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-00012980: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00012990: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-000129a0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-000129b0: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-000129c0: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
-000129d0: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
-000129e0: 6564 2074 6f20 6974 0a20 2020 2020 2020  ed to it.       
-000129f0: 2069 6620 6964 7820 3e20 313a 0a20 2020   if idx > 1:.   
-00012a00: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
-00012a10: 2028 6e6f 2074 6974 6c65 2064 6973 706c   (no title displ
-00012a20: 6179 6564 206f 6e20 666f 6c6c 6f77 696e  ayed on followin
-00012a30: 6720 656e 7472 6965 730a 2020 2020 2020  g entries.      
-00012a40: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
-00012a50: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
-00012a60: 3d3d 2022 220a 2020 2020 2020 2020 656c  == "".        el
-00012a70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00012a80: 2320 5468 6520 626f 6479 206c 656e 6774  # The body lengt
-00012a90: 6820 7072 6576 6169 6c73 2064 7565 2074  h prevails due t
-00012aa0: 6f20 6f75 7220 616d 616c 6761 6d61 7469  o our amalgamati
-00012ab0: 6f6e 2066 6c61 670a 2020 2020 2020 2020  on flag.        
-00012ac0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-00012ad0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-00012ae0: 2929 203d 3d20 6f62 6a2e 7469 746c 655f  )) == obj.title_
-00012af0: 6d61 786c 656e 0a20 2020 2020 2020 2020  maxlen.         
-00012b00: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-00012b10: 3a6f 626a 2e74 6974 6c65 5f6d 6178 6c65  :obj.title_maxle
-00012b20: 6e5d 203d 3d20 6368 756e 6b2e 6765 7428  n] == chunk.get(
-00012b30: 2774 6974 6c65 2729 0a0a 2020 2020 2020  'title')..      
-00012b40: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-00012b50: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-00012b60: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-00012b70: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-00012b80: 6574 2827 626f 6479 2729 0a0a 2020 2020  et('body')..    
-00012b90: 2020 2020 2320 556e 2d75 7365 6420 7768      # Un-used wh
-00012ba0: 6974 6573 7061 6365 2069 7320 616c 7761  itespace is alwa
-00012bb0: 7973 2063 6c65 616e 6564 2075 703b 206d  ys cleaned up; m
-00012bc0: 616b 6520 7375 7265 2077 6520 6163 636f  ake sure we acco
-00012bd0: 756e 7420 666f 720a 2020 2020 2020 2020  unt for.        
-00012be0: 2320 7468 6973 2069 6e20 6f75 7220 6e65  # this in our ne
-00012bf0: 7720 6361 6c63 756c 6174 696f 6e0a 2020  w calculation.  
-00012c00: 2020 2020 2020 7773 5f64 6966 6620 3d20        ws_diff = 
-00012c10: 6c65 6e28 626f 6479 5b6f 6666 7365 743a  len(body[offset:
-00012c20: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
-00012c30: 6673 6574 5d29 202d 205c 0a20 2020 2020  fset]) - \.     
-00012c40: 2020 2020 2020 206c 656e 2862 6f64 795b         len(body[
-00012c50: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-00012c60: 7929 202b 206f 6666 7365 745d 0a20 2020  y) + offset].   
-00012c70: 2020 2020 2020 2020 2020 2020 202e 6c73               .ls
-00012c80: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
-00012c90: 3063 2729 2e72 7374 7269 7028 2929 0a0a  0c').rstrip())..
-00012ca0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-00012cb0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-00012cc0: 5f62 6f64 7929 202b 206f 6666 7365 7420  _body) + offset 
-00012cd0: 2b20 7773 5f64 6966 665d 5c0a 2020 2020  + ws_diff]\.    
-00012ce0: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
-00012cf0: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
-00012d00: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
-00012d10: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
-00012d20: 202b 3d20 286c 656e 285f 626f 6479 2920   += (len(_body) 
-00012d30: 2b20 7773 5f64 6966 6629 0a0a 2020 2020  + ws_diff)..    
-00012d40: 230a 2020 2020 2320 5363 656e 6172 696f  #.    # Scenario
-00012d50: 2077 6865 7265 2074 6865 2074 6974 6c65   where the title
-00012d60: 206c 656e 6774 6820 6973 206c 6172 6765   length is large
-00012d70: 7220 7468 616e 2074 6865 2062 6f64 790a  r than the body.
-00012d80: 2020 2020 230a 0a20 2020 2063 6c61 7373      #..    class
-00012d90: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-00012da0: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
-00012db0: 2020 2020 2020 2020 2320 5365 7420 6120          # Set a 
-00012dc0: 736d 616c 6c20 7469 746c 6520 6c65 6e67  small title leng
-00012dd0: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
-00012de0: 5f6d 6178 6c65 6e20 3d20 3130 300a 0a20  _maxlen = 100.. 
-00012df0: 2020 2020 2020 2023 2045 6e66 6f72 6365         # Enforce
-00012e00: 2061 2062 6f64 7920 6c65 6e67 7468 2e20   a body length. 
-00012e10: 4d61 6b65 2073 7572 6520 6974 2773 2061  Make sure it's a
-00012e20: 6e20 696e 742e 0a20 2020 2020 2020 2062  n int..        b
-00012e30: 6f64 795f 6d61 786c 656e 203d 2035 300a  ody_maxlen = 50.
-00012e40: 0a20 2020 2020 2020 2023 2057 6974 6820  .        # With 
-00012e50: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
-00012e60: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
-00012e70: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
-00012e80: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
-00012e90: 2046 6f72 6365 2074 6974 6c65 2064 6973   Force title dis
-00012ea0: 706c 6179 6564 206f 6e63 650a 2020 2020  played once.    
-00012eb0: 2020 2020 6f76 6572 666c 6f77 5f64 6973      overflow_dis
-00012ec0: 706c 6179 5f74 6974 6c65 5f6f 6e63 6520  play_title_once 
-00012ed0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-00012ee0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00012ef0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00012f00: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-00012f10: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00012f20: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
-00012f30: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
-00012f40: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00012f50: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00012f60: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
-00012f70: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
-00012f80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00012f90: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
-00012fa0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
-00012fb0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
-00012fc0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
-00012fd0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
-00012fe0: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
-00012ff0: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
-00013000: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
-00013010: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
-00013020: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
-00013030: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
-00013040: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
-00013050: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
-00013060: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
-00013070: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
-00013080: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-00013090: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
-000130a0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
-000130b0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-000130c0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-000130d0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
-000130e0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-000130f0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00013100: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
-00013110: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-00013120: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00013130: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-00013140: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00013150: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
-00013160: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00013170: 6b73 2920 3d3d 2032 320a 2020 2020 666f  ks) == 22.    fo
-00013180: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
-00013190: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
-000131a0: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
-000131b0: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
-000131c0: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
-000131d0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-000131e0: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
-000131f0: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
-00013200: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00013210: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
-00013220: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
-00013230: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
-00013240: 2320 4f75 7220 7469 746c 6520 6861 7320  # Our title has 
-00013250: 6e6f 2063 6f75 6e74 6572 2061 6464 6564  no counter added
-00013260: 2074 6f20 6974 2064 7565 2074 6f20 6974   to it due to it
-00013270: 2773 206c 656e 6774 680a 2020 2020 2020  's length.      
-00013280: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-00013290: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-000132a0: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-000132b0: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-000132c0: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-000132d0: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-000132e0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-000132f0: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-00013300: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00013310: 2023 2042 6563 6175 7365 2031 3530 2069   # Because 150 i
-00013320: 7320 7768 6174 2077 6520 7365 7420 7468  s what we set th
-00013330: 6520 7469 746c 6520 6c69 6d69 7420 746f  e title limit to
-00013340: 2035 3020 6475 650a 2020 2020 2020 2020   50 due.        
-00013350: 2020 2020 2320 746f 2061 6d61 6c61 6d61      # to amalama
-00013360: 7469 6f6e 2e20 2054 6865 206c 6f77 6573  tion.  The lowes
-00013370: 7420 7661 6c75 6520 616c 7761 7973 2070  t value always p
-00013380: 7265 7661 696c 730a 2020 2020 2020 2020  revails.        
-00013390: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-000133a0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-000133b0: 2929 203d 3d20 6f62 6a2e 626f 6479 5f6d  )) == obj.body_m
-000133c0: 6178 6c65 6e0a 2020 2020 2020 2020 2020  axlen.          
-000133d0: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
-000133e0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e5d  obj.body_maxlen]
-000133f0: 203d 3d20 6368 756e 6b2e 6765 7428 2774   == chunk.get('t
-00013400: 6974 6c65 2729 0a0a 2020 2020 2020 2020  itle')..        
-00013410: 2320 4f75 7220 626f 6479 2069 7320 6f6e  # Our body is on
-00013420: 6c79 2062 726f 6b65 6e20 7570 3b20 6e6f  ly broken up; no
-00013430: 7420 6c6f 7374 0a20 2020 2020 2020 205f  t lost.        _
-00013440: 626f 6479 203d 2063 6875 6e6b 2e67 6574  body = chunk.get
-00013450: 2827 626f 6479 2729 0a0a 2020 2020 2020  ('body')..      
-00013460: 2020 2320 556e 2d75 7365 6420 7768 6974    # Un-used whit
-00013470: 6573 7061 6365 2069 7320 616c 7761 7973  espace is always
-00013480: 2063 6c65 616e 6564 2075 703b 206d 616b   cleaned up; mak
-00013490: 6520 7375 7265 2077 6520 6163 636f 756e  e sure we accoun
-000134a0: 7420 666f 720a 2020 2020 2020 2020 2320  t for.        # 
-000134b0: 7468 6973 2069 6e20 6f75 7220 6e65 7720  this in our new 
-000134c0: 6361 6c63 756c 6174 696f 6e0a 2020 2020  calculation.    
-000134d0: 2020 2020 7773 5f64 6966 6620 3d20 6c65      ws_diff = le
-000134e0: 6e28 626f 6479 5b6f 6666 7365 743a 206c  n(body[offset: l
-000134f0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00013500: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
-00013510: 2020 2020 206c 656e 2862 6f64 795b 6f66       len(body[of
-00013520: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-00013530: 202b 206f 6666 7365 745d 0a20 2020 2020   + offset].     
-00013540: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-00013550: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-00013560: 2729 2e72 7374 7269 7028 2929 0a0a 2020  ').rstrip())..  
-00013570: 2020 2020 2020 6173 7365 7274 2062 6f64        assert bod
-00013580: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-00013590: 6f64 7929 202b 206f 6666 7365 7420 2b20  ody) + offset + 
-000135a0: 7773 5f64 6966 665d 5c0a 2020 2020 2020  ws_diff]\.      
-000135b0: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
-000135c0: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-000135d0: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
-000135e0: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
-000135f0: 3d20 286c 656e 285f 626f 6479 2920 2b20  = (len(_body) + 
-00013600: 7773 5f64 6966 6629 0a0a 0a64 6566 2074  ws_diff)...def t
-00013610: 6573 745f 6e6f 7469 6679 5f6f 7665 7266  est_notify_overf
-00013620: 6c6f 775f 7370 6c69 745f 6e6f 5f61 6d61  low_split_no_ama
-00013630: 6c67 616d 6174 696f 6e28 293a 0a20 2020  lgamation():.   
-00013640: 2022 2222 0a20 2020 2041 5049 3a20 4f76   """.    API: Ov
-00013650: 6572 666c 6f77 204e 6f20 416d 616c 6761  erflow No Amalga
-00013660: 6d61 7469 6f6e 2053 706c 6974 7320 4675  mation Splits Fu
-00013670: 6e63 7469 6f6e 616c 6974 7920 5465 7374  nctionality Test
-00013680: 696e 670a 0a20 2020 2022 2222 0a0a 2020  ing..    """..  
-00013690: 2020 230a 2020 2020 2320 4120 6c69 7474    #.    # A litt
-000136a0: 6c65 2070 7265 7061 7261 7469 6f6e 0a20  le preparation. 
-000136b0: 2020 2023 0a0a 2020 2020 2320 4e75 6d62     #..    # Numb
-000136c0: 6572 206f 6620 6368 6172 6163 7465 7273  er of characters
-000136d0: 2070 6572 206c 696e 650a 2020 2020 726f   per line.    ro
-000136e0: 7720 3d20 3234 0a0a 2020 2020 2320 536f  w = 24..    # So
-000136f0: 6d65 2076 6172 6961 626c 6573 2077 6520  me variables we 
-00013700: 7573 6520 746f 2063 6f6e 7472 6f6c 2074  use to control t
-00013710: 6865 2064 6174 6120 7765 2077 6f72 6b20  he data we work 
-00013720: 7769 7468 0a20 2020 2062 6f64 795f 6c65  with.    body_le
-00013730: 6e20 3d20 3130 3234 0a20 2020 2074 6974  n = 1024.    tit
-00013740: 6c65 5f6c 656e 203d 2031 3032 340a 0a20  le_len = 1024.. 
-00013750: 2020 2023 2043 7265 6174 6520 6120 6c61     # Create a la
-00013760: 7267 6520 626f 6479 2061 6e64 2074 6974  rge body and tit
-00013770: 6c65 2077 6974 6820 7261 6e64 6f6d 2064  le with random d
-00013780: 6174 610a 2020 2020 626f 6479 203d 2027  ata.    body = '
-00013790: 272e 6a6f 696e 2863 686f 6963 6528 7374  '.join(choice(st
-000137a0: 725f 616c 7068 6120 2b20 7374 725f 6e75  r_alpha + str_nu
-000137b0: 6d29 2066 6f72 205f 2069 6e20 7261 6e67  m) for _ in rang
-000137c0: 6528 626f 6479 5f6c 656e 2929 0a20 2020  e(body_len)).   
-000137d0: 2062 6f64 7920 3d20 275c 725c 6e27 2e6a   body = '\r\n'.j
-000137e0: 6f69 6e28 5b62 6f64 795b 693a 2069 202b  oin([body[i: i +
-000137f0: 2072 6f77 5d20 666f 7220 6920 696e 2072   row] for i in r
-00013800: 616e 6765 2830 2c20 6c65 6e28 626f 6479  ange(0, len(body
-00013810: 292c 2072 6f77 295d 290a 0a20 2020 2023  ), row)])..    #
-00013820: 2074 6865 206e 6577 206c 696e 6573 2061   the new lines a
-00013830: 6464 2061 206c 6172 6765 2061 6d6f 756e  dd a large amoun
-00013840: 7420 746f 206f 7572 2062 6f64 793b 206c  t to our body; l
-00013850: 6574 7320 666f 7263 6520 7468 6520 636f  ets force the co
-00013860: 6e74 656e 740a 2020 2020 2320 6261 636b  ntent.    # back
-00013870: 2074 6f20 6265 696e 6720 3130 3234 2063   to being 1024 c
-00013880: 6861 7261 6374 6572 732e 0a20 2020 2062  haracters..    b
-00013890: 6f64 7920 3d20 626f 6479 5b30 3a31 3032  ody = body[0:102
-000138a0: 345d 0a0a 2020 2020 2320 4372 6561 7465  4]..    # Create
-000138b0: 206f 7572 2074 6974 6c65 2075 7369 6e67   our title using
-000138c0: 2072 616e 646f 6d20 6461 7461 0a20 2020   random data.   
-000138d0: 2074 6974 6c65 203d 2027 272e 6a6f 696e   title = ''.join
-000138e0: 2863 686f 6963 6528 7374 725f 616c 7068  (choice(str_alph
-000138f0: 6120 2b20 7374 725f 6e75 6d29 2066 6f72  a + str_num) for
-00013900: 205f 2069 6e20 7261 6e67 6528 7469 746c   _ in range(titl
-00013910: 655f 6c65 6e29 290a 0a20 2020 2023 0a20  e_len))..    #. 
-00013920: 2020 2023 2046 6972 7374 2054 6573 743a     # First Test:
-00013930: 2054 7275 6e63 6174 6564 2054 6974 6c65   Truncated Title
-00013940: 0a20 2020 2023 0a20 2020 2063 6c61 7373  .    #.    class
-00013950: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-00013960: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
-00013970: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
-00013980: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
-00013990: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
-000139a0: 786c 656e 203d 2031 300a 0a20 2020 2020  xlen = 10..     
-000139b0: 2020 2023 204e 6f20 616d 616c 6761 6d61     # No amalgama
-000139c0: 7469 6f6e 0a20 2020 2020 2020 206f 7665  tion.        ove
-000139d0: 7266 6c6f 775f 616d 616c 6761 6d61 7465  rflow_amalgamate
-000139e0: 5f74 6974 6c65 203d 2046 616c 7365 0a0a  _title = False..
-000139f0: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
-00013a00: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
-00013a10: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00013a20: 2020 2020 2020 2020 2073 7570 6572 2829           super()
-00013a30: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
-00013a40: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
-00013a50: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
-00013a60: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00013a70: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
-00013a80: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
-00013a90: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
-00013aa0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00013ab0: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
-00013ac0: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
-00013ad0: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
-00013ae0: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
-00013af0: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
-00013b00: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
-00013b10: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
-00013b20: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
-00013b30: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
-00013b40: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
-00013b50: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
-00013b60: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
-00013b70: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-00013b80: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-00013b90: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00013ba0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00013bb0: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-00013bc0: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-00013bd0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00013be0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00013bf0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-00013c00: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00013c10: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-00013c20: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-00013c30: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00013c40: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00013c50: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-00013c60: 6974 6c65 290a 2020 2020 6173 7365 7274  itle).    assert
-00013c70: 206c 656e 2863 6875 6e6b 7329 203d 3d20   len(chunks) == 
-00013c80: 310a 2020 2020 6173 7365 7274 2062 6f64  1.    assert bod
-00013c90: 792e 6c73 7472 6970 2827 5c72 5c6e 5c78  y.lstrip('\r\n\x
-00013ca0: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
-00013cb0: 2920 3d3d 2063 6875 6e6b 735b 305d 2e67  ) == chunks[0].g
-00013cc0: 6574 2827 626f 6479 2729 0a20 2020 2061  et('body').    a
-00013cd0: 7373 6572 7420 7469 746c 655b 303a 6f62  ssert title[0:ob
-00013ce0: 6a2e 7469 746c 655f 6d61 786c 656e 5d20  j.title_maxlen] 
-00013cf0: 3d3d 2063 6875 6e6b 735b 305d 2e67 6574  == chunks[0].get
-00013d00: 2827 7469 746c 6527 290a 0a20 2020 2023  ('title')..    #
-00013d10: 0a20 2020 2023 204e 6578 7420 5465 7374  .    # Next Test
-00013d20: 3a20 4c69 6e65 2043 6f75 6e74 2043 6f6e  : Line Count Con
-00013d30: 7472 6f6c 0a20 2020 2023 0a0a 2020 2020  trol.    #..    
-00013d40: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
-00013d50: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-00013d60: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
-00013d70: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
-00013d80: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
-00013d90: 6c65 5f6d 6178 6c65 6e20 3d20 350a 0a20  le_maxlen = 5.. 
-00013da0: 2020 2020 2020 2023 204d 6178 696d 756d         # Maximum
-00013db0: 206e 756d 6265 7220 6f66 206c 696e 6573   number of lines
-00013dc0: 0a20 2020 2020 2020 2062 6f64 795f 6d61  .        body_ma
-00013dd0: 785f 6c69 6e65 5f63 6f75 6e74 203d 2035  x_line_count = 5
-00013de0: 0a0a 2020 2020 2020 2020 2320 4e6f 2061  ..        # No a
-00013df0: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
-00013e00: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
-00013e10: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
-00013e20: 4661 6c73 650a 0a20 2020 2020 2020 2064  False..        d
-00013e30: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00013e40: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00013e50: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00013e60: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
-00013e70: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
-00013e80: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
-00013e90: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00013ea0: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-00013eb0: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
-00013ec0: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
-00013ed0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00013ee0: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
-00013ef0: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
-00013f00: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
-00013f10: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
-00013f20: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
-00013f30: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
-00013f40: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
-00013f50: 650a 0a20 2020 2023 2056 6572 6966 7920  e..    # Verify 
-00013f60: 7468 6174 2077 6520 6272 6561 6b20 7468  that we break th
-00013f70: 6520 7469 746c 6520 746f 2061 206d 6178  e title to a max
-00013f80: 206c 656e 6774 6820 6f66 206f 7572 2074   length of our t
-00013f90: 6974 6c65 5f6d 6178 0a20 2020 2023 2061  itle_max.    # a
-00013fa0: 6e64 2074 6861 7420 7468 6520 626f 6479  nd that the body
-00013fb0: 2072 656d 6169 6e73 2075 6e74 6f75 6368   remains untouch
-00013fc0: 6564 0a20 2020 2063 6875 6e6b 7320 3d20  ed.    chunks = 
-00013fd0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00013fe0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00013ff0: 6c65 3d74 6974 6c65 290a 2020 2020 6368  le=title).    ch
-00014000: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00014010: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00014020: 2222 2c20 7469 746c 653d 2222 290a 2020  "", title="").  
-00014030: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00014040: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00014050: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
-00014060: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-00014070: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-00014080: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-00014090: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
-000140a0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-000140b0: 6b73 2920 3d3d 2031 0a20 2020 2061 7373  ks) == 1.    ass
-000140c0: 6572 7420 6c65 6e28 6368 756e 6b73 5b30  ert len(chunks[0
-000140d0: 5d2e 6765 7428 2762 6f64 7927 292e 7370  ].get('body').sp
-000140e0: 6c69 7428 275c 6e27 2929 203d 3d20 6f62  lit('\n')) == ob
-000140f0: 6a2e 626f 6479 5f6d 6178 5f6c 696e 655f  j.body_max_line_
-00014100: 636f 756e 740a 2020 2020 6173 7365 7274  count.    assert
-00014110: 2074 6974 6c65 5b30 3a6f 626a 2e74 6974   title[0:obj.tit
-00014120: 6c65 5f6d 6178 6c65 6e5d 203d 3d20 6368  le_maxlen] == ch
-00014130: 756e 6b73 5b30 5d2e 6765 7428 2774 6974  unks[0].get('tit
-00014140: 6c65 2729 0a0a 2020 2020 230a 2020 2020  le')..    #.    
-00014150: 2320 4e65 7874 2054 6573 743a 2053 706c  # Next Test: Spl
-00014160: 6974 2062 6f64 790a 2020 2020 230a 0a20  it body.    #.. 
-00014170: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
-00014180: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
-00014190: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
-000141a0: 2320 5465 7374 2074 6974 6c65 206d 6178  # Test title max
-000141b0: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
-000141c0: 7469 746c 655f 6d61 786c 656e 203d 2074  title_maxlen = t
-000141d0: 6974 6c65 5f6c 656e 0a0a 2020 2020 2020  itle_len..      
-000141e0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
-000141f0: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
-00014200: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
-00014210: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
-00014220: 6178 6c65 6e20 3d20 696e 7428 626f 6479  axlen = int(body
-00014230: 5f6c 656e 202f 2034 290a 0a20 2020 2020  _len / 4)..     
-00014240: 2020 2023 204e 6f20 616d 616c 6761 6d61     # No amalgama
-00014250: 7469 6f6e 0a20 2020 2020 2020 206f 7665  tion.        ove
-00014260: 7266 6c6f 775f 616d 616c 6761 6d61 7465  rflow_amalgamate
-00014270: 5f74 6974 6c65 203d 2046 616c 7365 0a0a  _title = False..
-00014280: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
-00014290: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
-000142a0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-000142b0: 2020 2020 2020 2020 2073 7570 6572 2829           super()
-000142c0: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
-000142d0: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
-000142e0: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
-000142f0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00014300: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
-00014310: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
-00014320: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
-00014330: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00014340: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
-00014350: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
-00014360: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
-00014370: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
-00014380: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
-00014390: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
-000143a0: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
-000143b0: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
-000143c0: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
-000143d0: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
-000143e0: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
-000143f0: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
-00014400: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-00014410: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-00014420: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00014430: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00014440: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-00014450: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-00014460: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00014470: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00014480: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-00014490: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-000144a0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-000144b0: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-000144c0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-000144d0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-000144e0: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-000144f0: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
-00014500: 203d 2030 0a20 2020 2063 5f6c 656e 203d   = 0.    c_len =
-00014510: 206c 656e 2827 205b 582f 585d 2729 0a20   len(' [X/X]'). 
-00014520: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-00014530: 756e 6b73 2920 3d3d 2034 0a20 2020 2066  unks) == 4.    f
-00014540: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
-00014550: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
-00014560: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
-00014570: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
-00014580: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
-00014590: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
-000145a0: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
-000145b0: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
-000145c0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-000145d0: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
-000145e0: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
-000145f0: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
-00014600: 2023 204f 7572 2074 6974 6c65 2068 6173   # Our title has
-00014610: 2061 2063 6f75 6e74 6572 2061 6464 6564   a counter added
-00014620: 2074 6f20 6974 0a20 2020 2020 2020 2061   to it.        a
-00014630: 7373 6572 7420 7469 746c 655b 3a2d 635f  ssert title[:-c_
-00014640: 6c65 6e5d 203d 3d20 6368 756e 6b2e 6765  len] == chunk.ge
-00014650: 7428 2774 6974 6c65 2729 5b3a 2d63 5f6c  t('title')[:-c_l
-00014660: 656e 5d0a 2020 2020 2020 2020 6173 7365  en].        asse
-00014670: 7274 2063 6875 6e6b 2e67 6574 2827 7469  rt chunk.get('ti
-00014680: 746c 6527 295b 2d63 5f6c 656e 3a5d 203d  tle')[-c_len:] =
-00014690: 3d20 5c0a 2020 2020 2020 2020 2020 2020  = \.            
-000146a0: 2720 5b7b 3a30 317d 2f7b 3a30 317d 5d27  ' [{:01}/{:01}]'
-000146b0: 2e66 6f72 6d61 7428 6964 782c 206c 656e  .format(idx, len
-000146c0: 2863 6875 6e6b 7329 290a 2020 2020 2020  (chunks)).      
-000146d0: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-000146e0: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-000146f0: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-00014700: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-00014710: 6574 2827 626f 6479 2729 0a20 2020 2020  et('body').     
-00014720: 2020 2061 7373 6572 7420 626f 6479 5b6f     assert body[o
-00014730: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00014740: 2920 2b20 6f66 6673 6574 5d5c 0a20 2020  ) + offset]\.   
-00014750: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-00014760: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-00014770: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
-00014780: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
-00014790: 7420 2b3d 206c 656e 285f 626f 6479 290a  t += len(_body).
-000147a0: 0a20 2020 2023 2041 6e6f 7468 6572 2065  .    # Another e
-000147b0: 6467 6520 6361 7365 2077 6865 7265 2074  dge case where t
-000147c0: 6865 2074 6974 6c65 206a 7573 7420 6973  he title just is
-000147d0: 6e27 7420 7468 6174 206c 6f6e 6720 6c65  n't that long le
-000147e0: 6176 696e 670a 2020 2020 2320 6120 6c6f  aving.    # a lo
-000147f0: 7420 6f66 2073 7061 6365 2066 6f72 2074  t of space for t
-00014800: 6865 205b 7878 2f78 785d 2065 6e74 7269  he [xx/xx] entri
-00014810: 6573 2028 6e6f 2074 7275 6e63 6174 696f  es (no truncatio
-00014820: 6e20 6e65 6564 6564 290a 2020 2020 6368  n needed).    ch
-00014830: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00014840: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00014850: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
-00014860: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00014870: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00014880: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00014890: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-000148a0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-000148b0: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-000148c0: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-000148d0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-000148e0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-000148f0: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
-00014900: 6c65 5b3a 3230 5d29 0a20 2020 206f 6666  le[:20]).    off
-00014910: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
-00014920: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-00014930: 3d20 340a 2020 2020 666f 7220 6964 782c  = 4.    for idx,
-00014940: 2063 6875 6e6b 2069 6e20 656e 756d 6572   chunk in enumer
-00014950: 6174 6528 6368 756e 6b73 2c20 7374 6172  ate(chunks, star
-00014960: 743d 3129 3a0a 2020 2020 2020 2020 2320  t=1):.        # 
-00014970: 5665 7269 6669 6361 7469 6f6e 0a20 2020  Verification.   
-00014980: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-00014990: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-000149a0: 2729 2920 3c3d 206f 626a 2e74 6974 6c65  ')) <= obj.title
-000149b0: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
-000149c0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-000149d0: 2e67 6574 2827 626f 6479 2729 2920 3c3d  .get('body')) <=
-000149e0: 206f 626a 2e62 6f64 795f 6d61 786c 656e   obj.body_maxlen
-000149f0: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
-00014a00: 7469 746c 6520 6861 7320 6120 636f 756e  title has a coun
-00014a10: 7465 7220 6164 6465 6420 746f 2069 740a  ter added to it.
-00014a20: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00014a30: 6974 6c65 5b3a 3230 5d20 3d3d 2063 6875  itle[:20] == chu
-00014a40: 6e6b 2e67 6574 2827 7469 746c 6527 295b  nk.get('title')[
-00014a50: 3a2d 635f 6c65 6e5d 0a20 2020 2020 2020  :-c_len].       
-00014a60: 2061 7373 6572 7420 6368 756e 6b2e 6765   assert chunk.ge
-00014a70: 7428 2774 6974 6c65 2729 5b2d 635f 6c65  t('title')[-c_le
-00014a80: 6e3a 5d20 3d3d 205c 0a20 2020 2020 2020  n:] == \.       
-00014a90: 2020 2020 2027 205b 7b3a 3031 7d2f 7b3a       ' [{:01}/{:
-00014aa0: 3031 7d5d 272e 666f 726d 6174 2869 6478  01}]'.format(idx
-00014ab0: 2c20 6c65 6e28 6368 756e 6b73 2929 0a20  , len(chunks)). 
-00014ac0: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
-00014ad0: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
-00014ae0: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
-00014af0: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
-00014b00: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
-00014b10: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
-00014b20: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-00014b30: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
-00014b40: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
-00014b50: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-00014b60: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
-00014b70: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
-00014b80: 6f66 6673 6574 202b 3d20 6c65 6e28 5f62  offset += len(_b
-00014b90: 6f64 7929 0a0a 2020 2020 2320 5465 7374  ody)..    # Test
-00014ba0: 206c 6172 6765 7220 6d65 7373 6167 6573   larger messages
-00014bb0: 0a20 2020 2023 2061 6e64 2074 6861 7420  .    # and that 
-00014bc0: 7468 6520 626f 6479 2072 656d 6169 6e73  the body remains
-00014bd0: 2075 6e74 6f75 6368 6564 0a20 2020 2063   untouched.    c
-00014be0: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
-00014bf0: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
-00014c00: 293a 0a0a 2020 2020 2020 2020 2320 5465  ):..        # Te
-00014c10: 7374 2074 6974 6c65 206d 6178 206c 656e  st title max len
-00014c20: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
-00014c30: 655f 6d61 786c 656e 203d 2031 3530 0a0a  e_maxlen = 150..
-00014c40: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
-00014c50: 6520 6120 626f 6479 206c 656e 6774 682e  e a body length.
-00014c60: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
-00014c70: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
-00014c80: 626f 6479 5f6d 6178 6c65 6e20 3d20 3430  body_maxlen = 40
-00014c90: 300a 0a20 2020 2020 2020 2023 204e 6f20  0..        # No 
-00014ca0: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
-00014cb0: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
-00014cc0: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
-00014cd0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00014ce0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00014cf0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00014d00: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-00014d10: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00014d20: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
-00014d30: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
-00014d40: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00014d50: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00014d60: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
-00014d70: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
-00014d80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00014d90: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
-00014da0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
-00014db0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
-00014dc0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
-00014dd0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
-00014de0: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
-00014df0: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
-00014e00: 6e65 0a0a 2020 2020 6e65 775f 626f 6479  ne..    new_body
-00014e10: 203d 2028 626f 6479 202a 2035 3030 290a   = (body * 500).
-00014e20: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00014e30: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00014e40: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-00014e50: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
-00014e60: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00014e70: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00014e80: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-00014e90: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00014ea0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00014eb0: 3d6e 6577 5f62 6f64 792c 2074 6974 6c65  =new_body, title
-00014ec0: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-00014ed0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00014ee0: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
-00014ef0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-00014f00: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-00014f10: 0a20 2020 2063 5f6c 656e 203d 206c 656e  .    c_len = len
-00014f20: 2827 205b 5858 5858 2f58 5858 585d 2729  (' [XXXX/XXXX]')
-00014f30: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00014f40: 6368 756e 6b73 2920 3d3d 2031 3238 300a  chunks) == 1280.
-00014f50: 2020 2020 666f 7220 6964 782c 2063 6875      for idx, chu
-00014f60: 6e6b 2069 6e20 656e 756d 6572 6174 6528  nk in enumerate(
-00014f70: 6368 756e 6b73 2c20 7374 6172 743d 3129  chunks, start=1)
-00014f80: 3a0a 2020 2020 2020 2020 2320 5665 7269  :.        # Veri
-00014f90: 6669 6361 7469 6f6e 0a20 2020 2020 2020  fication.       
-00014fa0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00014fb0: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
-00014fc0: 3c3d 206f 626a 2e74 6974 6c65 5f6d 6178  <= obj.title_max
-00014fd0: 6c65 6e0a 2020 2020 2020 2020 6173 7365  len.        asse
-00014fe0: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
-00014ff0: 2827 626f 6479 2729 2920 3c3d 206f 626a  ('body')) <= obj
-00015000: 2e62 6f64 795f 6d61 786c 656e 0a20 2020  .body_maxlen.   
-00015010: 2020 2020 2023 204f 7572 2074 6974 6c65       # Our title
-00015020: 2068 6173 2061 2063 6f75 6e74 6572 2061   has a counter a
-00015030: 6464 6564 2074 6f20 6974 0a20 2020 2020  dded to it.     
-00015040: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-00015050: 3a6f 626a 2e74 6974 6c65 5f6d 6178 6c65  :obj.title_maxle
-00015060: 6e5d 5b3a 2d63 5f6c 656e 5d20 3d3d 2063  n][:-c_len] == c
-00015070: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-00015080: 295b 3a2d 635f 6c65 6e5d 0a20 2020 2020  )[:-c_len].     
-00015090: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
-000150a0: 6765 7428 2774 6974 6c65 2729 5b2d 635f  get('title')[-c_
-000150b0: 6c65 6e3a 5d20 3d3d 205c 0a20 2020 2020  len:] == \.     
-000150c0: 2020 2020 2020 2027 205b 7b3a 3034 7d2f         ' [{:04}/
-000150d0: 7b3a 3034 7d5d 272e 666f 726d 6174 2869  {:04}]'.format(i
-000150e0: 6478 2c20 6c65 6e28 6368 756e 6b73 2929  dx, len(chunks))
-000150f0: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
-00015100: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
-00015110: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
-00015120: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
-00015130: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-00015140: 290a 0a20 2020 2020 2020 2023 2055 6e2d  )..        # Un-
-00015150: 7573 6564 2077 6869 7465 7370 6163 6520  used whitespace 
-00015160: 6973 2061 6c77 6179 7320 636c 6561 6e65  is always cleane
-00015170: 6420 7570 3b20 6d61 6b65 2073 7572 6520  d up; make sure 
-00015180: 7765 2061 6363 6f75 6e74 2066 6f72 0a20  we account for. 
-00015190: 2020 2020 2020 2023 2074 6869 7320 696e         # this in
-000151a0: 206f 7572 206e 6577 2063 616c 6375 6c61   our new calcula
-000151b0: 7469 6f6e 0a20 2020 2020 2020 2077 735f  tion.        ws_
-000151c0: 6469 6666 203d 206c 656e 286e 6577 5f62  diff = len(new_b
-000151d0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-000151e0: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
-000151f0: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
-00015200: 2020 6c65 6e28 6e65 775f 626f 6479 5b6f    len(new_body[o
-00015210: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00015220: 2920 2b20 6f66 6673 6574 5d0a 2020 2020  ) + offset].    
-00015230: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
-00015240: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
-00015250: 6327 292e 7273 7472 6970 2829 290a 0a20  c').rstrip()).. 
-00015260: 2020 2020 2020 2061 7373 6572 7420 6e65         assert ne
-00015270: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
-00015280: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00015290: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
-000152a0: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-000152b0: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-000152c0: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
-000152d0: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
-000152e0: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
-000152f0: 7929 202b 2077 735f 6469 6666 290a 0a20  y) + ws_diff).. 
-00015300: 2020 2023 2042 6f64 7920 6368 756e 6b20     # Body chunk 
-00015310: 6973 2062 6579 6f6e 6420 3420 6469 6769  is beyond 4 digi
-00015320: 7473 2c20 736f 205b 5858 5858 2f58 5858  ts, so [XXXX/XXX
-00015330: 585d 2069 7320 7475 726e 6564 206f 6666  X] is turned off
-00015340: 0a20 2020 206e 6577 5f62 6f64 7920 3d20  .    new_body = 
-00015350: 2862 6f64 7920 2a20 3435 3030 290a 2020  (body * 4500).  
-00015360: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00015370: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00015380: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
-00015390: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
-000153a0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-000153b0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-000153c0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-000153d0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-000153e0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d6e  _overflow(body=n
-000153f0: 6577 5f62 6f64 792c 2074 6974 6c65 3d22  ew_body, title="
-00015400: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-00015410: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00015420: 6c6f 7728 626f 6479 3d6e 6577 5f62 6f64  low(body=new_bod
-00015430: 792c 2074 6974 6c65 3d74 6974 6c65 290a  y, title=title).
-00015440: 2020 2020 6f66 6673 6574 203d 2030 0a20      offset = 0. 
-00015450: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-00015460: 756e 6b73 2920 3d3d 2031 3135 3230 0a20  unks) == 11520. 
-00015470: 2020 2066 6f72 2069 6478 2c20 6368 756e     for idx, chun
-00015480: 6b20 696e 2065 6e75 6d65 7261 7465 2863  k in enumerate(c
-00015490: 6875 6e6b 732c 2073 7461 7274 3d31 293a  hunks, start=1):
-000154a0: 0a20 2020 2020 2020 2023 2056 6572 6966  .        # Verif
-000154b0: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
-000154c0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-000154d0: 2e67 6574 2827 7469 746c 6527 2929 203c  .get('title')) <
-000154e0: 3d20 6f62 6a2e 7469 746c 655f 6d61 786c  = obj.title_maxl
-000154f0: 656e 0a20 2020 2020 2020 2061 7373 6572  en.        asser
-00015500: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-00015510: 2762 6f64 7927 2929 203c 3d20 6f62 6a2e  'body')) <= obj.
-00015520: 626f 6479 5f6d 6178 6c65 6e0a 0a20 2020  body_maxlen..   
-00015530: 2020 2020 2023 204f 7572 2074 6974 6c65       # Our title
-00015540: 2068 6173 206e 6f20 636f 756e 7465 7220   has no counter 
-00015550: 6164 6465 6420 746f 2069 740a 2020 2020  added to it.    
-00015560: 2020 2020 6173 7365 7274 2074 6974 6c65      assert title
-00015570: 5b3a 6f62 6a2e 7469 746c 655f 6d61 786c  [:obj.title_maxl
-00015580: 656e 5d20 3d3d 2063 6875 6e6b 2e67 6574  en] == chunk.get
-00015590: 2827 7469 746c 6527 290a 2020 2020 2020  ('title').      
-000155a0: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
-000155b0: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
-000155c0: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
-000155d0: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
-000155e0: 6574 2827 626f 6479 2729 0a0a 2020 2020  et('body')..    
-000155f0: 2020 2020 2320 556e 2d75 7365 6420 7768      # Un-used wh
-00015600: 6974 6573 7061 6365 2069 7320 616c 7761  itespace is alwa
-00015610: 7973 2063 6c65 616e 6564 2075 703b 206d  ys cleaned up; m
-00015620: 616b 6520 7375 7265 2077 6520 6163 636f  ake sure we acco
-00015630: 756e 7420 666f 720a 2020 2020 2020 2020  unt for.        
-00015640: 2320 7468 6973 2069 6e20 6f75 7220 6e65  # this in our ne
-00015650: 7720 6361 6c63 756c 6174 696f 6e0a 2020  w calculation.  
-00015660: 2020 2020 2020 7773 5f64 6966 6620 3d20        ws_diff = 
-00015670: 6c65 6e28 6e65 775f 626f 6479 5b6f 6666  len(new_body[off
-00015680: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-00015690: 2b20 6f66 6673 6574 5d29 202d 205c 0a20  + offset]) - \. 
-000156a0: 2020 2020 2020 2020 2020 206c 656e 286e             len(n
-000156b0: 6577 5f62 6f64 795b 6f66 6673 6574 3a20  ew_body[offset: 
-000156c0: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
-000156d0: 7365 745d 0a20 2020 2020 2020 2020 2020  set].           
-000156e0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
-000156f0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
-00015700: 7269 7028 2929 0a0a 2020 2020 2020 2020  rip())..        
-00015710: 6173 7365 7274 206e 6577 5f62 6f64 795b  assert new_body[
-00015720: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-00015730: 7929 202b 206f 6666 7365 7420 2b20 7773  y) + offset + ws
-00015740: 5f64 6966 665d 5c0a 2020 2020 2020 2020  _diff]\.        
-00015750: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-00015760: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-00015770: 6970 2829 203d 3d20 5f62 6f64 790a 2020  ip() == _body.  
-00015780: 2020 2020 2020 6f66 6673 6574 202b 3d20        offset += 
-00015790: 286c 656e 285f 626f 6479 2920 2b20 7773  (len(_body) + ws
-000157a0: 5f64 6966 6629 0a0a 2020 2020 2320 5465  _diff)..    # Te
-000157b0: 7374 206c 6172 6765 7220 6d65 7373 6167  st larger messag
-000157c0: 6573 0a20 2020 2023 2061 6e64 2074 6861  es.    # and tha
-000157d0: 7420 7468 6520 626f 6479 2072 656d 6169  t the body remai
-000157e0: 6e73 2075 6e74 6f75 6368 6564 0a20 2020  ns untouched.   
-000157f0: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
-00015800: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
-00015810: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
-00015820: 5465 7374 2074 6974 6c65 206d 6178 206c  Test title max l
-00015830: 656e 6774 680a 2020 2020 2020 2020 7469  ength.        ti
-00015840: 746c 655f 6d61 786c 656e 203d 2031 3530  tle_maxlen = 150
-00015850: 0a0a 2020 2020 2020 2020 2320 456e 666f  ..        # Enfo
-00015860: 7263 6520 6120 626f 6479 206c 656e 6774  rce a body lengt
-00015870: 682e 204d 616b 6520 7375 7265 2069 7427  h. Make sure it'
-00015880: 7320 616e 2069 6e74 2e0a 2020 2020 2020  s an int..      
-00015890: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
-000158a0: 3135 300a 0a20 2020 2020 2020 2023 204e  150..        # N
-000158b0: 6f20 616d 616c 6761 6d61 7469 6f6e 0a20  o amalgamation. 
-000158c0: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
-000158d0: 616d 616c 6761 6d61 7465 5f74 6974 6c65  amalgamate_title
-000158e0: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-000158f0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00015900: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00015910: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-00015920: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
-00015930: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
-00015940: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
-00015950: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
-00015960: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00015970: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
-00015980: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
-00015990: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
-000159a0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-000159b0: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
-000159c0: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
-000159d0: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
-000159e0: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
-000159f0: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
-00015a00: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
-00015a10: 4e6f 6e65 0a0a 2020 2020 6e65 775f 626f  None..    new_bo
-00015a20: 6479 203d 2028 626f 6479 202a 2035 290a  dy = (body * 5).
-00015a30: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00015a40: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00015a50: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-00015a60: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
-00015a70: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00015a80: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00015a90: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-00015aa0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00015ab0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00015ac0: 3d6e 6577 5f62 6f64 792c 2074 6974 6c65  =new_body, title
-00015ad0: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-00015ae0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00015af0: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
-00015b00: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-00015b10: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-00015b20: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00015b30: 6368 756e 6b73 2920 3d3d 2033 350a 2020  chunks) == 35.  
-00015b40: 2020 635f 6c65 6e20 3d20 6c65 6e28 2720    c_len = len(' 
-00015b50: 5b58 582f 5858 5d27 290a 2020 2020 666f  [XX/XX]').    fo
-00015b60: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
-00015b70: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
-00015b80: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
-00015b90: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
-00015ba0: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
-00015bb0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
-00015bc0: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
-00015bd0: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
-00015be0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00015bf0: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
-00015c00: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
-00015c10: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
-00015c20: 2320 4f75 7220 7469 746c 6520 6861 7320  # Our title has 
-00015c30: 6120 636f 756e 7465 7220 6164 6465 6420  a counter added 
-00015c40: 746f 2069 740a 2020 2020 2020 2020 6173  to it.        as
-00015c50: 7365 7274 2074 6974 6c65 5b3a 6f62 6a2e  sert title[:obj.
-00015c60: 7469 746c 655f 6d61 786c 656e 5d5b 3a2d  title_maxlen][:-
-00015c70: 635f 6c65 6e5d 203d 3d20 6368 756e 6b2e  c_len] == chunk.
-00015c80: 6765 7428 2774 6974 6c65 2729 5b3a 2d63  get('title')[:-c
-00015c90: 5f6c 656e 5d0a 2020 2020 2020 2020 6173  _len].        as
-00015ca0: 7365 7274 2063 6875 6e6b 2e67 6574 2827  sert chunk.get('
-00015cb0: 7469 746c 6527 295b 2d63 5f6c 656e 3a5d  title')[-c_len:]
-00015cc0: 203d 3d20 5c0a 2020 2020 2020 2020 2020   == \.          
-00015cd0: 2020 2720 5b7b 3a30 327d 2f7b 3a30 327d    ' [{:02}/{:02}
-00015ce0: 5d27 2e66 6f72 6d61 7428 6964 782c 206c  ]'.format(idx, l
-00015cf0: 656e 2863 6875 6e6b 7329 290a 2020 2020  en(chunks)).    
-00015d00: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
-00015d10: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
-00015d20: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
-00015d30: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
-00015d40: 2e67 6574 2827 626f 6479 2729 0a0a 2020  .get('body')..  
-00015d50: 2020 2020 2020 2320 556e 2d75 7365 6420        # Un-used 
-00015d60: 7768 6974 6573 7061 6365 2069 7320 616c  whitespace is al
-00015d70: 7761 7973 2063 6c65 616e 6564 2075 703b  ways cleaned up;
-00015d80: 206d 616b 6520 7375 7265 2077 6520 6163   make sure we ac
-00015d90: 636f 756e 7420 666f 720a 2020 2020 2020  count for.      
-00015da0: 2020 2320 7468 6973 2069 6e20 6f75 7220    # this in our 
-00015db0: 6e65 7720 6361 6c63 756c 6174 696f 6e0a  new calculation.
-00015dc0: 2020 2020 2020 2020 7773 5f64 6966 6620          ws_diff 
-00015dd0: 3d20 6c65 6e28 6e65 775f 626f 6479 5b6f  = len(new_body[o
-00015de0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00015df0: 2920 2b20 6f66 6673 6574 5d29 202d 205c  ) + offset]) - \
-00015e00: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-00015e10: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
-00015e20: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-00015e30: 6666 7365 745d 0a20 2020 2020 2020 2020  ffset].         
-00015e40: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
-00015e50: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
-00015e60: 7374 7269 7028 2929 0a0a 2020 2020 2020  strip())..      
-00015e70: 2020 6173 7365 7274 206e 6577 5f62 6f64    assert new_bod
-00015e80: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-00015e90: 6f64 7929 202b 206f 6666 7365 7420 2b20  ody) + offset + 
-00015ea0: 7773 5f64 6966 665d 5c0a 2020 2020 2020  ws_diff]\.      
-00015eb0: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
-00015ec0: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-00015ed0: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
-00015ee0: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
-00015ef0: 3d20 286c 656e 285f 626f 6479 2920 2b20  = (len(_body) + 
-00015f00: 7773 5f64 6966 6629 0a0a 2020 2020 230a  ws_diff)..    #.
-00015f10: 2020 2020 2320 4e65 7874 2054 6573 743a      # Next Test:
-00015f20: 2041 7070 656e 6420 7469 746c 6520 746f   Append title to
-00015f30: 2062 6f64 7920 2b20 7370 6c69 7420 626f   body + split bo
-00015f40: 6479 0a20 2020 2023 0a0a 2020 2020 636c  dy.    #..    cl
-00015f50: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
-00015f60: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
-00015f70: 3a0a 0a20 2020 2020 2020 2023 2045 6e66  :..        # Enf
-00015f80: 6f72 6365 206e 6f20 7469 746c 650a 2020  orce no title.  
-00015f90: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
-00015fa0: 656e 203d 2030 0a0a 2020 2020 2020 2020  en = 0..        
-00015fb0: 2320 456e 666f 7263 6520 6120 626f 6479  # Enforce a body
-00015fc0: 206c 656e 6774 6820 6261 7365 6420 6f6e   length based on
-00015fd0: 2074 6865 2074 6974 6c65 2e20 4d61 6b65   the title. Make
-00015fe0: 2073 7572 6520 6974 2773 2061 6e20 696e   sure it's an in
-00015ff0: 742e 0a20 2020 2020 2020 2062 6f64 795f  t..        body_
-00016000: 6d61 786c 656e 203d 2069 6e74 2874 6974  maxlen = int(tit
-00016010: 6c65 5f6c 656e 202f 2034 290a 0a20 2020  le_len / 4)..   
-00016020: 2020 2020 2023 204e 6f20 416d 616c 6761       # No Amalga
-00016030: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
-00016040: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
-00016050: 7465 5f74 6974 6c65 203d 2046 616c 7365  te_title = False
-00016060: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
-00016070: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
-00016080: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00016090: 2020 2020 2020 2020 2020 2073 7570 6572             super
-000160a0: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
-000160b0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
-000160c0: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
-000160d0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-000160e0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-000160f0: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
-00016100: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
-00016110: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00016120: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
-00016130: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
-00016140: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
-00016150: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
-00016160: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
-00016170: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
-00016180: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
-00016190: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
-000161a0: 7765 2062 7265 616b 2074 6865 2074 6974  we break the tit
-000161b0: 6c65 2074 6f20 6120 6d61 7820 6c65 6e67  le to a max leng
-000161c0: 7468 206f 6620 6f75 7220 7469 746c 655f  th of our title_
-000161d0: 6d61 780a 2020 2020 2320 616e 6420 7468  max.    # and th
-000161e0: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
-000161f0: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
-00016200: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00016210: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00016220: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
-00016230: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
-00016240: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00016250: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-00016260: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-00016270: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-00016280: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-00016290: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
-000162a0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-000162b0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-000162c0: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
-000162d0: 3d74 6974 6c65 290a 0a20 2020 2023 204f  =title)..    # O
-000162e0: 7572 2066 696e 616c 2070 726f 6475 6374  ur final product
-000162f0: 2069 7320 7468 6174 206f 7572 2074 6974   is that our tit
-00016300: 6c65 2068 6173 2062 6565 6e20 6170 7065  le has been appe
-00016310: 6e64 6564 2074 6f20 6f75 7220 626f 6479  nded to our body
-00016320: 2074 6f0a 2020 2020 2320 6372 6561 7465   to.    # create
-00016330: 206f 6e65 2067 7265 6174 2062 6967 2062   one great big b
-00016340: 6f64 792e 2041 7320 6120 7265 7375 6c74  ody. As a result
-00016350: 2077 6527 6c6c 2067 6574 2071 7569 7465   we'll get quite
-00016360: 2061 2066 6577 206c 696e 6573 2062 6163   a few lines bac
-00016370: 6b0a 2020 2020 2320 6e6f 772e 0a20 2020  k.    # now..   
-00016380: 206f 6666 7365 7420 3d20 300a 0a20 2020   offset = 0..   
-00016390: 2023 204f 7572 2062 6f64 7920 7769 6c6c   # Our body will
-000163a0: 206c 6f6f 6b20 6c69 6b65 2074 6869 7320   look like this 
-000163b0: 696e 2073 6d61 6c6c 2063 6875 6e6b 7320  in small chunks 
-000163c0: 6174 2074 6865 2065 6e64 206f 6620 7468  at the end of th
-000163d0: 6520 6461 790a 2020 2020 6275 6c6b 203d  e day.    bulk =
-000163e0: 2074 6974 6c65 202b 2027 5c72 5c6e 2720   title + '\r\n' 
-000163f0: 2b20 626f 6479 0a0a 2020 2020 2320 4475  + body..    # Du
-00016400: 6520 746f 2074 6865 206e 6577 206c 696e  e to the new lin
-00016410: 6520 6164 6465 6420 746f 2074 6865 2065  e added to the e
-00016420: 6e64 0a20 2020 2061 7373 6572 7420 6c65  nd.    assert le
-00016430: 6e28 6368 756e 6b73 2920 3d3d 2028 0a20  n(chunks) == (. 
-00016440: 2020 2020 2020 2023 2077 7261 7020 6469         # wrap di
-00016450: 7669 7369 6f6e 2069 6e20 696e 7428 2920  vision in int() 
-00016460: 736f 2050 7974 686f 6e20 3320 646f 6573  so Python 3 does
-00016470: 6e27 7420 636f 6e76 6572 7420 6974 2074  n't convert it t
-00016480: 6f20 6120 666c 6f61 7420 6f6e 0a20 2020  o a float on.   
-00016490: 2020 2020 2023 2075 730a 2020 2020 2020       # us.      
-000164a0: 2020 696e 7428 6c65 6e28 6275 6c6b 2920    int(len(bulk) 
-000164b0: 2f20 6f62 6a2e 626f 6479 5f6d 6178 6c65  / obj.body_maxle
-000164c0: 6e29 202b 0a20 2020 2020 2020 2028 3120  n) +.        (1 
-000164d0: 6966 206c 656e 2862 756c 6b29 2025 206f  if len(bulk) % o
-000164e0: 626a 2e62 6f64 795f 6d61 786c 656e 2065  bj.body_maxlen e
-000164f0: 6c73 6520 3029 290a 0a20 2020 2066 6f72  lse 0))..    for
-00016500: 2063 6875 6e6b 2069 6e20 6368 756e 6b73   chunk in chunks
-00016510: 3a0a 2020 2020 2020 2020 2320 5665 7269  :.        # Veri
-00016520: 6669 6361 7469 6f6e 0a20 2020 2020 2020  fication.       
-00016530: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-00016540: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
-00016550: 3c3d 206f 626a 2e74 6974 6c65 5f6d 6178  <= obj.title_max
-00016560: 6c65 6e0a 2020 2020 2020 2020 6173 7365  len.        asse
-00016570: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
-00016580: 2827 626f 6479 2729 2920 3c3d 206f 626a  ('body')) <= obj
-00016590: 2e62 6f64 795f 6d61 786c 656e 0a0a 2020  .body_maxlen..  
-000165a0: 2020 2020 2020 2320 4f75 7220 7469 746c        # Our titl
-000165b0: 6520 6973 2065 6d70 7479 2065 7665 7279  e is empty every
-000165c0: 2074 696d 650a 2020 2020 2020 2020 6173   time.        as
-000165d0: 7365 7274 2063 6875 6e6b 2e67 6574 2827  sert chunk.get('
-000165e0: 7469 746c 6527 2920 3d3d 2027 270a 0a20  title') == ''.. 
-000165f0: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
-00016600: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
-00016610: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
-00016620: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
-00016630: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
-00016640: 0a20 2020 2020 2020 2023 2055 6e2d 7573  .        # Un-us
-00016650: 6564 2077 6869 7465 7370 6163 6520 6973  ed whitespace is
-00016660: 2061 6c77 6179 7320 636c 6561 6e65 6420   always cleaned 
-00016670: 7570 3b20 6d61 6b65 2073 7572 6520 7765  up; make sure we
-00016680: 2061 6363 6f75 6e74 2066 6f72 0a20 2020   account for.   
-00016690: 2020 2020 2023 2074 6869 7320 696e 206f       # this in o
-000166a0: 7572 206e 6577 2063 616c 6375 6c61 7469  ur new calculati
-000166b0: 6f6e 0a20 2020 2020 2020 2077 735f 6469  on.        ws_di
-000166c0: 6666 203d 206c 656e 2862 756c 6b5b 6f66  ff = len(bulk[of
-000166d0: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-000166e0: 202b 206f 6666 7365 745d 2920 2d20 5c0a   + offset]) - \.
-000166f0: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-00016700: 6275 6c6b 5b6f 6666 7365 743a 206c 656e  bulk[offset: len
-00016710: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-00016720: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00016730: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
-00016740: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
-00016750: 2829 290a 0a20 2020 2020 2020 2061 7373  ())..        ass
-00016760: 6572 7420 6275 6c6b 5b6f 6666 7365 743a  ert bulk[offset:
-00016770: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
-00016780: 6673 6574 202b 2077 735f 6469 6666 5d5c  fset + ws_diff]\
-00016790: 0a20 2020 2020 2020 2020 2020 202e 6c73  .            .ls
-000167a0: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
-000167b0: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
-000167c0: 205f 626f 6479 0a20 2020 2020 2020 206f   _body.        o
-000167d0: 6666 7365 7420 2b3d 2028 6c65 6e28 5f62  ffset += (len(_b
-000167e0: 6f64 7929 202b 2077 735f 6469 6666 290a  ody) + ws_diff).
-000167f0: 0a20 2020 2023 0a20 2020 2023 2054 6573  .    #.    # Tes
-00016800: 7420 6361 7365 2077 6865 7265 206f 7572  t case where our
-00016810: 2074 6974 6c65 5f6c 656e 2069 7320 7368   title_len is sh
-00016820: 6f72 7465 7220 7468 656e 2074 6865 2076  orter then the v
-00016830: 616c 7565 0a20 2020 2023 2074 6861 7420  alue.    # that 
-00016840: 776f 756c 6420 6f74 6865 7277 6973 6520  would otherwise 
-00016850: 7472 6967 6765 7220 7468 6520 5b58 582f  trigger the [XX/
-00016860: 5858 5d20 656c 656d 656e 7473 0a20 2020  XX] elements.   
-00016870: 2023 0a0a 2020 2020 636c 6173 7320 5465   #..    class Te
-00016880: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
-00016890: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
-000168a0: 2020 2020 2023 2053 6574 2061 2073 6d61       # Set a sma
-000168b0: 6c6c 2074 6974 6c65 206c 656e 6774 680a  ll title length.
-000168c0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
-000168d0: 786c 656e 203d 2031 3030 0a0a 2020 2020  xlen = 100..    
-000168e0: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
-000168f0: 626f 6479 206c 656e 6774 682e 204d 616b  body length. Mak
-00016900: 6520 7375 7265 2069 7427 7320 616e 2069  e sure it's an i
-00016910: 6e74 2e0a 2020 2020 2020 2020 626f 6479  nt..        body
-00016920: 5f6d 6178 6c65 6e20 3d20 696e 7428 626f  _maxlen = int(bo
-00016930: 6479 5f6c 656e 202f 2034 290a 0a20 2020  dy_len / 4)..   
-00016940: 2020 2020 2023 204e 6f20 416d 616c 6761       # No Amalga
-00016950: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
-00016960: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
-00016970: 7465 5f74 6974 6c65 203d 2046 616c 7365  te_title = False
-00016980: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
-00016990: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
-000169a0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-000169b0: 2020 2020 2020 2020 2020 2073 7570 6572             super
-000169c0: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
-000169d0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
-000169e0: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
-000169f0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00016a00: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00016a10: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
-00016a20: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
-00016a30: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00016a40: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
-00016a50: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
-00016a60: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
-00016a70: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
-00016a80: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
-00016a90: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
-00016aa0: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
-00016ab0: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
-00016ac0: 7765 2062 7265 616b 2074 6865 2074 6974  we break the tit
-00016ad0: 6c65 2074 6f20 6120 6d61 7820 6c65 6e67  le to a max leng
-00016ae0: 7468 206f 6620 6f75 7220 7469 746c 655f  th of our title_
-00016af0: 6d61 780a 2020 2020 2320 616e 6420 7468  max.    # and th
-00016b00: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
-00016b10: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
-00016b20: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00016b30: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00016b40: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
-00016b50: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
-00016b60: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00016b70: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
-00016b80: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-00016b90: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-00016ba0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-00016bb0: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
-00016bc0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-00016bd0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00016be0: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
-00016bf0: 3d74 6974 6c65 290a 2020 2020 6f66 6673  =title).    offs
-00016c00: 6574 203d 2030 0a20 2020 2061 7373 6572  et = 0.    asser
-00016c10: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
-00016c20: 2034 0a20 2020 2066 6f72 2069 6478 2c20   4.    for idx, 
-00016c30: 6368 756e 6b20 696e 2065 6e75 6d65 7261  chunk in enumera
-00016c40: 7465 2863 6875 6e6b 732c 2073 7461 7274  te(chunks, start
-00016c50: 3d31 293a 0a20 2020 2020 2020 2023 2056  =1):.        # V
-00016c60: 6572 6966 6963 6174 696f 6e0a 2020 2020  erification.    
-00016c70: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-00016c80: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-00016c90: 2929 203c 3d20 6f62 6a2e 7469 746c 655f  )) <= obj.title_
-00016ca0: 6d61 786c 656e 0a20 2020 2020 2020 2061  maxlen.        a
-00016cb0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-00016cc0: 6765 7428 2762 6f64 7927 2929 203c 3d20  get('body')) <= 
-00016cd0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e0a  obj.body_maxlen.
-00016ce0: 0a20 2020 2020 2020 2023 204f 7572 2074  .        # Our t
-00016cf0: 6974 6c65 2069 7320 7472 756e 6361 7465  itle is truncate
-00016d00: 6420 616e 6420 6e6f 2063 6f75 6e74 6572  d and no counter
-00016d10: 2061 6464 6564 0a20 2020 2020 2020 2061   added.        a
-00016d20: 7373 6572 7420 7469 746c 655b 3a6f 626a  ssert title[:obj
-00016d30: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
-00016d40: 3d20 6368 756e 6b2e 6765 7428 2774 6974  = chunk.get('tit
-00016d50: 6c65 2729 0a0a 2020 2020 2020 2020 2320  le')..        # 
-00016d60: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
-00016d70: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
-00016d80: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
-00016d90: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
-00016da0: 626f 6479 2729 0a20 2020 2020 2020 2061  body').        a
-00016db0: 7373 6572 7420 626f 6479 5b6f 6666 7365  ssert body[offse
-00016dc0: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
-00016dd0: 6f66 6673 6574 5d5c 0a20 2020 2020 2020  offset]\.       
-00016de0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
-00016df0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
-00016e00: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
-00016e10: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
-00016e20: 206c 656e 285f 626f 6479 290a 0a20 2020   len(_body)..   
-00016e30: 2023 0a20 2020 2023 2053 6365 6e61 7269   #.    # Scenari
-00016e40: 6f20 7768 6572 6520 7468 6520 7469 746c  o where the titl
-00016e50: 6520 6c65 6e67 7468 2069 7320 6c61 7267  e length is larg
-00016e60: 6572 2074 6861 6e20 7468 6520 626f 6479  er than the body
-00016e70: 0a20 2020 2023 0a0a 2020 2020 636c 6173  .    #..    clas
-00016e80: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
-00016e90: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
-00016ea0: 0a20 2020 2020 2020 2023 2053 6574 2061  .        # Set a
-00016eb0: 2073 6d61 6c6c 2074 6974 6c65 206c 656e   small title len
-00016ec0: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
-00016ed0: 655f 6d61 786c 656e 203d 2031 3030 0a0a  e_maxlen = 100..
-00016ee0: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
-00016ef0: 6520 6120 626f 6479 206c 656e 6774 682e  e a body length.
-00016f00: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
-00016f10: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
-00016f20: 626f 6479 5f6d 6178 6c65 6e20 3d20 3530  body_maxlen = 50
-00016f30: 0a0a 2020 2020 2020 2020 2320 4e6f 2041  ..        # No A
-00016f40: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
-00016f50: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
-00016f60: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
-00016f70: 4661 6c73 650a 0a20 2020 2020 2020 2064  False..        d
-00016f80: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00016f90: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00016fa0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00016fb0: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
-00016fc0: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
-00016fd0: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
-00016fe0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00016ff0: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
-00017000: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
-00017010: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
-00017020: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00017030: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
-00017040: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
-00017050: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
-00017060: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
-00017070: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
-00017080: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
-00017090: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
-000170a0: 650a 0a20 2020 2023 2056 6572 6966 7920  e..    # Verify 
-000170b0: 7468 6174 2077 6520 6272 6561 6b20 7468  that we break th
-000170c0: 6520 7469 746c 6520 746f 2061 206d 6178  e title to a max
-000170d0: 206c 656e 6774 6820 6f66 206f 7572 2074   length of our t
-000170e0: 6974 6c65 5f6d 6178 0a20 2020 2023 2061  itle_max.    # a
-000170f0: 6e64 2074 6861 7420 7468 6520 626f 6479  nd that the body
-00017100: 2072 656d 6169 6e73 2075 6e74 6f75 6368   remains untouch
-00017110: 6564 0a20 2020 2063 6875 6e6b 7320 3d20  ed.    chunks = 
-00017120: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00017130: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00017140: 6c65 3d74 6974 6c65 290a 2020 2020 6368  le=title).    ch
-00017150: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00017160: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00017170: 2222 2c20 7469 746c 653d 2222 290a 2020  "", title="").  
-00017180: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00017190: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-000171a0: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
-000171b0: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-000171c0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-000171d0: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-000171e0: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
-000171f0: 206f 6666 7365 7420 3d20 300a 2020 2020   offset = 0.    
-00017200: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-00017210: 7329 203d 3d20 3231 0a20 2020 2066 6f72  s) == 21.    for
-00017220: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
-00017230: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
-00017240: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
-00017250: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
-00017260: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-00017270: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-00017280: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
-00017290: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
-000172a0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-000172b0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-000172c0: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
-000172d0: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
-000172e0: 204f 7572 2074 6974 6c65 2069 7320 7472   Our title is tr
-000172f0: 756e 6361 7465 6420 616e 6420 6e6f 2063  uncated and no c
-00017300: 6f75 6e74 6572 2061 6464 6564 0a20 2020  ounter added.   
-00017310: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
-00017320: 655b 3a6f 626a 2e74 6974 6c65 5f6d 6178  e[:obj.title_max
-00017330: 6c65 6e5d 203d 3d20 6368 756e 6b2e 6765  len] == chunk.ge
-00017340: 7428 2774 6974 6c65 2729 0a0a 2020 2020  t('title')..    
-00017350: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
-00017360: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
-00017370: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
-00017380: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
-00017390: 2e67 6574 2827 626f 6479 2729 0a0a 2020  .get('body')..  
-000173a0: 2020 2020 2020 2320 556e 2d75 7365 6420        # Un-used 
-000173b0: 7768 6974 6573 7061 6365 2069 7320 616c  whitespace is al
-000173c0: 7761 7973 2063 6c65 616e 6564 2075 703b  ways cleaned up;
-000173d0: 206d 616b 6520 7375 7265 2077 6520 6163   make sure we ac
-000173e0: 636f 756e 7420 666f 720a 2020 2020 2020  count for.      
-000173f0: 2020 2320 7468 6973 2069 6e20 6f75 7220    # this in our 
-00017400: 6e65 7720 6361 6c63 756c 6174 696f 6e0a  new calculation.
-00017410: 2020 2020 2020 2020 7773 5f64 6966 6620          ws_diff 
-00017420: 3d20 6c65 6e28 626f 6479 5b6f 6666 7365  = len(body[offse
-00017430: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
-00017440: 6f66 6673 6574 5d29 202d 205c 0a20 2020  offset]) - \.   
-00017450: 2020 2020 2020 2020 206c 656e 2862 6f64           len(bod
-00017460: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-00017470: 6f64 7929 202b 206f 6666 7365 745d 0a20  ody) + offset]. 
-00017480: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-00017490: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-000174a0: 5c78 3063 2729 2e72 7374 7269 7028 2929  \x0c').rstrip())
-000174b0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-000174c0: 2062 6f64 795b 6f66 6673 6574 3a20 6c65   body[offset: le
-000174d0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-000174e0: 7420 2b20 7773 5f64 6966 665d 5c0a 2020  t + ws_diff]\.  
-000174f0: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
-00017500: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
-00017510: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
-00017520: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
-00017530: 6574 202b 3d20 286c 656e 285f 626f 6479  et += (len(_body
-00017540: 2920 2b20 7773 5f64 6966 6629 0a0a 0a64  ) + ws_diff)...d
-00017550: 6566 2074 6573 745f 6e6f 7469 6679 5f6f  ef test_notify_o
-00017560: 7665 7266 6c6f 775f 7370 6c69 745f 6e6f  verflow_split_no
-00017570: 5f61 6d61 6c67 616d 6174 696f 6e5f 666f  _amalgamation_fo
-00017580: 7263 655f 7469 746c 655f 616c 7761 7973  rce_title_always
-00017590: 2829 3a0a 2020 2020 2222 220a 2020 2020  ():.    """.    
-000175a0: 4150 493a 204f 7665 7266 6c6f 7720 4e6f  API: Overflow No
-000175b0: 2041 6d61 6c67 616d 6174 696f 6e20 2874   Amalgamation (t
-000175c0: 6974 6c65 2061 6c77 6179 7329 2053 706c  itle always) Spl
-000175d0: 6974 2046 756e 6374 696f 6e61 6c69 7479  it Functionality
-000175e0: 2054 6573 7469 6e67 0a0a 2020 2020 2222   Testing..    ""
-000175f0: 220a 0a20 2020 2023 0a20 2020 2023 2041  "..    #.    # A
-00017600: 206c 6974 746c 6520 7072 6570 6172 6174   little preparat
-00017610: 696f 6e0a 2020 2020 230a 0a20 2020 2023  ion.    #..    #
-00017620: 204e 756d 6265 7220 6f66 2063 6861 7261   Number of chara
-00017630: 6374 6572 7320 7065 7220 6c69 6e65 0a20  cters per line. 
-00017640: 2020 2072 6f77 203d 2032 340a 0a20 2020     row = 24..   
-00017650: 2023 2053 6f6d 6520 7661 7269 6162 6c65   # Some variable
-00017660: 7320 7765 2075 7365 2074 6f20 636f 6e74  s we use to cont
-00017670: 726f 6c20 7468 6520 6461 7461 2077 6520  rol the data we 
-00017680: 776f 726b 2077 6974 680a 2020 2020 626f  work with.    bo
-00017690: 6479 5f6c 656e 203d 2031 3032 340a 2020  dy_len = 1024.  
-000176a0: 2020 7469 746c 655f 6c65 6e20 3d20 3130    title_len = 10
-000176b0: 3234 0a0a 2020 2020 2320 4372 6561 7465  24..    # Create
-000176c0: 2061 206c 6172 6765 2062 6f64 7920 616e   a large body an
-000176d0: 6420 7469 746c 6520 7769 7468 2072 616e  d title with ran
-000176e0: 646f 6d20 6461 7461 0a20 2020 2062 6f64  dom data.    bod
-000176f0: 7920 3d20 2727 2e6a 6f69 6e28 6368 6f69  y = ''.join(choi
-00017700: 6365 2873 7472 5f61 6c70 6861 202b 2073  ce(str_alpha + s
-00017710: 7472 5f6e 756d 2920 666f 7220 5f20 696e  tr_num) for _ in
-00017720: 2072 616e 6765 2862 6f64 795f 6c65 6e29   range(body_len)
-00017730: 290a 2020 2020 626f 6479 203d 2027 5c72  ).    body = '\r
-00017740: 5c6e 272e 6a6f 696e 285b 626f 6479 5b69  \n'.join([body[i
-00017750: 3a20 6920 2b20 726f 775d 2066 6f72 2069  : i + row] for i
-00017760: 2069 6e20 7261 6e67 6528 302c 206c 656e   in range(0, len
-00017770: 2862 6f64 7929 2c20 726f 7729 5d29 0a0a  (body), row)])..
-00017780: 2020 2020 2320 7468 6520 6e65 7720 6c69      # the new li
-00017790: 6e65 7320 6164 6420 6120 6c61 7267 6520  nes add a large 
-000177a0: 616d 6f75 6e74 2074 6f20 6f75 7220 626f  amount to our bo
-000177b0: 6479 3b20 6c65 7473 2066 6f72 6365 2074  dy; lets force t
-000177c0: 6865 2063 6f6e 7465 6e74 0a20 2020 2023  he content.    #
-000177d0: 2062 6163 6b20 746f 2062 6569 6e67 2031   back to being 1
-000177e0: 3032 3420 6368 6172 6163 7465 7273 2e0a  024 characters..
-000177f0: 2020 2020 626f 6479 203d 2062 6f64 795b      body = body[
-00017800: 303a 3130 3234 5d0a 0a20 2020 2023 2043  0:1024]..    # C
-00017810: 7265 6174 6520 6f75 7220 7469 746c 6520  reate our title 
-00017820: 7573 696e 6720 7261 6e64 6f6d 2064 6174  using random dat
-00017830: 610a 2020 2020 7469 746c 6520 3d20 2727  a.    title = ''
-00017840: 2e6a 6f69 6e28 6368 6f69 6365 2873 7472  .join(choice(str
-00017850: 5f61 6c70 6861 202b 2073 7472 5f6e 756d  _alpha + str_num
-00017860: 2920 666f 7220 5f20 696e 2072 616e 6765  ) for _ in range
-00017870: 2874 6974 6c65 5f6c 656e 2929 0a0a 2020  (title_len))..  
-00017880: 2020 230a 2020 2020 2320 4669 7273 7420    #.    # First 
-00017890: 5465 7374 3a20 5472 756e 6361 7465 6420  Test: Truncated 
-000178a0: 5469 746c 650a 2020 2020 230a 2020 2020  Title.    #.    
-000178b0: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
-000178c0: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-000178d0: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
-000178e0: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
-000178f0: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
-00017900: 6c65 5f6d 6178 6c65 6e20 3d20 3130 0a0a  le_maxlen = 10..
-00017910: 2020 2020 2020 2020 2320 4e6f 2061 6d61          # No ama
-00017920: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
-00017930: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
-00017940: 616d 6174 655f 7469 746c 6520 3d20 4661  amate_title = Fa
-00017950: 6c73 650a 0a20 2020 2020 2020 2023 2046  lse..        # F
-00017960: 6f72 6365 2074 6974 6c65 2074 6f20 6265  orce title to be
-00017970: 2064 6973 706c 6179 6564 2061 6c77 6179   displayed alway
-00017980: 730a 2020 2020 2020 2020 6f76 6572 666c  s.        overfl
-00017990: 6f77 5f64 6973 706c 6179 5f74 6974 6c65  ow_display_title
-000179a0: 5f6f 6e63 6520 3d20 4661 6c73 650a 0a20  _once = False.. 
-000179b0: 2020 2020 2020 2064 6566 205f 5f69 6e69         def __ini
-000179c0: 745f 5f28 7365 6c66 2c20 2a61 7267 732c  t__(self, *args,
-000179d0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-000179e0: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-000179f0: 5f5f 696e 6974 5f5f 282a 2a6b 7761 7267  __init__(**kwarg
-00017a00: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
-00017a10: 6e6f 7469 6679 2873 656c 662c 202a 6172  notify(self, *ar
-00017a20: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00017a30: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
-00017a40: 7465 6e64 2065 7665 7279 7468 696e 6720  tend everything 
-00017a50: 6973 206f 6b61 790a 2020 2020 2020 2020  is okay.        
-00017a60: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-00017a70: 0a20 2020 2023 204c 6f61 6420 6f75 7220  .    # Load our 
-00017a80: 6f62 6a65 6374 0a20 2020 206f 626a 203d  object.    obj =
-00017a90: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
-00017aa0: 6e28 6f76 6572 666c 6f77 3d4f 7665 7266  n(overflow=Overf
-00017ab0: 6c6f 774d 6f64 652e 5350 4c49 5429 0a20  lowMode.SPLIT). 
-00017ac0: 2020 2061 7373 6572 7420 6f62 6a20 6973     assert obj is
-00017ad0: 206e 6f74 204e 6f6e 650a 0a20 2020 2023   not None..    #
-00017ae0: 2056 6572 6966 7920 7468 6174 2077 6520   Verify that we 
-00017af0: 6272 6561 6b20 7468 6520 7469 746c 6520  break the title 
-00017b00: 746f 2061 206d 6178 206c 656e 6774 6820  to a max length 
-00017b10: 6f66 206f 7572 2074 6974 6c65 5f6d 6178  of our title_max
-00017b20: 0a20 2020 2023 2061 6e64 2074 6861 7420  .    # and that 
-00017b30: 7468 6520 626f 6479 2072 656d 6169 6e73  the body remains
-00017b40: 2075 6e74 6f75 6368 6564 0a20 2020 2063   untouched.    c
-00017b50: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00017b60: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00017b70: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
-00017b80: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00017b90: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00017ba0: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-00017bb0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-00017bc0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-00017bd0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
-00017be0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-00017bf0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00017c00: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00017c10: 793d 626f 6479 2c20 7469 746c 653d 7469  y=body, title=ti
-00017c20: 746c 6529 0a20 2020 2061 7373 6572 7420  tle).    assert 
-00017c30: 6c65 6e28 6368 756e 6b73 2920 3d3d 2031  len(chunks) == 1
-00017c40: 0a20 2020 2061 7373 6572 7420 626f 6479  .    assert body
-00017c50: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
-00017c60: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
-00017c70: 203d 3d20 6368 756e 6b73 5b30 5d2e 6765   == chunks[0].ge
-00017c80: 7428 2762 6f64 7927 290a 2020 2020 6173  t('body').    as
-00017c90: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
-00017ca0: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
-00017cb0: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
-00017cc0: 2774 6974 6c65 2729 0a0a 2020 2020 230a  'title')..    #.
-00017cd0: 2020 2020 2320 4e65 7874 2054 6573 743a      # Next Test:
-00017ce0: 204c 696e 6520 436f 756e 7420 436f 6e74   Line Count Cont
-00017cf0: 726f 6c0a 2020 2020 230a 0a20 2020 2063  rol.    #..    c
-00017d00: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
-00017d10: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
-00017d20: 293a 0a0a 2020 2020 2020 2020 2320 5465  ):..        # Te
-00017d30: 7374 2074 6974 6c65 206d 6178 206c 656e  st title max len
-00017d40: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
-00017d50: 655f 6d61 786c 656e 203d 2035 0a0a 2020  e_maxlen = 5..  
-00017d60: 2020 2020 2020 2320 4d61 7869 6d75 6d20        # Maximum 
-00017d70: 6e75 6d62 6572 206f 6620 6c69 6e65 730a  number of lines.
-00017d80: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
-00017d90: 5f6c 696e 655f 636f 756e 7420 3d20 350a  _line_count = 5.
-00017da0: 0a20 2020 2020 2020 2023 204e 6f20 616d  .        # No am
-00017db0: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
-00017dc0: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
-00017dd0: 6761 6d61 7465 5f74 6974 6c65 203d 2046  gamate_title = F
-00017de0: 616c 7365 0a0a 2020 2020 2020 2020 2320  alse..        # 
-00017df0: 466f 7263 6520 7469 746c 6520 746f 2062  Force title to b
-00017e00: 6520 6469 7370 6c61 7965 6420 616c 7761  e displayed alwa
-00017e10: 7973 0a20 2020 2020 2020 206f 7665 7266  ys.        overf
-00017e20: 6c6f 775f 6469 7370 6c61 795f 7469 746c  low_display_titl
-00017e30: 655f 6f6e 6365 203d 2046 616c 7365 0a0a  e_once = False..
-00017e40: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
-00017e50: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
-00017e60: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00017e70: 2020 2020 2020 2020 2073 7570 6572 2829           super()
-00017e80: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
-00017e90: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
-00017ea0: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
-00017eb0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00017ec0: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
-00017ed0: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
-00017ee0: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
-00017ef0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00017f00: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
-00017f10: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
-00017f20: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
-00017f30: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
-00017f40: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
-00017f50: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
-00017f60: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
-00017f70: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
-00017f80: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
-00017f90: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
-00017fa0: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
-00017fb0: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
-00017fc0: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
-00017fd0: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
-00017fe0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00017ff0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00018000: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-00018010: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-00018020: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-00018030: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-00018040: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-00018050: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00018060: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
-00018070: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
-00018080: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00018090: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-000180a0: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
-000180b0: 6974 6c65 290a 2020 2020 6173 7365 7274  itle).    assert
-000180c0: 206c 656e 2863 6875 6e6b 7329 203d 3d20   len(chunks) == 
-000180d0: 310a 2020 2020 6173 7365 7274 206c 656e  1.    assert len
-000180e0: 2863 6875 6e6b 735b 305d 2e67 6574 2827  (chunks[0].get('
-000180f0: 626f 6479 2729 2e73 706c 6974 2827 5c6e  body').split('\n
-00018100: 2729 2920 3d3d 206f 626a 2e62 6f64 795f  ')) == obj.body_
-00018110: 6d61 785f 6c69 6e65 5f63 6f75 6e74 0a20  max_line_count. 
-00018120: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-00018130: 303a 6f62 6a2e 7469 746c 655f 6d61 786c  0:obj.title_maxl
-00018140: 656e 5d20 3d3d 2063 6875 6e6b 735b 305d  en] == chunks[0]
-00018150: 2e67 6574 2827 7469 746c 6527 290a 0a20  .get('title').. 
-00018160: 2020 2023 0a20 2020 2023 204e 6578 7420     #.    # Next 
-00018170: 5465 7374 3a20 5370 6c69 7420 626f 6479  Test: Split body
-00018180: 0a20 2020 2023 0a0a 2020 2020 636c 6173  .    #..    clas
-00018190: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
-000181a0: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
-000181b0: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
-000181c0: 7469 746c 6520 6d61 7820 6c65 6e67 7468  title max length
-000181d0: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
-000181e0: 6178 6c65 6e20 3d20 7469 746c 655f 6c65  axlen = title_le
-000181f0: 6e0a 0a20 2020 2020 2020 2023 2045 6e66  n..        # Enf
-00018200: 6f72 6365 2061 2062 6f64 7920 6c65 6e67  orce a body leng
-00018210: 7468 2e20 4d61 6b65 2073 7572 6520 6974  th. Make sure it
-00018220: 2773 2061 6e20 696e 742e 0a20 2020 2020  's an int..     
-00018230: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
-00018240: 2069 6e74 2862 6f64 795f 6c65 6e20 2f20   int(body_len / 
-00018250: 3429 0a0a 2020 2020 2020 2020 2320 4e6f  4)..        # No
-00018260: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
-00018270: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
-00018280: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
-00018290: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-000182a0: 2023 2046 6f72 6365 2074 6974 6c65 2074   # Force title t
-000182b0: 6f20 6265 2064 6973 706c 6179 6564 2061  o be displayed a
-000182c0: 6c77 6179 730a 2020 2020 2020 2020 6f76  lways.        ov
-000182d0: 6572 666c 6f77 5f64 6973 706c 6179 5f74  erflow_display_t
-000182e0: 6974 6c65 5f6f 6e63 6520 3d20 4661 6c73  itle_once = Fals
-000182f0: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
-00018300: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-00018310: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00018320: 2020 2020 2020 2020 2020 2020 7375 7065              supe
-00018330: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
-00018340: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
-00018350: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
-00018360: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00018370: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00018380: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
-00018390: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
-000183a0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-000183b0: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
-000183c0: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
-000183d0: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
-000183e0: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
-000183f0: 7665 7266 6c6f 774d 6f64 652e 5350 4c49  verflowMode.SPLI
-00018400: 5429 0a20 2020 2061 7373 6572 7420 6f62  T).    assert ob
-00018410: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
-00018420: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
-00018430: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
-00018440: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
-00018450: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
-00018460: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
-00018470: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
-00018480: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
-00018490: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-000184a0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-000184b0: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
-000184c0: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
-000184d0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-000184e0: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
-000184f0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-00018500: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00018510: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00018520: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
-00018530: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-00018540: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-00018550: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-00018560: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
-00018570: 7365 7420 3d20 300a 2020 2020 635f 6c65  set = 0.    c_le
-00018580: 6e20 3d20 6c65 6e28 2720 5b58 2f58 5d27  n = len(' [X/X]'
-00018590: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
-000185a0: 2863 6875 6e6b 7329 203d 3d20 340a 2020  (chunks) == 4.  
-000185b0: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
-000185c0: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
-000185d0: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
-000185e0: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
-000185f0: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
-00018600: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-00018610: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
-00018620: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-00018630: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-00018640: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-00018650: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
-00018660: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
-00018670: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
-00018680: 6861 7320 6120 636f 756e 7465 7220 6164  has a counter ad
-00018690: 6465 6420 746f 2069 740a 2020 2020 2020  ded to it.      
-000186a0: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
-000186b0: 2d63 5f6c 656e 5d20 3d3d 2063 6875 6e6b  -c_len] == chunk
-000186c0: 2e67 6574 2827 7469 746c 6527 295b 3a2d  .get('title')[:-
-000186d0: 635f 6c65 6e5d 0a20 2020 2020 2020 2061  c_len].        a
-000186e0: 7373 6572 7420 6368 756e 6b2e 6765 7428  ssert chunk.get(
-000186f0: 2774 6974 6c65 2729 5b2d 635f 6c65 6e3a  'title')[-c_len:
-00018700: 5d20 3d3d 205c 0a20 2020 2020 2020 2020  ] == \.         
-00018710: 2020 2027 205b 7b3a 3031 7d2f 7b3a 3031     ' [{:01}/{:01
-00018720: 7d5d 272e 666f 726d 6174 2869 6478 2c20  }]'.format(idx, 
-00018730: 6c65 6e28 6368 756e 6b73 2929 0a20 2020  len(chunks)).   
-00018740: 2020 2020 2023 204f 7572 2062 6f64 7920       # Our body 
-00018750: 6973 206f 6e6c 7920 6272 6f6b 656e 2075  is only broken u
-00018760: 703b 206e 6f74 206c 6f73 740a 2020 2020  p; not lost.    
-00018770: 2020 2020 5f62 6f64 7920 3d20 6368 756e      _body = chun
-00018780: 6b2e 6765 7428 2762 6f64 7927 290a 2020  k.get('body').  
-00018790: 2020 2020 2020 6173 7365 7274 2062 6f64        assert bod
-000187a0: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-000187b0: 6f64 7929 202b 206f 6666 7365 745d 5c0a  ody) + offset]\.
-000187c0: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
-000187d0: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
-000187e0: 6327 292e 7273 7472 6970 2829 203d 3d20  c').rstrip() == 
-000187f0: 5f62 6f64 790a 2020 2020 2020 2020 6f66  _body.        of
-00018800: 6673 6574 202b 3d20 6c65 6e28 5f62 6f64  fset += len(_bod
-00018810: 7929 0a0a 2020 2020 2320 416e 6f74 6865  y)..    # Anothe
-00018820: 7220 6564 6765 2063 6173 6520 7768 6572  r edge case wher
-00018830: 6520 7468 6520 7469 746c 6520 6a75 7374  e the title just
-00018840: 2069 736e 2774 2074 6861 7420 6c6f 6e67   isn't that long
-00018850: 206c 6561 7669 6e67 0a20 2020 2023 2061   leaving.    # a
-00018860: 206c 6f74 206f 6620 7370 6163 6520 666f   lot of space fo
-00018870: 7220 7468 6520 5b78 782f 7878 5d20 656e  r the [xx/xx] en
-00018880: 7472 6965 7320 286e 6f20 7472 756e 6361  tries (no trunca
-00018890: 7469 6f6e 206e 6565 6465 6429 0a20 2020  tion needed).   
-000188a0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-000188b0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-000188c0: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
-000188d0: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
-000188e0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-000188f0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
-00018900: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00018910: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00018920: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-00018930: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
-00018940: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00018950: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00018960: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
-00018970: 7469 746c 655b 3a32 305d 290a 2020 2020  title[:20]).    
-00018980: 6f66 6673 6574 203d 2030 0a20 2020 2061  offset = 0.    a
-00018990: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
-000189a0: 2920 3d3d 2034 0a20 2020 2066 6f72 2069  ) == 4.    for i
-000189b0: 6478 2c20 6368 756e 6b20 696e 2065 6e75  dx, chunk in enu
-000189c0: 6d65 7261 7465 2863 6875 6e6b 732c 2073  merate(chunks, s
-000189d0: 7461 7274 3d31 293a 0a20 2020 2020 2020  tart=1):.       
-000189e0: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
-000189f0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-00018a00: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
-00018a10: 746c 6527 2929 203c 3d20 6f62 6a2e 7469  tle')) <= obj.ti
-00018a20: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
-00018a30: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
-00018a40: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
-00018a50: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
-00018a60: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
-00018a70: 7572 2074 6974 6c65 2068 6173 2061 2063  ur title has a c
-00018a80: 6f75 6e74 6572 2061 6464 6564 2074 6f20  ounter added to 
-00018a90: 6974 0a20 2020 2020 2020 2061 7373 6572  it.        asser
-00018aa0: 7420 7469 746c 655b 3a32 305d 203d 3d20  t title[:20] == 
-00018ab0: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-00018ac0: 2729 5b3a 2d63 5f6c 656e 5d0a 2020 2020  ')[:-c_len].    
-00018ad0: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
-00018ae0: 2e67 6574 2827 7469 746c 6527 295b 2d63  .get('title')[-c
-00018af0: 5f6c 656e 3a5d 203d 3d20 5c0a 2020 2020  _len:] == \.    
-00018b00: 2020 2020 2020 2020 2720 5b7b 3a30 317d          ' [{:01}
-00018b10: 2f7b 3a30 317d 5d27 2e66 6f72 6d61 7428  /{:01}]'.format(
-00018b20: 6964 782c 206c 656e 2863 6875 6e6b 7329  idx, len(chunks)
-00018b30: 290a 2020 2020 2020 2020 2320 4f75 7220  ).        # Our 
-00018b40: 626f 6479 2069 7320 6f6e 6c79 2062 726f  body is only bro
-00018b50: 6b65 6e20 7570 3b20 6e6f 7420 6c6f 7374  ken up; not lost
-00018b60: 0a20 2020 2020 2020 205f 626f 6479 203d  .        _body =
-00018b70: 2063 6875 6e6b 2e67 6574 2827 626f 6479   chunk.get('body
-00018b80: 2729 0a20 2020 2020 2020 2061 7373 6572  ').        asser
-00018b90: 7420 626f 6479 5b6f 6666 7365 743a 206c  t body[offset: l
-00018ba0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-00018bb0: 6574 5d5c 0a20 2020 2020 2020 2020 2020  et]\.           
-00018bc0: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
-00018bd0: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
-00018be0: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
-00018bf0: 2020 206f 6666 7365 7420 2b3d 206c 656e     offset += len
-00018c00: 285f 626f 6479 290a 0a20 2020 2023 2054  (_body)..    # T
-00018c10: 6573 7420 6c61 7267 6572 206d 6573 7361  est larger messa
-00018c20: 6765 730a 2020 2020 2320 616e 6420 7468  ges.    # and th
-00018c30: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
-00018c40: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
-00018c50: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
-00018c60: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
-00018c70: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
-00018c80: 2054 6573 7420 7469 746c 6520 6d61 7820   Test title max 
-00018c90: 6c65 6e67 7468 0a20 2020 2020 2020 2074  length.        t
-00018ca0: 6974 6c65 5f6d 6178 6c65 6e20 3d20 3135  itle_maxlen = 15
-00018cb0: 300a 0a20 2020 2020 2020 2023 2045 6e66  0..        # Enf
-00018cc0: 6f72 6365 2061 2062 6f64 7920 6c65 6e67  orce a body leng
-00018cd0: 7468 2e20 4d61 6b65 2073 7572 6520 6974  th. Make sure it
-00018ce0: 2773 2061 6e20 696e 742e 0a20 2020 2020  's an int..     
-00018cf0: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
-00018d00: 2034 3030 0a0a 2020 2020 2020 2020 2320   400..        # 
-00018d10: 4e6f 2061 6d61 6c67 616d 6174 696f 6e0a  No amalgamation.
-00018d20: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-00018d30: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
-00018d40: 6520 3d20 4661 6c73 650a 0a20 2020 2020  e = False..     
-00018d50: 2020 2023 2046 6f72 6365 2074 6974 6c65     # Force title
-00018d60: 2074 6f20 6265 2064 6973 706c 6179 6564   to be displayed
-00018d70: 2061 6c77 6179 730a 2020 2020 2020 2020   always.        
-00018d80: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
-00018d90: 5f74 6974 6c65 5f6f 6e63 6520 3d20 4661  _title_once = Fa
-00018da0: 6c73 650a 0a20 2020 2020 2020 2064 6566  lse..        def
-00018db0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00018dc0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00018dd0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
-00018de0: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
-00018df0: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-00018e00: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
-00018e10: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00018e20: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-00018e30: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
-00018e40: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
-00018e50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00018e60: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
-00018e70: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
-00018e80: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
-00018e90: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
-00018ea0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
-00018eb0: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
-00018ec0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
-00018ed0: 0a20 2020 206e 6577 5f62 6f64 7920 3d20  .    new_body = 
-00018ee0: 2862 6f64 7920 2a20 3530 3029 0a20 2020  (body * 500).   
-00018ef0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-00018f00: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-00018f10: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
-00018f20: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
-00018f30: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-00018f40: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
-00018f50: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-00018f60: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00018f70: 6f76 6572 666c 6f77 2862 6f64 793d 6e65  overflow(body=ne
-00018f80: 775f 626f 6479 2c20 7469 746c 653d 2222  w_body, title=""
-00018f90: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00018fa0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00018fb0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
-00018fc0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-00018fd0: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
-00018fe0: 2020 635f 6c65 6e20 3d20 6c65 6e28 2720    c_len = len(' 
-00018ff0: 5b58 5858 582f 5858 5858 5d27 290a 2020  [XXXX/XXXX]').  
-00019000: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-00019010: 6e6b 7329 203d 3d20 3132 3830 0a20 2020  nks) == 1280.   
-00019020: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-00019030: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-00019040: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-00019050: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-00019060: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-00019070: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-00019080: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-00019090: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-000190a0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000190b0: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-000190c0: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-000190d0: 6479 5f6d 6178 6c65 6e0a 2020 2020 2020  dy_maxlen.      
-000190e0: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
-000190f0: 7320 6120 636f 756e 7465 7220 6164 6465  s a counter adde
-00019100: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
-00019110: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
-00019120: 6a2e 7469 746c 655f 6d61 786c 656e 5d5b  j.title_maxlen][
-00019130: 3a2d 635f 6c65 6e5d 203d 3d20 6368 756e  :-c_len] == chun
-00019140: 6b2e 6765 7428 2774 6974 6c65 2729 5b3a  k.get('title')[:
-00019150: 2d63 5f6c 656e 5d0a 2020 2020 2020 2020  -c_len].        
-00019160: 6173 7365 7274 2063 6875 6e6b 2e67 6574  assert chunk.get
-00019170: 2827 7469 746c 6527 295b 2d63 5f6c 656e  ('title')[-c_len
-00019180: 3a5d 203d 3d20 5c0a 2020 2020 2020 2020  :] == \.        
-00019190: 2020 2020 2720 5b7b 3a30 347d 2f7b 3a30      ' [{:04}/{:0
-000191a0: 347d 5d27 2e66 6f72 6d61 7428 6964 782c  4}]'.format(idx,
-000191b0: 206c 656e 2863 6875 6e6b 7329 290a 2020   len(chunks)).  
-000191c0: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
-000191d0: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
-000191e0: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
-000191f0: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
-00019200: 6e6b 2e67 6574 2827 626f 6479 2729 0a0a  nk.get('body')..
-00019210: 2020 2020 2020 2020 2320 556e 2d75 7365          # Un-use
-00019220: 6420 7768 6974 6573 7061 6365 2069 7320  d whitespace is 
-00019230: 616c 7761 7973 2063 6c65 616e 6564 2075  always cleaned u
-00019240: 703b 206d 616b 6520 7375 7265 2077 6520  p; make sure we 
-00019250: 6163 636f 756e 7420 666f 720a 2020 2020  account for.    
-00019260: 2020 2020 2320 7468 6973 2069 6e20 6f75      # this in ou
-00019270: 7220 6e65 7720 6361 6c63 756c 6174 696f  r new calculatio
-00019280: 6e0a 2020 2020 2020 2020 7773 5f64 6966  n.        ws_dif
-00019290: 6620 3d20 6c65 6e28 6e65 775f 626f 6479  f = len(new_body
-000192a0: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-000192b0: 6479 2920 2b20 6f66 6673 6574 5d29 202d  dy) + offset]) -
-000192c0: 205c 0a20 2020 2020 2020 2020 2020 206c   \.            l
-000192d0: 656e 286e 6577 5f62 6f64 795b 6f66 6673  en(new_body[offs
-000192e0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
-000192f0: 206f 6666 7365 745d 0a20 2020 2020 2020   offset].       
-00019300: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
-00019310: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-00019320: 2e72 7374 7269 7028 2929 0a0a 2020 2020  .rstrip())..    
-00019330: 2020 2020 6173 7365 7274 206e 6577 5f62      assert new_b
-00019340: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-00019350: 5f62 6f64 7929 202b 206f 6666 7365 7420  _body) + offset 
-00019360: 2b20 7773 5f64 6966 665d 5c0a 2020 2020  + ws_diff]\.    
-00019370: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
-00019380: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
-00019390: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
-000193a0: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
-000193b0: 202b 3d20 286c 656e 285f 626f 6479 2920   += (len(_body) 
-000193c0: 2b20 7773 5f64 6966 6629 0a0a 2020 2020  + ws_diff)..    
-000193d0: 2320 426f 6479 2063 6875 6e6b 2069 7320  # Body chunk is 
-000193e0: 6265 796f 6e64 2034 2064 6967 6974 732c  beyond 4 digits,
-000193f0: 2073 6f20 5b58 5858 582f 5858 5858 5d20   so [XXXX/XXXX] 
-00019400: 6973 2074 7572 6e65 6420 6f66 660a 2020  is turned off.  
-00019410: 2020 6e65 775f 626f 6479 203d 2028 626f    new_body = (bo
-00019420: 6479 202a 2034 3530 3029 0a20 2020 2063  dy * 4500).    c
-00019430: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00019440: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00019450: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
-00019460: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00019470: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00019480: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-00019490: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
-000194a0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-000194b0: 6572 666c 6f77 2862 6f64 793d 6e65 775f  erflow(body=new_
-000194c0: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
-000194d0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-000194e0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-000194f0: 2862 6f64 793d 6e65 775f 626f 6479 2c20  (body=new_body, 
-00019500: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
-00019510: 206f 6666 7365 7420 3d20 300a 2020 2020   offset = 0.    
-00019520: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-00019530: 7329 203d 3d20 3131 3532 300a 2020 2020  s) == 11520.    
-00019540: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-00019550: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-00019560: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-00019570: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-00019580: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-00019590: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-000195a0: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-000195b0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-000195c0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-000195d0: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-000195e0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-000195f0: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-00019600: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
-00019610: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
-00019620: 6564 2074 6f20 6974 0a20 2020 2020 2020  ed to it.       
-00019630: 2061 7373 6572 7420 7469 746c 655b 3a6f   assert title[:o
-00019640: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e5d  bj.title_maxlen]
-00019650: 203d 3d20 6368 756e 6b2e 6765 7428 2774   == chunk.get('t
-00019660: 6974 6c65 2729 0a20 2020 2020 2020 2023  itle').        #
-00019670: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
-00019680: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
-00019690: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
-000196a0: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
-000196b0: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
-000196c0: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
-000196d0: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
-000196e0: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
-000196f0: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
-00019700: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
-00019710: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
-00019720: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
-00019730: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
-00019740: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
-00019750: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-00019760: 6666 7365 745d 2920 2d20 5c0a 2020 2020  ffset]) - \.    
-00019770: 2020 2020 2020 2020 6c65 6e28 6e65 775f          len(new_
-00019780: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
-00019790: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-000197a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000197b0: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
-000197c0: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
-000197d0: 2829 290a 0a20 2020 2020 2020 2061 7373  ())..        ass
-000197e0: 6572 7420 6e65 775f 626f 6479 5b6f 6666  ert new_body[off
-000197f0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-00019800: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
-00019810: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
-00019820: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
-00019830: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
-00019840: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
-00019850: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
-00019860: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
-00019870: 6666 290a 0a20 2020 2023 2054 6573 7420  ff)..    # Test 
-00019880: 6c61 7267 6572 206d 6573 7361 6765 730a  larger messages.
-00019890: 2020 2020 2320 616e 6420 7468 6174 2074      # and that t
-000198a0: 6865 2062 6f64 7920 7265 6d61 696e 7320  he body remains 
-000198b0: 756e 746f 7563 6865 640a 2020 2020 636c  untouched.    cl
-000198c0: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
-000198d0: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
-000198e0: 3a0a 0a20 2020 2020 2020 2023 2054 6573  :..        # Tes
-000198f0: 7420 7469 746c 6520 6d61 7820 6c65 6e67  t title max leng
-00019900: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
-00019910: 5f6d 6178 6c65 6e20 3d20 3135 300a 0a20  _maxlen = 150.. 
-00019920: 2020 2020 2020 2023 2045 6e66 6f72 6365         # Enforce
-00019930: 2061 2062 6f64 7920 6c65 6e67 7468 2e20   a body length. 
-00019940: 4d61 6b65 2073 7572 6520 6974 2773 2061  Make sure it's a
-00019950: 6e20 696e 742e 0a20 2020 2020 2020 2062  n int..        b
-00019960: 6f64 795f 6d61 786c 656e 203d 2031 3530  ody_maxlen = 150
-00019970: 0a0a 2020 2020 2020 2020 2320 4e6f 2061  ..        # No a
-00019980: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
-00019990: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
-000199a0: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
-000199b0: 4661 6c73 650a 0a20 2020 2020 2020 2023  False..        #
-000199c0: 2046 6f72 6365 2074 6974 6c65 2074 6f20   Force title to 
-000199d0: 6265 2064 6973 706c 6179 6564 2061 6c77  be displayed alw
-000199e0: 6179 730a 2020 2020 2020 2020 6f76 6572  ays.        over
-000199f0: 666c 6f77 5f64 6973 706c 6179 5f74 6974  flow_display_tit
-00019a00: 6c65 5f6f 6e63 6520 3d20 4661 6c73 650a  le_once = False.
-00019a10: 0a20 2020 2020 2020 2064 6566 205f 5f69  .        def __i
-00019a20: 6e69 745f 5f28 7365 6c66 2c20 2a61 7267  nit__(self, *arg
-00019a30: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-00019a40: 2020 2020 2020 2020 2020 7375 7065 7228            super(
-00019a50: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7761  ).__init__(**kwa
-00019a60: 7267 7329 0a0a 2020 2020 2020 2020 6465  rgs)..        de
-00019a70: 6620 6e6f 7469 6679 2873 656c 662c 202a  f notify(self, *
-00019a80: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00019a90: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
-00019aa0: 7265 7465 6e64 2065 7665 7279 7468 696e  retend everythin
-00019ab0: 6720 6973 206f 6b61 790a 2020 2020 2020  g is okay.      
-00019ac0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-00019ad0: 650a 0a20 2020 2023 204c 6f61 6420 6f75  e..    # Load ou
-00019ae0: 7220 6f62 6a65 6374 0a20 2020 206f 626a  r object.    obj
-00019af0: 203d 2054 6573 744e 6f74 6966 6963 6174   = TestNotificat
-00019b00: 696f 6e28 6f76 6572 666c 6f77 3d4f 7665  ion(overflow=Ove
-00019b10: 7266 6c6f 774d 6f64 652e 5350 4c49 5429  rflowMode.SPLIT)
-00019b20: 0a20 2020 2061 7373 6572 7420 6f62 6a20  .    assert obj 
-00019b30: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
-00019b40: 206e 6577 5f62 6f64 7920 3d20 2862 6f64   new_body = (bod
-00019b50: 7920 2a20 3529 0a20 2020 2063 6875 6e6b  y * 5).    chunk
-00019b60: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-00019b70: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-00019b80: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-00019b90: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-00019ba0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-00019bb0: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-00019bc0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00019bd0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00019be0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
-00019bf0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-00019c00: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00019c10: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00019c20: 793d 6e65 775f 626f 6479 2c20 7469 746c  y=new_body, titl
-00019c30: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
-00019c40: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
-00019c50: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-00019c60: 3d20 3335 0a20 2020 2063 5f6c 656e 203d  = 35.    c_len =
-00019c70: 206c 656e 2827 205b 5858 2f58 585d 2729   len(' [XX/XX]')
-00019c80: 0a20 2020 2066 6f72 2069 6478 2c20 6368  .    for idx, ch
-00019c90: 756e 6b20 696e 2065 6e75 6d65 7261 7465  unk in enumerate
-00019ca0: 2863 6875 6e6b 732c 2073 7461 7274 3d31  (chunks, start=1
-00019cb0: 293a 0a20 2020 2020 2020 2023 2056 6572  ):.        # Ver
-00019cc0: 6966 6963 6174 696f 6e0a 2020 2020 2020  ification.      
-00019cd0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-00019ce0: 6e6b 2e67 6574 2827 7469 746c 6527 2929  nk.get('title'))
-00019cf0: 203c 3d20 6f62 6a2e 7469 746c 655f 6d61   <= obj.title_ma
-00019d00: 786c 656e 0a20 2020 2020 2020 2061 7373  xlen.        ass
-00019d10: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-00019d20: 7428 2762 6f64 7927 2929 203c 3d20 6f62  t('body')) <= ob
-00019d30: 6a2e 626f 6479 5f6d 6178 6c65 6e0a 0a20  j.body_maxlen.. 
-00019d40: 2020 2020 2020 2023 204f 7572 2074 6974         # Our tit
-00019d50: 6c65 2068 6173 2061 2063 6f75 6e74 6572  le has a counter
-00019d60: 2061 6464 6564 2074 6f20 6974 0a20 2020   added to it.   
-00019d70: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
-00019d80: 655b 3a6f 626a 2e74 6974 6c65 5f6d 6178  e[:obj.title_max
-00019d90: 6c65 6e5d 5b3a 2d63 5f6c 656e 5d20 3d3d  len][:-c_len] ==
-00019da0: 2063 6875 6e6b 2e67 6574 2827 7469 746c   chunk.get('titl
-00019db0: 6527 295b 3a2d 635f 6c65 6e5d 0a20 2020  e')[:-c_len].   
-00019dc0: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
-00019dd0: 6b2e 6765 7428 2774 6974 6c65 2729 5b2d  k.get('title')[-
-00019de0: 635f 6c65 6e3a 5d20 3d3d 205c 0a20 2020  c_len:] == \.   
-00019df0: 2020 2020 2020 2020 2027 205b 7b3a 3032           ' [{:02
-00019e00: 7d2f 7b3a 3032 7d5d 272e 666f 726d 6174  }/{:02}]'.format
-00019e10: 2869 6478 2c20 6c65 6e28 6368 756e 6b73  (idx, len(chunks
-00019e20: 2929 0a20 2020 2020 2020 2023 204f 7572  )).        # Our
-00019e30: 2062 6f64 7920 6973 206f 6e6c 7920 6272   body is only br
-00019e40: 6f6b 656e 2075 703b 206e 6f74 206c 6f73  oken up; not los
-00019e50: 740a 2020 2020 2020 2020 5f62 6f64 7920  t.        _body 
-00019e60: 3d20 6368 756e 6b2e 6765 7428 2762 6f64  = chunk.get('bod
-00019e70: 7927 290a 0a20 2020 2020 2020 2023 2055  y')..        # U
-00019e80: 6e2d 7573 6564 2077 6869 7465 7370 6163  n-used whitespac
-00019e90: 6520 6973 2061 6c77 6179 7320 636c 6561  e is always clea
-00019ea0: 6e65 6420 7570 3b20 6d61 6b65 2073 7572  ned up; make sur
-00019eb0: 6520 7765 2061 6363 6f75 6e74 2066 6f72  e we account for
-00019ec0: 0a20 2020 2020 2020 2023 2074 6869 7320  .        # this 
-00019ed0: 696e 206f 7572 206e 6577 2063 616c 6375  in our new calcu
-00019ee0: 6c61 7469 6f6e 0a20 2020 2020 2020 2077  lation.        w
-00019ef0: 735f 6469 6666 203d 206c 656e 286e 6577  s_diff = len(new
-00019f00: 5f62 6f64 795b 6f66 6673 6574 3a20 6c65  _body[offset: le
-00019f10: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-00019f20: 745d 2920 2d20 5c0a 2020 2020 2020 2020  t]) - \.        
-00019f30: 2020 2020 6c65 6e28 6e65 775f 626f 6479      len(new_body
-00019f40: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-00019f50: 6479 2920 2b20 6f66 6673 6574 5d0a 2020  dy) + offset].  
-00019f60: 2020 2020 2020 2020 2020 2020 2020 2e6c                .l
-00019f70: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-00019f80: 7830 6327 292e 7273 7472 6970 2829 290a  x0c').rstrip()).
-00019f90: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00019fa0: 6e65 775f 626f 6479 5b6f 6666 7365 743a  new_body[offset:
-00019fb0: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
-00019fc0: 6673 6574 202b 2077 735f 6469 6666 5d5c  fset + ws_diff]\
-00019fd0: 0a20 2020 2020 2020 2020 2020 202e 6c73  .            .ls
-00019fe0: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
-00019ff0: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
-0001a000: 205f 626f 6479 0a20 2020 2020 2020 206f   _body.        o
-0001a010: 6666 7365 7420 2b3d 2028 6c65 6e28 5f62  ffset += (len(_b
-0001a020: 6f64 7929 202b 2077 735f 6469 6666 290a  ody) + ws_diff).
-0001a030: 0a20 2020 2023 0a20 2020 2023 204e 6578  .    #.    # Nex
-0001a040: 7420 5465 7374 3a20 4170 7065 6e64 2074  t Test: Append t
-0001a050: 6974 6c65 2074 6f20 626f 6479 202b 2073  itle to body + s
-0001a060: 706c 6974 2062 6f64 790a 2020 2020 230a  plit body.    #.
-0001a070: 0a20 2020 2063 6c61 7373 2054 6573 744e  .    class TestN
-0001a080: 6f74 6966 6963 6174 696f 6e28 4e6f 7469  otification(Noti
-0001a090: 6679 4261 7365 293a 0a0a 2020 2020 2020  fyBase):..      
-0001a0a0: 2020 2320 456e 666f 7263 6520 6e6f 2074    # Enforce no t
-0001a0b0: 6974 6c65 0a20 2020 2020 2020 2074 6974  itle.        tit
-0001a0c0: 6c65 5f6d 6178 6c65 6e20 3d20 300a 0a20  le_maxlen = 0.. 
-0001a0d0: 2020 2020 2020 2023 2045 6e66 6f72 6365         # Enforce
-0001a0e0: 2061 2062 6f64 7920 6c65 6e67 7468 2062   a body length b
-0001a0f0: 6173 6564 206f 6e20 7468 6520 7469 746c  ased on the titl
-0001a100: 652e 204d 616b 6520 7375 7265 2069 7427  e. Make sure it'
-0001a110: 7320 616e 2069 6e74 2e0a 2020 2020 2020  s an int..      
-0001a120: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
-0001a130: 696e 7428 7469 746c 655f 6c65 6e20 2f20  int(title_len / 
-0001a140: 3429 0a0a 2020 2020 2020 2020 2320 4e6f  4)..        # No
-0001a150: 2041 6d61 6c67 616d 6174 696f 6e0a 2020   Amalgamation.  
-0001a160: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
-0001a170: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
-0001a180: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-0001a190: 2023 2046 6f72 6365 2074 6974 6c65 2074   # Force title t
-0001a1a0: 6f20 6265 2064 6973 706c 6179 6564 2061  o be displayed a
-0001a1b0: 6c77 6179 730a 2020 2020 2020 2020 6f76  lways.        ov
-0001a1c0: 6572 666c 6f77 5f64 6973 706c 6179 5f74  erflow_display_t
-0001a1d0: 6974 6c65 5f6f 6e63 6520 3d20 4661 6c73  itle_once = Fals
-0001a1e0: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
-0001a1f0: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-0001a200: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-0001a210: 2020 2020 2020 2020 2020 2020 7375 7065              supe
-0001a220: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
-0001a230: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
-0001a240: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
-0001a250: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0001a260: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0001a270: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
-0001a280: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
-0001a290: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0001a2a0: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
-0001a2b0: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
-0001a2c0: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
-0001a2d0: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
-0001a2e0: 7665 7266 6c6f 774d 6f64 652e 5350 4c49  verflowMode.SPLI
-0001a2f0: 5429 0a20 2020 2061 7373 6572 7420 6f62  T).    assert ob
-0001a300: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
-0001a310: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
-0001a320: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
-0001a330: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
-0001a340: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
-0001a350: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
-0001a360: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
-0001a370: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
-0001a380: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0001a390: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0001a3a0: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
-0001a3b0: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
-0001a3c0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-0001a3d0: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
-0001a3e0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-0001a3f0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-0001a400: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-0001a410: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
-0001a420: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-0001a430: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-0001a440: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-0001a450: 653d 7469 746c 6529 0a0a 2020 2020 2320  e=title)..    # 
-0001a460: 4f75 7220 6669 6e61 6c20 7072 6f64 7563  Our final produc
-0001a470: 7420 6973 2074 6861 7420 6f75 7220 7469  t is that our ti
-0001a480: 746c 6520 6861 7320 6265 656e 2061 7070  tle has been app
-0001a490: 656e 6465 6420 746f 206f 7572 2062 6f64  ended to our bod
-0001a4a0: 7920 746f 0a20 2020 2023 2063 7265 6174  y to.    # creat
-0001a4b0: 6520 6f6e 6520 6772 6561 7420 6269 6720  e one great big 
-0001a4c0: 626f 6479 2e20 4173 2061 2072 6573 756c  body. As a resul
-0001a4d0: 7420 7765 276c 6c20 6765 7420 7175 6974  t we'll get quit
-0001a4e0: 6520 6120 6665 7720 6c69 6e65 7320 6261  e a few lines ba
-0001a4f0: 636b 0a20 2020 2023 206e 6f77 2e0a 2020  ck.    # now..  
-0001a500: 2020 6f66 6673 6574 203d 2030 0a0a 2020    offset = 0..  
-0001a510: 2020 2320 4f75 7220 626f 6479 2077 696c    # Our body wil
-0001a520: 6c20 6c6f 6f6b 206c 696b 6520 7468 6973  l look like this
-0001a530: 2069 6e20 736d 616c 6c20 6368 756e 6b73   in small chunks
-0001a540: 2061 7420 7468 6520 656e 6420 6f66 2074   at the end of t
-0001a550: 6865 2064 6179 0a20 2020 2062 756c 6b20  he day.    bulk 
-0001a560: 3d20 7469 746c 6520 2b20 275c 725c 6e27  = title + '\r\n'
-0001a570: 202b 2062 6f64 790a 0a20 2020 2023 2044   + body..    # D
-0001a580: 7565 2074 6f20 7468 6520 6e65 7720 6c69  ue to the new li
-0001a590: 6e65 2061 6464 6564 2074 6f20 7468 6520  ne added to the 
-0001a5a0: 656e 640a 2020 2020 6173 7365 7274 206c  end.    assert l
-0001a5b0: 656e 2863 6875 6e6b 7329 203d 3d20 280a  en(chunks) == (.
-0001a5c0: 2020 2020 2020 2020 2320 7772 6170 2064          # wrap d
-0001a5d0: 6976 6973 696f 6e20 696e 2069 6e74 2829  ivision in int()
-0001a5e0: 2073 6f20 5079 7468 6f6e 2033 2064 6f65   so Python 3 doe
-0001a5f0: 736e 2774 2063 6f6e 7665 7274 2069 7420  sn't convert it 
-0001a600: 746f 2061 2066 6c6f 6174 206f 6e0a 2020  to a float on.  
-0001a610: 2020 2020 2020 2320 7573 0a20 2020 2020        # us.     
-0001a620: 2020 2069 6e74 286c 656e 2862 756c 6b29     int(len(bulk)
-0001a630: 202f 206f 626a 2e62 6f64 795f 6d61 786c   / obj.body_maxl
-0001a640: 656e 2920 2b0a 2020 2020 2020 2020 2831  en) +.        (1
-0001a650: 2069 6620 6c65 6e28 6275 6c6b 2920 2520   if len(bulk) % 
-0001a660: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e20  obj.body_maxlen 
-0001a670: 656c 7365 2030 2929 0a0a 2020 2020 666f  else 0))..    fo
-0001a680: 7220 6368 756e 6b20 696e 2063 6875 6e6b  r chunk in chunk
-0001a690: 733a 0a20 2020 2020 2020 2023 2056 6572  s:.        # Ver
-0001a6a0: 6966 6963 6174 696f 6e0a 2020 2020 2020  ification.      
-0001a6b0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-0001a6c0: 6e6b 2e67 6574 2827 7469 746c 6527 2929  nk.get('title'))
-0001a6d0: 203c 3d20 6f62 6a2e 7469 746c 655f 6d61   <= obj.title_ma
-0001a6e0: 786c 656e 0a20 2020 2020 2020 2061 7373  xlen.        ass
-0001a6f0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0001a700: 7428 2762 6f64 7927 2929 203c 3d20 6f62  t('body')) <= ob
-0001a710: 6a2e 626f 6479 5f6d 6178 6c65 6e0a 0a20  j.body_maxlen.. 
-0001a720: 2020 2020 2020 2023 204f 7572 2074 6974         # Our tit
-0001a730: 6c65 2069 7320 656d 7074 7920 6576 6572  le is empty ever
-0001a740: 7920 7469 6d65 0a20 2020 2020 2020 2061  y time.        a
-0001a750: 7373 6572 7420 6368 756e 6b2e 6765 7428  ssert chunk.get(
-0001a760: 2774 6974 6c65 2729 203d 3d20 2727 0a0a  'title') == ''..
-0001a770: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
-0001a780: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
-0001a790: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
-0001a7a0: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
-0001a7b0: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
-0001a7c0: 0a0a 2020 2020 2020 2020 2320 556e 2d75  ..        # Un-u
-0001a7d0: 7365 6420 7768 6974 6573 7061 6365 2069  sed whitespace i
-0001a7e0: 7320 616c 7761 7973 2063 6c65 616e 6564  s always cleaned
-0001a7f0: 2075 703b 206d 616b 6520 7375 7265 2077   up; make sure w
-0001a800: 6520 6163 636f 756e 7420 666f 720a 2020  e account for.  
-0001a810: 2020 2020 2020 2320 7468 6973 2069 6e20        # this in 
-0001a820: 6f75 7220 6e65 7720 6361 6c63 756c 6174  our new calculat
-0001a830: 696f 6e0a 2020 2020 2020 2020 7773 5f64  ion.        ws_d
-0001a840: 6966 6620 3d20 6c65 6e28 6275 6c6b 5b6f  iff = len(bulk[o
-0001a850: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-0001a860: 2920 2b20 6f66 6673 6574 5d29 202d 205c  ) + offset]) - \
-0001a870: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-0001a880: 2862 756c 6b5b 6f66 6673 6574 3a20 6c65  (bulk[offset: le
-0001a890: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0001a8a0: 745d 0a20 2020 2020 2020 2020 2020 2020  t].             
-0001a8b0: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
-0001a8c0: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
-0001a8d0: 7028 2929 0a0a 2020 2020 2020 2020 6173  p())..        as
-0001a8e0: 7365 7274 2062 756c 6b5b 6f66 6673 6574  sert bulk[offset
-0001a8f0: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-0001a900: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
-0001a910: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
-0001a920: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-0001a930: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
-0001a940: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
-0001a950: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
-0001a960: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
-0001a970: 0a0a 2020 2020 230a 2020 2020 2320 5465  ..    #.    # Te
-0001a980: 7374 2063 6173 6520 7768 6572 6520 6f75  st case where ou
-0001a990: 7220 7469 746c 655f 6c65 6e20 6973 2073  r title_len is s
-0001a9a0: 686f 7274 6572 2074 6865 6e20 7468 6520  horter then the 
-0001a9b0: 7661 6c75 650a 2020 2020 2320 7468 6174  value.    # that
-0001a9c0: 2077 6f75 6c64 206f 7468 6572 7769 7365   would otherwise
-0001a9d0: 2074 7269 6767 6572 2074 6865 205b 5858   trigger the [XX
-0001a9e0: 2f58 585d 2065 6c65 6d65 6e74 730a 2020  /XX] elements.  
-0001a9f0: 2020 230a 0a20 2020 2063 6c61 7373 2054    #..    class T
-0001aa00: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-0001aa10: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
-0001aa20: 2020 2020 2020 2320 5365 7420 6120 736d        # Set a sm
-0001aa30: 616c 6c20 7469 746c 6520 6c65 6e67 7468  all title length
-0001aa40: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
-0001aa50: 6178 6c65 6e20 3d20 3130 300a 0a20 2020  axlen = 100..   
-0001aa60: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
-0001aa70: 2062 6f64 7920 6c65 6e67 7468 2e20 4d61   body length. Ma
-0001aa80: 6b65 2073 7572 6520 6974 2773 2061 6e20  ke sure it's an 
-0001aa90: 696e 742e 0a20 2020 2020 2020 2062 6f64  int..        bod
-0001aaa0: 795f 6d61 786c 656e 203d 2069 6e74 2862  y_maxlen = int(b
-0001aab0: 6f64 795f 6c65 6e20 2f20 3429 0a0a 2020  ody_len / 4)..  
-0001aac0: 2020 2020 2020 2320 4e6f 2041 6d61 6c67        # No Amalg
-0001aad0: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
-0001aae0: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
-0001aaf0: 6174 655f 7469 746c 6520 3d20 4661 6c73  ate_title = Fals
-0001ab00: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
-0001ab10: 6365 2074 6974 6c65 2074 6f20 6265 2064  ce title to be d
-0001ab20: 6973 706c 6179 6564 2061 6c77 6179 730a  isplayed always.
-0001ab30: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-0001ab40: 5f64 6973 706c 6179 5f74 6974 6c65 5f6f  _display_title_o
-0001ab50: 6e63 6520 3d20 4661 6c73 650a 0a20 2020  nce = False..   
-0001ab60: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
-0001ab70: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
-0001ab80: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-0001ab90: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-0001aba0: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
-0001abb0: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
-0001abc0: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
-0001abd0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0001abe0: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
-0001abf0: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
-0001ac00: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
-0001ac10: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-0001ac20: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
-0001ac30: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
-0001ac40: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-0001ac50: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
-0001ac60: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
-0001ac70: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
-0001ac80: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
-0001ac90: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
-0001aca0: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
-0001acb0: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
-0001acc0: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
-0001acd0: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
-0001ace0: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
-0001acf0: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
-0001ad00: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0001ad10: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-0001ad20: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
-0001ad30: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-0001ad40: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-0001ad50: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-0001ad60: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-0001ad70: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-0001ad80: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-0001ad90: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-0001ada0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-0001adb0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-0001adc0: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
-0001add0: 6529 0a20 2020 206f 6666 7365 7420 3d20  e).    offset = 
-0001ade0: 300a 2020 2020 6173 7365 7274 206c 656e  0.    assert len
-0001adf0: 2863 6875 6e6b 7329 203d 3d20 340a 2020  (chunks) == 4.  
-0001ae00: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
-0001ae10: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
-0001ae20: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
-0001ae30: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
-0001ae40: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
-0001ae50: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-0001ae60: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
-0001ae70: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-0001ae80: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-0001ae90: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-0001aea0: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
-0001aeb0: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
-0001aec0: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
-0001aed0: 6973 2074 7275 6e63 6174 6564 2061 6e64  is truncated and
-0001aee0: 206e 6f20 636f 756e 7465 7220 6164 6465   no counter adde
-0001aef0: 640a 2020 2020 2020 2020 6173 7365 7274  d.        assert
-0001af00: 2074 6974 6c65 5b3a 6f62 6a2e 7469 746c   title[:obj.titl
-0001af10: 655f 6d61 786c 656e 5d20 3d3d 2063 6875  e_maxlen] == chu
-0001af20: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
-0001af30: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
-0001af40: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
-0001af50: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
-0001af60: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
-0001af70: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0001af80: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-0001af90: 2062 6f64 795b 6f66 6673 6574 3a20 6c65   body[offset: le
-0001afa0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0001afb0: 745d 5c0a 2020 2020 2020 2020 2020 2020  t]\.            
-0001afc0: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
-0001afd0: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
-0001afe0: 203d 3d20 5f62 6f64 790a 2020 2020 2020   == _body.      
-0001aff0: 2020 6f66 6673 6574 202b 3d20 6c65 6e28    offset += len(
-0001b000: 5f62 6f64 7929 0a0a 2020 2020 230a 2020  _body)..    #.  
-0001b010: 2020 2320 5363 656e 6172 696f 2077 6865    # Scenario whe
-0001b020: 7265 2074 6865 2074 6974 6c65 206c 656e  re the title len
-0001b030: 6774 6820 6973 206c 6172 6765 7220 7468  gth is larger th
-0001b040: 616e 2074 6865 2062 6f64 790a 2020 2020  an the body.    
-0001b050: 230a 0a20 2020 2063 6c61 7373 2054 6573  #..    class Tes
-0001b060: 744e 6f74 6966 6963 6174 696f 6e28 4e6f  tNotification(No
-0001b070: 7469 6679 4261 7365 293a 0a0a 2020 2020  tifyBase):..    
-0001b080: 2020 2020 2320 5365 7420 6120 736d 616c      # Set a smal
-0001b090: 6c20 7469 746c 6520 6c65 6e67 7468 0a20  l title length. 
-0001b0a0: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
-0001b0b0: 6c65 6e20 3d20 3130 300a 0a20 2020 2020  len = 100..     
-0001b0c0: 2020 2023 2045 6e66 6f72 6365 2061 2062     # Enforce a b
-0001b0d0: 6f64 7920 6c65 6e67 7468 2e20 4d61 6b65  ody length. Make
-0001b0e0: 2073 7572 6520 6974 2773 2061 6e20 696e   sure it's an in
-0001b0f0: 742e 0a20 2020 2020 2020 2062 6f64 795f  t..        body_
-0001b100: 6d61 786c 656e 203d 2035 300a 0a20 2020  maxlen = 50..   
-0001b110: 2020 2020 2023 204e 6f20 416d 616c 6761       # No Amalga
-0001b120: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
-0001b130: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
-0001b140: 7465 5f74 6974 6c65 203d 2046 616c 7365  te_title = False
-0001b150: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
-0001b160: 6520 7469 746c 6520 746f 2062 6520 6469  e title to be di
-0001b170: 7370 6c61 7965 6420 616c 7761 7973 0a20  splayed always. 
-0001b180: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
-0001b190: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
-0001b1a0: 6365 203d 2046 616c 7365 0a0a 2020 2020  ce = False..    
-0001b1b0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0001b1c0: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-0001b1d0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-0001b1e0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-0001b1f0: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
-0001b200: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
-0001b210: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
-0001b220: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0001b230: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
-0001b240: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
-0001b250: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
-0001b260: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-0001b270: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
-0001b280: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
-0001b290: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
-0001b2a0: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
-0001b2b0: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
-0001b2c0: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
-0001b2d0: 7420 4e6f 6e65 0a0a 2020 2020 2320 5665  t None..    # Ve
-0001b2e0: 7269 6679 2074 6861 7420 7765 2062 7265  rify that we bre
-0001b2f0: 616b 2074 6865 2074 6974 6c65 2074 6f20  ak the title to 
-0001b300: 6120 6d61 7820 6c65 6e67 7468 206f 6620  a max length of 
-0001b310: 6f75 7220 7469 746c 655f 6d61 780a 2020  our title_max.  
-0001b320: 2020 2320 616e 6420 7468 6174 2074 6865    # and that the
-0001b330: 2062 6f64 7920 7265 6d61 696e 7320 756e   body remains un
-0001b340: 746f 7563 6865 640a 2020 2020 6368 756e  touched.    chun
-0001b350: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0001b360: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-0001b370: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-0001b380: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0001b390: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0001b3a0: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
-0001b3b0: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-0001b3c0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0001b3d0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-0001b3e0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-0001b3f0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0001b400: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-0001b410: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-0001b420: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-0001b430: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-0001b440: 6368 756e 6b73 2920 3d3d 2032 310a 2020  chunks) == 21.  
-0001b450: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
-0001b460: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
-0001b470: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
-0001b480: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
-0001b490: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
-0001b4a0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-0001b4b0: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
-0001b4c0: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-0001b4d0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-0001b4e0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-0001b4f0: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
-0001b500: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
-0001b510: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
-0001b520: 6973 2074 7275 6e63 6174 6564 2061 6e64  is truncated and
-0001b530: 206e 6f20 636f 756e 7465 7220 6164 6465   no counter adde
-0001b540: 640a 2020 2020 2020 2020 6173 7365 7274  d.        assert
-0001b550: 2074 6974 6c65 5b3a 6f62 6a2e 7469 746c   title[:obj.titl
-0001b560: 655f 6d61 786c 656e 5d20 3d3d 2063 6875  e_maxlen] == chu
-0001b570: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
-0001b580: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
-0001b590: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
-0001b5a0: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
-0001b5b0: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
-0001b5c0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
-0001b5d0: 290a 0a20 2020 2020 2020 2023 2055 6e2d  )..        # Un-
-0001b5e0: 7573 6564 2077 6869 7465 7370 6163 6520  used whitespace 
-0001b5f0: 6973 2061 6c77 6179 7320 636c 6561 6e65  is always cleane
-0001b600: 6420 7570 3b20 6d61 6b65 2073 7572 6520  d up; make sure 
-0001b610: 7765 2061 6363 6f75 6e74 2066 6f72 0a20  we account for. 
-0001b620: 2020 2020 2020 2023 2074 6869 7320 696e         # this in
-0001b630: 206f 7572 206e 6577 2063 616c 6375 6c61   our new calcula
-0001b640: 7469 6f6e 0a20 2020 2020 2020 2077 735f  tion.        ws_
-0001b650: 6469 6666 203d 206c 656e 2862 6f64 795b  diff = len(body[
-0001b660: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
-0001b670: 7929 202b 206f 6666 7365 745d 2920 2d20  y) + offset]) - 
-0001b680: 5c0a 2020 2020 2020 2020 2020 2020 6c65  \.            le
-0001b690: 6e28 626f 6479 5b6f 6666 7365 743a 206c  n(body[offset: l
-0001b6a0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-0001b6b0: 6574 5d0a 2020 2020 2020 2020 2020 2020  et].            
-0001b6c0: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
-0001b6d0: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
-0001b6e0: 6970 2829 290a 0a20 2020 2020 2020 2061  ip())..        a
-0001b6f0: 7373 6572 7420 626f 6479 5b6f 6666 7365  ssert body[offse
-0001b700: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
-0001b710: 6f66 6673 6574 202b 2077 735f 6469 6666  offset + ws_diff
-0001b720: 5d5c 0a20 2020 2020 2020 2020 2020 202e  ]\.            .
-0001b730: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
-0001b740: 5c78 3063 2729 2e72 7374 7269 7028 2920  \x0c').rstrip() 
-0001b750: 3d3d 205f 626f 6479 0a20 2020 2020 2020  == _body.       
-0001b760: 206f 6666 7365 7420 2b3d 2028 6c65 6e28   offset += (len(
-0001b770: 5f62 6f64 7929 202b 2077 735f 6469 6666  _body) + ws_diff
-0001b780: 290a 0a0a 6465 6620 7465 7374 5f6e 6f74  )...def test_not
-0001b790: 6966 795f 6f76 6572 666c 6f77 5f73 706c  ify_overflow_spl
-0001b7a0: 6974 5f6e 6f5f 616d 616c 6761 6d61 7469  it_no_amalgamati
-0001b7b0: 6f6e 5f66 6f72 6365 5f74 6974 6c65 5f6f  on_force_title_o
-0001b7c0: 6e63 6528 293a 0a20 2020 2022 2222 0a20  nce():.    """. 
-0001b7d0: 2020 2041 5049 3a20 4f76 6572 666c 6f77     API: Overflow
-0001b7e0: 204e 6f20 416d 616c 6761 6d61 7469 6f6e   No Amalgamation
-0001b7f0: 2028 7469 746c 6520 6f6e 6365 2920 5370   (title once) Sp
-0001b800: 6c69 7420 4675 6e63 7469 6f6e 616c 6974  lit Functionalit
-0001b810: 7920 5465 7374 696e 670a 0a20 2020 2022  y Testing..    "
-0001b820: 2222 0a0a 2020 2020 230a 2020 2020 2320  ""..    #.    # 
-0001b830: 4120 6c69 7474 6c65 2070 7265 7061 7261  A little prepara
-0001b840: 7469 6f6e 0a20 2020 2023 0a0a 2020 2020  tion.    #..    
-0001b850: 2320 4e75 6d62 6572 206f 6620 6368 6172  # Number of char
-0001b860: 6163 7465 7273 2070 6572 206c 696e 650a  acters per line.
-0001b870: 2020 2020 726f 7720 3d20 3234 0a0a 2020      row = 24..  
-0001b880: 2020 2320 536f 6d65 2076 6172 6961 626c    # Some variabl
-0001b890: 6573 2077 6520 7573 6520 746f 2063 6f6e  es we use to con
-0001b8a0: 7472 6f6c 2074 6865 2064 6174 6120 7765  trol the data we
-0001b8b0: 2077 6f72 6b20 7769 7468 0a20 2020 2062   work with.    b
-0001b8c0: 6f64 795f 6c65 6e20 3d20 3130 3234 0a20  ody_len = 1024. 
-0001b8d0: 2020 2074 6974 6c65 5f6c 656e 203d 2031     title_len = 1
-0001b8e0: 3032 340a 0a20 2020 2023 2043 7265 6174  024..    # Creat
-0001b8f0: 6520 6120 6c61 7267 6520 626f 6479 2061  e a large body a
-0001b900: 6e64 2074 6974 6c65 2077 6974 6820 7261  nd title with ra
-0001b910: 6e64 6f6d 2064 6174 610a 2020 2020 626f  ndom data.    bo
-0001b920: 6479 203d 2027 272e 6a6f 696e 2863 686f  dy = ''.join(cho
-0001b930: 6963 6528 7374 725f 616c 7068 6120 2b20  ice(str_alpha + 
-0001b940: 7374 725f 6e75 6d29 2066 6f72 205f 2069  str_num) for _ i
-0001b950: 6e20 7261 6e67 6528 626f 6479 5f6c 656e  n range(body_len
-0001b960: 2929 0a20 2020 2062 6f64 7920 3d20 275c  )).    body = '\
-0001b970: 725c 6e27 2e6a 6f69 6e28 5b62 6f64 795b  r\n'.join([body[
-0001b980: 693a 2069 202b 2072 6f77 5d20 666f 7220  i: i + row] for 
-0001b990: 6920 696e 2072 616e 6765 2830 2c20 6c65  i in range(0, le
-0001b9a0: 6e28 626f 6479 292c 2072 6f77 295d 290a  n(body), row)]).
-0001b9b0: 0a20 2020 2023 2074 6865 206e 6577 206c  .    # the new l
-0001b9c0: 696e 6573 2061 6464 2061 206c 6172 6765  ines add a large
-0001b9d0: 2061 6d6f 756e 7420 746f 206f 7572 2062   amount to our b
-0001b9e0: 6f64 793b 206c 6574 7320 666f 7263 6520  ody; lets force 
-0001b9f0: 7468 6520 636f 6e74 656e 740a 2020 2020  the content.    
-0001ba00: 2320 6261 636b 2074 6f20 6265 696e 6720  # back to being 
-0001ba10: 3130 3234 2063 6861 7261 6374 6572 732e  1024 characters.
-0001ba20: 0a20 2020 2062 6f64 7920 3d20 626f 6479  .    body = body
-0001ba30: 5b30 3a31 3032 345d 0a0a 2020 2020 2320  [0:1024]..    # 
-0001ba40: 4372 6561 7465 206f 7572 2074 6974 6c65  Create our title
-0001ba50: 2075 7369 6e67 2072 616e 646f 6d20 6461   using random da
-0001ba60: 7461 0a20 2020 2074 6974 6c65 203d 2027  ta.    title = '
-0001ba70: 272e 6a6f 696e 2863 686f 6963 6528 7374  '.join(choice(st
-0001ba80: 725f 616c 7068 6120 2b20 7374 725f 6e75  r_alpha + str_nu
-0001ba90: 6d29 2066 6f72 205f 2069 6e20 7261 6e67  m) for _ in rang
-0001baa0: 6528 7469 746c 655f 6c65 6e29 290a 0a20  e(title_len)).. 
-0001bab0: 2020 2023 0a20 2020 2023 2046 6972 7374     #.    # First
-0001bac0: 2054 6573 743a 2054 7275 6e63 6174 6564   Test: Truncated
-0001bad0: 2054 6974 6c65 0a20 2020 2023 0a20 2020   Title.    #.   
-0001bae0: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
-0001baf0: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
-0001bb00: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
-0001bb10: 5465 7374 2074 6974 6c65 206d 6178 206c  Test title max l
-0001bb20: 656e 6774 680a 2020 2020 2020 2020 7469  ength.        ti
-0001bb30: 746c 655f 6d61 786c 656e 203d 2031 300a  tle_maxlen = 10.
-0001bb40: 0a20 2020 2020 2020 2023 2057 6974 6820  .        # With 
-0001bb50: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
-0001bb60: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
-0001bb70: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
-0001bb80: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
-0001bb90: 2046 6f72 6365 2074 6974 6c65 2064 6973   Force title dis
-0001bba0: 706c 6179 6564 206f 6e63 650a 2020 2020  played once.    
-0001bbb0: 2020 2020 6f76 6572 666c 6f77 5f64 6973      overflow_dis
-0001bbc0: 706c 6179 5f74 6974 6c65 5f6f 6e63 6520  play_title_once 
-0001bbd0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-0001bbe0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-0001bbf0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-0001bc00: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-0001bc10: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-0001bc20: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
-0001bc30: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
-0001bc40: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-0001bc50: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-0001bc60: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
-0001bc70: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
-0001bc80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001bc90: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
-0001bca0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
-0001bcb0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
-0001bcc0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
-0001bcd0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
-0001bce0: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
-0001bcf0: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
-0001bd00: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
-0001bd10: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
-0001bd20: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
-0001bd30: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
-0001bd40: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
-0001bd50: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
-0001bd60: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
-0001bd70: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
-0001bd80: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-0001bd90: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
-0001bda0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
-0001bdb0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-0001bdc0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-0001bdd0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
-0001bde0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0001bdf0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0001be00: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
-0001be10: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-0001be20: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-0001be30: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-0001be40: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-0001be50: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
-0001be60: 6e6b 7329 203d 3d20 310a 2020 2020 6173  nks) == 1.    as
-0001be70: 7365 7274 2062 6f64 792e 6c73 7472 6970  sert body.lstrip
-0001be80: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
-0001be90: 2e72 7374 7269 7028 2920 3d3d 2063 6875  .rstrip() == chu
-0001bea0: 6e6b 735b 305d 2e67 6574 2827 626f 6479  nks[0].get('body
-0001beb0: 2729 0a20 2020 2061 7373 6572 7420 7469  ').    assert ti
-0001bec0: 746c 655b 303a 6f62 6a2e 7469 746c 655f  tle[0:obj.title_
-0001bed0: 6d61 786c 656e 5d20 3d3d 2063 6875 6e6b  maxlen] == chunk
-0001bee0: 735b 305d 2e67 6574 2827 7469 746c 6527  s[0].get('title'
-0001bef0: 290a 0a20 2020 2023 0a20 2020 2023 204e  )..    #.    # N
-0001bf00: 6578 7420 5465 7374 3a20 4c69 6e65 2043  ext Test: Line C
-0001bf10: 6f75 6e74 2043 6f6e 7472 6f6c 0a20 2020  ount Control.   
-0001bf20: 2023 0a0a 2020 2020 636c 6173 7320 5465   #..    class Te
-0001bf30: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
-0001bf40: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
-0001bf50: 2020 2020 2023 2054 6573 7420 7469 746c       # Test titl
-0001bf60: 6520 6d61 7820 6c65 6e67 7468 0a20 2020  e max length.   
-0001bf70: 2020 2020 2074 6974 6c65 5f6d 6178 6c65       title_maxle
-0001bf80: 6e20 3d20 350a 0a20 2020 2020 2020 2023  n = 5..        #
-0001bf90: 204d 6178 696d 756d 206e 756d 6265 7220   Maximum number 
-0001bfa0: 6f66 206c 696e 6573 0a20 2020 2020 2020  of lines.       
-0001bfb0: 2062 6f64 795f 6d61 785f 6c69 6e65 5f63   body_max_line_c
-0001bfc0: 6f75 6e74 203d 2035 0a0a 2020 2020 2020  ount = 5..      
-0001bfd0: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
-0001bfe0: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
-0001bff0: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
-0001c000: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
-0001c010: 2020 2020 2020 2020 2320 466f 7263 6520          # Force 
-0001c020: 7469 746c 6520 6469 7370 6c61 7965 6420  title displayed 
-0001c030: 6f6e 6365 0a20 2020 2020 2020 206f 7665  once.        ove
-0001c040: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
-0001c050: 746c 655f 6f6e 6365 203d 2054 7275 650a  tle_once = True.
-0001c060: 0a20 2020 2020 2020 2064 6566 205f 5f69  .        def __i
-0001c070: 6e69 745f 5f28 7365 6c66 2c20 2a61 7267  nit__(self, *arg
-0001c080: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-0001c090: 2020 2020 2020 2020 2020 7375 7065 7228            super(
-0001c0a0: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7761  ).__init__(**kwa
-0001c0b0: 7267 7329 0a0a 2020 2020 2020 2020 6465  rgs)..        de
-0001c0c0: 6620 6e6f 7469 6679 2873 656c 662c 202a  f notify(self, *
-0001c0d0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-0001c0e0: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
-0001c0f0: 7265 7465 6e64 2065 7665 7279 7468 696e  retend everythin
-0001c100: 6720 6973 206f 6b61 790a 2020 2020 2020  g is okay.      
-0001c110: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-0001c120: 650a 0a20 2020 2023 204c 6f61 6420 6f75  e..    # Load ou
-0001c130: 7220 6f62 6a65 6374 0a20 2020 206f 626a  r object.    obj
-0001c140: 203d 2054 6573 744e 6f74 6966 6963 6174   = TestNotificat
-0001c150: 696f 6e28 6f76 6572 666c 6f77 3d4f 7665  ion(overflow=Ove
-0001c160: 7266 6c6f 774d 6f64 652e 5350 4c49 5429  rflowMode.SPLIT)
-0001c170: 0a20 2020 2061 7373 6572 7420 6f62 6a20  .    assert obj 
-0001c180: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
-0001c190: 2023 2056 6572 6966 7920 7468 6174 2077   # Verify that w
-0001c1a0: 6520 6272 6561 6b20 7468 6520 7469 746c  e break the titl
-0001c1b0: 6520 746f 2061 206d 6178 206c 656e 6774  e to a max lengt
-0001c1c0: 6820 6f66 206f 7572 2074 6974 6c65 5f6d  h of our title_m
-0001c1d0: 6178 0a20 2020 2023 2061 6e64 2074 6861  ax.    # and tha
-0001c1e0: 7420 7468 6520 626f 6479 2072 656d 6169  t the body remai
-0001c1f0: 6e73 2075 6e74 6f75 6368 6564 0a20 2020  ns untouched.   
-0001c200: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0001c210: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0001c220: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
-0001c230: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
-0001c240: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-0001c250: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
-0001c260: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-0001c270: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0001c280: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-0001c290: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
-0001c2a0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-0001c2b0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-0001c2c0: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
-0001c2d0: 7469 746c 6529 0a20 2020 2061 7373 6572  title).    asser
-0001c2e0: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
-0001c2f0: 2031 0a20 2020 2061 7373 6572 7420 6c65   1.    assert le
-0001c300: 6e28 6368 756e 6b73 5b30 5d2e 6765 7428  n(chunks[0].get(
-0001c310: 2762 6f64 7927 292e 7370 6c69 7428 275c  'body').split('\
-0001c320: 6e27 2929 203d 3d20 6f62 6a2e 626f 6479  n')) == obj.body
-0001c330: 5f6d 6178 5f6c 696e 655f 636f 756e 740a  _max_line_count.
-0001c340: 2020 2020 6173 7365 7274 2074 6974 6c65      assert title
-0001c350: 5b30 3a6f 626a 2e74 6974 6c65 5f6d 6178  [0:obj.title_max
-0001c360: 6c65 6e5d 203d 3d20 6368 756e 6b73 5b30  len] == chunks[0
-0001c370: 5d2e 6765 7428 2774 6974 6c65 2729 0a0a  ].get('title')..
-0001c380: 2020 2020 230a 2020 2020 2320 4e65 7874      #.    # Next
-0001c390: 2054 6573 743a 2053 706c 6974 2062 6f64   Test: Split bod
-0001c3a0: 790a 2020 2020 230a 0a20 2020 2063 6c61  y.    #..    cla
-0001c3b0: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
-0001c3c0: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
-0001c3d0: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
-0001c3e0: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
-0001c3f0: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
-0001c400: 6d61 786c 656e 203d 2074 6974 6c65 5f6c  maxlen = title_l
-0001c410: 656e 0a0a 2020 2020 2020 2020 2320 456e  en..        # En
-0001c420: 666f 7263 6520 6120 626f 6479 206c 656e  force a body len
-0001c430: 6774 682e 204d 616b 6520 7375 7265 2069  gth. Make sure i
-0001c440: 7427 7320 616e 2069 6e74 2e0a 2020 2020  t's an int..    
-0001c450: 2020 2020 626f 6479 5f6d 6178 6c65 6e20      body_maxlen 
-0001c460: 3d20 696e 7428 626f 6479 5f6c 656e 202f  = int(body_len /
-0001c470: 2034 290a 0a20 2020 2020 2020 2023 2057   4)..        # W
-0001c480: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-0001c490: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-0001c4a0: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-0001c4b0: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-0001c4c0: 2020 2023 2046 6f72 6365 2074 6974 6c65     # Force title
-0001c4d0: 2064 6973 706c 6179 6564 206f 6e63 650a   displayed once.
-0001c4e0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-0001c4f0: 5f64 6973 706c 6179 5f74 6974 6c65 5f6f  _display_title_o
-0001c500: 6e63 6520 3d20 5472 7565 0a0a 2020 2020  nce = True..    
-0001c510: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0001c520: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-0001c530: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-0001c540: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-0001c550: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
-0001c560: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
-0001c570: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
-0001c580: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0001c590: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
-0001c5a0: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
-0001c5b0: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
-0001c5c0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-0001c5d0: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
-0001c5e0: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
-0001c5f0: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
-0001c600: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
-0001c610: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
-0001c620: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
-0001c630: 7420 4e6f 6e65 0a0a 2020 2020 2320 5665  t None..    # Ve
-0001c640: 7269 6679 2074 6861 7420 7765 2062 7265  rify that we bre
-0001c650: 616b 2074 6865 2074 6974 6c65 2074 6f20  ak the title to 
-0001c660: 6120 6d61 7820 6c65 6e67 7468 206f 6620  a max length of 
-0001c670: 6f75 7220 7469 746c 655f 6d61 780a 2020  our title_max.  
-0001c680: 2020 2320 616e 6420 7468 6174 2074 6865    # and that the
-0001c690: 2062 6f64 7920 7265 6d61 696e 7320 756e   body remains un
-0001c6a0: 746f 7563 6865 640a 2020 2020 6368 756e  touched.    chun
-0001c6b0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0001c6c0: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-0001c6d0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-0001c6e0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0001c6f0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0001c700: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
-0001c710: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-0001c720: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0001c730: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-0001c740: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-0001c750: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0001c760: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-0001c770: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-0001c780: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-0001c790: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-0001c7a0: 6368 756e 6b73 2920 3d3d 2035 0a20 2020  chunks) == 5.   
-0001c7b0: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-0001c7c0: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-0001c7d0: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-0001c7e0: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-0001c7f0: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-0001c800: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-0001c810: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-0001c820: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-0001c830: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001c840: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-0001c850: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-0001c860: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
-0001c870: 2020 2023 204e 6f20 636f 756e 7465 7220     # No counter 
-0001c880: 6973 2064 6973 706c 6179 6564 2062 6563  is displayed bec
-0001c890: 6175 7365 206f 7572 2074 6974 6c65 2069  ause our title i
-0001c8a0: 7320 736f 2065 6e6f 726d 6f75 730a 2020  s so enormous.  
-0001c8b0: 2020 2020 2020 2320 5765 2073 7769 7463        # We switc
-0001c8c0: 6820 746f 2061 2064 6973 706c 6179 2074  h to a display t
-0001c8d0: 6974 6c65 206f 6e20 6669 7273 7420 6d65  itle on first me
-0001c8e0: 7373 6167 6520 6f6e 6c79 0a20 2020 2020  ssage only.     
-0001c8f0: 2020 2069 6620 6964 7820 3e20 313a 0a20     if idx > 1:. 
-0001c900: 2020 2020 2020 2020 2020 2023 2045 6d70             # Emp
-0001c910: 7479 2028 6e6f 2074 6974 6c65 2064 6973  ty (no title dis
-0001c920: 706c 6179 6564 206f 6e20 666f 6c6c 6f77  played on follow
-0001c930: 696e 6720 656e 7472 6965 730a 2020 2020  ing entries.    
-0001c940: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-0001c950: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-0001c960: 2920 3d3d 2022 220a 2020 2020 2020 2020  ) == "".        
-0001c970: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001c980: 2020 2320 5468 6520 6c65 6e67 7468 206f    # The length o
-0001c990: 6620 7468 6520 626f 6479 2070 7265 7661  f the body preva
-0001c9a0: 696c 7320 6f75 7220 7469 746c 6520 6475  ils our title du
-0001c9b0: 6520 746f 2069 7420 6265 696e 670a 2020  e to it being.  
-0001c9c0: 2020 2020 2020 2020 2020 2320 736f 206d            # so m
-0001c9d0: 7563 6820 736d 616c 6c65 7220 7468 656e  uch smaller then
-0001c9e0: 206f 7572 2074 6974 6c65 206c 656e 6774   our title lengt
-0001c9f0: 680a 2020 2020 2020 2020 2020 2020 6173  h.            as
-0001ca00: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-0001ca10: 6574 2827 7469 746c 6527 2929 203d 3d20  et('title')) == 
-0001ca20: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e0a  obj.body_maxlen.
-0001ca30: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-0001ca40: 7274 2074 6974 6c65 5b3a 6f62 6a2e 626f  rt title[:obj.bo
-0001ca50: 6479 5f6d 6178 6c65 6e5d 203d 3d20 6368  dy_maxlen] == ch
-0001ca60: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0001ca70: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
-0001ca80: 626f 6479 2069 7320 6f6e 6c79 2062 726f  body is only bro
-0001ca90: 6b65 6e20 7570 3b20 6e6f 7420 6c6f 7374  ken up; not lost
-0001caa0: 0a20 2020 2020 2020 205f 626f 6479 203d  .        _body =
-0001cab0: 2063 6875 6e6b 2e67 6574 2827 626f 6479   chunk.get('body
-0001cac0: 2729 0a20 2020 2020 2020 2061 7373 6572  ').        asser
-0001cad0: 7420 626f 6479 5b6f 6666 7365 743a 206c  t body[offset: l
-0001cae0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-0001caf0: 6574 5d5c 0a20 2020 2020 2020 2020 2020  et]\.           
-0001cb00: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
-0001cb10: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
-0001cb20: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
-0001cb30: 2020 206f 6666 7365 7420 2b3d 206c 656e     offset += len
-0001cb40: 285f 626f 6479 290a 0a20 2020 2023 2041  (_body)..    # A
-0001cb50: 6e6f 7468 6572 2065 6467 6520 6361 7365  nother edge case
-0001cb60: 2077 6865 7265 2074 6865 2074 6974 6c65   where the title
-0001cb70: 206a 7573 7420 6973 6e27 7420 7468 6174   just isn't that
-0001cb80: 206c 6f6e 6720 6c65 6176 696e 670a 2020   long leaving.  
-0001cb90: 2020 2320 6120 6c6f 7420 6f66 2073 7061    # a lot of spa
-0001cba0: 6365 2066 6f72 2074 6865 205b 7878 2f78  ce for the [xx/x
-0001cbb0: 785d 2065 6e74 7269 6573 2028 6e6f 2074  x] entries (no t
-0001cbc0: 7275 6e63 6174 696f 6e20 6e65 6564 6564  runcation needed
-0001cbd0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0001cbe0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0001cbf0: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
-0001cc00: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
-0001cc10: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0001cc20: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-0001cc30: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
-0001cc40: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
-0001cc50: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
-0001cc60: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
-0001cc70: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-0001cc80: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0001cc90: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-0001cca0: 6974 6c65 3d74 6974 6c65 5b3a 3230 5d29  itle=title[:20])
-0001ccb0: 0a20 2020 206f 6666 7365 7420 3d20 300a  .    offset = 0.
-0001ccc0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-0001ccd0: 6875 6e6b 7329 203d 3d20 350a 2020 2020  hunks) == 5.    
-0001cce0: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-0001ccf0: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-0001cd00: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-0001cd10: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-0001cd20: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-0001cd30: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0001cd40: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-0001cd50: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-0001cd60: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0001cd70: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-0001cd80: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-0001cd90: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-0001cda0: 2020 2320 4e6f 2063 6f75 6e74 6572 2069    # No counter i
-0001cdb0: 7320 6469 7370 6c61 7965 6420 6265 6361  s displayed beca
-0001cdc0: 7573 6520 6f75 7220 7469 746c 6520 6973  use our title is
-0001cdd0: 2073 6f20 656e 6f72 6d6f 7573 0a20 2020   so enormous.   
-0001cde0: 2020 2020 2023 2057 6520 7377 6974 6368       # We switch
-0001cdf0: 2074 6f20 6120 6469 7370 6c61 7920 7469   to a display ti
-0001ce00: 746c 6520 6f6e 2066 6972 7374 206d 6573  tle on first mes
-0001ce10: 7361 6765 206f 6e6c 790a 2020 2020 2020  sage only.      
-0001ce20: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-0001ce30: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-0001ce40: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-0001ce50: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-0001ce60: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-0001ce70: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-0001ce80: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0001ce90: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-0001cea0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001ceb0: 2023 2054 6865 206c 656e 6774 6820 6f66   # The length of
-0001cec0: 2074 6865 2062 6f64 7920 7072 6576 6169   the body prevai
-0001ced0: 6c73 206f 7572 2074 6974 6c65 2064 7565  ls our title due
-0001cee0: 2074 6f20 6974 2062 6569 6e67 0a20 2020   to it being.   
-0001cef0: 2020 2020 2020 2020 2023 2073 6f20 6d75           # so mu
-0001cf00: 6368 2073 6d61 6c6c 6572 2074 6865 6e20  ch smaller then 
-0001cf10: 6f75 7220 7469 746c 6520 6c65 6e67 7468  our title length
-0001cf20: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-0001cf30: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0001cf40: 7428 2774 6974 6c65 2729 2920 3d3d 2032  t('title')) == 2
-0001cf50: 300a 2020 2020 2020 2020 2020 2020 6173  0.            as
-0001cf60: 7365 7274 2074 6974 6c65 5b3a 3230 5d20  sert title[:20] 
-0001cf70: 3d3d 2063 6875 6e6b 2e67 6574 2827 7469  == chunk.get('ti
-0001cf80: 746c 6527 290a 0a20 2020 2020 2020 2023  tle')..        #
-0001cf90: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
-0001cfa0: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
-0001cfb0: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
-0001cfc0: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
-0001cfd0: 2762 6f64 7927 290a 2020 2020 2020 2020  'body').        
-0001cfe0: 6173 7365 7274 2062 6f64 795b 6f66 6673  assert body[offs
-0001cff0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
-0001d000: 206f 6666 7365 745d 5c0a 2020 2020 2020   offset]\.      
-0001d010: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
-0001d020: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-0001d030: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
-0001d040: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
-0001d050: 3d20 6c65 6e28 5f62 6f64 7929 0a0a 2020  = len(_body)..  
-0001d060: 2020 230a 2020 2020 2320 5465 7374 2066    #.    # Test f
-0001d070: 6f72 6369 6e67 206f 7665 7266 6c6f 775f  orcing overflow_
-0001d080: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
-0001d090: 6365 0a20 2020 2023 0a20 2020 2063 6c61  ce.    #.    cla
-0001d0a0: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
-0001d0b0: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
-0001d0c0: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
-0001d0d0: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
-0001d0e0: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
-0001d0f0: 6d61 786c 656e 203d 2074 6974 6c65 5f6c  maxlen = title_l
-0001d100: 656e 0a0a 2020 2020 2020 2020 2320 456e  en..        # En
-0001d110: 666f 7263 6520 6120 626f 6479 206c 656e  force a body len
-0001d120: 6774 682e 204d 616b 6520 7375 7265 2069  gth. Make sure i
-0001d130: 7427 7320 616e 2069 6e74 2e0a 2020 2020  t's an int..    
-0001d140: 2020 2020 626f 6479 5f6d 6178 6c65 6e20      body_maxlen 
-0001d150: 3d20 696e 7428 626f 6479 5f6c 656e 202f  = int(body_len /
-0001d160: 2034 290a 0a20 2020 2020 2020 2023 2057   4)..        # W
-0001d170: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
-0001d180: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-0001d190: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
-0001d1a0: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
-0001d1b0: 2020 2023 2046 6f72 6365 2074 6974 6c65     # Force title
-0001d1c0: 2064 6973 706c 6179 6564 206f 6e63 650a   displayed once.
-0001d1d0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-0001d1e0: 5f64 6973 706c 6179 5f74 6974 6c65 5f6f  _display_title_o
-0001d1f0: 6e63 6520 3d20 5472 7565 0a0a 2020 2020  nce = True..    
-0001d200: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0001d210: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-0001d220: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-0001d230: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-0001d240: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
-0001d250: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
-0001d260: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
-0001d270: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0001d280: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
-0001d290: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
-0001d2a0: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
-0001d2b0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-0001d2c0: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
-0001d2d0: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
-0001d2e0: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
-0001d2f0: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
-0001d300: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
-0001d310: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
-0001d320: 7420 4e6f 6e65 0a0a 2020 2020 6368 756e  t None..    chun
-0001d330: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0001d340: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-0001d350: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
-0001d360: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0001d370: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0001d380: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
-0001d390: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
-0001d3a0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0001d3b0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
-0001d3c0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
-0001d3d0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0001d3e0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
-0001d3f0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-0001d400: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-0001d410: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-0001d420: 6368 756e 6b73 2920 3d3d 2035 0a20 2020  chunks) == 5.   
-0001d430: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-0001d440: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-0001d450: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-0001d460: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-0001d470: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-0001d480: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-0001d490: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-0001d4a0: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-0001d4b0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001d4c0: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-0001d4d0: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-0001d4e0: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
-0001d4f0: 2020 2023 204f 7572 2074 6974 6c65 2068     # Our title h
-0001d500: 6173 206e 6f20 636f 756e 7465 7220 6164  as no counter ad
-0001d510: 6465 6420 746f 2069 740a 2020 2020 2020  ded to it.      
-0001d520: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-0001d530: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-0001d540: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-0001d550: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-0001d560: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-0001d570: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-0001d580: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0001d590: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-0001d5a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001d5b0: 2023 2054 6865 2062 6f64 7920 6c65 6e67   # The body leng
-0001d5c0: 7468 2070 7265 7661 696c 7320 6475 6520  th prevails due 
-0001d5d0: 746f 206f 7572 2061 6d61 6c67 616d 6174  to our amalgamat
-0001d5e0: 696f 6e20 666c 6167 0a20 2020 2020 2020  ion flag.       
-0001d5f0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0001d600: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-0001d610: 2729 2920 3d3d 206f 626a 2e62 6f64 795f  ')) == obj.body_
-0001d620: 6d61 786c 656e 0a20 2020 2020 2020 2020  maxlen.         
-0001d630: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
-0001d640: 3a6f 626a 2e62 6f64 795f 6d61 786c 656e  :obj.body_maxlen
-0001d650: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
-0001d660: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
-0001d670: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
-0001d680: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
-0001d690: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
-0001d6a0: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
-0001d6b0: 7428 2762 6f64 7927 290a 2020 2020 2020  t('body').      
-0001d6c0: 2020 6173 7365 7274 2062 6f64 795b 6f66    assert body[of
-0001d6d0: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-0001d6e0: 202b 206f 6666 7365 745d 5c0a 2020 2020   + offset]\.    
-0001d6f0: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
-0001d700: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
-0001d710: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
-0001d720: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
-0001d730: 202b 3d20 6c65 6e28 5f62 6f64 7929 0a0a   += len(_body)..
-0001d740: 2020 2020 2320 5465 7374 206c 6172 6765      # Test large
-0001d750: 7220 6d65 7373 6167 6573 0a20 2020 2023  r messages.    #
-0001d760: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
-0001d770: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
-0001d780: 6368 6564 0a20 2020 2063 6c61 7373 2054  ched.    class T
-0001d790: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-0001d7a0: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
-0001d7b0: 2020 2020 2020 2320 5465 7374 2074 6974        # Test tit
-0001d7c0: 6c65 206d 6178 206c 656e 6774 680a 2020  le max length.  
-0001d7d0: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
-0001d7e0: 656e 203d 2031 3530 0a0a 2020 2020 2020  en = 150..      
-0001d7f0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
-0001d800: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
-0001d810: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
-0001d820: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
-0001d830: 6178 6c65 6e20 3d20 3430 300a 0a20 2020  axlen = 400..   
-0001d840: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
-0001d850: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
-0001d860: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
-0001d870: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
-0001d880: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
-0001d890: 6365 2074 6974 6c65 2064 6973 706c 6179  ce title display
-0001d8a0: 6564 206f 6e63 650a 2020 2020 2020 2020  ed once.        
-0001d8b0: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
-0001d8c0: 5f74 6974 6c65 5f6f 6e63 6520 3d20 5472  _title_once = Tr
-0001d8d0: 7565 0a0a 2020 2020 2020 2020 6465 6620  ue..        def 
-0001d8e0: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
-0001d8f0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-0001d900: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
-0001d910: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
-0001d920: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
-0001d930: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
-0001d940: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-0001d950: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0001d960: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
-0001d970: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
-0001d980: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001d990: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
-0001d9a0: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
-0001d9b0: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
-0001d9c0: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
-0001d9d0: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
-0001d9e0: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
-0001d9f0: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
-0001da00: 2020 2020 6e65 775f 626f 6479 203d 2028      new_body = (
-0001da10: 626f 6479 202a 2035 3030 290a 2020 2020  body * 500).    
-0001da20: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-0001da30: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-0001da40: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
-0001da50: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
-0001da60: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
-0001da70: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
-0001da80: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
-0001da90: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0001daa0: 7665 7266 6c6f 7728 626f 6479 3d6e 6577  verflow(body=new
-0001dab0: 5f62 6f64 792c 2074 6974 6c65 3d22 2229  _body, title="")
-0001dac0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-0001dad0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-0001dae0: 7728 626f 6479 3d6e 6577 5f62 6f64 792c  w(body=new_body,
-0001daf0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-0001db00: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
-0001db10: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-0001db20: 6b73 2920 3d3d 2031 3238 310a 2020 2020  ks) == 1281.    
-0001db30: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
-0001db40: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
-0001db50: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
-0001db60: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
-0001db70: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
-0001db80: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0001db90: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
-0001dba0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-0001dbb0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-0001dbc0: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
-0001dbd0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
-0001dbe0: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
-0001dbf0: 2020 2320 4e6f 2063 6f75 6e74 6572 2069    # No counter i
-0001dc00: 7320 6469 7370 6c61 7965 6420 6265 6361  s displayed beca
-0001dc10: 7573 6520 6f75 7220 7469 746c 6520 6973  use our title is
-0001dc20: 2073 6f20 656e 6f72 6d6f 7573 0a20 2020   so enormous.   
-0001dc30: 2020 2020 2023 2057 6520 7377 6974 6368       # We switch
-0001dc40: 2074 6f20 6120 6469 7370 6c61 7920 7469   to a display ti
-0001dc50: 746c 6520 6f6e 2066 6972 7374 206d 6573  tle on first mes
-0001dc60: 7361 6765 206f 6e6c 790a 2020 2020 2020  sage only.      
-0001dc70: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-0001dc80: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-0001dc90: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-0001dca0: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-0001dcb0: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-0001dcc0: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-0001dcd0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0001dce0: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-0001dcf0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001dd00: 2023 2054 6865 206c 656e 6774 6820 6f66   # The length of
-0001dd10: 2074 6865 2062 6f64 7920 7072 6576 6169   the body prevai
-0001dd20: 6c73 206f 7572 2074 6974 6c65 2064 7565  ls our title due
-0001dd30: 2074 6f20 6974 2062 6569 6e67 0a20 2020   to it being.   
-0001dd40: 2020 2020 2020 2020 2023 2073 6f20 6d75           # so mu
-0001dd50: 6368 2073 6d61 6c6c 6572 2074 6865 6e20  ch smaller then 
-0001dd60: 6f75 7220 7469 746c 6520 6c65 6e67 7468  our title length
-0001dd70: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-0001dd80: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0001dd90: 7428 2774 6974 6c65 2729 2920 3d3d 206f  t('title')) == o
-0001dda0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-0001ddb0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-0001ddc0: 7274 2074 6974 6c65 5b3a 6f62 6a2e 7469  rt title[:obj.ti
-0001ddd0: 746c 655f 6d61 786c 656e 5d20 3d3d 2063  tle_maxlen] == c
-0001dde0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-0001ddf0: 290a 0a20 2020 2020 2020 2023 204f 7572  )..        # Our
-0001de00: 2062 6f64 7920 6973 206f 6e6c 7920 6272   body is only br
-0001de10: 6f6b 656e 2075 703b 206e 6f74 206c 6f73  oken up; not los
-0001de20: 740a 2020 2020 2020 2020 5f62 6f64 7920  t.        _body 
-0001de30: 3d20 6368 756e 6b2e 6765 7428 2762 6f64  = chunk.get('bod
-0001de40: 7927 290a 0a20 2020 2020 2020 2023 2055  y')..        # U
-0001de50: 6e2d 7573 6564 2077 6869 7465 7370 6163  n-used whitespac
-0001de60: 6520 6973 2061 6c77 6179 7320 636c 6561  e is always clea
-0001de70: 6e65 6420 7570 3b20 6d61 6b65 2073 7572  ned up; make sur
-0001de80: 6520 7765 2061 6363 6f75 6e74 2066 6f72  e we account for
-0001de90: 0a20 2020 2020 2020 2023 2074 6869 7320  .        # this 
-0001dea0: 696e 206f 7572 206e 6577 2063 616c 6375  in our new calcu
-0001deb0: 6c61 7469 6f6e 0a20 2020 2020 2020 2077  lation.        w
-0001dec0: 735f 6469 6666 203d 206c 656e 286e 6577  s_diff = len(new
-0001ded0: 5f62 6f64 795b 6f66 6673 6574 3a20 6c65  _body[offset: le
-0001dee0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0001def0: 745d 2920 2d20 5c0a 2020 2020 2020 2020  t]) - \.        
-0001df00: 2020 2020 6c65 6e28 6e65 775f 626f 6479      len(new_body
-0001df10: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-0001df20: 6479 2920 2b20 6f66 6673 6574 5d0a 2020  dy) + offset].  
-0001df30: 2020 2020 2020 2020 2020 2020 2020 2e6c                .l
-0001df40: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-0001df50: 7830 6327 292e 7273 7472 6970 2829 290a  x0c').rstrip()).
-0001df60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001df70: 6e65 775f 626f 6479 5b6f 6666 7365 743a  new_body[offset:
-0001df80: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
-0001df90: 6673 6574 202b 2077 735f 6469 6666 5d5c  fset + ws_diff]\
-0001dfa0: 0a20 2020 2020 2020 2020 2020 202e 6c73  .            .ls
-0001dfb0: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
-0001dfc0: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
-0001dfd0: 205f 626f 6479 0a20 2020 2020 2020 206f   _body.        o
-0001dfe0: 6666 7365 7420 2b3d 2028 6c65 6e28 5f62  ffset += (len(_b
-0001dff0: 6f64 7929 202b 2077 735f 6469 6666 290a  ody) + ws_diff).
-0001e000: 0a20 2020 2023 2042 6f64 7920 6368 756e  .    # Body chun
-0001e010: 6b20 6973 2062 6579 6f6e 6420 3420 6469  k is beyond 4 di
-0001e020: 6769 7473 2c20 736f 205b 5858 5858 2f58  gits, so [XXXX/X
-0001e030: 5858 585d 2069 7320 7475 726e 6564 206f  XXX] is turned o
-0001e040: 6666 0a20 2020 206e 6577 5f62 6f64 7920  ff.    new_body 
-0001e050: 3d20 2862 6f64 7920 2a20 3235 3030 290a  = (body * 2500).
-0001e060: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-0001e070: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-0001e080: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-0001e090: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
-0001e0a0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0001e0b0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-0001e0c0: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-0001e0d0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-0001e0e0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-0001e0f0: 3d6e 6577 5f62 6f64 792c 2074 6974 6c65  =new_body, title
-0001e100: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-0001e110: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-0001e120: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
-0001e130: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
-0001e140: 290a 2020 2020 6f66 6673 6574 203d 2030  ).    offset = 0
-0001e150: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-0001e160: 6368 756e 6b73 2920 3d3d 2036 3430 310a  chunks) == 6401.
-0001e170: 2020 2020 666f 7220 6964 782c 2063 6875      for idx, chu
-0001e180: 6e6b 2069 6e20 656e 756d 6572 6174 6528  nk in enumerate(
-0001e190: 6368 756e 6b73 2c20 7374 6172 743d 3129  chunks, start=1)
-0001e1a0: 3a0a 2020 2020 2020 2020 2320 5665 7269  :.        # Veri
-0001e1b0: 6669 6361 7469 6f6e 0a20 2020 2020 2020  fication.       
-0001e1c0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-0001e1d0: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
-0001e1e0: 3c3d 206f 626a 2e74 6974 6c65 5f6d 6178  <= obj.title_max
-0001e1f0: 6c65 6e0a 2020 2020 2020 2020 6173 7365  len.        asse
-0001e200: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
-0001e210: 2827 626f 6479 2729 2920 3c3d 206f 626a  ('body')) <= obj
-0001e220: 2e62 6f64 795f 6d61 786c 656e 0a0a 2020  .body_maxlen..  
-0001e230: 2020 2020 2020 2320 4e6f 2063 6f75 6e74        # No count
-0001e240: 6572 2069 7320 6469 7370 6c61 7965 6420  er is displayed 
-0001e250: 6265 6361 7573 6520 6f75 7220 7469 746c  because our titl
-0001e260: 6520 6973 2073 6f20 656e 6f72 6d6f 7573  e is so enormous
-0001e270: 0a20 2020 2020 2020 2023 2057 6520 7377  .        # We sw
-0001e280: 6974 6368 2074 6f20 6120 6469 7370 6c61  itch to a displa
-0001e290: 7920 7469 746c 6520 6f6e 2066 6972 7374  y title on first
-0001e2a0: 206d 6573 7361 6765 206f 6e6c 790a 2020   message only.  
-0001e2b0: 2020 2020 2020 6966 2069 6478 203e 2031        if idx > 1
-0001e2c0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0001e2d0: 456d 7074 7920 286e 6f20 7469 746c 6520  Empty (no title 
-0001e2e0: 6469 7370 6c61 7965 6420 6f6e 2066 6f6c  displayed on fol
-0001e2f0: 6c6f 7769 6e67 2065 6e74 7269 6573 0a20  lowing entries. 
-0001e300: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-0001e310: 7420 6368 756e 6b2e 6765 7428 2774 6974  t chunk.get('tit
-0001e320: 6c65 2729 203d 3d20 2222 0a20 2020 2020  le') == "".     
-0001e330: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001e340: 2020 2020 2023 2054 6865 206c 656e 6774       # The lengt
-0001e350: 6820 6f66 2074 6865 2062 6f64 7920 7072  h of the body pr
-0001e360: 6576 6169 6c73 206f 7572 2074 6974 6c65  evails our title
-0001e370: 2064 7565 2074 6f20 6974 2062 6569 6e67   due to it being
-0001e380: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-0001e390: 6f20 6d75 6368 2073 6d61 6c6c 6572 2074  o much smaller t
-0001e3a0: 6865 6e20 6f75 7220 7469 746c 6520 6c65  hen our title le
-0001e3b0: 6e67 7468 0a20 2020 2020 2020 2020 2020  ngth.           
-0001e3c0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-0001e3d0: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
-0001e3e0: 3d3d 206f 626a 2e74 6974 6c65 5f6d 6178  == obj.title_max
-0001e3f0: 6c65 6e0a 2020 2020 2020 2020 2020 2020  len.            
-0001e400: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
-0001e410: 6a2e 7469 746c 655f 6d61 786c 656e 5d20  j.title_maxlen] 
-0001e420: 3d3d 2063 6875 6e6b 2e67 6574 2827 7469  == chunk.get('ti
-0001e430: 746c 6527 290a 0a20 2020 2020 2020 2023  tle')..        #
-0001e440: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
-0001e450: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
-0001e460: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
-0001e470: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
-0001e480: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
-0001e490: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
-0001e4a0: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
-0001e4b0: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
-0001e4c0: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
-0001e4d0: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
-0001e4e0: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
-0001e4f0: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
-0001e500: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
-0001e510: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
-0001e520: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
-0001e530: 6666 7365 745d 2920 2d20 5c0a 2020 2020  ffset]) - \.    
-0001e540: 2020 2020 2020 2020 6c65 6e28 6e65 775f          len(new_
-0001e550: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
-0001e560: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
-0001e570: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001e580: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
-0001e590: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
-0001e5a0: 2829 290a 0a20 2020 2020 2020 2061 7373  ())..        ass
-0001e5b0: 6572 7420 6e65 775f 626f 6479 5b6f 6666  ert new_body[off
-0001e5c0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-0001e5d0: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
-0001e5e0: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
-0001e5f0: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
-0001e600: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
-0001e610: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
-0001e620: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
-0001e630: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
-0001e640: 6666 290a 0a20 2020 2023 2054 6573 7420  ff)..    # Test 
-0001e650: 6c61 7267 6572 206d 6573 7361 6765 730a  larger messages.
-0001e660: 2020 2020 2320 616e 6420 7468 6174 2074      # and that t
-0001e670: 6865 2062 6f64 7920 7265 6d61 696e 7320  he body remains 
-0001e680: 756e 746f 7563 6865 640a 2020 2020 636c  untouched.    cl
-0001e690: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
-0001e6a0: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
-0001e6b0: 3a0a 0a20 2020 2020 2020 2023 2054 6573  :..        # Tes
-0001e6c0: 7420 7469 746c 6520 6d61 7820 6c65 6e67  t title max leng
-0001e6d0: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
-0001e6e0: 5f6d 6178 6c65 6e20 3d20 3135 300a 0a20  _maxlen = 150.. 
-0001e6f0: 2020 2020 2020 2023 2045 6e66 6f72 6365         # Enforce
-0001e700: 2061 2062 6f64 7920 6c65 6e67 7468 2e20   a body length. 
-0001e710: 4d61 6b65 2073 7572 6520 6974 2773 2061  Make sure it's a
-0001e720: 6e20 696e 742e 0a20 2020 2020 2020 2062  n int..        b
-0001e730: 6f64 795f 6d61 786c 656e 203d 2031 3530  ody_maxlen = 150
-0001e740: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
-0001e750: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
-0001e760: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
-0001e770: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
-0001e780: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-0001e790: 2320 466f 7263 6520 7469 746c 6520 6469  # Force title di
-0001e7a0: 7370 6c61 7965 6420 6f6e 6365 0a20 2020  splayed once.   
-0001e7b0: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
-0001e7c0: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
-0001e7d0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
-0001e7e0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0001e7f0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-0001e800: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
-0001e810: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
-0001e820: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
-0001e830: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
-0001e840: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-0001e850: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-0001e860: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
-0001e870: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
-0001e880: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
-0001e890: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
-0001e8a0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
-0001e8b0: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
-0001e8c0: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
-0001e8d0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
-0001e8e0: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
-0001e8f0: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
-0001e900: 6f6e 650a 0a20 2020 206e 6577 5f62 6f64  one..    new_bod
-0001e910: 7920 3d20 2862 6f64 7920 2a20 3529 0a20  y = (body * 5). 
-0001e920: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-0001e930: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-0001e940: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
-0001e950: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
-0001e960: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-0001e970: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
-0001e980: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-0001e990: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-0001e9a0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-0001e9b0: 6e65 775f 626f 6479 2c20 7469 746c 653d  new_body, title=
-0001e9c0: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-0001e9d0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-0001e9e0: 666c 6f77 2862 6f64 793d 6e65 775f 626f  flow(body=new_bo
-0001e9f0: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-0001ea00: 0a20 2020 206f 6666 7365 7420 3d20 300a  .    offset = 0.
-0001ea10: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
-0001ea20: 6875 6e6b 7329 203d 3d20 3336 0a20 2020  hunks) == 36.   
-0001ea30: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
-0001ea40: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
-0001ea50: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
-0001ea60: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
-0001ea70: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
-0001ea80: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
-0001ea90: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
-0001eaa0: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
-0001eab0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001eac0: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
-0001ead0: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
-0001eae0: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
-0001eaf0: 2020 2023 204f 7572 2074 6974 6c65 2068     # Our title h
-0001eb00: 6173 206e 6f20 636f 756e 7465 7220 6164  as no counter ad
-0001eb10: 6465 6420 746f 2069 740a 2020 2020 2020  ded to it.      
-0001eb20: 2020 6966 2069 6478 203e 2031 3a0a 2020    if idx > 1:.  
-0001eb30: 2020 2020 2020 2020 2020 2320 456d 7074            # Empt
-0001eb40: 7920 286e 6f20 7469 746c 6520 6469 7370  y (no title disp
-0001eb50: 6c61 7965 6420 6f6e 2066 6f6c 6c6f 7769  layed on followi
-0001eb60: 6e67 2065 6e74 7269 6573 0a20 2020 2020  ng entries.     
-0001eb70: 2020 2020 2020 2061 7373 6572 7420 6368         assert ch
-0001eb80: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
-0001eb90: 203d 3d20 2222 0a20 2020 2020 2020 2065   == "".        e
-0001eba0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001ebb0: 2023 2042 6563 6175 7365 2031 3530 2069   # Because 150 i
-0001ebc0: 7320 7768 6174 2077 6520 7365 7420 7468  s what we set th
-0001ebd0: 6520 7469 746c 6520 6c69 6d69 7420 746f  e title limit to
-0001ebe0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-0001ebf0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
-0001ec00: 7428 2774 6974 6c65 2729 2920 3d3d 206f  t('title')) == o
-0001ec10: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
-0001ec20: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-0001ec30: 7274 2074 6974 6c65 5b3a 6f62 6a2e 7469  rt title[:obj.ti
-0001ec40: 746c 655f 6d61 786c 656e 5d20 3d3d 2063  tle_maxlen] == c
-0001ec50: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-0001ec60: 290a 0a20 2020 2020 2020 2023 204f 7572  )..        # Our
-0001ec70: 2062 6f64 7920 6973 206f 6e6c 7920 6272   body is only br
-0001ec80: 6f6b 656e 2075 703b 206e 6f74 206c 6f73  oken up; not los
-0001ec90: 740a 2020 2020 2020 2020 5f62 6f64 7920  t.        _body 
-0001eca0: 3d20 6368 756e 6b2e 6765 7428 2762 6f64  = chunk.get('bod
-0001ecb0: 7927 290a 0a20 2020 2020 2020 2023 2055  y')..        # U
-0001ecc0: 6e2d 7573 6564 2077 6869 7465 7370 6163  n-used whitespac
-0001ecd0: 6520 6973 2061 6c77 6179 7320 636c 6561  e is always clea
-0001ece0: 6e65 6420 7570 3b20 6d61 6b65 2073 7572  ned up; make sur
-0001ecf0: 6520 7765 2061 6363 6f75 6e74 2066 6f72  e we account for
-0001ed00: 0a20 2020 2020 2020 2023 2074 6869 7320  .        # this 
-0001ed10: 696e 206f 7572 206e 6577 2063 616c 6375  in our new calcu
-0001ed20: 6c61 7469 6f6e 0a20 2020 2020 2020 2077  lation.        w
-0001ed30: 735f 6469 6666 203d 206c 656e 286e 6577  s_diff = len(new
-0001ed40: 5f62 6f64 795b 6f66 6673 6574 3a20 6c65  _body[offset: le
-0001ed50: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
-0001ed60: 745d 2920 2d20 5c0a 2020 2020 2020 2020  t]) - \.        
-0001ed70: 2020 2020 6c65 6e28 6e65 775f 626f 6479      len(new_body
-0001ed80: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
-0001ed90: 6479 2920 2b20 6f66 6673 6574 5d0a 2020  dy) + offset].  
-0001eda0: 2020 2020 2020 2020 2020 2020 2020 2e6c                .l
-0001edb0: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
-0001edc0: 7830 6327 292e 7273 7472 6970 2829 290a  x0c').rstrip()).
-0001edd0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001ede0: 6e65 775f 626f 6479 5b6f 6666 7365 743a  new_body[offset:
-0001edf0: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
-0001ee00: 6673 6574 202b 2077 735f 6469 6666 5d5c  fset + ws_diff]\
-0001ee10: 0a20 2020 2020 2020 2020 2020 202e 6c73  .            .ls
-0001ee20: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
-0001ee30: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
-0001ee40: 205f 626f 6479 0a20 2020 2020 2020 206f   _body.        o
-0001ee50: 6666 7365 7420 2b3d 2028 6c65 6e28 5f62  ffset += (len(_b
-0001ee60: 6f64 7929 202b 2077 735f 6469 6666 290a  ody) + ws_diff).
-0001ee70: 0a20 2020 2023 0a20 2020 2023 204e 6578  .    #.    # Nex
-0001ee80: 7420 5465 7374 3a20 4170 7065 6e64 2074  t Test: Append t
-0001ee90: 6974 6c65 2074 6f20 626f 6479 202b 2073  itle to body + s
-0001eea0: 706c 6974 2062 6f64 790a 2020 2020 230a  plit body.    #.
-0001eeb0: 0a20 2020 2063 6c61 7373 2054 6573 744e  .    class TestN
-0001eec0: 6f74 6966 6963 6174 696f 6e28 4e6f 7469  otification(Noti
-0001eed0: 6679 4261 7365 293a 0a0a 2020 2020 2020  fyBase):..      
-0001eee0: 2020 2320 456e 666f 7263 6520 6e6f 2074    # Enforce no t
-0001eef0: 6974 6c65 0a20 2020 2020 2020 2074 6974  itle.        tit
-0001ef00: 6c65 5f6d 6178 6c65 6e20 3d20 300a 0a20  le_maxlen = 0.. 
-0001ef10: 2020 2020 2020 2023 2045 6e66 6f72 6365         # Enforce
-0001ef20: 2061 2062 6f64 7920 6c65 6e67 7468 2062   a body length b
-0001ef30: 6173 6564 206f 6e20 7468 6520 7469 746c  ased on the titl
-0001ef40: 652e 204d 616b 6520 7375 7265 2069 7427  e. Make sure it'
-0001ef50: 7320 616e 2069 6e74 2e0a 2020 2020 2020  s an int..      
-0001ef60: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
-0001ef70: 696e 7428 7469 746c 655f 6c65 6e20 2f20  int(title_len / 
-0001ef80: 3429 0a0a 2020 2020 2020 2020 2320 5769  4)..        # Wi
-0001ef90: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
-0001efa0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
-0001efb0: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
-0001efc0: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
-0001efd0: 2020 2320 466f 7263 6520 7469 746c 6520    # Force title 
-0001efe0: 6469 7370 6c61 7965 6420 6f6e 6365 0a20  displayed once. 
-0001eff0: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
-0001f000: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
-0001f010: 6365 203d 2054 7275 650a 0a20 2020 2020  ce = True..     
-0001f020: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0001f030: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-0001f040: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-0001f050: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-0001f060: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
-0001f070: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
-0001f080: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
-0001f090: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0001f0a0: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
-0001f0b0: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
-0001f0c0: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
-0001f0d0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-0001f0e0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-0001f0f0: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
-0001f100: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
-0001f110: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
-0001f120: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
-0001f130: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
-0001f140: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
-0001f150: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
-0001f160: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
-0001f170: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
-0001f180: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
-0001f190: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
-0001f1a0: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
-0001f1b0: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
-0001f1c0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
-0001f1d0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
-0001f1e0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
-0001f1f0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
-0001f200: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
-0001f210: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
-0001f220: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-0001f230: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-0001f240: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
-0001f250: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
-0001f260: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-0001f270: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
-0001f280: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
-0001f290: 0a0a 2020 2020 2320 4f75 7220 6669 6e61  ..    # Our fina
-0001f2a0: 6c20 7072 6f64 7563 7420 6973 2074 6861  l product is tha
-0001f2b0: 7420 6f75 7220 7469 746c 6520 6861 7320  t our title has 
-0001f2c0: 6265 656e 2061 7070 656e 6465 6420 746f  been appended to
-0001f2d0: 206f 7572 2062 6f64 7920 746f 0a20 2020   our body to.   
-0001f2e0: 2023 2063 7265 6174 6520 6f6e 6520 6772   # create one gr
-0001f2f0: 6561 7420 6269 6720 626f 6479 2e20 4173  eat big body. As
-0001f300: 2061 2072 6573 756c 7420 7765 276c 6c20   a result we'll 
-0001f310: 6765 7420 7175 6974 6520 6120 6665 7720  get quite a few 
-0001f320: 6c69 6e65 7320 6261 636b 0a20 2020 2023  lines back.    #
-0001f330: 206e 6f77 2e0a 2020 2020 6f66 6673 6574   now..    offset
-0001f340: 203d 2030 0a0a 2020 2020 2320 4f75 7220   = 0..    # Our 
-0001f350: 626f 6479 2077 696c 6c20 6c6f 6f6b 206c  body will look l
-0001f360: 696b 6520 7468 6973 2069 6e20 736d 616c  ike this in smal
-0001f370: 6c20 6368 756e 6b73 2061 7420 7468 6520  l chunks at the 
-0001f380: 656e 6420 6f66 2074 6865 2064 6179 0a20  end of the day. 
-0001f390: 2020 2062 756c 6b20 3d20 7469 746c 6520     bulk = title 
-0001f3a0: 2b20 275c 725c 6e27 202b 2062 6f64 790a  + '\r\n' + body.
-0001f3b0: 0a20 2020 2023 2044 7565 2074 6f20 7468  .    # Due to th
-0001f3c0: 6520 6e65 7720 6c69 6e65 2061 6464 6564  e new line added
-0001f3d0: 2074 6f20 7468 6520 656e 640a 2020 2020   to the end.    
-0001f3e0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
-0001f3f0: 7329 203d 3d20 280a 2020 2020 2020 2020  s) == (.        
-0001f400: 2320 7772 6170 2064 6976 6973 696f 6e20  # wrap division 
-0001f410: 696e 2069 6e74 2829 2073 6f20 5079 7468  in int() so Pyth
-0001f420: 6f6e 2033 2064 6f65 736e 2774 2063 6f6e  on 3 doesn't con
-0001f430: 7665 7274 2069 7420 746f 2061 2066 6c6f  vert it to a flo
-0001f440: 6174 206f 6e0a 2020 2020 2020 2020 2320  at on.        # 
-0001f450: 7573 0a20 2020 2020 2020 2069 6e74 286c  us.        int(l
-0001f460: 656e 2862 756c 6b29 202f 206f 626a 2e62  en(bulk) / obj.b
-0001f470: 6f64 795f 6d61 786c 656e 2920 2b0a 2020  ody_maxlen) +.  
-0001f480: 2020 2020 2020 2831 2069 6620 6c65 6e28        (1 if len(
-0001f490: 6275 6c6b 2920 2520 6f62 6a2e 626f 6479  bulk) % obj.body
-0001f4a0: 5f6d 6178 6c65 6e20 656c 7365 2030 2929  _maxlen else 0))
-0001f4b0: 0a0a 2020 2020 666f 7220 6368 756e 6b20  ..    for chunk 
-0001f4c0: 696e 2063 6875 6e6b 733a 0a20 2020 2020  in chunks:.     
-0001f4d0: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
-0001f4e0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-0001f4f0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-0001f500: 7469 746c 6527 2929 203d 3d20 300a 2020  title')) == 0.  
-0001f510: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-0001f520: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
-0001f530: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
-0001f540: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
-0001f550: 2320 4f75 7220 7469 746c 6520 6973 2065  # Our title is e
-0001f560: 6d70 7479 2065 7665 7279 2074 696d 650a  mpty every time.
-0001f570: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-0001f580: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-0001f590: 2920 3d3d 2027 270a 2020 2020 2020 2020  ) == ''.        
-0001f5a0: 2320 4f75 7220 626f 6479 2069 7320 6f6e  # Our body is on
-0001f5b0: 6c79 2062 726f 6b65 6e20 7570 3b20 6e6f  ly broken up; no
-0001f5c0: 7420 6c6f 7374 0a20 2020 2020 2020 205f  t lost.        _
-0001f5d0: 626f 6479 203d 2063 6875 6e6b 2e67 6574  body = chunk.get
-0001f5e0: 2827 626f 6479 2729 0a0a 2020 2020 2020  ('body')..      
-0001f5f0: 2020 2320 556e 2d75 7365 6420 7768 6974    # Un-used whit
-0001f600: 6573 7061 6365 2069 7320 616c 7761 7973  espace is always
-0001f610: 2063 6c65 616e 6564 2075 703b 206d 616b   cleaned up; mak
-0001f620: 6520 7375 7265 2077 6520 6163 636f 756e  e sure we accoun
-0001f630: 7420 666f 720a 2020 2020 2020 2020 2320  t for.        # 
-0001f640: 7468 6973 2069 6e20 6f75 7220 6e65 7720  this in our new 
-0001f650: 6361 6c63 756c 6174 696f 6e0a 2020 2020  calculation.    
-0001f660: 2020 2020 7773 5f64 6966 6620 3d20 6c65      ws_diff = le
-0001f670: 6e28 6275 6c6b 5b6f 6666 7365 743a 206c  n(bulk[offset: l
-0001f680: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
-0001f690: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
-0001f6a0: 2020 2020 206c 656e 2862 756c 6b5b 6f66       len(bulk[of
-0001f6b0: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
-0001f6c0: 202b 206f 6666 7365 745d 0a20 2020 2020   + offset].     
-0001f6d0: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
-0001f6e0: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
-0001f6f0: 2729 2e72 7374 7269 7028 2929 0a0a 2020  ').rstrip())..  
-0001f700: 2020 2020 2020 6173 7365 7274 2062 756c        assert bul
-0001f710: 6b5b 6f66 6673 6574 3a20 6c65 6e28 5f62  k[offset: len(_b
-0001f720: 6f64 7929 202b 206f 6666 7365 7420 2b20  ody) + offset + 
-0001f730: 7773 5f64 6966 665d 5c0a 2020 2020 2020  ws_diff]\.      
-0001f740: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
-0001f750: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-0001f760: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
-0001f770: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
-0001f780: 3d20 286c 656e 285f 626f 6479 2920 2b20  = (len(_body) + 
-0001f790: 7773 5f64 6966 6629 0a0a 2020 2020 230a  ws_diff)..    #.
-0001f7a0: 2020 2020 2320 5465 7374 2063 6173 6520      # Test case 
-0001f7b0: 7768 6572 6520 6f75 7220 7469 746c 655f  where our title_
-0001f7c0: 6c65 6e20 6973 2073 686f 7274 6572 2074  len is shorter t
-0001f7d0: 6865 6e20 7468 6520 7661 6c75 650a 2020  hen the value.  
-0001f7e0: 2020 2320 7468 6174 2077 6f75 6c64 206f    # that would o
-0001f7f0: 7468 6572 7769 7365 2074 7269 6767 6572  therwise trigger
-0001f800: 2074 6865 205b 5858 2f58 585d 2065 6c65   the [XX/XX] ele
-0001f810: 6d65 6e74 730a 2020 2020 230a 0a20 2020  ments.    #..   
-0001f820: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
-0001f830: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
-0001f840: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
-0001f850: 5365 7420 6120 736d 616c 6c20 7469 746c  Set a small titl
-0001f860: 6520 6c65 6e67 7468 0a20 2020 2020 2020  e length.       
-0001f870: 2074 6974 6c65 5f6d 6178 6c65 6e20 3d20   title_maxlen = 
-0001f880: 3130 300a 0a20 2020 2020 2020 2023 2045  100..        # E
-0001f890: 6e66 6f72 6365 2061 2062 6f64 7920 6c65  nforce a body le
-0001f8a0: 6e67 7468 2e20 4d61 6b65 2073 7572 6520  ngth. Make sure 
-0001f8b0: 6974 2773 2061 6e20 696e 742e 0a20 2020  it's an int..   
-0001f8c0: 2020 2020 2062 6f64 795f 6d61 786c 656e       body_maxlen
-0001f8d0: 203d 2069 6e74 2862 6f64 795f 6c65 6e20   = int(body_len 
-0001f8e0: 2f20 3429 0a0a 2020 2020 2020 2020 2320  / 4)..        # 
-0001f8f0: 5769 7468 2061 6d61 6c67 616d 6174 696f  With amalgamatio
-0001f900: 6e0a 2020 2020 2020 2020 6f76 6572 666c  n.        overfl
-0001f910: 6f77 5f61 6d61 6c67 616d 6174 655f 7469  ow_amalgamate_ti
-0001f920: 746c 6520 3d20 5472 7565 0a0a 2020 2020  tle = True..    
-0001f930: 2020 2020 2320 466f 7263 6520 7469 746c      # Force titl
-0001f940: 6520 6469 7370 6c61 7965 6420 6f6e 6365  e displayed once
-0001f950: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
-0001f960: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
-0001f970: 6f6e 6365 203d 2054 7275 650a 0a20 2020  once = True..   
-0001f980: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
-0001f990: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
-0001f9a0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-0001f9b0: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
-0001f9c0: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
-0001f9d0: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
-0001f9e0: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
-0001f9f0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0001fa00: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
-0001fa10: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
-0001fa20: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
-0001fa30: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-0001fa40: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
-0001fa50: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
-0001fa60: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
-0001fa70: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
-0001fa80: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
-0001fa90: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
-0001faa0: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
-0001fab0: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
-0001fac0: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
-0001fad0: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
-0001fae0: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
-0001faf0: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
-0001fb00: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
-0001fb10: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
-0001fb20: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
-0001fb30: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
-0001fb40: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
-0001fb50: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-0001fb60: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-0001fb70: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
-0001fb80: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
-0001fb90: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
-0001fba0: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
-0001fbb0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-0001fbc0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-0001fbd0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-0001fbe0: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
-0001fbf0: 6529 0a20 2020 206f 6666 7365 7420 3d20  e).    offset = 
-0001fc00: 300a 2020 2020 6173 7365 7274 206c 656e  0.    assert len
-0001fc10: 2863 6875 6e6b 7329 203d 3d20 350a 2020  (chunks) == 5.  
-0001fc20: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
-0001fc30: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
-0001fc40: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
-0001fc50: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
-0001fc60: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
-0001fc70: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-0001fc80: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
-0001fc90: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-0001fca0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
-0001fcb0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
-0001fcc0: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
-0001fcd0: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
-0001fce0: 2020 2020 2320 4e6f 2063 6f75 6e74 6572      # No counter
-0001fcf0: 2069 7320 6469 7370 6c61 7965 6420 6265   is displayed be
-0001fd00: 6361 7573 6520 6f75 7220 7469 746c 6520  cause our title 
-0001fd10: 6973 2073 6f20 656e 6f72 6d6f 7573 0a20  is so enormous. 
-0001fd20: 2020 2020 2020 2023 2057 6520 7377 6974         # We swit
-0001fd30: 6368 2074 6f20 6120 6469 7370 6c61 7920  ch to a display 
-0001fd40: 7469 746c 6520 6f6e 2066 6972 7374 206d  title on first m
-0001fd50: 6573 7361 6765 206f 6e6c 790a 2020 2020  essage only.    
-0001fd60: 2020 2020 6966 2069 6478 203e 2031 3a0a      if idx > 1:.
-0001fd70: 2020 2020 2020 2020 2020 2020 2320 456d              # Em
-0001fd80: 7074 7920 286e 6f20 7469 746c 6520 6469  pty (no title di
-0001fd90: 7370 6c61 7965 6420 6f6e 2066 6f6c 6c6f  splayed on follo
-0001fda0: 7769 6e67 2065 6e74 7269 6573 0a20 2020  wing entries.   
-0001fdb0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-0001fdc0: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
-0001fdd0: 2729 203d 3d20 2222 0a20 2020 2020 2020  ') == "".       
-0001fde0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001fdf0: 2020 2023 2054 6865 206c 656e 6774 6820     # The length 
-0001fe00: 6f66 2074 6865 2062 6f64 7920 7072 6576  of the body prev
-0001fe10: 6169 6c73 206f 7572 2074 6974 6c65 2064  ails our title d
-0001fe20: 7565 2074 6f20 6974 2062 6569 6e67 0a20  ue to it being. 
-0001fe30: 2020 2020 2020 2020 2020 2023 2073 6f20             # so 
-0001fe40: 6d75 6368 2073 6d61 6c6c 6572 2074 6865  much smaller the
-0001fe50: 6e20 6f75 7220 7469 746c 6520 6c65 6e67  n our title leng
-0001fe60: 7468 0a20 2020 2020 2020 2020 2020 2061  th.            a
-0001fe70: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-0001fe80: 6765 7428 2774 6974 6c65 2729 2920 3d3d  get('title')) ==
-0001fe90: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
-0001fea0: 6e0a 2020 2020 2020 2020 2020 2020 6173  n.            as
-0001feb0: 7365 7274 2074 6974 6c65 5b3a 6f62 6a2e  sert title[:obj.
-0001fec0: 7469 746c 655f 6d61 786c 656e 5d20 3d3d  title_maxlen] ==
-0001fed0: 2063 6875 6e6b 2e67 6574 2827 7469 746c   chunk.get('titl
-0001fee0: 6527 290a 0a20 2020 2020 2020 2023 204f  e')..        # O
-0001fef0: 7572 2062 6f64 7920 6973 206f 6e6c 7920  ur body is only 
-0001ff00: 6272 6f6b 656e 2075 703b 206e 6f74 206c  broken up; not l
-0001ff10: 6f73 740a 2020 2020 2020 2020 5f62 6f64  ost.        _bod
-0001ff20: 7920 3d20 6368 756e 6b2e 6765 7428 2762  y = chunk.get('b
-0001ff30: 6f64 7927 290a 0a20 2020 2020 2020 2023  ody')..        #
-0001ff40: 2055 6e2d 7573 6564 2077 6869 7465 7370   Un-used whitesp
-0001ff50: 6163 6520 6973 2061 6c77 6179 7320 636c  ace is always cl
-0001ff60: 6561 6e65 6420 7570 3b20 6d61 6b65 2073  eaned up; make s
-0001ff70: 7572 6520 7765 2061 6363 6f75 6e74 2066  ure we account f
-0001ff80: 6f72 0a20 2020 2020 2020 2023 2074 6869  or.        # thi
-0001ff90: 7320 696e 206f 7572 206e 6577 2063 616c  s in our new cal
-0001ffa0: 6375 6c61 7469 6f6e 0a20 2020 2020 2020  culation.       
-0001ffb0: 2077 735f 6469 6666 203d 206c 656e 2862   ws_diff = len(b
-0001ffc0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
-0001ffd0: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
-0001ffe0: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
-0001fff0: 2020 6c65 6e28 626f 6479 5b6f 6666 7365    len(body[offse
-00020000: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
-00020010: 6f66 6673 6574 5d0a 2020 2020 2020 2020  offset].        
-00020020: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
-00020030: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
-00020040: 7273 7472 6970 2829 290a 0a20 2020 2020  rstrip())..     
-00020050: 2020 2061 7373 6572 7420 626f 6479 5b6f     assert body[o
-00020060: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
-00020070: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
-00020080: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
-00020090: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
-000200a0: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
-000200b0: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
-000200c0: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
-000200d0: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
-000200e0: 6469 6666 290a 0a20 2020 2023 0a20 2020  diff)..    #.   
-000200f0: 2023 2053 6365 6e61 7269 6f20 7768 6572   # Scenario wher
-00020100: 6520 7468 6520 7469 746c 6520 6c65 6e67  e the title leng
-00020110: 7468 2069 7320 6c61 7267 6572 2074 6861  th is larger tha
-00020120: 6e20 7468 6520 626f 6479 0a20 2020 2023  n the body.    #
-00020130: 0a0a 2020 2020 636c 6173 7320 5465 7374  ..    class Test
-00020140: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
-00020150: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
-00020160: 2020 2023 2053 6574 2061 2073 6d61 6c6c     # Set a small
-00020170: 2074 6974 6c65 206c 656e 6774 680a 2020   title length.  
-00020180: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
-00020190: 656e 203d 2031 3030 0a0a 2020 2020 2020  en = 100..      
-000201a0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
-000201b0: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
-000201c0: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
-000201d0: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
-000201e0: 6178 6c65 6e20 3d20 3530 0a0a 2020 2020  axlen = 50..    
-000201f0: 2020 2020 2320 5769 7468 2061 6d61 6c67      # With amalg
-00020200: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
-00020210: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
-00020220: 6174 655f 7469 746c 6520 3d20 5472 7565  ate_title = True
-00020230: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
-00020240: 6520 7469 746c 6520 6469 7370 6c61 7965  e title displaye
-00020250: 6420 6f6e 6365 0a20 2020 2020 2020 206f  d once.        o
-00020260: 7665 7266 6c6f 775f 6469 7370 6c61 795f  verflow_display_
-00020270: 7469 746c 655f 6f6e 6365 203d 2054 7275  title_once = Tru
-00020280: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
-00020290: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
-000202a0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-000202b0: 2020 2020 2020 2020 2020 2020 7375 7065              supe
-000202c0: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
-000202d0: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
-000202e0: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
-000202f0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00020300: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00020310: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
-00020320: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
-00020330: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00020340: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
-00020350: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
-00020360: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
-00020370: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
-00020380: 7665 7266 6c6f 774d 6f64 652e 5350 4c49  verflowMode.SPLI
-00020390: 5429 0a20 2020 2061 7373 6572 7420 6f62  T).    assert ob
-000203a0: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
-000203b0: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
-000203c0: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
-000203d0: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
-000203e0: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
-000203f0: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
-00020400: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
-00020410: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
-00020420: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
-00020430: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
-00020440: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
-00020450: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
-00020460: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
-00020470: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
-00020480: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
-00020490: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-000204a0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-000204b0: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
-000204c0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
-000204d0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
-000204e0: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
-000204f0: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
-00020500: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
-00020510: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
-00020520: 3d20 3232 0a20 2020 2066 6f72 2069 6478  = 22.    for idx
-00020530: 2c20 6368 756e 6b20 696e 2065 6e75 6d65  , chunk in enume
-00020540: 7261 7465 2863 6875 6e6b 732c 2073 7461  rate(chunks, sta
-00020550: 7274 3d31 293a 0a20 2020 2020 2020 2023  rt=1):.        #
-00020560: 2056 6572 6966 6963 6174 696f 6e0a 2020   Verification.  
-00020570: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00020580: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
-00020590: 6527 2929 203c 3d20 6f62 6a2e 7469 746c  e')) <= obj.titl
-000205a0: 655f 6d61 786c 656e 0a20 2020 2020 2020  e_maxlen.       
-000205b0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
-000205c0: 6b2e 6765 7428 2762 6f64 7927 2929 203c  k.get('body')) <
-000205d0: 3d20 6f62 6a2e 626f 6479 5f6d 6178 6c65  = obj.body_maxle
-000205e0: 6e0a 0a20 2020 2020 2020 2023 204f 7572  n..        # Our
-000205f0: 2074 6974 6c65 2068 6173 206e 6f20 636f   title has no co
-00020600: 756e 7465 7220 6164 6465 6420 746f 2069  unter added to i
-00020610: 7420 6475 6520 746f 2069 7427 7320 6c65  t due to it's le
-00020620: 6e67 7468 0a20 2020 2020 2020 2069 6620  ngth.        if 
-00020630: 6964 7820 3e20 313a 0a20 2020 2020 2020  idx > 1:.       
-00020640: 2020 2020 2023 2045 6d70 7479 2028 6e6f       # Empty (no
-00020650: 2074 6974 6c65 2064 6973 706c 6179 6564   title displayed
-00020660: 206f 6e20 666f 6c6c 6f77 696e 6720 656e   on following en
-00020670: 7472 6965 730a 2020 2020 2020 2020 2020  tries.          
-00020680: 2020 6173 7365 7274 2063 6875 6e6b 2e67    assert chunk.g
-00020690: 6574 2827 7469 746c 6527 2920 3d3d 2022  et('title') == "
-000206a0: 220a 2020 2020 2020 2020 656c 7365 3a0a  ".        else:.
-000206b0: 2020 2020 2020 2020 2020 2020 2320 4265              # Be
-000206c0: 6361 7573 6520 3135 3020 6973 2077 6861  cause 150 is wha
-000206d0: 7420 7765 2073 6574 2074 6865 2074 6974  t we set the tit
-000206e0: 6c65 206c 696d 6974 2074 6f20 3530 2064  le limit to 50 d
-000206f0: 7565 0a20 2020 2020 2020 2020 2020 2023  ue.            #
-00020700: 2074 6f20 616d 616c 616d 6174 696f 6e2e   to amalamation.
-00020710: 2020 5468 6520 6c6f 7765 7374 2076 616c    The lowest val
-00020720: 7565 2061 6c77 6179 7320 7072 6576 6169  ue always prevai
-00020730: 6c73 0a20 2020 2020 2020 2020 2020 2061  ls.            a
-00020740: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
-00020750: 6765 7428 2774 6974 6c65 2729 2920 3d3d  get('title')) ==
-00020760: 206f 626a 2e62 6f64 795f 6d61 786c 656e   obj.body_maxlen
-00020770: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-00020780: 6572 7420 7469 746c 655b 3a6f 626a 2e62  ert title[:obj.b
-00020790: 6f64 795f 6d61 786c 656e 5d20 3d3d 2063  ody_maxlen] == c
-000207a0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
-000207b0: 290a 0a20 2020 2020 2020 2023 204f 7572  )..        # Our
-000207c0: 2062 6f64 7920 6973 206f 6e6c 7920 6272   body is only br
-000207d0: 6f6b 656e 2075 703b 206e 6f74 206c 6f73  oken up; not los
-000207e0: 740a 2020 2020 2020 2020 5f62 6f64 7920  t.        _body 
-000207f0: 3d20 6368 756e 6b2e 6765 7428 2762 6f64  = chunk.get('bod
-00020800: 7927 290a 0a20 2020 2020 2020 2023 2055  y')..        # U
-00020810: 6e2d 7573 6564 2077 6869 7465 7370 6163  n-used whitespac
-00020820: 6520 6973 2061 6c77 6179 7320 636c 6561  e is always clea
-00020830: 6e65 6420 7570 3b20 6d61 6b65 2073 7572  ned up; make sur
-00020840: 6520 7765 2061 6363 6f75 6e74 2066 6f72  e we account for
-00020850: 0a20 2020 2020 2020 2023 2074 6869 7320  .        # this 
-00020860: 696e 206f 7572 206e 6577 2063 616c 6375  in our new calcu
-00020870: 6c61 7469 6f6e 0a20 2020 2020 2020 2077  lation.        w
-00020880: 735f 6469 6666 203d 206c 656e 2862 6f64  s_diff = len(bod
-00020890: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
-000208a0: 6f64 7929 202b 206f 6666 7365 745d 2920  ody) + offset]) 
-000208b0: 2d20 5c0a 2020 2020 2020 2020 2020 2020  - \.            
-000208c0: 6c65 6e28 626f 6479 5b6f 6666 7365 743a  len(body[offset:
-000208d0: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
-000208e0: 6673 6574 5d0a 2020 2020 2020 2020 2020  fset].          
-000208f0: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
-00020900: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
-00020910: 7472 6970 2829 290a 0a20 2020 2020 2020  trip())..       
-00020920: 2061 7373 6572 7420 626f 6479 5b6f 6666   assert body[off
-00020930: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
-00020940: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
-00020950: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
-00020960: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
-00020970: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
-00020980: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
-00020990: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
-000209a0: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
-000209b0: 6666 290a 0a0a 6465 6620 7465 7374 5f6e  ff)...def test_n
-000209c0: 6f74 6966 795f 6d61 726b 646f 776e 5f67  otify_markdown_g
-000209d0: 656e 6572 616c 2829 3a0a 2020 2020 2222  eneral():.    ""
-000209e0: 220a 2020 2020 4150 493a 204d 6172 6b64  ".    API: Markd
-000209f0: 6f77 6e20 4765 6e65 7261 6c20 5465 7374  own General Test
-00020a00: 696e 670a 0a20 2020 2022 2222 0a0a 2020  ing..    """..  
-00020a10: 2020 230a 2020 2020 2320 4120 6c69 7474    #.    # A litt
-00020a20: 6c65 2070 7265 7061 7261 7469 6f6e 0a20  le preparation. 
-00020a30: 2020 2023 0a0a 2020 2020 230a 2020 2020     #..    #.    
-00020a40: 2320 4669 7273 7420 5465 7374 3a20 5472  # First Test: Tr
-00020a50: 756e 6361 7465 6420 5469 746c 650a 2020  uncated Title.  
-00020a60: 2020 230a 2020 2020 636c 6173 7320 5465    #.    class Te
-00020a70: 7374 4d61 726b 646f 776e 4e6f 7469 6669  stMarkdownNotifi
-00020a80: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
-00020a90: 6529 3a0a 0a20 2020 2020 2020 2023 2046  e):..        # F
-00020aa0: 6f72 6365 206f 7572 2074 6974 6c65 2074  orce our title t
-00020ab0: 6f20 7772 6170 0a20 2020 2020 2020 2074  o wrap.        t
-00020ac0: 6974 6c65 5f6d 6178 6c65 6e20 3d20 300a  itle_maxlen = 0.
-00020ad0: 0a20 2020 2020 2020 2023 2044 6566 6175  .        # Defau
-00020ae0: 6c74 204e 6f74 6966 7920 466f 726d 6174  lt Notify Format
-00020af0: 0a20 2020 2020 2020 206e 6f74 6966 795f  .        notify_
-00020b00: 666f 726d 6174 203d 204e 6f74 6966 7946  format = NotifyF
-00020b10: 6f72 6d61 742e 4d41 524b 444f 574e 0a0a  ormat.MARKDOWN..
-00020b20: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
-00020b30: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
-00020b40: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00020b50: 2020 2020 2020 2020 2073 7570 6572 2829           super()
-00020b60: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
-00020b70: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
-00020b80: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
-00020b90: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00020ba0: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
-00020bb0: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
-00020bc0: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
-00020bd0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00020be0: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
-00020bf0: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
-00020c00: 3d20 5465 7374 4d61 726b 646f 776e 4e6f  = TestMarkdownNo
-00020c10: 7469 6669 6361 7469 6f6e 2829 0a20 2020  tification().   
-00020c20: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
-00020c30: 6f74 204e 6f6e 650a 0a20 2020 2023 2041  ot None..    # A
-00020c40: 2062 6164 2068 6561 6465 720a 2020 2020   bad header.    
-00020c50: 7469 746c 6520 3d20 2220 2320 220a 2020  title = " # ".  
-00020c60: 2020 626f 6479 203d 2022 2a2a 5465 7374    body = "**Test
-00020c70: 2042 6f64 792a 2a22 0a0a 2020 2020 6368   Body**"..    ch
-00020c80: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
-00020c90: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
-00020ca0: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
-00020cb0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00020cc0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00020cd0: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00020ce0: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
-00020cf0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
-00020d00: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
-00020d10: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
-00020d20: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
-00020d30: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
-00020d40: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
-00020d50: 6c65 290a 2020 2020 6173 7365 7274 206c  le).    assert l
-00020d60: 656e 2863 6875 6e6b 7329 203d 3d20 310a  en(chunks) == 1.
-00020d70: 2020 2020 2320 7768 6974 7370 6163 6520      # whitspace 
-00020d80: 6973 2074 7269 6d6d 6564 0a20 2020 2061  is trimmed.    a
-00020d90: 7373 6572 7420 2723 5c72 5c6e 2a2a 5465  ssert '#\r\n**Te
-00020da0: 7374 2042 6f64 792a 2a27 203d 3d20 6368  st Body**' == ch
-00020db0: 756e 6b73 5b30 5d2e 6765 7428 2762 6f64  unks[0].get('bod
-00020dc0: 7927 290a 2020 2020 6173 7365 7274 2063  y').    assert c
-00020dd0: 6875 6e6b 735b 305d 2e67 6574 2827 7469  hunks[0].get('ti
-00020de0: 746c 6527 2920 3d3d 2022 220a 0a20 2020  tle') == ""..   
-00020df0: 2023 2049 6620 7765 206b 6e6f 7720 6f75   # If we know ou
-00020e00: 7220 696e 7075 7420 6973 2074 6578 7420  r input is text 
-00020e10: 686f 7765 7665 722c 2077 6520 7065 7266  however, we perf
-00020e20: 6f72 6d20 6d61 6e69 7075 6c61 7469 6f6e  orm manipulation
-00020e30: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
-00020e40: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
-00020e50: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
-00020e60: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
-00020e70: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
-00020e80: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
-00020e90: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
-00020ea0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
-00020eb0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
-00020ec0: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
-00020ed0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
-00020ee0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
-00020ef0: 6f77 280a 2020 2020 2020 2020 626f 6479  ow(.        body
-00020f00: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
-00020f10: 6c65 2c20 626f 6479 5f66 6f72 6d61 743d  le, body_format=
-00020f20: 4e6f 7469 6679 466f 726d 6174 2e54 4558  NotifyFormat.TEX
-00020f30: 5429 0a20 2020 2061 7373 6572 7420 6c65  T).    assert le
-00020f40: 6e28 6368 756e 6b73 2920 3d3d 2031 0a20  n(chunks) == 1. 
-00020f50: 2020 2023 204f 7572 2074 6974 6c65 2067     # Our title g
-00020f60: 6574 2773 2073 7472 6970 7065 6420 6f66  et's stripped of
-00020f70: 6620 7369 6e63 6520 6974 2773 206e 6f74  f since it's not
-00020f80: 206f 6620 7661 6c69 6420 6d61 726b 646f   of valid markdo
-00020f90: 776e 0a20 2020 2061 7373 6572 7420 626f  wn.    assert bo
-00020fa0: 6479 2e6c 7374 7269 7028 275c 725c 6e5c  dy.lstrip('\r\n\
-00020fb0: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
-00020fc0: 2829 203d 3d20 6368 756e 6b73 5b30 5d2e  () == chunks[0].
-00020fd0: 6765 7428 2762 6f64 7927 290a 2020 2020  get('body').    
-00020fe0: 6173 7365 7274 2063 6875 6e6b 735b 305d  assert chunks[0]
-00020ff0: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
-00021000: 2022 220a 0a0a 406d 6f63 6b2e 7061 7463   ""...@mock.patc
-00021010: 6828 2772 6571 7565 7374 732e 706f 7374  h('requests.post
-00021020: 2729 0a64 6566 2074 6573 745f 6e6f 7469  ').def test_noti
-00021030: 6679 5f65 6d6f 6a69 5f67 656e 6572 616c  fy_emoji_general
-00021040: 286d 6f63 6b5f 706f 7374 293a 0a20 2020  (mock_post):.   
-00021050: 2022 2222 0a20 2020 2041 5049 3a20 456d   """.    API: Em
-00021060: 6f6a 6920 4765 6e65 7261 6c20 5465 7374  oji General Test
-00021070: 696e 670a 0a20 2020 2022 2222 0a0a 2020  ing..    """..  
-00021080: 2020 2320 5072 6570 6172 6520 6f75 7220    # Prepare our 
-00021090: 7265 7370 6f6e 7365 0a20 2020 2072 6573  response.    res
-000210a0: 706f 6e73 6520 3d20 7265 7175 6573 7473  ponse = requests
-000210b0: 2e52 6571 7565 7374 2829 0a20 2020 2072  .Request().    r
-000210c0: 6573 706f 6e73 652e 7374 6174 7573 5f63  esponse.status_c
-000210d0: 6f64 6520 3d20 7265 7175 6573 7473 2e63  ode = requests.c
-000210e0: 6f64 6573 2e6f 6b0a 0a20 2020 2023 2050  odes.ok..    # P
-000210f0: 7265 7061 7265 204d 6f63 6b0a 2020 2020  repare Mock.    
-00021100: 6d6f 636b 5f70 6f73 742e 7265 7475 726e  mock_post.return
-00021110: 5f76 616c 7565 203d 2072 6573 706f 6e73  _value = respons
-00021120: 650a 0a20 2020 2023 2053 6574 2075 7020  e..    # Set up 
-00021130: 6f75 7220 656d 6f6a 6973 0a20 2020 2074  our emojis.    t
-00021140: 6974 6c65 203d 2022 3a73 6d69 6c65 3a22  itle = ":smile:"
-00021150: 0a20 2020 2062 6f64 7920 3d20 223a 6772  .    body = ":gr
-00021160: 696e 3a22 0a0a 2020 2020 2320 6765 6e65  in:"..    # gene
-00021170: 7261 6c20 7265 6665 7265 6e63 6520 7573  ral reference us
-00021180: 6564 2062 656c 6f77 2028 7573 696e 6720  ed below (using 
-00021190: 6465 6661 756c 7420 7661 6c75 6573 290a  default values).
-000211a0: 2020 2020 6173 7365 7420 3d20 4170 7072      asset = Appr
-000211b0: 6973 6541 7373 6574 2829 0a0a 2020 2020  iseAsset()..    
-000211c0: 230a 2020 2020 2320 5465 7374 2064 6566  #.    # Test def
-000211d0: 6175 6c74 2065 6d6f 6a69 2061 7373 6574  ault emoji asset
-000211e0: 2076 616c 7565 0a20 2020 2023 0a0a 2020   value.    #..  
-000211f0: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
-00021200: 6563 740a 2020 2020 6170 5f6f 626a 203d  ect.    ap_obj =
-00021210: 2041 7070 7269 7365 2861 7373 6574 3d61   Apprise(asset=a
-00021220: 7373 6574 290a 2020 2020 6170 5f6f 626a  sset).    ap_obj
-00021230: 2e61 6464 2827 6a73 6f6e 3a2f 2f6c 6f63  .add('json://loc
-00021240: 616c 686f 7374 2729 0a20 2020 2061 7373  alhost').    ass
-00021250: 6572 7420 6c65 6e28 6170 5f6f 626a 2920  ert len(ap_obj) 
-00021260: 3d3d 2031 0a0a 2020 2020 6173 7365 7274  == 1..    assert
-00021270: 2061 705f 6f62 6a2e 6e6f 7469 6679 2874   ap_obj.notify(t
-00021280: 6974 6c65 3d74 6974 6c65 2c20 626f 6479  itle=title, body
-00021290: 3d62 6f64 7929 2069 7320 5472 7565 0a20  =body) is True. 
-000212a0: 2020 2061 7373 6572 7420 6d6f 636b 5f70     assert mock_p
-000212b0: 6f73 742e 6361 6c6c 5f63 6f75 6e74 203d  ost.call_count =
-000212c0: 3d20 310a 0a20 2020 2064 6574 6169 6c73  = 1..    details
-000212d0: 203d 206d 6f63 6b5f 706f 7374 2e63 616c   = mock_post.cal
-000212e0: 6c5f 6172 6773 5f6c 6973 745b 305d 0a20  l_args_list[0]. 
-000212f0: 2020 2064 6174 6173 6574 203d 206a 736f     dataset = jso
-00021300: 6e2e 6c6f 6164 7328 6465 7461 696c 735b  n.loads(details[
-00021310: 315d 5b27 6461 7461 275d 290a 0a20 2020  1]['data'])..   
-00021320: 2023 204e 6f20 6368 616e 6765 730a 2020   # No changes.  
-00021330: 2020 6173 7365 7274 2064 6174 6173 6574    assert dataset
-00021340: 5b27 7469 746c 6527 5d20 3d3d 2074 6974  ['title'] == tit
-00021350: 6c65 0a20 2020 2061 7373 6572 7420 6461  le.    assert da
-00021360: 7461 7365 745b 276d 6573 7361 6765 275d  taset['message']
-00021370: 203d 3d20 626f 6479 0a0a 2020 2020 6d6f   == body..    mo
-00021380: 636b 5f70 6f73 742e 7265 7365 745f 6d6f  ck_post.reset_mo
-00021390: 636b 2829 0a0a 2020 2020 230a 2020 2020  ck()..    #.    
-000213a0: 2320 5465 7374 2055 524c 206f 7665 722d  # Test URL over-
-000213b0: 7269 6465 2077 6869 6c65 2064 6566 6175  ride while defau
-000213c0: 6c74 2076 616c 7565 2073 6574 2069 6e20  lt value set in 
-000213d0: 6173 7365 740a 2020 2020 230a 0a20 2020  asset.    #..   
-000213e0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-000213f0: 6374 0a20 2020 2061 705f 6f62 6a20 3d20  ct.    ap_obj = 
-00021400: 4170 7072 6973 6528 6173 7365 743d 6173  Apprise(asset=as
-00021410: 7365 7429 0a20 2020 2061 705f 6f62 6a2e  set).    ap_obj.
-00021420: 6164 6428 276a 736f 6e3a 2f2f 6c6f 6361  add('json://loca
-00021430: 6c68 6f73 743f 656d 6f6a 6973 3d6e 6f27  lhost?emojis=no'
-00021440: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
-00021450: 2861 705f 6f62 6a29 203d 3d20 310a 0a20  (ap_obj) == 1.. 
-00021460: 2020 2061 7373 6572 7420 6170 5f6f 626a     assert ap_obj
-00021470: 2e6e 6f74 6966 7928 7469 746c 653d 7469  .notify(title=ti
-00021480: 746c 652c 2062 6f64 793d 626f 6479 2920  tle, body=body) 
-00021490: 6973 2054 7275 650a 2020 2020 6173 7365  is True.    asse
-000214a0: 7274 206d 6f63 6b5f 706f 7374 2e63 616c  rt mock_post.cal
-000214b0: 6c5f 636f 756e 7420 3d3d 2031 0a0a 2020  l_count == 1..  
-000214c0: 2020 6465 7461 696c 7320 3d20 6d6f 636b    details = mock
-000214d0: 5f70 6f73 742e 6361 6c6c 5f61 7267 735f  _post.call_args_
-000214e0: 6c69 7374 5b30 5d0a 2020 2020 6461 7461  list[0].    data
-000214f0: 7365 7420 3d20 6a73 6f6e 2e6c 6f61 6473  set = json.loads
-00021500: 2864 6574 6169 6c73 5b31 5d5b 2764 6174  (details[1]['dat
-00021510: 6127 5d29 0a0a 2020 2020 2320 4e6f 2063  a'])..    # No c
-00021520: 6861 6e67 6573 0a20 2020 2061 7373 6572  hanges.    asser
-00021530: 7420 6461 7461 7365 745b 2774 6974 6c65  t dataset['title
-00021540: 275d 203d 3d20 7469 746c 650a 2020 2020  '] == title.    
-00021550: 6173 7365 7274 2064 6174 6173 6574 5b27  assert dataset['
-00021560: 6d65 7373 6167 6527 5d20 3d3d 2062 6f64  message'] == bod
-00021570: 790a 0a20 2020 206d 6f63 6b5f 706f 7374  y..    mock_post
-00021580: 2e72 6573 6574 5f6d 6f63 6b28 290a 0a20  .reset_mock().. 
-00021590: 2020 2023 0a20 2020 2023 2054 6573 7420     #.    # Test 
-000215a0: 5552 4c20 6f76 6572 2d72 6964 6520 7768  URL over-ride wh
-000215b0: 696c 6520 6465 6661 756c 7420 7661 6c75  ile default valu
-000215c0: 6520 7365 7420 696e 2061 7373 6574 2070  e set in asset p
-000215d0: 7420 320a 2020 2020 230a 0a20 2020 2023  t 2.    #..    #
-000215e0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
-000215f0: 0a20 2020 2061 705f 6f62 6a20 3d20 4170  .    ap_obj = Ap
-00021600: 7072 6973 6528 6173 7365 743d 6173 7365  prise(asset=asse
-00021610: 7429 0a20 2020 2061 705f 6f62 6a2e 6164  t).    ap_obj.ad
-00021620: 6428 276a 736f 6e3a 2f2f 6c6f 6361 6c68  d('json://localh
-00021630: 6f73 743f 656d 6f6a 6973 3d79 6573 2729  ost?emojis=yes')
-00021640: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00021650: 6170 5f6f 626a 2920 3d3d 2031 0a0a 2020  ap_obj) == 1..  
-00021660: 2020 6173 7365 7274 2061 705f 6f62 6a2e    assert ap_obj.
-00021670: 6e6f 7469 6679 2874 6974 6c65 3d74 6974  notify(title=tit
-00021680: 6c65 2c20 626f 6479 3d62 6f64 7929 2069  le, body=body) i
-00021690: 7320 5472 7565 0a20 2020 2061 7373 6572  s True.    asser
-000216a0: 7420 6d6f 636b 5f70 6f73 742e 6361 6c6c  t mock_post.call
-000216b0: 5f63 6f75 6e74 203d 3d20 310a 0a20 2020  _count == 1..   
-000216c0: 2064 6574 6169 6c73 203d 206d 6f63 6b5f   details = mock_
-000216d0: 706f 7374 2e63 616c 6c5f 6172 6773 5f6c  post.call_args_l
-000216e0: 6973 745b 305d 0a20 2020 2064 6174 6173  ist[0].    datas
-000216f0: 6574 203d 206a 736f 6e2e 6c6f 6164 7328  et = json.loads(
-00021700: 6465 7461 696c 735b 315d 5b27 6461 7461  details[1]['data
-00021710: 275d 290a 0a20 2020 2023 2045 6d6f 6a69  '])..    # Emoji
-00021720: 2773 2061 7265 2064 6973 706c 6179 6564  's are displayed
-00021730: 0a20 2020 2061 7373 6572 7420 6461 7461  .    assert data
-00021740: 7365 745b 2774 6974 6c65 275d 203d 3d20  set['title'] == 
-00021750: 27f0 9f98 8427 0a20 2020 2061 7373 6572  '....'.    asser
-00021760: 7420 6461 7461 7365 745b 276d 6573 7361  t dataset['messa
-00021770: 6765 275d 203d 3d20 27f0 9f98 8327 0a0a  ge'] == '....'..
-00021780: 2020 2020 6d6f 636b 5f70 6f73 742e 7265      mock_post.re
-00021790: 7365 745f 6d6f 636b 2829 0a0a 2020 2020  set_mock()..    
-000217a0: 230a 2020 2020 2320 5465 7374 2055 524c  #.    # Test URL
-000217b0: 206f 7665 722d 7269 6465 2077 6869 6c65   over-ride while
-000217c0: 2064 6566 6175 6c74 2076 616c 7565 2073   default value s
-000217d0: 6574 2069 6e20 6173 7365 7420 7074 2032  et in asset pt 2
-000217e0: 0a20 2020 2023 0a0a 2020 2020 2320 4c6f  .    #..    # Lo
-000217f0: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
-00021800: 2020 6170 5f6f 626a 203d 2041 7070 7269    ap_obj = Appri
-00021810: 7365 2861 7373 6574 3d61 7373 6574 290a  se(asset=asset).
-00021820: 2020 2020 6170 5f6f 626a 2e61 6464 2827      ap_obj.add('
-00021830: 6a73 6f6e 3a2f 2f6c 6f63 616c 686f 7374  json://localhost
-00021840: 3f65 6d6f 6a69 733d 6e6f 2729 0a20 2020  ?emojis=no').   
-00021850: 2061 7373 6572 7420 6c65 6e28 6170 5f6f   assert len(ap_o
-00021860: 626a 2920 3d3d 2031 0a0a 2020 2020 6173  bj) == 1..    as
-00021870: 7365 7274 2061 705f 6f62 6a2e 6e6f 7469  sert ap_obj.noti
-00021880: 6679 2874 6974 6c65 3d74 6974 6c65 2c20  fy(title=title, 
-00021890: 626f 6479 3d62 6f64 7929 2069 7320 5472  body=body) is Tr
-000218a0: 7565 0a20 2020 2061 7373 6572 7420 6d6f  ue.    assert mo
-000218b0: 636b 5f70 6f73 742e 6361 6c6c 5f63 6f75  ck_post.call_cou
-000218c0: 6e74 203d 3d20 310a 0a20 2020 2064 6574  nt == 1..    det
-000218d0: 6169 6c73 203d 206d 6f63 6b5f 706f 7374  ails = mock_post
-000218e0: 2e63 616c 6c5f 6172 6773 5f6c 6973 745b  .call_args_list[
-000218f0: 305d 0a20 2020 2064 6174 6173 6574 203d  0].    dataset =
-00021900: 206a 736f 6e2e 6c6f 6164 7328 6465 7461   json.loads(deta
-00021910: 696c 735b 315d 5b27 6461 7461 275d 290a  ils[1]['data']).
-00021920: 0a20 2020 2023 204e 6f20 6368 616e 6765  .    # No change
-00021930: 730a 2020 2020 6173 7365 7274 2064 6174  s.    assert dat
-00021940: 6173 6574 5b27 7469 746c 6527 5d20 3d3d  aset['title'] ==
-00021950: 2074 6974 6c65 0a20 2020 2061 7373 6572   title.    asser
-00021960: 7420 6461 7461 7365 745b 276d 6573 7361  t dataset['messa
-00021970: 6765 275d 203d 3d20 626f 6479 0a0a 2020  ge'] == body..  
-00021980: 2020 6d6f 636b 5f70 6f73 742e 7265 7365    mock_post.rese
-00021990: 745f 6d6f 636b 2829 0a0a 2020 2020 230a  t_mock()..    #.
-000219a0: 2020 2020 2320 5465 7374 2044 6566 6175      # Test Defau
-000219b0: 6c74 2045 6d6f 6a69 2073 6574 7469 6e67  lt Emoji setting
-000219c0: 730a 2020 2020 230a 0a20 2020 2023 2053  s.    #..    # S
-000219d0: 6574 206f 7572 2069 6e74 6572 7072 6574  et our interpret
-000219e0: 2065 6d6f 6a69 2773 2066 6c61 670a 2020   emoji's flag.  
-000219f0: 2020 6173 7365 7420 3d20 4170 7072 6973    asset = Appris
-00021a00: 6541 7373 6574 2869 6e74 6572 7072 6574  eAsset(interpret
-00021a10: 5f65 6d6f 6a69 733d 5472 7565 290a 0a20  _emojis=True).. 
-00021a20: 2020 2023 2052 652d 6372 6561 7465 206f     # Re-create o
-00021a30: 7572 206f 626a 6563 740a 2020 2020 6170  ur object.    ap
-00021a40: 5f6f 626a 203d 2041 7070 7269 7365 2861  _obj = Apprise(a
-00021a50: 7373 6574 3d61 7373 6574 290a 0a20 2020  sset=asset)..   
-00021a60: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
-00021a70: 6374 0a20 2020 2061 705f 6f62 6a2e 6164  ct.    ap_obj.ad
-00021a80: 6428 276a 736f 6e3a 2f2f 6c6f 6361 6c68  d('json://localh
-00021a90: 6f73 7427 290a 2020 2020 6173 7365 7274  ost').    assert
-00021aa0: 206c 656e 2861 705f 6f62 6a29 203d 3d20   len(ap_obj) == 
-00021ab0: 310a 0a20 2020 2061 7373 6572 7420 6170  1..    assert ap
-00021ac0: 5f6f 626a 2e6e 6f74 6966 7928 7469 746c  _obj.notify(titl
-00021ad0: 653d 7469 746c 652c 2062 6f64 793d 626f  e=title, body=bo
-00021ae0: 6479 2920 6973 2054 7275 650a 2020 2020  dy) is True.    
-00021af0: 6173 7365 7274 206d 6f63 6b5f 706f 7374  assert mock_post
-00021b00: 2e63 616c 6c5f 636f 756e 7420 3d3d 2031  .call_count == 1
-00021b10: 0a0a 2020 2020 6465 7461 696c 7320 3d20  ..    details = 
-00021b20: 6d6f 636b 5f70 6f73 742e 6361 6c6c 5f61  mock_post.call_a
-00021b30: 7267 735f 6c69 7374 5b30 5d0a 2020 2020  rgs_list[0].    
-00021b40: 6461 7461 7365 7420 3d20 6a73 6f6e 2e6c  dataset = json.l
-00021b50: 6f61 6473 2864 6574 6169 6c73 5b31 5d5b  oads(details[1][
-00021b60: 2764 6174 6127 5d29 0a0a 2020 2020 2320  'data'])..    # 
-00021b70: 656d 6f6a 6927 7320 6172 6520 6469 7370  emoji's are disp
-00021b80: 6c61 7965 640a 2020 2020 6173 7365 7274  layed.    assert
-00021b90: 2064 6174 6173 6574 5b27 7469 746c 6527   dataset['title'
-00021ba0: 5d20 3d3d 2027 f09f 9884 270a 2020 2020  ] == '....'.    
-00021bb0: 6173 7365 7274 2064 6174 6173 6574 5b27  assert dataset['
-00021bc0: 6d65 7373 6167 6527 5d20 3d3d 2027 f09f  message'] == '..
-00021bd0: 9883 270a 0a20 2020 206d 6f63 6b5f 706f  ..'..    mock_po
-00021be0: 7374 2e72 6573 6574 5f6d 6f63 6b28 290a  st.reset_mock().
-00021bf0: 0a20 2020 2023 0a20 2020 2023 2057 6974  .    #.    # Wit
-00021c00: 6820 456d 6f6a 6927 7320 7475 726e 6564  h Emoji's turned
-00021c10: 206f 6e20 6279 2064 6566 6175 6c74 2c20   on by default, 
-00021c20: 7468 6520 7573 6572 2063 616e 206f 7074  the user can opt
-00021c30: 696f 6e61 6c6c 7920 7475 726e 2074 6865  ionally turn the
-00021c40: 6d0a 2020 2020 2320 6f66 662e 0a20 2020  m.    # off..   
-00021c50: 2023 0a0a 2020 2020 2320 5265 2d63 7265   #..    # Re-cre
-00021c60: 6174 6520 6f75 7220 6f62 6a65 6374 0a20  ate our object. 
-00021c70: 2020 2061 705f 6f62 6a20 3d20 4170 7072     ap_obj = Appr
-00021c80: 6973 6528 6173 7365 743d 6173 7365 7429  ise(asset=asset)
-00021c90: 0a0a 2020 2020 6170 5f6f 626a 2e61 6464  ..    ap_obj.add
-00021ca0: 2827 6a73 6f6e 3a2f 2f6c 6f63 616c 686f  ('json://localho
-00021cb0: 7374 3f65 6d6f 6a69 733d 6e6f 2729 0a20  st?emojis=no'). 
-00021cc0: 2020 2061 7373 6572 7420 6c65 6e28 6170     assert len(ap
-00021cd0: 5f6f 626a 2920 3d3d 2031 0a0a 2020 2020  _obj) == 1..    
-00021ce0: 6173 7365 7274 2061 705f 6f62 6a2e 6e6f  assert ap_obj.no
-00021cf0: 7469 6679 2874 6974 6c65 3d74 6974 6c65  tify(title=title
-00021d00: 2c20 626f 6479 3d62 6f64 7929 2069 7320  , body=body) is 
-00021d10: 5472 7565 0a20 2020 2061 7373 6572 7420  True.    assert 
-00021d20: 6d6f 636b 5f70 6f73 742e 6361 6c6c 5f63  mock_post.call_c
-00021d30: 6f75 6e74 203d 3d20 310a 0a20 2020 2064  ount == 1..    d
-00021d40: 6574 6169 6c73 203d 206d 6f63 6b5f 706f  etails = mock_po
-00021d50: 7374 2e63 616c 6c5f 6172 6773 5f6c 6973  st.call_args_lis
-00021d60: 745b 305d 0a20 2020 2064 6174 6173 6574  t[0].    dataset
-00021d70: 203d 206a 736f 6e2e 6c6f 6164 7328 6465   = json.loads(de
-00021d80: 7461 696c 735b 315d 5b27 6461 7461 275d  tails[1]['data']
-00021d90: 290a 0a20 2020 2023 204e 6f20 6368 616e  )..    # No chan
-00021da0: 6765 730a 2020 2020 6173 7365 7274 2064  ges.    assert d
-00021db0: 6174 6173 6574 5b27 7469 746c 6527 5d20  ataset['title'] 
-00021dc0: 3d3d 2074 6974 6c65 0a20 2020 2061 7373  == title.    ass
-00021dd0: 6572 7420 6461 7461 7365 745b 276d 6573  ert dataset['mes
-00021de0: 7361 6765 275d 203d 3d20 626f 6479 0a0a  sage'] == body..
-00021df0: 2020 2020 6d6f 636b 5f70 6f73 742e 7265      mock_post.re
-00021e00: 7365 745f 6d6f 636b 2829 0a0a 2020 2020  set_mock()..    
-00021e10: 230a 2020 2020 2320 5769 7468 2045 6d6f  #.    # With Emo
-00021e20: 6a69 2773 2074 7572 6e65 6420 6f6e 2062  ji's turned on b
-00021e30: 7920 6465 6661 756c 742c 2074 6865 7265  y default, there
-00021e40: 2069 7320 6e6f 2063 6861 6e67 6520 7768   is no change wh
-00021e50: 656e 2065 6d6f 6a69 730a 2020 2020 2320  en emojis.    # 
-00021e60: 666c 6167 2069 7320 7365 7420 746f 206f  flag is set to o
-00021e70: 6e0a 2020 2020 230a 0a20 2020 2023 2052  n.    #..    # R
-00021e80: 652d 6372 6561 7465 206f 7572 206f 626a  e-create our obj
-00021e90: 6563 740a 2020 2020 6170 5f6f 626a 203d  ect.    ap_obj =
-00021ea0: 2041 7070 7269 7365 2861 7373 6574 3d61   Apprise(asset=a
-00021eb0: 7373 6574 290a 0a20 2020 2061 705f 6f62  sset)..    ap_ob
-00021ec0: 6a2e 6164 6428 276a 736f 6e3a 2f2f 6c6f  j.add('json://lo
-00021ed0: 6361 6c68 6f73 743f 656d 6f6a 6973 3d79  calhost?emojis=y
-00021ee0: 6573 2729 0a20 2020 2061 7373 6572 7420  es').    assert 
-00021ef0: 6c65 6e28 6170 5f6f 626a 2920 3d3d 2031  len(ap_obj) == 1
-00021f00: 0a0a 2020 2020 6173 7365 7274 2061 705f  ..    assert ap_
-00021f10: 6f62 6a2e 6e6f 7469 6679 2874 6974 6c65  obj.notify(title
-00021f20: 3d74 6974 6c65 2c20 626f 6479 3d62 6f64  =title, body=bod
-00021f30: 7929 2069 7320 5472 7565 0a20 2020 2061  y) is True.    a
-00021f40: 7373 6572 7420 6d6f 636b 5f70 6f73 742e  ssert mock_post.
-00021f50: 6361 6c6c 5f63 6f75 6e74 203d 3d20 310a  call_count == 1.
-00021f60: 0a20 2020 2064 6574 6169 6c73 203d 206d  .    details = m
-00021f70: 6f63 6b5f 706f 7374 2e63 616c 6c5f 6172  ock_post.call_ar
-00021f80: 6773 5f6c 6973 745b 305d 0a20 2020 2064  gs_list[0].    d
-00021f90: 6174 6173 6574 203d 206a 736f 6e2e 6c6f  ataset = json.lo
-00021fa0: 6164 7328 6465 7461 696c 735b 315d 5b27  ads(details[1]['
-00021fb0: 6461 7461 275d 290a 0a20 2020 2023 2065  data'])..    # e
-00021fc0: 6d6f 6a69 2773 2061 7265 2064 6973 706c  moji's are displ
-00021fd0: 6179 6564 0a20 2020 2061 7373 6572 7420  ayed.    assert 
-00021fe0: 6461 7461 7365 745b 2774 6974 6c65 275d  dataset['title']
-00021ff0: 203d 3d20 27f0 9f98 8427 0a20 2020 2061   == '....'.    a
-00022000: 7373 6572 7420 6461 7461 7365 745b 276d  ssert dataset['m
-00022010: 6573 7361 6765 275d 203d 3d20 27f0 9f98  essage'] == '...
-00022020: 8327 0a0a 2020 2020 6d6f 636b 5f70 6f73  .'..    mock_pos
-00022030: 742e 7265 7365 745f 6d6f 636b 2829 0a0a  t.reset_mock()..
-00022040: 2020 2020 230a 2020 2020 2320 456e 666f      #.    # Enfo
-00022050: 7263 6520 7468 6520 6469 7361 626c 696e  rce the disablin
-00022060: 6720 6f66 2065 6d6f 6a69 730a 2020 2020  g of emojis.    
-00022070: 230a 0a20 2020 2023 2053 6574 206f 7572  #..    # Set our
-00022080: 2069 6e74 6572 7072 6574 2065 6d6f 6a69   interpret emoji
-00022090: 2773 2066 6c61 670a 2020 2020 6173 7365  's flag.    asse
-000220a0: 7420 3d20 4170 7072 6973 6541 7373 6574  t = AppriseAsset
-000220b0: 2869 6e74 6572 7072 6574 5f65 6d6f 6a69  (interpret_emoji
-000220c0: 733d 4661 6c73 6529 0a0a 2020 2020 2320  s=False)..    # 
-000220d0: 5265 2d63 7265 6174 6520 6f75 7220 6f62  Re-create our ob
-000220e0: 6a65 6374 0a20 2020 2061 705f 6f62 6a20  ject.    ap_obj 
-000220f0: 3d20 4170 7072 6973 6528 6173 7365 743d  = Apprise(asset=
-00022100: 6173 7365 7429 0a0a 2020 2020 2320 4c6f  asset)..    # Lo
-00022110: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
-00022120: 2020 6170 5f6f 626a 2e61 6464 2827 6a73    ap_obj.add('js
-00022130: 6f6e 3a2f 2f6c 6f63 616c 686f 7374 2729  on://localhost')
-00022140: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-00022150: 6170 5f6f 626a 2920 3d3d 2031 0a0a 2020  ap_obj) == 1..  
-00022160: 2020 6173 7365 7274 2061 705f 6f62 6a2e    assert ap_obj.
-00022170: 6e6f 7469 6679 2874 6974 6c65 3d74 6974  notify(title=tit
-00022180: 6c65 2c20 626f 6479 3d62 6f64 7929 2069  le, body=body) i
-00022190: 7320 5472 7565 0a20 2020 2061 7373 6572  s True.    asser
-000221a0: 7420 6d6f 636b 5f70 6f73 742e 6361 6c6c  t mock_post.call
-000221b0: 5f63 6f75 6e74 203d 3d20 310a 0a20 2020  _count == 1..   
-000221c0: 2064 6574 6169 6c73 203d 206d 6f63 6b5f   details = mock_
-000221d0: 706f 7374 2e63 616c 6c5f 6172 6773 5f6c  post.call_args_l
-000221e0: 6973 745b 305d 0a20 2020 2064 6174 6173  ist[0].    datas
-000221f0: 6574 203d 206a 736f 6e2e 6c6f 6164 7328  et = json.loads(
-00022200: 6465 7461 696c 735b 315d 5b27 6461 7461  details[1]['data
-00022210: 275d 290a 0a20 2020 2023 2044 6973 6162  '])..    # Disab
-00022220: 6c65 6420 2d20 6e6f 2065 6d6f 6a69 730a  led - no emojis.
-00022230: 2020 2020 6173 7365 7274 2064 6174 6173      assert datas
-00022240: 6574 5b27 7469 746c 6527 5d20 3d3d 2074  et['title'] == t
-00022250: 6974 6c65 0a20 2020 2061 7373 6572 7420  itle.    assert 
-00022260: 6461 7461 7365 745b 276d 6573 7361 6765  dataset['message
-00022270: 275d 203d 3d20 626f 6479 0a0a 2020 2020  '] == body..    
-00022280: 6d6f 636b 5f70 6f73 742e 7265 7365 745f  mock_post.reset_
-00022290: 6d6f 636b 2829 0a0a 2020 2020 230a 2020  mock()..    #.  
-000222a0: 2020 2320 456e 666f 7263 6520 7468 6520    # Enforce the 
-000222b0: 6469 7361 626c 696e 6720 6f66 2065 6d6f  disabling of emo
-000222c0: 6a69 730a 2020 2020 230a 0a20 2020 2023  jis.    #..    #
-000222d0: 2053 6574 206f 7572 2069 6e74 6572 7072   Set our interpr
-000222e0: 6574 2065 6d6f 6a69 2773 2066 6c61 670a  et emoji's flag.
-000222f0: 2020 2020 6173 7365 7420 3d20 4170 7072      asset = Appr
-00022300: 6973 6541 7373 6574 2869 6e74 6572 7072  iseAsset(interpr
-00022310: 6574 5f65 6d6f 6a69 733d 4661 6c73 6529  et_emojis=False)
-00022320: 0a0a 2020 2020 2320 5265 2d63 7265 6174  ..    # Re-creat
-00022330: 6520 6f75 7220 6f62 6a65 6374 0a20 2020  e our object.   
-00022340: 2061 705f 6f62 6a20 3d20 4170 7072 6973   ap_obj = Appris
-00022350: 6528 6173 7365 743d 6173 7365 7429 0a0a  e(asset=asset)..
-00022360: 2020 2020 2320 4c6f 6164 206f 7572 206f      # Load our o
-00022370: 626a 6563 740a 2020 2020 6170 5f6f 626a  bject.    ap_obj
-00022380: 2e61 6464 2827 6a73 6f6e 3a2f 2f6c 6f63  .add('json://loc
-00022390: 616c 686f 7374 3f65 6d6f 6a69 733d 7965  alhost?emojis=ye
-000223a0: 7327 290a 2020 2020 6173 7365 7274 206c  s').    assert l
-000223b0: 656e 2861 705f 6f62 6a29 203d 3d20 310a  en(ap_obj) == 1.
-000223c0: 0a20 2020 2061 7373 6572 7420 6170 5f6f  .    assert ap_o
-000223d0: 626a 2e6e 6f74 6966 7928 7469 746c 653d  bj.notify(title=
-000223e0: 7469 746c 652c 2062 6f64 793d 626f 6479  title, body=body
-000223f0: 2920 6973 2054 7275 650a 2020 2020 6173  ) is True.    as
-00022400: 7365 7274 206d 6f63 6b5f 706f 7374 2e63  sert mock_post.c
-00022410: 616c 6c5f 636f 756e 7420 3d3d 2031 0a0a  all_count == 1..
-00022420: 2020 2020 6465 7461 696c 7320 3d20 6d6f      details = mo
-00022430: 636b 5f70 6f73 742e 6361 6c6c 5f61 7267  ck_post.call_arg
-00022440: 735f 6c69 7374 5b30 5d0a 2020 2020 6461  s_list[0].    da
-00022450: 7461 7365 7420 3d20 6a73 6f6e 2e6c 6f61  taset = json.loa
-00022460: 6473 2864 6574 6169 6c73 5b31 5d5b 2764  ds(details[1]['d
-00022470: 6174 6127 5d29 0a0a 2020 2020 2320 4469  ata'])..    # Di
-00022480: 7361 626c 6564 202d 206e 6f20 656d 6f6a  sabled - no emoj
-00022490: 6973 0a20 2020 2061 7373 6572 7420 6461  is.    assert da
-000224a0: 7461 7365 745b 2774 6974 6c65 275d 203d  taset['title'] =
-000224b0: 3d20 7469 746c 650a 2020 2020 6173 7365  = title.    asse
-000224c0: 7274 2064 6174 6173 6574 5b27 6d65 7373  rt dataset['mess
-000224d0: 6167 6527 5d20 3d3d 2062 6f64 790a 0a20  age'] == body.. 
-000224e0: 2020 206d 6f63 6b5f 706f 7374 2e72 6573     mock_post.res
-000224f0: 6574 5f6d 6f63 6b28 290a                 et_mock().
+00000670: 7070 7269 7365 2069 6d70 6f72 7420 4e6f  pprise import No
+00000680: 7469 6679 466f 726d 6174 0a66 726f 6d20  tifyFormat.from 
+00000690: 6170 7072 6973 6520 696d 706f 7274 204f  apprise import O
+000006a0: 7665 7266 6c6f 774d 6f64 650a 6672 6f6d  verflowMode.from
+000006b0: 2061 7070 7269 7365 2069 6d70 6f72 7420   apprise import 
+000006c0: 4170 7072 6973 6541 7373 6574 0a66 726f  AppriseAsset.fro
+000006d0: 6d20 6170 7072 6973 6520 696d 706f 7274  m apprise import
+000006e0: 2041 7070 7269 7365 0a0a 2320 4469 7361   Apprise..# Disa
+000006f0: 626c 6520 6c6f 6767 696e 6720 666f 7220  ble logging for 
+00000700: 6120 636c 6561 6e65 7220 7465 7374 696e  a cleaner testin
+00000710: 6720 6f75 7470 7574 0a69 6d70 6f72 7420  g output.import 
+00000720: 6c6f 6767 696e 670a 6c6f 6767 696e 672e  logging.logging.
+00000730: 6469 7361 626c 6528 6c6f 6767 696e 672e  disable(logging.
+00000740: 4352 4954 4943 414c 290a 0a0a 6465 6620  CRITICAL)...def 
+00000750: 7465 7374 5f6e 6f74 6966 795f 6f76 6572  test_notify_over
+00000760: 666c 6f77 5f74 7275 6e63 6174 655f 7769  flow_truncate_wi
+00000770: 7468 5f61 6d61 6c67 616d 6174 696f 6e28  th_amalgamation(
+00000780: 293a 0a20 2020 2022 2222 0a20 2020 2041  ):.    """.    A
+00000790: 5049 3a20 4f76 6572 666c 6f77 2057 6974  PI: Overflow Wit
+000007a0: 6820 416d 616c 6761 6d61 7469 6f6e 2054  h Amalgamation T
+000007b0: 7275 6e63 6174 6520 4675 6e63 7469 6f6e  runcate Function
+000007c0: 616c 6974 7920 5465 7374 696e 670a 0a20  ality Testing.. 
+000007d0: 2020 2022 2222 0a20 2020 2023 0a20 2020     """.    #.   
+000007e0: 2023 2041 206c 6974 746c 6520 7072 6570   # A little prep
+000007f0: 6172 6174 696f 6e0a 2020 2020 230a 0a20  aration.    #.. 
+00000800: 2020 2023 204e 756d 6265 7220 6f66 2063     # Number of c
+00000810: 6861 7261 6374 6572 7320 7065 7220 6c69  haracters per li
+00000820: 6e65 0a20 2020 2072 6f77 203d 2032 340a  ne.    row = 24.
+00000830: 0a20 2020 2023 2053 6f6d 6520 7661 7269  .    # Some vari
+00000840: 6162 6c65 7320 7765 2075 7365 2074 6f20  ables we use to 
+00000850: 636f 6e74 726f 6c20 7468 6520 6461 7461  control the data
+00000860: 2077 6520 776f 726b 2077 6974 680a 2020   we work with.  
+00000870: 2020 626f 6479 5f6c 656e 203d 2031 3032    body_len = 102
+00000880: 340a 2020 2020 7469 746c 655f 6c65 6e20  4.    title_len 
+00000890: 3d20 3130 3234 0a0a 2020 2020 2320 4372  = 1024..    # Cr
+000008a0: 6561 7465 2061 206c 6172 6765 2062 6f64  eate a large bod
+000008b0: 7920 616e 6420 7469 746c 6520 7769 7468  y and title with
+000008c0: 2072 616e 646f 6d20 6461 7461 0a20 2020   random data.   
+000008d0: 2062 6f64 7920 3d20 2727 2e6a 6f69 6e28   body = ''.join(
+000008e0: 6368 6f69 6365 2873 7472 5f61 6c70 6861  choice(str_alpha
+000008f0: 202b 2073 7472 5f6e 756d 202b 2027 2027   + str_num + ' '
+00000900: 2920 666f 7220 5f20 696e 2072 616e 6765  ) for _ in range
+00000910: 2862 6f64 795f 6c65 6e29 290a 2020 2020  (body_len)).    
+00000920: 626f 6479 203d 2027 5c72 5c6e 272e 6a6f  body = '\r\n'.jo
+00000930: 696e 285b 626f 6479 5b69 3a20 6920 2b20  in([body[i: i + 
+00000940: 726f 775d 2066 6f72 2069 2069 6e20 7261  row] for i in ra
+00000950: 6e67 6528 302c 206c 656e 2862 6f64 7929  nge(0, len(body)
+00000960: 2c20 726f 7729 5d29 0a0a 2020 2020 2320  , row)])..    # 
+00000970: 7468 6520 6e65 7720 6c69 6e65 7320 6164  the new lines ad
+00000980: 6420 6120 6c61 7267 6520 616d 6f75 6e74  d a large amount
+00000990: 2074 6f20 6f75 7220 626f 6479 3b20 6c65   to our body; le
+000009a0: 7473 2066 6f72 6365 2074 6865 2063 6f6e  ts force the con
+000009b0: 7465 6e74 0a20 2020 2023 2062 6163 6b20  tent.    # back 
+000009c0: 746f 2062 6569 6e67 2031 3032 3420 6368  to being 1024 ch
+000009d0: 6172 6163 7465 7273 2e0a 2020 2020 626f  aracters..    bo
+000009e0: 6479 203d 2062 6f64 795b 303a 3130 3234  dy = body[0:1024
+000009f0: 5d0a 0a20 2020 2023 2043 7265 6174 6520  ]..    # Create 
+00000a00: 6f75 7220 7469 746c 6520 7573 696e 6720  our title using 
+00000a10: 7261 6e64 6f6d 2064 6174 610a 2020 2020  random data.    
+00000a20: 7469 746c 6520 3d20 2727 2e6a 6f69 6e28  title = ''.join(
+00000a30: 6368 6f69 6365 2873 7472 5f61 6c70 6861  choice(str_alpha
+00000a40: 202b 2073 7472 5f6e 756d 2920 666f 7220   + str_num) for 
+00000a50: 5f20 696e 2072 616e 6765 2874 6974 6c65  _ in range(title
+00000a60: 5f6c 656e 2929 0a0a 2020 2020 230a 2020  _len))..    #.  
+00000a70: 2020 2320 4669 7273 7420 5465 7374 3a20    # First Test: 
+00000a80: 5472 756e 6361 7465 6420 5469 746c 650a  Truncated Title.
+00000a90: 2020 2020 230a 2020 2020 636c 6173 7320      #.    class 
+00000aa0: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+00000ab0: 284e 6f74 6966 7942 6173 6529 3a0a 0a20  (NotifyBase):.. 
+00000ac0: 2020 2020 2020 2023 2054 6573 7420 7469         # Test ti
+00000ad0: 746c 6520 6d61 7820 6c65 6e67 7468 0a20  tle max length. 
+00000ae0: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
+00000af0: 6c65 6e20 3d20 3130 0a0a 2020 2020 2020  len = 10..      
+00000b00: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
+00000b10: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
+00000b20: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
+00000b30: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
+00000b40: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
+00000b50: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
+00000b60: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00000b70: 2020 2020 2020 2020 2073 7570 6572 2829           super()
+00000b80: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
+00000b90: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
+00000ba0: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
+00000bb0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00000bc0: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
+00000bd0: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
+00000be0: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
+00000bf0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00000c00: 0a0a 2020 2020 2320 5765 2073 686f 756c  ..    # We shoul
+00000c10: 6420 7468 726f 7720 616e 2065 7863 6570  d throw an excep
+00000c20: 7469 6f6e 2062 6563 6175 7365 206f 7572  tion because our
+00000c30: 2073 7065 6369 6669 6564 206f 7665 7266   specified overf
+00000c40: 6c6f 7720 6973 2077 726f 6e67 2e0a 2020  low is wrong..  
+00000c50: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00000c60: 6973 6573 2854 7970 6545 7272 6f72 293a  ises(TypeError):
+00000c70: 0a20 2020 2020 2020 2023 204c 6f61 6420  .        # Load 
+00000c80: 6f75 7220 6f62 6a65 6374 0a20 2020 2020  our object.     
+00000c90: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
+00000ca0: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
+00000cb0: 6f77 3d27 696e 7661 6c69 6427 290a 0a20  ow='invalid').. 
+00000cc0: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
+00000cd0: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
+00000ce0: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00000cf0: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
+00000d00: 774d 6f64 652e 5452 554e 4341 5445 290a  wMode.TRUNCATE).
+00000d10: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
+00000d20: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
+00000d30: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
+00000d40: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
+00000d50: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
+00000d60: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
+00000d70: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
+00000d80: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
+00000d90: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
+00000da0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00000db0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00000dc0: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
+00000dd0: 652c 206f 7665 7266 6c6f 773d 4e6f 6e65  e, overflow=None
+00000de0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00000df0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00000e00: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+00000e10: 653d 2222 2c20 6f76 6572 666c 6f77 3d4e  e="", overflow=N
+00000e20: 6f6e 6529 0a20 2020 2063 6875 6e6b 7320  one).    chunks 
+00000e30: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00000e40: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+00000e50: 2074 6974 6c65 3d22 222c 206f 7665 7266   title="", overf
+00000e60: 6c6f 773d 4e6f 6e65 290a 2020 2020 6368  low=None).    ch
+00000e70: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00000e80: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00000e90: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+00000ea0: 652c 206f 7665 7266 6c6f 773d 4e6f 6e65  e, overflow=None
+00000eb0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00000ec0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00000ed0: 6f77 280a 2020 2020 2020 2020 626f 6479  ow(.        body
+00000ee0: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
+00000ef0: 6c65 2c20 6f76 6572 666c 6f77 3d4f 7665  le, overflow=Ove
+00000f00: 7266 6c6f 774d 6f64 652e 5350 4c49 5429  rflowMode.SPLIT)
+00000f10: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+00000f20: 6368 756e 6b73 2920 3d3d 2031 0a20 2020  chunks) == 1.   
+00000f30: 2061 7373 6572 7420 626f 6479 2e6c 7374   assert body.lst
+00000f40: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+00000f50: 6327 292e 7273 7472 6970 2829 203d 3d20  c').rstrip() == 
+00000f60: 6368 756e 6b73 5b30 5d2e 6765 7428 2762  chunks[0].get('b
+00000f70: 6f64 7927 290a 2020 2020 6173 7365 7274  ody').    assert
+00000f80: 2074 6974 6c65 5b30 3a6f 626a 2e74 6974   title[0:obj.tit
+00000f90: 6c65 5f6d 6178 6c65 6e5d 203d 3d20 6368  le_maxlen] == ch
+00000fa0: 756e 6b73 5b30 5d2e 6765 7428 2774 6974  unks[0].get('tit
+00000fb0: 6c65 2729 0a0a 2020 2020 230a 2020 2020  le')..    #.    
+00000fc0: 2320 4e65 7874 2054 6573 743a 204c 696e  # Next Test: Lin
+00000fd0: 6520 436f 756e 7420 436f 6e74 726f 6c0a  e Count Control.
+00000fe0: 2020 2020 230a 0a20 2020 2063 6c61 7373      #..    class
+00000ff0: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+00001000: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
+00001010: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
+00001020: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
+00001030: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
+00001040: 786c 656e 203d 2035 0a0a 2020 2020 2020  xlen = 5..      
+00001050: 2020 2320 4d61 7869 6d75 6d20 6e75 6d62    # Maximum numb
+00001060: 6572 206f 6620 6c69 6e65 730a 2020 2020  er of lines.    
+00001070: 2020 2020 626f 6479 5f6d 6178 5f6c 696e      body_max_lin
+00001080: 655f 636f 756e 7420 3d20 350a 0a20 2020  e_count = 5..   
+00001090: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
+000010a0: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
+000010b0: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
+000010c0: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
+000010d0: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
+000010e0: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
+000010f0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00001100: 2020 2020 2020 2020 2020 2020 7375 7065              supe
+00001110: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
+00001120: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
+00001130: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
+00001140: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00001150: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+00001160: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
+00001170: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
+00001180: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+00001190: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
+000011a0: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
+000011b0: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
+000011c0: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
+000011d0: 7665 7266 6c6f 774d 6f64 652e 5452 554e  verflowMode.TRUN
+000011e0: 4341 5445 290a 2020 2020 6173 7365 7274  CATE).    assert
+000011f0: 206f 626a 2069 7320 6e6f 7420 4e6f 6e65   obj is not None
+00001200: 0a0a 2020 2020 2320 5665 7269 6679 2074  ..    # Verify t
+00001210: 6861 7420 7765 2062 7265 616b 2074 6865  hat we break the
+00001220: 2074 6974 6c65 2074 6f20 6120 6d61 7820   title to a max 
+00001230: 6c65 6e67 7468 206f 6620 6f75 7220 7469  length of our ti
+00001240: 746c 655f 6d61 780a 2020 2020 2320 616e  tle_max.    # an
+00001250: 6420 7468 6174 2074 6865 2062 6f64 7920  d that the body 
+00001260: 7265 6d61 696e 7320 756e 746f 7563 6865  remains untouche
+00001270: 640a 2020 2020 6368 756e 6b73 203d 206f  d.    chunks = o
+00001280: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00001290: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+000012a0: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
+000012b0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+000012c0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+000012d0: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
+000012e0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+000012f0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00001300: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
+00001310: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+00001320: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+00001330: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
+00001340: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+00001350: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+00001360: 7329 203d 3d20 310a 2020 2020 6173 7365  s) == 1.    asse
+00001370: 7274 206c 656e 2863 6875 6e6b 735b 305d  rt len(chunks[0]
+00001380: 2e67 6574 2827 626f 6479 2729 2e73 706c  .get('body').spl
+00001390: 6974 2827 5c6e 2729 2920 3d3d 206f 626a  it('\n')) == obj
+000013a0: 2e62 6f64 795f 6d61 785f 6c69 6e65 5f63  .body_max_line_c
+000013b0: 6f75 6e74 0a20 2020 2061 7373 6572 7420  ount.    assert 
+000013c0: 7469 746c 655b 303a 6f62 6a2e 7469 746c  title[0:obj.titl
+000013d0: 655f 6d61 786c 656e 5d20 3d3d 2063 6875  e_maxlen] == chu
+000013e0: 6e6b 735b 305d 2e67 6574 2827 7469 746c  nks[0].get('titl
+000013f0: 6527 290a 0a20 2020 2023 0a20 2020 2023  e')..    #.    #
+00001400: 204e 6578 7420 5465 7374 3a20 5472 756e   Next Test: Trun
+00001410: 6361 7465 6420 626f 6479 0a20 2020 2023  cated body.    #
+00001420: 0a0a 2020 2020 636c 6173 7320 5465 7374  ..    class Test
+00001430: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
+00001440: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
+00001450: 2020 2023 2054 6573 7420 7469 746c 6520     # Test title 
+00001460: 6d61 7820 6c65 6e67 7468 0a20 2020 2020  max length.     
+00001470: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
+00001480: 3d20 7469 746c 655f 6c65 6e0a 0a20 2020  = title_len..   
+00001490: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
+000014a0: 2062 6f64 7920 6c65 6e67 7468 206f 6620   body length of 
+000014b0: 6a75 7374 2031 300a 2020 2020 2020 2020  just 10.        
+000014c0: 626f 6479 5f6d 6178 6c65 6e20 3d20 3130  body_maxlen = 10
+000014d0: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+000014e0: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+000014f0: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+00001500: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+00001510: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00001520: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00001530: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00001540: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00001550: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00001560: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00001570: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+00001580: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00001590: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+000015a0: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+000015b0: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+000015c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000015d0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+000015e0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+000015f0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+00001600: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+00001610: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+00001620: 2e54 5255 4e43 4154 4529 0a20 2020 2061  .TRUNCATE).    a
+00001630: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
+00001640: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
+00001650: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
+00001660: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
+00001670: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
+00001680: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
+00001690: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
+000016a0: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
+000016b0: 6f75 6368 6564 0a20 2020 2063 6875 6e6b  ouched.    chunk
+000016c0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+000016d0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+000016e0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+000016f0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00001700: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00001710: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
+00001720: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00001730: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00001740: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+00001750: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+00001760: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00001770: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
+00001780: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
+00001790: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+000017a0: 6368 756e 6b73 2920 3d3d 2031 0a20 2020  chunks) == 1.   
+000017b0: 2023 2042 6f64 7920 6973 206c 6f73 7420   # Body is lost 
+000017c0: 6173 2074 6865 2074 6974 6c65 2070 7265  as the title pre
+000017d0: 7661 696c 7320 6f76 6572 2065 7665 7279  vails over every
+000017e0: 7468 696e 670a 2020 2020 6173 7365 7274  thing.    assert
+000017f0: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
+00001800: 626f 6479 2729 203d 3d20 2727 0a20 2020  body') == ''.   
+00001810: 2023 2054 6974 6c65 2069 7320 6e6f 7420   # Title is not 
+00001820: 6c6f 6e67 6572 2074 6865 6e20 7468 6520  longer then the 
+00001830: 6d61 7869 6d75 6d20 7369 7a65 2074 6865  maximum size the
+00001840: 2062 6f64 7920 6361 6e20 6265 2064 7565   body can be due
+00001850: 2074 6f0a 2020 2020 2320 616d 616c 6761   to.    # amalga
+00001860: 6d61 7469 6f6e 666c 6167 3a0a 2020 2020  mationflag:.    
+00001870: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
+00001880: 6a2e 626f 6479 5f6d 6178 6c65 6e5d 203d  j.body_maxlen] =
+00001890: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
+000018a0: 2774 6974 6c65 2729 0a0a 2020 2020 636c  'title')..    cl
+000018b0: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
+000018c0: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
+000018d0: 3a0a 0a20 2020 2020 2020 2023 2054 6573  :..        # Tes
+000018e0: 7420 7469 746c 6520 6d61 7820 6c65 6e67  t title max leng
+000018f0: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
+00001900: 5f6d 6178 6c65 6e20 3d20 7469 746c 655f  _maxlen = title_
+00001910: 6c65 6e0a 0a20 2020 2020 2020 2023 2045  len..        # E
+00001920: 6e66 6f72 6365 2061 2062 6f64 7920 6c65  nforce a body le
+00001930: 6e67 7468 206f 6620 6a75 7374 2031 300a  ngth of just 10.
+00001940: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
+00001950: 6c65 6e20 3d20 3130 0a0a 2020 2020 2020  len = 10..      
+00001960: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
+00001970: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
+00001980: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
+00001990: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
+000019a0: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
+000019b0: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
+000019c0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+000019d0: 2020 2020 2020 2020 2073 7570 6572 2829           super()
+000019e0: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
+000019f0: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
+00001a00: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
+00001a10: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00001a20: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
+00001a30: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
+00001a40: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
+00001a50: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00001a60: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
+00001a70: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
+00001a80: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
+00001a90: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
+00001aa0: 666c 6f77 4d6f 6465 2e54 5255 4e43 4154  flowMode.TRUNCAT
+00001ab0: 4529 0a20 2020 2061 7373 6572 7420 6f62  E).    assert ob
+00001ac0: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
+00001ad0: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
+00001ae0: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
+00001af0: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
+00001b00: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
+00001b10: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
+00001b20: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
+00001b30: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
+00001b40: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00001b50: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00001b60: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
+00001b70: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
+00001b80: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00001b90: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+00001ba0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+00001bb0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00001bc0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00001bd0: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
+00001be0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00001bf0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00001c00: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+00001c10: 653d 7469 746c 6529 0a20 2020 2061 7373  e=title).    ass
+00001c20: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+00001c30: 3d3d 2031 0a0a 2020 2020 6173 7365 7274  == 1..    assert
+00001c40: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
+00001c50: 626f 6479 2729 203d 3d20 2727 0a20 2020  body') == ''.   
+00001c60: 2023 2062 6f64 795f 6d61 786c 656e 2070   # body_maxlen p
+00001c70: 7265 7661 696c 7320 6475 6520 746f 2069  revails due to i
+00001c80: 7420 6265 696e 6720 736d 616c 6c65 7220  t being smaller 
+00001c90: 616e 6420 616d 616c 6761 6d61 7469 6f6e  and amalgamation
+00001ca0: 2066 6c61 6720 7365 740a 2020 2020 6173   flag set.    as
+00001cb0: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
+00001cc0: 2e62 6f64 795f 6d61 786c 656e 5d20 3d3d  .body_maxlen] ==
+00001cd0: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
+00001ce0: 7469 746c 6527 290a 0a20 2020 2023 0a20  title')..    #. 
+00001cf0: 2020 2023 204e 6578 7420 5465 7374 3a20     # Next Test: 
+00001d00: 4170 7065 6e64 2074 6974 6c65 2074 6f20  Append title to 
+00001d10: 626f 6479 202b 2054 7275 6e63 6174 6564  body + Truncated
+00001d20: 2062 6f64 790a 2020 2020 230a 0a20 2020   body.    #..   
+00001d30: 2063 6c61 7373 2054 6573 744e 6f74 6966   class TestNotif
+00001d40: 6963 6174 696f 6e28 4e6f 7469 6679 4261  ication(NotifyBa
+00001d50: 7365 293a 0a0a 2020 2020 2020 2020 2320  se):..        # 
+00001d60: 456e 666f 7263 6520 6e6f 2074 6974 6c65  Enforce no title
+00001d70: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
+00001d80: 6178 6c65 6e20 3d20 300a 0a20 2020 2020  axlen = 0..     
+00001d90: 2020 2023 2045 6e66 6f72 6365 2061 2062     # Enforce a b
+00001da0: 6f64 7920 6c65 6e67 7468 206f 6620 6a75  ody length of ju
+00001db0: 7374 2031 3030 0a20 2020 2020 2020 2062  st 100.        b
+00001dc0: 6f64 795f 6d61 786c 656e 203d 2031 3030  ody_maxlen = 100
+00001dd0: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+00001de0: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+00001df0: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+00001e00: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+00001e10: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00001e20: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00001e30: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00001e40: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00001e50: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00001e60: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00001e70: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+00001e80: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00001e90: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00001ea0: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+00001eb0: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+00001ec0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00001ed0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+00001ee0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+00001ef0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+00001f00: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+00001f10: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+00001f20: 2e54 5255 4e43 4154 4529 0a20 2020 2061  .TRUNCATE).    a
+00001f30: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
+00001f40: 204e 6f6e 650a 0a20 2020 2023 2056 6572   None..    # Ver
+00001f50: 6966 7920 7468 6174 2077 6520 6272 6561  ify that we brea
+00001f60: 6b20 7468 6520 7469 746c 6520 746f 2061  k the title to a
+00001f70: 206d 6178 206c 656e 6774 6820 6f66 206f   max length of o
+00001f80: 7572 2074 6974 6c65 5f6d 6178 0a20 2020  ur title_max.   
+00001f90: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
+00001fa0: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
+00001fb0: 6f75 6368 6564 0a0a 2020 2020 6f62 6a2e  ouched..    obj.
+00001fc0: 6e6f 7469 6679 5f66 6f72 6d61 7420 3d20  notify_format = 
+00001fd0: 4e6f 7469 6679 466f 726d 6174 2e48 544d  NotifyFormat.HTM
+00001fe0: 4c0a 2020 2020 6368 756e 6b73 203d 206f  L.    chunks = o
+00001ff0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00002000: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+00002010: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
+00002020: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00002030: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00002040: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
+00002050: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00002060: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00002070: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
+00002080: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+00002090: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+000020a0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
+000020b0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+000020c0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+000020d0: 7329 203d 3d20 310a 0a20 2020 206f 626a  s) == 1..    obj
+000020e0: 2e6e 6f74 6966 795f 666f 726d 6174 203d  .notify_format =
+000020f0: 204e 6f74 6966 7946 6f72 6d61 742e 4d41   NotifyFormat.MA
+00002100: 524b 444f 574e 0a20 2020 2063 6875 6e6b  RKDOWN.    chunk
+00002110: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00002120: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+00002130: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+00002140: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00002150: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00002160: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
+00002170: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00002180: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00002190: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+000021a0: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+000021b0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+000021c0: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
+000021d0: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
+000021e0: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+000021f0: 6368 756e 6b73 2920 3d3d 2031 0a0a 2020  chunks) == 1..  
+00002200: 2020 6f62 6a2e 6e6f 7469 6679 5f66 6f72    obj.notify_for
+00002210: 6d61 7420 3d20 4e6f 7469 6679 466f 726d  mat = NotifyForm
+00002220: 6174 2e54 4558 540a 2020 2020 6368 756e  at.TEXT.    chun
+00002230: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00002240: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
+00002250: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00002260: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00002270: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00002280: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
+00002290: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+000022a0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+000022b0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
+000022c0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+000022d0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+000022e0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+000022f0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
+00002300: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
+00002310: 2863 6875 6e6b 7329 203d 3d20 310a 0a20  (chunks) == 1.. 
+00002320: 2020 2023 2054 6865 2062 656c 6f77 206c     # The below l
+00002330: 696e 6520 7368 6f75 6c64 2062 6520 7265  ine should be re
+00002340: 6164 2063 6172 6566 756c 6c79 2e2e 2e20  ad carefully... 
+00002350: 5765 2772 6520 6163 7475 616c 6c79 2074  We're actually t
+00002360: 6573 7469 6e67 2074 6f20 7365 650a 2020  esting to see.  
+00002370: 2020 2320 7468 6174 206f 7572 2074 6974    # that our tit
+00002380: 6c65 2069 7320 6d61 7463 6865 6420 6167  le is matched ag
+00002390: 6169 6e73 7420 6f75 7220 626f 6479 2e20  ainst our body. 
+000023a0: 4265 6869 6e64 2074 6865 2073 6365 6e65  Behind the scene
+000023b0: 732c 2074 6865 2074 6974 6c65 0a20 2020  s, the title.   
+000023c0: 2023 2077 6173 2061 7070 656e 6465 6420   # was appended 
+000023d0: 746f 2074 6865 2062 6f64 792e 2054 6865  to the body. The
+000023e0: 2062 6f64 7920 7761 7320 7468 656e 2074   body was then t
+000023f0: 7275 6e63 6174 6564 2074 6f20 7468 6520  runcated to the 
+00002400: 6d61 786c 656e 2e0a 2020 2020 2320 5468  maxlen..    # Th
+00002410: 6520 7468 696e 6720 6973 2c20 7369 6e63  e thing is, sinc
+00002420: 6520 7468 6520 7469 746c 6520 6973 2073  e the title is s
+00002430: 6f20 6c61 7267 652c 2061 6c6c 206f 6620  o large, all of 
+00002440: 7468 6520 626f 6479 2077 6173 206c 6f73  the body was los
+00002450: 740a 2020 2020 2320 616e 6420 6120 676f  t.    # and a go
+00002460: 6f64 2063 6875 6e6b 206f 6620 7468 6520  od chunk of the 
+00002470: 7469 746c 6520 7761 7320 746f 6f2e 2020  title was too.  
+00002480: 5468 6520 6d65 7373 6167 6520 7365 6e74  The message sent
+00002490: 2077 696c 6c20 6a75 7374 2062 6520 610a   will just be a.
+000024a0: 2020 2020 2320 736d 616c 6c20 706f 7274      # small port
+000024b0: 696f 6e20 6f66 2074 6865 2074 6974 6c65  ion of the title
+000024c0: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+000024d0: 6368 756e 6b73 5b30 5d2e 6765 7428 2762  chunks[0].get('b
+000024e0: 6f64 7927 2929 203d 3d20 6f62 6a2e 626f  ody')) == obj.bo
+000024f0: 6479 5f6d 6178 6c65 6e0a 2020 2020 6173  dy_maxlen.    as
+00002500: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
+00002510: 2e62 6f64 795f 6d61 786c 656e 5d20 3d3d  .body_maxlen] ==
+00002520: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
+00002530: 626f 6479 2729 0a0a 0a64 6566 2074 6573  body')...def tes
+00002540: 745f 6e6f 7469 6679 5f6f 7665 7266 6c6f  t_notify_overflo
+00002550: 775f 7472 756e 6361 7465 5f6e 6f5f 616d  w_truncate_no_am
+00002560: 616c 6761 6d61 7469 6f6e 2829 3a0a 2020  algamation():.  
+00002570: 2020 2222 220a 2020 2020 4150 493a 204f    """.    API: O
+00002580: 7665 7266 6c6f 7720 4e6f 2041 6d61 6c67  verflow No Amalg
+00002590: 616d 6174 696f 6e20 5472 756e 6361 7465  amation Truncate
+000025a0: 2046 756e 6374 696f 6e61 6c69 7479 2054   Functionality T
+000025b0: 6573 7469 6e67 0a0a 2020 2020 2222 220a  esting..    """.
+000025c0: 2020 2020 230a 2020 2020 2320 4120 6c69      #.    # A li
+000025d0: 7474 6c65 2070 7265 7061 7261 7469 6f6e  ttle preparation
+000025e0: 0a20 2020 2023 0a0a 2020 2020 2320 4e75  .    #..    # Nu
+000025f0: 6d62 6572 206f 6620 6368 6172 6163 7465  mber of characte
+00002600: 7273 2070 6572 206c 696e 650a 2020 2020  rs per line.    
+00002610: 726f 7720 3d20 3234 0a0a 2020 2020 2320  row = 24..    # 
+00002620: 536f 6d65 2076 6172 6961 626c 6573 2077  Some variables w
+00002630: 6520 7573 6520 746f 2063 6f6e 7472 6f6c  e use to control
+00002640: 2074 6865 2064 6174 6120 7765 2077 6f72   the data we wor
+00002650: 6b20 7769 7468 0a20 2020 2062 6f64 795f  k with.    body_
+00002660: 6c65 6e20 3d20 3130 3234 0a20 2020 2074  len = 1024.    t
+00002670: 6974 6c65 5f6c 656e 203d 2031 3032 340a  itle_len = 1024.
+00002680: 0a20 2020 2023 2043 7265 6174 6520 6120  .    # Create a 
+00002690: 6c61 7267 6520 626f 6479 2061 6e64 2074  large body and t
+000026a0: 6974 6c65 2077 6974 6820 7261 6e64 6f6d  itle with random
+000026b0: 2064 6174 610a 2020 2020 626f 6479 203d   data.    body =
+000026c0: 2027 272e 6a6f 696e 2863 686f 6963 6528   ''.join(choice(
+000026d0: 7374 725f 616c 7068 6120 2b20 7374 725f  str_alpha + str_
+000026e0: 6e75 6d20 2b20 2720 2729 2066 6f72 205f  num + ' ') for _
+000026f0: 2069 6e20 7261 6e67 6528 626f 6479 5f6c   in range(body_l
+00002700: 656e 2929 0a20 2020 2062 6f64 7920 3d20  en)).    body = 
+00002710: 275c 725c 6e27 2e6a 6f69 6e28 5b62 6f64  '\r\n'.join([bod
+00002720: 795b 693a 2069 202b 2072 6f77 5d20 666f  y[i: i + row] fo
+00002730: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
+00002740: 6c65 6e28 626f 6479 292c 2072 6f77 295d  len(body), row)]
+00002750: 290a 0a20 2020 2023 2074 6865 206e 6577  )..    # the new
+00002760: 206c 696e 6573 2061 6464 2061 206c 6172   lines add a lar
+00002770: 6765 2061 6d6f 756e 7420 746f 206f 7572  ge amount to our
+00002780: 2062 6f64 793b 206c 6574 7320 666f 7263   body; lets forc
+00002790: 6520 7468 6520 636f 6e74 656e 740a 2020  e the content.  
+000027a0: 2020 2320 6261 636b 2074 6f20 6265 696e    # back to bein
+000027b0: 6720 3130 3234 2063 6861 7261 6374 6572  g 1024 character
+000027c0: 732e 0a20 2020 2062 6f64 7920 3d20 626f  s..    body = bo
+000027d0: 6479 5b30 3a31 3032 345d 0a0a 2020 2020  dy[0:1024]..    
+000027e0: 2320 4372 6561 7465 206f 7572 2074 6974  # Create our tit
+000027f0: 6c65 2075 7369 6e67 2072 616e 646f 6d20  le using random 
+00002800: 6461 7461 0a20 2020 2074 6974 6c65 203d  data.    title =
+00002810: 2027 272e 6a6f 696e 2863 686f 6963 6528   ''.join(choice(
+00002820: 7374 725f 616c 7068 6120 2b20 7374 725f  str_alpha + str_
+00002830: 6e75 6d29 2066 6f72 205f 2069 6e20 7261  num) for _ in ra
+00002840: 6e67 6528 7469 746c 655f 6c65 6e29 290a  nge(title_len)).
+00002850: 0a20 2020 2023 0a20 2020 2023 2046 6972  .    #.    # Fir
+00002860: 7374 2054 6573 743a 2054 7275 6e63 6174  st Test: Truncat
+00002870: 6564 2054 6974 6c65 0a20 2020 2023 0a20  ed Title.    #. 
+00002880: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
+00002890: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
+000028a0: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
+000028b0: 2320 5465 7374 2074 6974 6c65 206d 6178  # Test title max
+000028c0: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+000028d0: 7469 746c 655f 6d61 786c 656e 203d 2031  title_maxlen = 1
+000028e0: 300a 0a20 2020 2020 2020 2023 204e 6f20  0..        # No 
+000028f0: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
+00002900: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
+00002910: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
+00002920: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+00002930: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00002940: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00002950: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00002960: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00002970: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00002980: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+00002990: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+000029a0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+000029b0: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+000029c0: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+000029d0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000029e0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+000029f0: 5765 2073 686f 756c 6420 7468 726f 7720  We should throw 
+00002a00: 616e 2065 7863 6570 7469 6f6e 2062 6563  an exception bec
+00002a10: 6175 7365 206f 7572 2073 7065 6369 6669  ause our specifi
+00002a20: 6564 206f 7665 7266 6c6f 7720 6973 2077  ed overflow is w
+00002a30: 726f 6e67 2e0a 2020 2020 7769 7468 2070  rong..    with p
+00002a40: 7974 6573 742e 7261 6973 6573 2854 7970  ytest.raises(Typ
+00002a50: 6545 7272 6f72 293a 0a20 2020 2020 2020  eError):.       
+00002a60: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
+00002a70: 6374 0a20 2020 2020 2020 206f 626a 203d  ct.        obj =
+00002a80: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+00002a90: 6e28 6f76 6572 666c 6f77 3d27 696e 7661  n(overflow='inva
+00002aa0: 6c69 6427 290a 0a20 2020 2023 204c 6f61  lid')..    # Loa
+00002ab0: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
+00002ac0: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
+00002ad0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
+00002ae0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5452  =OverflowMode.TR
+00002af0: 554e 4341 5445 290a 2020 2020 6173 7365  UNCATE).    asse
+00002b00: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+00002b10: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+00002b20: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+00002b30: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+00002b40: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+00002b50: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+00002b60: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+00002b70: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+00002b80: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+00002b90: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00002ba0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00002bb0: 746c 653d 7469 746c 652c 206f 7665 7266  tle=title, overf
+00002bc0: 6c6f 773d 4e6f 6e65 290a 2020 2020 6368  low=None).    ch
+00002bd0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00002be0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00002bf0: 2222 2c20 7469 746c 653d 2222 2c20 6f76  "", title="", ov
+00002c00: 6572 666c 6f77 3d4e 6f6e 6529 0a20 2020  erflow=None).   
+00002c10: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00002c20: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00002c30: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
+00002c40: 222c 206f 7665 7266 6c6f 773d 4e6f 6e65  ", overflow=None
+00002c50: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00002c60: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00002c70: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+00002c80: 746c 653d 7469 746c 652c 206f 7665 7266  tle=title, overf
+00002c90: 6c6f 773d 4e6f 6e65 290a 2020 2020 6368  low=None).    ch
+00002ca0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00002cb0: 795f 6f76 6572 666c 6f77 280a 2020 2020  y_overflow(.    
+00002cc0: 2020 2020 626f 6479 3d62 6f64 792c 2074      body=body, t
+00002cd0: 6974 6c65 3d74 6974 6c65 2c20 6f76 6572  itle=title, over
+00002ce0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
+00002cf0: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
+00002d00: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+00002d10: 3d3d 2031 0a20 2020 2061 7373 6572 7420  == 1.    assert 
+00002d20: 626f 6479 2e6c 7374 7269 7028 275c 725c  body.lstrip('\r\
+00002d30: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
+00002d40: 6970 2829 203d 3d20 6368 756e 6b73 5b30  ip() == chunks[0
+00002d50: 5d2e 6765 7428 2762 6f64 7927 290a 2020  ].get('body').  
+00002d60: 2020 6173 7365 7274 2074 6974 6c65 5b30    assert title[0
+00002d70: 3a6f 626a 2e74 6974 6c65 5f6d 6178 6c65  :obj.title_maxle
+00002d80: 6e5d 203d 3d20 6368 756e 6b73 5b30 5d2e  n] == chunks[0].
+00002d90: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
+00002da0: 2020 230a 2020 2020 2320 4e65 7874 2054    #.    # Next T
+00002db0: 6573 743a 204c 696e 6520 436f 756e 7420  est: Line Count 
+00002dc0: 436f 6e74 726f 6c0a 2020 2020 230a 0a20  Control.    #.. 
+00002dd0: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
+00002de0: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
+00002df0: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
+00002e00: 2320 5465 7374 2074 6974 6c65 206d 6178  # Test title max
+00002e10: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+00002e20: 7469 746c 655f 6d61 786c 656e 203d 2035  title_maxlen = 5
+00002e30: 0a0a 2020 2020 2020 2020 2320 4d61 7869  ..        # Maxi
+00002e40: 6d75 6d20 6e75 6d62 6572 206f 6620 6c69  mum number of li
+00002e50: 6e65 730a 2020 2020 2020 2020 626f 6479  nes.        body
+00002e60: 5f6d 6178 5f6c 696e 655f 636f 756e 7420  _max_line_count 
+00002e70: 3d20 350a 0a20 2020 2020 2020 2023 204e  = 5..        # N
+00002e80: 6f20 616d 616c 6761 6d61 7469 6f6e 0a20  o amalgamation. 
+00002e90: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+00002ea0: 616d 616c 6761 6d61 7465 5f74 6974 6c65  amalgamate_title
+00002eb0: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
+00002ec0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00002ed0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00002ee0: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+00002ef0: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+00002f00: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
+00002f10: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
+00002f20: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
+00002f30: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00002f40: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
+00002f50: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
+00002f60: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
+00002f70: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00002f80: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
+00002f90: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
+00002fa0: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
+00002fb0: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
+00002fc0: 6465 2e54 5255 4e43 4154 4529 0a20 2020  de.TRUNCATE).   
+00002fd0: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
+00002fe0: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
+00002ff0: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
+00003000: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
+00003010: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
+00003020: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
+00003030: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+00003040: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+00003050: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
+00003060: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00003070: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00003080: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00003090: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+000030a0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+000030b0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+000030c0: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+000030d0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+000030e0: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+000030f0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+00003100: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00003110: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00003120: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+00003130: 6529 0a20 2020 2061 7373 6572 7420 6c65  e).    assert le
+00003140: 6e28 6368 756e 6b73 2920 3d3d 2031 0a20  n(chunks) == 1. 
+00003150: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00003160: 756e 6b73 5b30 5d2e 6765 7428 2762 6f64  unks[0].get('bod
+00003170: 7927 292e 7370 6c69 7428 275c 6e27 2929  y').split('\n'))
+00003180: 203d 3d20 6f62 6a2e 626f 6479 5f6d 6178   == obj.body_max
+00003190: 5f6c 696e 655f 636f 756e 740a 2020 2020  _line_count.    
+000031a0: 6173 7365 7274 2074 6974 6c65 5b30 3a6f  assert title[0:o
+000031b0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e5d  bj.title_maxlen]
+000031c0: 203d 3d20 6368 756e 6b73 5b30 5d2e 6765   == chunks[0].ge
+000031d0: 7428 2774 6974 6c65 2729 0a0a 2020 2020  t('title')..    
+000031e0: 230a 2020 2020 2320 4e65 7874 2054 6573  #.    # Next Tes
+000031f0: 743a 2054 7275 6e63 6174 6564 2062 6f64  t: Truncated bod
+00003200: 790a 2020 2020 230a 0a20 2020 2063 6c61  y.    #..    cla
+00003210: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
+00003220: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+00003230: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
+00003240: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
+00003250: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
+00003260: 6d61 786c 656e 203d 2074 6974 6c65 5f6c  maxlen = title_l
+00003270: 656e 0a0a 2020 2020 2020 2020 2320 456e  en..        # En
+00003280: 666f 7263 6520 6120 626f 6479 206c 656e  force a body len
+00003290: 6774 6820 6f66 206a 7573 7420 3130 0a20  gth of just 10. 
+000032a0: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
+000032b0: 656e 203d 2031 300a 0a20 2020 2020 2020  en = 10..       
+000032c0: 2023 204e 6f20 616d 616c 6761 6d61 7469   # No amalgamati
+000032d0: 6f6e 0a20 2020 2020 2020 206f 7665 7266  on.        overf
+000032e0: 6c6f 775f 616d 616c 6761 6d61 7465 5f74  low_amalgamate_t
+000032f0: 6974 6c65 203d 2046 616c 7365 0a0a 2020  itle = False..  
+00003300: 2020 2020 2020 6465 6620 5f5f 696e 6974        def __init
+00003310: 5f5f 2873 656c 662c 202a 6172 6773 2c20  __(self, *args, 
+00003320: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00003330: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+00003340: 5f69 6e69 745f 5f28 2a2a 6b77 6172 6773  _init__(**kwargs
+00003350: 290a 0a20 2020 2020 2020 2064 6566 206e  )..        def n
+00003360: 6f74 6966 7928 7365 6c66 2c20 2a61 7267  otify(self, *arg
+00003370: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+00003380: 2020 2020 2020 2020 2020 2320 5072 6574            # Pret
+00003390: 656e 6420 6576 6572 7974 6869 6e67 2069  end everything i
+000033a0: 7320 6f6b 6179 0a20 2020 2020 2020 2020  s okay.         
+000033b0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+000033c0: 2020 2020 2320 4c6f 6164 206f 7572 206f      # Load our o
+000033d0: 626a 6563 740a 2020 2020 6f62 6a20 3d20  bject.    obj = 
+000033e0: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+000033f0: 286f 7665 7266 6c6f 773d 4f76 6572 666c  (overflow=Overfl
+00003400: 6f77 4d6f 6465 2e54 5255 4e43 4154 4529  owMode.TRUNCATE)
+00003410: 0a20 2020 2061 7373 6572 7420 6f62 6a20  .    assert obj 
+00003420: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
+00003430: 2023 2056 6572 6966 7920 7468 6174 2077   # Verify that w
+00003440: 6520 6272 6561 6b20 7468 6520 7469 746c  e break the titl
+00003450: 6520 746f 2061 206d 6178 206c 656e 6774  e to a max lengt
+00003460: 6820 6f66 206f 7572 2074 6974 6c65 5f6d  h of our title_m
+00003470: 6178 0a20 2020 2023 2061 6e64 2074 6861  ax.    # and tha
+00003480: 7420 7468 6520 626f 6479 2072 656d 6169  t the body remai
+00003490: 6e73 2075 6e74 6f75 6368 6564 0a20 2020  ns untouched.   
+000034a0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+000034b0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+000034c0: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
+000034d0: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
+000034e0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+000034f0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00003500: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+00003510: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00003520: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
+00003530: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
+00003540: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00003550: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00003560: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
+00003570: 7469 746c 6529 0a20 2020 2061 7373 6572  title).    asser
+00003580: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
+00003590: 2031 0a20 2020 2061 7373 6572 7420 626f   1.    assert bo
+000035a0: 6479 5b30 3a6f 626a 2e62 6f64 795f 6d61  dy[0:obj.body_ma
+000035b0: 786c 656e 5d5c 0a20 2020 2020 2020 202e  xlen]\.        .
+000035c0: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
+000035d0: 5c78 3063 2729 2e72 7374 7269 7028 2920  \x0c').rstrip() 
+000035e0: 3d3d 2063 6875 6e6b 735b 305d 2e67 6574  == chunks[0].get
+000035f0: 2827 626f 6479 2729 0a20 2020 2061 7373  ('body').    ass
+00003600: 6572 7420 7469 746c 6520 3d3d 2063 6875  ert title == chu
+00003610: 6e6b 735b 305d 2e67 6574 2827 7469 746c  nks[0].get('titl
+00003620: 6527 290a 0a20 2020 2063 6c61 7373 2054  e')..    class T
+00003630: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00003640: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
+00003650: 2020 2020 2020 2320 5465 7374 2074 6974        # Test tit
+00003660: 6c65 206d 6178 206c 656e 6774 680a 2020  le max length.  
+00003670: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
+00003680: 656e 203d 2074 6974 6c65 5f6c 656e 0a0a  en = title_len..
+00003690: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
+000036a0: 6520 6120 626f 6479 206c 656e 6774 6820  e a body length 
+000036b0: 6f66 206a 7573 7420 3130 0a20 2020 2020  of just 10.     
+000036c0: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
+000036d0: 2031 300a 0a20 2020 2020 2020 2023 204e   10..        # N
+000036e0: 6f20 616d 616c 6761 6d61 7469 6f6e 0a20  o amalgamation. 
+000036f0: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+00003700: 616d 616c 6761 6d61 7465 5f74 6974 6c65  amalgamate_title
+00003710: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
+00003720: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00003730: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00003740: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+00003750: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+00003760: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
+00003770: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
+00003780: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
+00003790: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+000037a0: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
+000037b0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
+000037c0: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
+000037d0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+000037e0: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
+000037f0: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
+00003800: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
+00003810: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
+00003820: 6465 2e54 5255 4e43 4154 4529 0a20 2020  de.TRUNCATE).   
+00003830: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
+00003840: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
+00003850: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
+00003860: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
+00003870: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
+00003880: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
+00003890: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+000038a0: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+000038b0: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
+000038c0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+000038d0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+000038e0: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+000038f0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00003900: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00003910: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00003920: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+00003930: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00003940: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+00003950: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+00003960: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00003970: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00003980: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+00003990: 6529 0a20 2020 2061 7373 6572 7420 6c65  e).    assert le
+000039a0: 6e28 6368 756e 6b73 2920 3d3d 2031 0a20  n(chunks) == 1. 
+000039b0: 2020 2023 204e 6f20 616d 616c 6761 6d61     # No amalgama
+000039c0: 7469 6f6e 2073 6574 2073 6f20 6f75 7220  tion set so our 
+000039d0: 626f 6479 2061 6c69 676e 7320 696e 2073  body aligns in s
+000039e0: 697a 6520 286e 6f20 2d32 206c 696b 6520  ize (no -2 like 
+000039f0: 7072 6576 696f 7573 0a20 2020 2023 2074  previous.    # t
+00003a00: 6573 7429 0a20 2020 2061 7373 6572 7420  est).    assert 
+00003a10: 626f 6479 5b30 3a6f 626a 2e62 6f64 795f  body[0:obj.body_
+00003a20: 6d61 786c 656e 5d5c 0a20 2020 2020 2020  maxlen]\.       
+00003a30: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+00003a40: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+00003a50: 2920 3d3d 2063 6875 6e6b 735b 305d 2e67  ) == chunks[0].g
+00003a60: 6574 2827 626f 6479 2729 0a20 2020 2061  et('body').    a
+00003a70: 7373 6572 7420 7469 746c 6520 3d3d 2063  ssert title == c
+00003a80: 6875 6e6b 735b 305d 2e67 6574 2827 7469  hunks[0].get('ti
+00003a90: 746c 6527 290a 0a20 2020 2023 0a20 2020  tle')..    #.   
+00003aa0: 2023 204e 6578 7420 5465 7374 3a20 4170   # Next Test: Ap
+00003ab0: 7065 6e64 2074 6974 6c65 2074 6f20 626f  pend title to bo
+00003ac0: 6479 202b 2054 7275 6e63 6174 6564 2062  dy + Truncated b
+00003ad0: 6f64 790a 2020 2020 230a 0a20 2020 2063  ody.    #..    c
+00003ae0: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
+00003af0: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
+00003b00: 293a 0a0a 2020 2020 2020 2020 2320 456e  ):..        # En
+00003b10: 666f 7263 6520 6e6f 2074 6974 6c65 0a20  force no title. 
+00003b20: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
+00003b30: 6c65 6e20 3d20 300a 0a20 2020 2020 2020  len = 0..       
+00003b40: 2023 2045 6e66 6f72 6365 2061 2062 6f64   # Enforce a bod
+00003b50: 7920 6c65 6e67 7468 206f 6620 6a75 7374  y length of just
+00003b60: 2031 3030 0a20 2020 2020 2020 2062 6f64   100.        bod
+00003b70: 795f 6d61 786c 656e 203d 2031 3030 0a0a  y_maxlen = 100..
+00003b80: 2020 2020 2020 2020 2320 4e6f 2061 6d61          # No ama
+00003b90: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
+00003ba0: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
+00003bb0: 616d 6174 655f 7469 746c 6520 3d20 4661  amate_title = Fa
+00003bc0: 6c73 650a 0a20 2020 2020 2020 2064 6566  lse..        def
+00003bd0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00003be0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00003bf0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
+00003c00: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
+00003c10: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
+00003c20: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
+00003c30: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00003c40: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00003c50: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
+00003c60: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
+00003c70: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003c80: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
+00003c90: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
+00003ca0: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
+00003cb0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
+00003cc0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5452  =OverflowMode.TR
+00003cd0: 554e 4341 5445 290a 2020 2020 6173 7365  UNCATE).    asse
+00003ce0: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+00003cf0: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+00003d00: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+00003d10: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+00003d20: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+00003d30: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+00003d40: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+00003d50: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+00003d60: 6865 640a 0a20 2020 206f 626a 2e6e 6f74  hed..    obj.not
+00003d70: 6966 795f 666f 726d 6174 203d 204e 6f74  ify_format = Not
+00003d80: 6966 7946 6f72 6d61 742e 4854 4d4c 0a20  ifyFormat.HTML. 
+00003d90: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00003da0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00003db0: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
+00003dc0: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
+00003dd0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00003de0: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+00003df0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+00003e00: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00003e10: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00003e20: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
+00003e30: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00003e40: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00003e50: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+00003e60: 653d 7469 746c 6529 0a20 2020 2061 7373  e=title).    ass
+00003e70: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+00003e80: 3d3d 2031 0a0a 2020 2020 6f62 6a2e 6e6f  == 1..    obj.no
+00003e90: 7469 6679 5f66 6f72 6d61 7420 3d20 4e6f  tify_format = No
+00003ea0: 7469 6679 466f 726d 6174 2e4d 4152 4b44  tifyFormat.MARKD
+00003eb0: 4f57 4e0a 2020 2020 6368 756e 6b73 203d  OWN.    chunks =
+00003ec0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00003ed0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00003ee0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+00003ef0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00003f00: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00003f10: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+00003f20: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00003f30: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00003f40: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+00003f50: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00003f60: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00003f70: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+00003f80: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+00003f90: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00003fa0: 6e6b 7329 203d 3d20 310a 0a20 2020 206f  nks) == 1..    o
+00003fb0: 626a 2e6e 6f74 6966 795f 666f 726d 6174  bj.notify_format
+00003fc0: 203d 204e 6f74 6966 7946 6f72 6d61 742e   = NotifyFormat.
+00003fd0: 5445 5854 0a20 2020 2063 6875 6e6b 7320  TEXT.    chunks 
+00003fe0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00003ff0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+00004000: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+00004010: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00004020: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00004030: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
+00004040: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00004050: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00004060: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+00004070: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+00004080: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00004090: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+000040a0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+000040b0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+000040c0: 756e 6b73 2920 3d3d 2031 0a0a 2020 2020  unks) == 1..    
+000040d0: 2320 5468 6520 6265 6c6f 7720 6c69 6e65  # The below line
+000040e0: 2073 686f 756c 6420 6265 2072 6561 6420   should be read 
+000040f0: 6361 7265 6675 6c6c 792e 2e2e 2057 6527  carefully... We'
+00004100: 7265 2061 6374 7561 6c6c 7920 7465 7374  re actually test
+00004110: 696e 6720 746f 2073 6565 0a20 2020 2023  ing to see.    #
+00004120: 2074 6861 7420 6f75 7220 7469 746c 6520   that our title 
+00004130: 6973 206d 6174 6368 6564 2061 6761 696e  is matched again
+00004140: 7374 206f 7572 2062 6f64 792e 2042 6568  st our body. Beh
+00004150: 696e 6420 7468 6520 7363 656e 6573 2c20  ind the scenes, 
+00004160: 7468 6520 7469 746c 650a 2020 2020 2320  the title.    # 
+00004170: 7761 7320 6170 7065 6e64 6564 2074 6f20  was appended to 
+00004180: 7468 6520 626f 6479 2e20 5468 6520 626f  the body. The bo
+00004190: 6479 2077 6173 2074 6865 6e20 7472 756e  dy was then trun
+000041a0: 6361 7465 6420 746f 2074 6865 206d 6178  cated to the max
+000041b0: 6c65 6e2e 0a20 2020 2023 2054 6865 2074  len..    # The t
+000041c0: 6869 6e67 2069 732c 2073 696e 6365 2074  hing is, since t
+000041d0: 6865 2074 6974 6c65 2069 7320 736f 206c  he title is so l
+000041e0: 6172 6765 2c20 616c 6c20 6f66 2074 6865  arge, all of the
+000041f0: 2062 6f64 7920 7761 7320 6c6f 7374 0a20   body was lost. 
+00004200: 2020 2023 2061 6e64 2061 2067 6f6f 6420     # and a good 
+00004210: 6368 756e 6b20 6f66 2074 6865 2074 6974  chunk of the tit
+00004220: 6c65 2077 6173 2074 6f6f 2e20 2054 6865  le was too.  The
+00004230: 206d 6573 7361 6765 2073 656e 7420 7769   message sent wi
+00004240: 6c6c 206a 7573 7420 6265 2061 0a20 2020  ll just be a.   
+00004250: 2023 2073 6d61 6c6c 2070 6f72 7469 6f6e   # small portion
+00004260: 206f 6620 7468 6520 7469 746c 650a 2020   of the title.  
+00004270: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00004280: 6e6b 735b 305d 2e67 6574 2827 626f 6479  nks[0].get('body
+00004290: 2729 2920 3d3d 206f 626a 2e62 6f64 795f  ')) == obj.body_
+000042a0: 6d61 786c 656e 0a20 2020 2061 7373 6572  maxlen.    asser
+000042b0: 7420 7469 746c 655b 303a 6f62 6a2e 626f  t title[0:obj.bo
+000042c0: 6479 5f6d 6178 6c65 6e5d 203d 3d20 6368  dy_maxlen] == ch
+000042d0: 756e 6b73 5b30 5d2e 6765 7428 2762 6f64  unks[0].get('bod
+000042e0: 7927 290a 0a0a 6465 6620 7465 7374 5f6e  y')...def test_n
+000042f0: 6f74 6966 795f 6f76 6572 666c 6f77 5f73  otify_overflow_s
+00004300: 706c 6974 5f77 6974 685f 616d 616c 6761  plit_with_amalga
+00004310: 6d61 7469 6f6e 2829 3a0a 2020 2020 2222  mation():.    ""
+00004320: 220a 2020 2020 4150 493a 204f 7665 7266  ".    API: Overf
+00004330: 6c6f 7720 5769 7468 2041 6d61 6c67 616d  low With Amalgam
+00004340: 6174 696f 6e20 5370 6c69 7473 2046 756e  ation Splits Fun
+00004350: 6374 696f 6e61 6c69 7479 2054 6573 7469  ctionality Testi
+00004360: 6e67 0a0a 2020 2020 2222 220a 0a20 2020  ng..    """..   
+00004370: 2023 0a20 2020 2023 2041 206c 6974 746c   #.    # A littl
+00004380: 6520 7072 6570 6172 6174 696f 6e0a 2020  e preparation.  
+00004390: 2020 230a 0a20 2020 2023 204e 756d 6265    #..    # Numbe
+000043a0: 7220 6f66 2063 6861 7261 6374 6572 7320  r of characters 
+000043b0: 7065 7220 6c69 6e65 0a20 2020 2072 6f77  per line.    row
+000043c0: 203d 2032 340a 0a20 2020 2023 2053 6f6d   = 24..    # Som
+000043d0: 6520 7661 7269 6162 6c65 7320 7765 2075  e variables we u
+000043e0: 7365 2074 6f20 636f 6e74 726f 6c20 7468  se to control th
+000043f0: 6520 6461 7461 2077 6520 776f 726b 2077  e data we work w
+00004400: 6974 680a 2020 2020 626f 6479 5f6c 656e  ith.    body_len
+00004410: 203d 2031 3032 340a 2020 2020 7469 746c   = 1024.    titl
+00004420: 655f 6c65 6e20 3d20 3130 3234 0a0a 2020  e_len = 1024..  
+00004430: 2020 2320 4372 6561 7465 2061 206c 6172    # Create a lar
+00004440: 6765 2062 6f64 7920 616e 6420 7469 746c  ge body and titl
+00004450: 6520 7769 7468 2072 616e 646f 6d20 6461  e with random da
+00004460: 7461 0a20 2020 2062 6f64 7920 3d20 2727  ta.    body = ''
+00004470: 2e6a 6f69 6e28 6368 6f69 6365 2873 7472  .join(choice(str
+00004480: 5f61 6c70 6861 202b 2073 7472 5f6e 756d  _alpha + str_num
+00004490: 2920 666f 7220 5f20 696e 2072 616e 6765  ) for _ in range
+000044a0: 2862 6f64 795f 6c65 6e29 290a 2020 2020  (body_len)).    
+000044b0: 626f 6479 203d 2027 5c72 5c6e 272e 6a6f  body = '\r\n'.jo
+000044c0: 696e 285b 626f 6479 5b69 3a20 6920 2b20  in([body[i: i + 
+000044d0: 726f 775d 2066 6f72 2069 2069 6e20 7261  row] for i in ra
+000044e0: 6e67 6528 302c 206c 656e 2862 6f64 7929  nge(0, len(body)
+000044f0: 2c20 726f 7729 5d29 0a0a 2020 2020 2320  , row)])..    # 
+00004500: 7468 6520 6e65 7720 6c69 6e65 7320 6164  the new lines ad
+00004510: 6420 6120 6c61 7267 6520 616d 6f75 6e74  d a large amount
+00004520: 2074 6f20 6f75 7220 626f 6479 3b20 6c65   to our body; le
+00004530: 7473 2066 6f72 6365 2074 6865 2063 6f6e  ts force the con
+00004540: 7465 6e74 0a20 2020 2023 2062 6163 6b20  tent.    # back 
+00004550: 746f 2062 6569 6e67 2031 3032 3420 6368  to being 1024 ch
+00004560: 6172 6163 7465 7273 2e0a 2020 2020 626f  aracters..    bo
+00004570: 6479 203d 2062 6f64 795b 303a 3130 3234  dy = body[0:1024
+00004580: 5d0a 0a20 2020 2023 2043 7265 6174 6520  ]..    # Create 
+00004590: 6f75 7220 7469 746c 6520 7573 696e 6720  our title using 
+000045a0: 7261 6e64 6f6d 2064 6174 610a 2020 2020  random data.    
+000045b0: 7469 746c 6520 3d20 2727 2e6a 6f69 6e28  title = ''.join(
+000045c0: 6368 6f69 6365 2873 7472 5f61 6c70 6861  choice(str_alpha
+000045d0: 202b 2073 7472 5f6e 756d 2920 666f 7220   + str_num) for 
+000045e0: 5f20 696e 2072 616e 6765 2874 6974 6c65  _ in range(title
+000045f0: 5f6c 656e 2929 0a0a 2020 2020 230a 2020  _len))..    #.  
+00004600: 2020 2320 4669 7273 7420 5465 7374 3a20    # First Test: 
+00004610: 5472 756e 6361 7465 6420 5469 746c 650a  Truncated Title.
+00004620: 2020 2020 230a 2020 2020 636c 6173 7320      #.    class 
+00004630: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+00004640: 284e 6f74 6966 7942 6173 6529 3a0a 0a20  (NotifyBase):.. 
+00004650: 2020 2020 2020 2023 2054 6573 7420 7469         # Test ti
+00004660: 746c 6520 6d61 7820 6c65 6e67 7468 0a20  tle max length. 
+00004670: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
+00004680: 6c65 6e20 3d20 3130 0a0a 2020 2020 2020  len = 10..      
+00004690: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
+000046a0: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
+000046b0: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
+000046c0: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
+000046d0: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
+000046e0: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
+000046f0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00004700: 2020 2020 2020 2020 2073 7570 6572 2829           super()
+00004710: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
+00004720: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
+00004730: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
+00004740: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00004750: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
+00004760: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
+00004770: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
+00004780: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00004790: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
+000047a0: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
+000047b0: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
+000047c0: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
+000047d0: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
+000047e0: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
+000047f0: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
+00004800: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
+00004810: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
+00004820: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
+00004830: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
+00004840: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
+00004850: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
+00004860: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
+00004870: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00004880: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00004890: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
+000048a0: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
+000048b0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+000048c0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
+000048d0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+000048e0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+000048f0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+00004900: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
+00004910: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00004920: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00004930: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
+00004940: 6974 6c65 290a 2020 2020 6173 7365 7274  itle).    assert
+00004950: 206c 656e 2863 6875 6e6b 7329 203d 3d20   len(chunks) == 
+00004960: 310a 2020 2020 6173 7365 7274 2062 6f64  1.    assert bod
+00004970: 792e 6c73 7472 6970 2827 5c72 5c6e 5c78  y.lstrip('\r\n\x
+00004980: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+00004990: 2920 3d3d 2063 6875 6e6b 735b 305d 2e67  ) == chunks[0].g
+000049a0: 6574 2827 626f 6479 2729 0a20 2020 2061  et('body').    a
+000049b0: 7373 6572 7420 7469 746c 655b 303a 6f62  ssert title[0:ob
+000049c0: 6a2e 7469 746c 655f 6d61 786c 656e 5d20  j.title_maxlen] 
+000049d0: 3d3d 2063 6875 6e6b 735b 305d 2e67 6574  == chunks[0].get
+000049e0: 2827 7469 746c 6527 290a 0a20 2020 2023  ('title')..    #
+000049f0: 0a20 2020 2023 204e 6578 7420 5465 7374  .    # Next Test
+00004a00: 3a20 4c69 6e65 2043 6f75 6e74 2043 6f6e  : Line Count Con
+00004a10: 7472 6f6c 0a20 2020 2023 0a0a 2020 2020  trol.    #..    
+00004a20: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
+00004a30: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
+00004a40: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
+00004a50: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
+00004a60: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
+00004a70: 6c65 5f6d 6178 6c65 6e20 3d20 350a 0a20  le_maxlen = 5.. 
+00004a80: 2020 2020 2020 2023 204d 6178 696d 756d         # Maximum
+00004a90: 206e 756d 6265 7220 6f66 206c 696e 6573   number of lines
+00004aa0: 0a20 2020 2020 2020 2062 6f64 795f 6d61  .        body_ma
+00004ab0: 785f 6c69 6e65 5f63 6f75 6e74 203d 2035  x_line_count = 5
+00004ac0: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+00004ad0: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+00004ae0: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+00004af0: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+00004b00: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00004b10: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00004b20: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00004b30: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00004b40: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00004b50: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00004b60: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+00004b70: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00004b80: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00004b90: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+00004ba0: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+00004bb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00004bc0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+00004bd0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+00004be0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+00004bf0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+00004c00: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+00004c10: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
+00004c20: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+00004c30: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+00004c40: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+00004c50: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+00004c60: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+00004c70: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+00004c80: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+00004c90: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+00004ca0: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+00004cb0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00004cc0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00004cd0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+00004ce0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00004cf0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00004d00: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+00004d10: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00004d20: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00004d30: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+00004d40: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00004d50: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00004d60: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+00004d70: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+00004d80: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00004d90: 6e6b 7329 203d 3d20 310a 2020 2020 6173  nks) == 1.    as
+00004da0: 7365 7274 206c 656e 2863 6875 6e6b 735b  sert len(chunks[
+00004db0: 305d 2e67 6574 2827 626f 6479 2729 2e73  0].get('body').s
+00004dc0: 706c 6974 2827 5c6e 2729 2920 3d3d 206f  plit('\n')) == o
+00004dd0: 626a 2e62 6f64 795f 6d61 785f 6c69 6e65  bj.body_max_line
+00004de0: 5f63 6f75 6e74 0a20 2020 2061 7373 6572  _count.    asser
+00004df0: 7420 7469 746c 655b 303a 6f62 6a2e 7469  t title[0:obj.ti
+00004e00: 746c 655f 6d61 786c 656e 5d20 3d3d 2063  tle_maxlen] == c
+00004e10: 6875 6e6b 735b 305d 2e67 6574 2827 7469  hunks[0].get('ti
+00004e20: 746c 6527 290a 0a20 2020 2023 0a20 2020  tle')..    #.   
+00004e30: 2023 204e 6578 7420 5465 7374 3a20 5370   # Next Test: Sp
+00004e40: 6c69 7420 626f 6479 0a20 2020 2023 0a0a  lit body.    #..
+00004e50: 2020 2020 636c 6173 7320 5465 7374 4e6f      class TestNo
+00004e60: 7469 6669 6361 7469 6f6e 284e 6f74 6966  tification(Notif
+00004e70: 7942 6173 6529 3a0a 0a20 2020 2020 2020  yBase):..       
+00004e80: 2023 2054 6573 7420 7469 746c 6520 6d61   # Test title ma
+00004e90: 7820 6c65 6e67 7468 0a20 2020 2020 2020  x length.       
+00004ea0: 2074 6974 6c65 5f6d 6178 6c65 6e20 3d20   title_maxlen = 
+00004eb0: 7469 746c 655f 6c65 6e0a 0a20 2020 2020  title_len..     
+00004ec0: 2020 2023 2045 6e66 6f72 6365 2061 2062     # Enforce a b
+00004ed0: 6f64 7920 6c65 6e67 7468 2e20 4d61 6b65  ody length. Make
+00004ee0: 2073 7572 6520 6974 2773 2061 6e20 696e   sure it's an in
+00004ef0: 742e 0a20 2020 2020 2020 2062 6f64 795f  t..        body_
+00004f00: 6d61 786c 656e 203d 2069 6e74 2862 6f64  maxlen = int(bod
+00004f10: 795f 6c65 6e20 2f20 3429 0a0a 2020 2020  y_len / 4)..    
+00004f20: 2020 2020 2320 5769 7468 2061 6d61 6c67      # With amalg
+00004f30: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
+00004f40: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
+00004f50: 6174 655f 7469 746c 6520 3d20 5472 7565  ate_title = True
+00004f60: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
+00004f70: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
+00004f80: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+00004f90: 2020 2020 2020 2020 2020 2073 7570 6572             super
+00004fa0: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
+00004fb0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
+00004fc0: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
+00004fd0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00004fe0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00004ff0: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
+00005000: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
+00005010: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+00005020: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
+00005030: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
+00005040: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
+00005050: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
+00005060: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
+00005070: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
+00005080: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
+00005090: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
+000050a0: 7765 2062 7265 616b 2074 6865 2074 6974  we break the tit
+000050b0: 6c65 2074 6f20 6120 6d61 7820 6c65 6e67  le to a max leng
+000050c0: 7468 206f 6620 6f75 7220 7469 746c 655f  th of our title_
+000050d0: 6d61 780a 2020 2020 2320 616e 6420 7468  max.    # and th
+000050e0: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
+000050f0: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
+00005100: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00005110: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00005120: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
+00005130: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
+00005140: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00005150: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+00005160: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+00005170: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00005180: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+00005190: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+000051a0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+000051b0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+000051c0: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+000051d0: 3d74 6974 6c65 290a 2020 2020 6f66 6673  =title).    offs
+000051e0: 6574 203d 2030 0a20 2020 2061 7373 6572  et = 0.    asser
+000051f0: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
+00005200: 2035 0a20 2020 2066 6f72 2069 6478 2c20   5.    for idx, 
+00005210: 6368 756e 6b20 696e 2065 6e75 6d65 7261  chunk in enumera
+00005220: 7465 2863 6875 6e6b 732c 2073 7461 7274  te(chunks, start
+00005230: 3d31 293a 0a20 2020 2020 2020 2023 2056  =1):.        # V
+00005240: 6572 6966 6963 6174 696f 6e0a 2020 2020  erification.    
+00005250: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00005260: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+00005270: 2929 203c 3d20 6f62 6a2e 7469 746c 655f  )) <= obj.title_
+00005280: 6d61 786c 656e 0a20 2020 2020 2020 2061  maxlen.        a
+00005290: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
+000052a0: 6765 7428 2762 6f64 7927 2929 203c 3d20  get('body')) <= 
+000052b0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e0a  obj.body_maxlen.
+000052c0: 0a20 2020 2020 2020 2023 204e 6f20 636f  .        # No co
+000052d0: 756e 7465 7220 6973 2064 6973 706c 6179  unter is display
+000052e0: 6564 2062 6563 6175 7365 206f 7572 2074  ed because our t
+000052f0: 6974 6c65 2069 7320 736f 2065 6e6f 726d  itle is so enorm
+00005300: 6f75 730a 2020 2020 2020 2020 2320 5765  ous.        # We
+00005310: 2073 7769 7463 6820 746f 2061 2064 6973   switch to a dis
+00005320: 706c 6179 2074 6974 6c65 206f 6e20 6669  play title on fi
+00005330: 7273 7420 6d65 7373 6167 6520 6f6e 6c79  rst message only
+00005340: 0a20 2020 2020 2020 2069 6620 6964 7820  .        if idx 
+00005350: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+00005360: 2023 2045 6d70 7479 2028 6e6f 2074 6974   # Empty (no tit
+00005370: 6c65 2064 6973 706c 6179 6564 206f 6e20  le displayed on 
+00005380: 666f 6c6c 6f77 696e 6720 656e 7472 6965  following entrie
+00005390: 730a 2020 2020 2020 2020 2020 2020 6173  s.            as
+000053a0: 7365 7274 2063 6875 6e6b 2e67 6574 2827  sert chunk.get('
+000053b0: 7469 746c 6527 2920 3d3d 2022 220a 2020  title') == "".  
+000053c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000053d0: 2020 2020 2020 2020 2320 5468 6520 6c65          # The le
+000053e0: 6e67 7468 206f 6620 7468 6520 626f 6479  ngth of the body
+000053f0: 2070 7265 7661 696c 7320 6f75 7220 7469   prevails our ti
+00005400: 746c 6520 6475 6520 746f 2069 7420 6265  tle due to it be
+00005410: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00005420: 2320 736f 206d 7563 6820 736d 616c 6c65  # so much smalle
+00005430: 7220 7468 656e 206f 7572 2074 6974 6c65  r then our title
+00005440: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+00005450: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00005460: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+00005470: 2929 203d 3d20 6f62 6a2e 626f 6479 5f6d  )) == obj.body_m
+00005480: 6178 6c65 6e0a 2020 2020 2020 2020 2020  axlen.          
+00005490: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
+000054a0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e5d  obj.body_maxlen]
+000054b0: 203d 3d20 6368 756e 6b2e 6765 7428 2774   == chunk.get('t
+000054c0: 6974 6c65 2729 0a0a 2020 2020 2020 2020  itle')..        
+000054d0: 2320 4f75 7220 626f 6479 2069 7320 6f6e  # Our body is on
+000054e0: 6c79 2062 726f 6b65 6e20 7570 3b20 6e6f  ly broken up; no
+000054f0: 7420 6c6f 7374 0a20 2020 2020 2020 205f  t lost.        _
+00005500: 626f 6479 203d 2063 6875 6e6b 2e67 6574  body = chunk.get
+00005510: 2827 626f 6479 2729 0a20 2020 2020 2020  ('body').       
+00005520: 2061 7373 6572 7420 626f 6479 5b6f 6666   assert body[off
+00005530: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+00005540: 2b20 6f66 6673 6574 5d5c 0a20 2020 2020  + offset]\.     
+00005550: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+00005560: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+00005570: 7374 7269 7028 2920 3d3d 205f 626f 6479  strip() == _body
+00005580: 0a20 2020 2020 2020 206f 6666 7365 7420  .        offset 
+00005590: 2b3d 206c 656e 285f 626f 6479 290a 0a20  += len(_body).. 
+000055a0: 2020 2023 2041 6e6f 7468 6572 2065 6467     # Another edg
+000055b0: 6520 6361 7365 2077 6865 7265 2074 6865  e case where the
+000055c0: 2074 6974 6c65 206a 7573 7420 6973 6e27   title just isn'
+000055d0: 7420 7468 6174 206c 6f6e 6720 6c65 6176  t that long leav
+000055e0: 696e 670a 2020 2020 2320 6120 6c6f 7420  ing.    # a lot 
+000055f0: 6f66 2073 7061 6365 2066 6f72 2074 6865  of space for the
+00005600: 205b 7878 2f78 785d 2065 6e74 7269 6573   [xx/xx] entries
+00005610: 2028 6e6f 2074 7275 6e63 6174 696f 6e20   (no truncation 
+00005620: 6e65 6564 6564 290a 2020 2020 6368 756e  needed).    chun
+00005630: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00005640: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
+00005650: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00005660: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00005670: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00005680: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
+00005690: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+000056a0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+000056b0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
+000056c0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+000056d0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+000056e0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+000056f0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
+00005700: 5b3a 3230 5d29 0a20 2020 206f 6666 7365  [:20]).    offse
+00005710: 7420 3d20 300a 2020 2020 635f 6c65 6e20  t = 0.    c_len 
+00005720: 3d20 6c65 6e28 2720 5b58 2f58 5d27 290a  = len(' [X/X]').
+00005730: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00005740: 6875 6e6b 7329 203d 3d20 350a 2020 2020  hunks) == 5.    
+00005750: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
+00005760: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
+00005770: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
+00005780: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
+00005790: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
+000057a0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
+000057b0: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
+000057c0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
+000057d0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000057e0: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
+000057f0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
+00005800: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
+00005810: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
+00005820: 7320 6120 636f 756e 7465 7220 6164 6465  s a counter adde
+00005830: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
+00005840: 6173 7365 7274 2074 6974 6c65 5b3a 3230  assert title[:20
+00005850: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
+00005860: 7469 746c 6527 295b 3a2d 635f 6c65 6e5d  title')[:-c_len]
+00005870: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00005880: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+00005890: 2729 5b2d 635f 6c65 6e3a 5d20 3d3d 205c  ')[-c_len:] == \
+000058a0: 0a20 2020 2020 2020 2020 2020 2027 205b  .            ' [
+000058b0: 7b3a 3031 7d2f 7b3a 3031 7d5d 272e 666f  {:01}/{:01}]'.fo
+000058c0: 726d 6174 2869 6478 2c20 6c65 6e28 6368  rmat(idx, len(ch
+000058d0: 756e 6b73 2929 0a20 2020 2020 2020 2023  unks)).        #
+000058e0: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+000058f0: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+00005900: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+00005910: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+00005920: 2762 6f64 7927 290a 2020 2020 2020 2020  'body').        
+00005930: 6173 7365 7274 2062 6f64 795b 6f66 6673  assert body[offs
+00005940: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00005950: 206f 6666 7365 745d 5c0a 2020 2020 2020   offset]\.      
+00005960: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+00005970: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+00005980: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
+00005990: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
+000059a0: 3d20 6c65 6e28 5f62 6f64 7929 0a0a 2020  = len(_body)..  
+000059b0: 2020 230a 2020 2020 2320 5465 7374 2066    #.    # Test f
+000059c0: 6f72 6369 6e67 206f 7665 7266 6c6f 775f  orcing overflow_
+000059d0: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
+000059e0: 6365 0a20 2020 2023 0a20 2020 2063 6c61  ce.    #.    cla
+000059f0: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
+00005a00: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+00005a10: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
+00005a20: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
+00005a30: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
+00005a40: 6d61 786c 656e 203d 2074 6974 6c65 5f6c  maxlen = title_l
+00005a50: 656e 0a0a 2020 2020 2020 2020 2320 456e  en..        # En
+00005a60: 666f 7263 6520 6120 626f 6479 206c 656e  force a body len
+00005a70: 6774 682e 204d 616b 6520 7375 7265 2069  gth. Make sure i
+00005a80: 7427 7320 616e 2069 6e74 2e0a 2020 2020  t's an int..    
+00005a90: 2020 2020 626f 6479 5f6d 6178 6c65 6e20      body_maxlen 
+00005aa0: 3d20 696e 7428 626f 6479 5f6c 656e 202f  = int(body_len /
+00005ab0: 2034 290a 0a20 2020 2020 2020 2023 2057   4)..        # W
+00005ac0: 6974 6820 616d 616c 6761 6d61 7469 6f6e  ith amalgamation
+00005ad0: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
+00005ae0: 775f 616d 616c 6761 6d61 7465 5f74 6974  w_amalgamate_tit
+00005af0: 6c65 203d 2054 7275 650a 0a20 2020 2020  le = True..     
+00005b00: 2020 2023 2020 4f6e 6c79 2064 6973 706c     #  Only displ
+00005b10: 6179 2074 6974 6c65 206f 6e63 650a 2020  ay title once.  
+00005b20: 2020 2020 2020 6f76 6572 666c 6f77 5f64        overflow_d
+00005b30: 6973 706c 6179 5f74 6974 6c65 5f6f 6e63  isplay_title_onc
+00005b40: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+00005b50: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00005b60: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00005b70: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+00005b80: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+00005b90: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
+00005ba0: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
+00005bb0: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
+00005bc0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00005bd0: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
+00005be0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
+00005bf0: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
+00005c00: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00005c10: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
+00005c20: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
+00005c30: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
+00005c40: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
+00005c50: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
+00005c60: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
+00005c70: 4e6f 6e65 0a0a 2020 2020 6368 756e 6b73  None..    chunks
+00005c80: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00005c90: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+00005ca0: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
+00005cb0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00005cc0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00005cd0: 6479 3d22 222c 2074 6974 6c65 3d22 2229  dy="", title="")
+00005ce0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00005cf0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00005d00: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+00005d10: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+00005d20: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00005d30: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+00005d40: 792c 2074 6974 6c65 3d74 6974 6c65 290a  y, title=title).
+00005d50: 2020 2020 6f66 6673 6574 203d 2030 0a20      offset = 0. 
+00005d60: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00005d70: 756e 6b73 2920 3d3d 2035 0a20 2020 2066  unks) == 5.    f
+00005d80: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
+00005d90: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+00005da0: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
+00005db0: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
+00005dc0: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
+00005dd0: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+00005de0: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
+00005df0: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+00005e00: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00005e10: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
+00005e20: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
+00005e30: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
+00005e40: 2023 204f 7572 2074 6974 6c65 2068 6173   # Our title has
+00005e50: 206e 6f20 636f 756e 7465 7220 6164 6465   no counter adde
+00005e60: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
+00005e70: 6966 2069 6478 203e 2031 3a0a 2020 2020  if idx > 1:.    
+00005e80: 2020 2020 2020 2020 2320 456d 7074 7920          # Empty 
+00005e90: 286e 6f20 7469 746c 6520 6469 7370 6c61  (no title displa
+00005ea0: 7965 6420 6f6e 2066 6f6c 6c6f 7769 6e67  yed on following
+00005eb0: 2065 6e74 7269 6573 0a20 2020 2020 2020   entries.       
+00005ec0: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
+00005ed0: 6b2e 6765 7428 2774 6974 6c65 2729 203d  k.get('title') =
+00005ee0: 3d20 2222 0a20 2020 2020 2020 2065 6c73  = "".        els
+00005ef0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+00005f00: 2054 6865 2062 6f64 7920 6c65 6e67 7468   The body length
+00005f10: 2070 7265 7661 696c 7320 6475 6520 746f   prevails due to
+00005f20: 206f 7572 2061 6d61 6c67 616d 6174 696f   our amalgamatio
+00005f30: 6e20 666c 6167 0a20 2020 2020 2020 2020  n flag.         
+00005f40: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00005f50: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
+00005f60: 2920 3d3d 206f 626a 2e62 6f64 795f 6d61  ) == obj.body_ma
+00005f70: 786c 656e 0a20 2020 2020 2020 2020 2020  xlen.           
+00005f80: 2061 7373 6572 7420 7469 746c 655b 3a6f   assert title[:o
+00005f90: 626a 2e62 6f64 795f 6d61 786c 656e 5d20  bj.body_maxlen] 
+00005fa0: 3d3d 2063 6875 6e6b 2e67 6574 2827 7469  == chunk.get('ti
+00005fb0: 746c 6527 290a 0a20 2020 2020 2020 2023  tle')..        #
+00005fc0: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+00005fd0: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+00005fe0: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+00005ff0: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+00006000: 2762 6f64 7927 290a 2020 2020 2020 2020  'body').        
+00006010: 6173 7365 7274 2062 6f64 795b 6f66 6673  assert body[offs
+00006020: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00006030: 206f 6666 7365 745d 5c0a 2020 2020 2020   offset]\.      
+00006040: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+00006050: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+00006060: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
+00006070: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
+00006080: 3d20 6c65 6e28 5f62 6f64 7929 0a0a 2020  = len(_body)..  
+00006090: 2020 2320 5465 7374 206c 6172 6765 7220    # Test larger 
+000060a0: 6d65 7373 6167 6573 0a20 2020 2023 2061  messages.    # a
+000060b0: 6e64 2074 6861 7420 7468 6520 626f 6479  nd that the body
+000060c0: 2072 656d 6169 6e73 2075 6e74 6f75 6368   remains untouch
+000060d0: 6564 0a20 2020 2063 6c61 7373 2054 6573  ed.    class Tes
+000060e0: 744e 6f74 6966 6963 6174 696f 6e28 4e6f  tNotification(No
+000060f0: 7469 6679 4261 7365 293a 0a0a 2020 2020  tifyBase):..    
+00006100: 2020 2020 2320 5465 7374 2074 6974 6c65      # Test title
+00006110: 206d 6178 206c 656e 6774 680a 2020 2020   max length.    
+00006120: 2020 2020 7469 746c 655f 6d61 786c 656e      title_maxlen
+00006130: 203d 2031 3530 0a0a 2020 2020 2020 2020   = 150..        
+00006140: 2320 456e 666f 7263 6520 6120 626f 6479  # Enforce a body
+00006150: 206c 656e 6774 682e 204d 616b 6520 7375   length. Make su
+00006160: 7265 2069 7427 7320 616e 2069 6e74 2e0a  re it's an int..
+00006170: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
+00006180: 6c65 6e20 3d20 3430 300a 0a20 2020 2020  len = 400..     
+00006190: 2020 2023 2057 6974 6820 616d 616c 6761     # With amalga
+000061a0: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
+000061b0: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
+000061c0: 7465 5f74 6974 6c65 203d 2054 7275 650a  te_title = True.
+000061d0: 0a20 2020 2020 2020 2064 6566 205f 5f69  .        def __i
+000061e0: 6e69 745f 5f28 7365 6c66 2c20 2a61 7267  nit__(self, *arg
+000061f0: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+00006200: 2020 2020 2020 2020 2020 7375 7065 7228            super(
+00006210: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7761  ).__init__(**kwa
+00006220: 7267 7329 0a0a 2020 2020 2020 2020 6465  rgs)..        de
+00006230: 6620 6e6f 7469 6679 2873 656c 662c 202a  f notify(self, *
+00006240: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00006250: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
+00006260: 7265 7465 6e64 2065 7665 7279 7468 696e  retend everythin
+00006270: 6720 6973 206f 6b61 790a 2020 2020 2020  g is okay.      
+00006280: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00006290: 650a 0a20 2020 2023 204c 6f61 6420 6f75  e..    # Load ou
+000062a0: 7220 6f62 6a65 6374 0a20 2020 206f 626a  r object.    obj
+000062b0: 203d 2054 6573 744e 6f74 6966 6963 6174   = TestNotificat
+000062c0: 696f 6e28 6f76 6572 666c 6f77 3d4f 7665  ion(overflow=Ove
+000062d0: 7266 6c6f 774d 6f64 652e 5350 4c49 5429  rflowMode.SPLIT)
+000062e0: 0a20 2020 2061 7373 6572 7420 6f62 6a20  .    assert obj 
+000062f0: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
+00006300: 206e 6577 5f62 6f64 7920 3d20 2862 6f64   new_body = (bod
+00006310: 7920 2a20 3530 3029 0a20 2020 2063 6875  y * 500).    chu
+00006320: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00006330: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00006340: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00006350: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00006360: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00006370: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00006380: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+00006390: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+000063a0: 666c 6f77 2862 6f64 793d 6e65 775f 626f  flow(body=new_bo
+000063b0: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
+000063c0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+000063d0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+000063e0: 6f64 793d 6e65 775f 626f 6479 2c20 7469  ody=new_body, ti
+000063f0: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
+00006400: 6666 7365 7420 3d20 300a 2020 2020 635f  ffset = 0.    c_
+00006410: 6c65 6e20 3d20 6c65 6e28 2720 5b58 5858  len = len(' [XXX
+00006420: 582f 5858 5858 5d27 290a 2020 2020 6173  X/XXXX]').    as
+00006430: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+00006440: 203d 3d20 3230 3438 0a20 2020 2066 6f72   == 2048.    for
+00006450: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+00006460: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+00006470: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+00006480: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+00006490: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+000064a0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+000064b0: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+000064c0: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+000064d0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000064e0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+000064f0: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+00006500: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+00006510: 204f 7572 2074 6974 6c65 2068 6173 2061   Our title has a
+00006520: 2063 6f75 6e74 6572 2061 6464 6564 2074   counter added t
+00006530: 6f20 6974 0a20 2020 2020 2020 2061 7373  o it.        ass
+00006540: 6572 7420 7469 746c 655b 3a6f 626a 2e74  ert title[:obj.t
+00006550: 6974 6c65 5f6d 6178 6c65 6e5d 5b3a 2d63  itle_maxlen][:-c
+00006560: 5f6c 656e 5d20 3d3d 2063 6875 6e6b 2e67  _len] == chunk.g
+00006570: 6574 2827 7469 746c 6527 295b 3a2d 635f  et('title')[:-c_
+00006580: 6c65 6e5d 0a20 2020 2020 2020 2061 7373  len].        ass
+00006590: 6572 7420 6368 756e 6b2e 6765 7428 2774  ert chunk.get('t
+000065a0: 6974 6c65 2729 5b2d 635f 6c65 6e3a 5d20  itle')[-c_len:] 
+000065b0: 3d3d 205c 0a20 2020 2020 2020 2020 2020  == \.           
+000065c0: 2027 205b 7b3a 3034 7d2f 7b3a 3034 7d5d   ' [{:04}/{:04}]
+000065d0: 272e 666f 726d 6174 2869 6478 2c20 6c65  '.format(idx, le
+000065e0: 6e28 6368 756e 6b73 2929 0a0a 2020 2020  n(chunks))..    
+000065f0: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
+00006600: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
+00006610: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
+00006620: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
+00006630: 2e67 6574 2827 626f 6479 2729 0a0a 2020  .get('body')..  
+00006640: 2020 2020 2020 2320 556e 2d75 7365 6420        # Un-used 
+00006650: 7768 6974 6573 7061 6365 2069 7320 616c  whitespace is al
+00006660: 7761 7973 2063 6c65 616e 6564 2075 703b  ways cleaned up;
+00006670: 206d 616b 6520 7375 7265 2077 6520 6163   make sure we ac
+00006680: 636f 756e 7420 666f 720a 2020 2020 2020  count for.      
+00006690: 2020 2320 7468 6973 2069 6e20 6f75 7220    # this in our 
+000066a0: 6e65 7720 6361 6c63 756c 6174 696f 6e0a  new calculation.
+000066b0: 2020 2020 2020 2020 7773 5f64 6966 6620          ws_diff 
+000066c0: 3d20 6c65 6e28 6e65 775f 626f 6479 5b6f  = len(new_body[o
+000066d0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+000066e0: 2920 2b20 6f66 6673 6574 5d29 202d 205c  ) + offset]) - \
+000066f0: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+00006700: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
+00006710: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+00006720: 6666 7365 745d 0a20 2020 2020 2020 2020  ffset].         
+00006730: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+00006740: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+00006750: 7374 7269 7028 2929 0a0a 2020 2020 2020  strip())..      
+00006760: 2020 6173 7365 7274 206e 6577 5f62 6f64    assert new_bod
+00006770: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
+00006780: 6f64 7929 202b 206f 6666 7365 7420 2b20  ody) + offset + 
+00006790: 7773 5f64 6966 665d 5c0a 2020 2020 2020  ws_diff]\.      
+000067a0: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+000067b0: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+000067c0: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
+000067d0: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
+000067e0: 3d20 286c 656e 285f 626f 6479 2920 2b20  = (len(_body) + 
+000067f0: 7773 5f64 6966 6629 0a0a 2020 2020 2320  ws_diff)..    # 
+00006800: 426f 6479 2063 6875 6e6b 2069 7320 6265  Body chunk is be
+00006810: 796f 6e64 2034 2064 6967 6974 732c 2073  yond 4 digits, s
+00006820: 6f20 5b58 5858 582f 5858 5858 5d20 6973  o [XXXX/XXXX] is
+00006830: 2074 7572 6e65 6420 6f66 660a 2020 2020   turned off.    
+00006840: 6e65 775f 626f 6479 203d 2028 626f 6479  new_body = (body
+00006850: 202a 2032 3530 3029 0a20 2020 2063 6875   * 2500).    chu
+00006860: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00006870: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00006880: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00006890: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+000068a0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+000068b0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+000068c0: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+000068d0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+000068e0: 666c 6f77 2862 6f64 793d 6e65 775f 626f  flow(body=new_bo
+000068f0: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
+00006900: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00006910: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00006920: 6f64 793d 6e65 775f 626f 6479 2c20 7469  ody=new_body, ti
+00006930: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
+00006940: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
+00006950: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+00006960: 203d 3d20 3130 3234 300a 2020 2020 666f   == 10240.    fo
+00006970: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+00006980: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+00006990: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+000069a0: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+000069b0: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+000069c0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+000069d0: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+000069e0: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+000069f0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00006a00: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+00006a10: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+00006a20: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
+00006a30: 2320 4f75 7220 7469 746c 6520 6861 7320  # Our title has 
+00006a40: 6e6f 2063 6f75 6e74 6572 2061 6464 6564  no counter added
+00006a50: 2074 6f20 6974 0a20 2020 2020 2020 2061   to it.        a
+00006a60: 7373 6572 7420 7469 746c 655b 3a6f 626a  ssert title[:obj
+00006a70: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
+00006a80: 3d20 6368 756e 6b2e 6765 7428 2774 6974  = chunk.get('tit
+00006a90: 6c65 2729 0a0a 2020 2020 2020 2020 2320  le')..        # 
+00006aa0: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
+00006ab0: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
+00006ac0: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
+00006ad0: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
+00006ae0: 626f 6479 2729 0a0a 2020 2020 2020 2020  body')..        
+00006af0: 2320 556e 2d75 7365 6420 7768 6974 6573  # Un-used whites
+00006b00: 7061 6365 2069 7320 616c 7761 7973 2063  pace is always c
+00006b10: 6c65 616e 6564 2075 703b 206d 616b 6520  leaned up; make 
+00006b20: 7375 7265 2077 6520 6163 636f 756e 7420  sure we account 
+00006b30: 666f 720a 2020 2020 2020 2020 2320 7468  for.        # th
+00006b40: 6973 2069 6e20 6f75 7220 6e65 7720 6361  is in our new ca
+00006b50: 6c63 756c 6174 696f 6e0a 2020 2020 2020  lculation.      
+00006b60: 2020 7773 5f64 6966 6620 3d20 6c65 6e28    ws_diff = len(
+00006b70: 6e65 775f 626f 6479 5b6f 6666 7365 743a  new_body[offset:
+00006b80: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
+00006b90: 6673 6574 5d29 202d 205c 0a20 2020 2020  fset]) - \.     
+00006ba0: 2020 2020 2020 206c 656e 286e 6577 5f62         len(new_b
+00006bb0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+00006bc0: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+00006bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006be0: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+00006bf0: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+00006c00: 2929 0a0a 2020 2020 2020 2020 6173 7365  ))..        asse
+00006c10: 7274 206e 6577 5f62 6f64 795b 6f66 6673  rt new_body[offs
+00006c20: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00006c30: 206f 6666 7365 7420 2b20 7773 5f64 6966   offset + ws_dif
+00006c40: 665d 5c0a 2020 2020 2020 2020 2020 2020  f]\.            
+00006c50: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
+00006c60: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
+00006c70: 203d 3d20 5f62 6f64 790a 2020 2020 2020   == _body.      
+00006c80: 2020 6f66 6673 6574 202b 3d20 286c 656e    offset += (len
+00006c90: 285f 626f 6479 2920 2b20 7773 5f64 6966  (_body) + ws_dif
+00006ca0: 6629 0a0a 2020 2020 2320 5465 7374 206c  f)..    # Test l
+00006cb0: 6172 6765 7220 6d65 7373 6167 6573 0a20  arger messages. 
+00006cc0: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+00006cd0: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+00006ce0: 6e74 6f75 6368 6564 0a20 2020 2063 6c61  ntouched.    cla
+00006cf0: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
+00006d00: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+00006d10: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
+00006d20: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
+00006d30: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
+00006d40: 6d61 786c 656e 203d 2031 3530 0a0a 2020  maxlen = 150..  
+00006d50: 2020 2020 2020 2320 456e 666f 7263 6520        # Enforce 
+00006d60: 6120 626f 6479 206c 656e 6774 682e 204d  a body length. M
+00006d70: 616b 6520 7375 7265 2069 7427 7320 616e  ake sure it's an
+00006d80: 2069 6e74 2e0a 2020 2020 2020 2020 626f   int..        bo
+00006d90: 6479 5f6d 6178 6c65 6e20 3d20 3135 300a  dy_maxlen = 150.
+00006da0: 0a20 2020 2020 2020 2023 2057 6974 6820  .        # With 
+00006db0: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
+00006dc0: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
+00006dd0: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
+00006de0: 2054 7275 650a 0a20 2020 2020 2020 2064   True..        d
+00006df0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+00006e00: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00006e10: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00006e20: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
+00006e30: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
+00006e40: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
+00006e50: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00006e60: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+00006e70: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
+00006e80: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
+00006e90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00006ea0: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
+00006eb0: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
+00006ec0: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
+00006ed0: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
+00006ee0: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
+00006ef0: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
+00006f00: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
+00006f10: 650a 0a20 2020 206e 6577 5f62 6f64 7920  e..    new_body 
+00006f20: 3d20 2862 6f64 7920 2a20 3529 0a20 2020  = (body * 5).   
+00006f30: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00006f40: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00006f50: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
+00006f60: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
+00006f70: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00006f80: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00006f90: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+00006fa0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00006fb0: 6f76 6572 666c 6f77 2862 6f64 793d 6e65  overflow(body=ne
+00006fc0: 775f 626f 6479 2c20 7469 746c 653d 2222  w_body, title=""
+00006fd0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00006fe0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00006ff0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
+00007000: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00007010: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+00007020: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00007030: 6e6b 7329 203d 3d20 3336 0a20 2020 2066  nks) == 36.    f
+00007040: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
+00007050: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+00007060: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
+00007070: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
+00007080: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
+00007090: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+000070a0: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
+000070b0: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+000070c0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+000070d0: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
+000070e0: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
+000070f0: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
+00007100: 2023 204f 7572 2074 6974 6c65 2068 6173   # Our title has
+00007110: 206e 6f20 636f 756e 7465 7220 6164 6465   no counter adde
+00007120: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
+00007130: 6966 2069 6478 203e 2031 3a0a 2020 2020  if idx > 1:.    
+00007140: 2020 2020 2020 2020 2320 456d 7074 7920          # Empty 
+00007150: 286e 6f20 7469 746c 6520 6469 7370 6c61  (no title displa
+00007160: 7965 6420 6f6e 2066 6f6c 6c6f 7769 6e67  yed on following
+00007170: 2065 6e74 7269 6573 0a20 2020 2020 2020   entries.       
+00007180: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
+00007190: 6b2e 6765 7428 2774 6974 6c65 2729 203d  k.get('title') =
+000071a0: 3d20 2222 0a20 2020 2020 2020 2065 6c73  = "".        els
+000071b0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+000071c0: 2042 6563 6175 7365 2031 3530 2069 7320   Because 150 is 
+000071d0: 7768 6174 2077 6520 7365 7420 7468 6520  what we set the 
+000071e0: 7469 746c 6520 6c69 6d69 7420 746f 0a20  title limit to. 
+000071f0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00007200: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+00007210: 2774 6974 6c65 2729 2920 3d3d 206f 626a  'title')) == obj
+00007220: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+00007230: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00007240: 2074 6974 6c65 5b3a 6f62 6a2e 7469 746c   title[:obj.titl
+00007250: 655f 6d61 786c 656e 5d20 3d3d 2063 6875  e_maxlen] == chu
+00007260: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
+00007270: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
+00007280: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
+00007290: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
+000072a0: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
+000072b0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+000072c0: 290a 0a20 2020 2020 2020 2023 2055 6e2d  )..        # Un-
+000072d0: 7573 6564 2077 6869 7465 7370 6163 6520  used whitespace 
+000072e0: 6973 2061 6c77 6179 7320 636c 6561 6e65  is always cleane
+000072f0: 6420 7570 3b20 6d61 6b65 2073 7572 6520  d up; make sure 
+00007300: 7765 2061 6363 6f75 6e74 2066 6f72 0a20  we account for. 
+00007310: 2020 2020 2020 2023 2074 6869 7320 696e         # this in
+00007320: 206f 7572 206e 6577 2063 616c 6375 6c61   our new calcula
+00007330: 7469 6f6e 0a20 2020 2020 2020 2077 735f  tion.        ws_
+00007340: 6469 6666 203d 206c 656e 286e 6577 5f62  diff = len(new_b
+00007350: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+00007360: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+00007370: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
+00007380: 2020 6c65 6e28 6e65 775f 626f 6479 5b6f    len(new_body[o
+00007390: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+000073a0: 2920 2b20 6f66 6673 6574 5d0a 2020 2020  ) + offset].    
+000073b0: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
+000073c0: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+000073d0: 6327 292e 7273 7472 6970 2829 290a 0a20  c').rstrip()).. 
+000073e0: 2020 2020 2020 2061 7373 6572 7420 6e65         assert ne
+000073f0: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
+00007400: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+00007410: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
+00007420: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+00007430: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+00007440: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
+00007450: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
+00007460: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
+00007470: 7929 202b 2077 735f 6469 6666 290a 0a20  y) + ws_diff).. 
+00007480: 2020 2023 0a20 2020 2023 204e 6578 7420     #.    # Next 
+00007490: 5465 7374 3a20 4170 7065 6e64 2074 6974  Test: Append tit
+000074a0: 6c65 2074 6f20 626f 6479 202b 2073 706c  le to body + spl
+000074b0: 6974 2062 6f64 790a 2020 2020 230a 0a20  it body.    #.. 
+000074c0: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
+000074d0: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
+000074e0: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
+000074f0: 2320 456e 666f 7263 6520 6e6f 2074 6974  # Enforce no tit
+00007500: 6c65 0a20 2020 2020 2020 2074 6974 6c65  le.        title
+00007510: 5f6d 6178 6c65 6e20 3d20 300a 0a20 2020  _maxlen = 0..   
+00007520: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
+00007530: 2062 6f64 7920 6c65 6e67 7468 2062 6173   body length bas
+00007540: 6564 206f 6e20 7468 6520 7469 746c 652e  ed on the title.
+00007550: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
+00007560: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
+00007570: 626f 6479 5f6d 6178 6c65 6e20 3d20 696e  body_maxlen = in
+00007580: 7428 7469 746c 655f 6c65 6e20 2f20 3429  t(title_len / 4)
+00007590: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+000075a0: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+000075b0: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+000075c0: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+000075d0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+000075e0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+000075f0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00007600: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00007610: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00007620: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00007630: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+00007640: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00007650: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00007660: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+00007670: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+00007680: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00007690: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+000076a0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+000076b0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+000076c0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+000076d0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+000076e0: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
+000076f0: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+00007700: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+00007710: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+00007720: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+00007730: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+00007740: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+00007750: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+00007760: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+00007770: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+00007780: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00007790: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+000077a0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+000077b0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+000077c0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+000077d0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+000077e0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+000077f0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00007800: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+00007810: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00007820: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00007830: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+00007840: 2074 6974 6c65 3d74 6974 6c65 290a 0a20   title=title).. 
+00007850: 2020 2023 204f 7572 2066 696e 616c 2070     # Our final p
+00007860: 726f 6475 6374 2069 7320 7468 6174 206f  roduct is that o
+00007870: 7572 2074 6974 6c65 2068 6173 2062 6565  ur title has bee
+00007880: 6e20 6170 7065 6e64 6564 2074 6f20 6f75  n appended to ou
+00007890: 7220 626f 6479 2074 6f0a 2020 2020 2320  r body to.    # 
+000078a0: 6372 6561 7465 206f 6e65 2067 7265 6174  create one great
+000078b0: 2062 6967 2062 6f64 792e 2041 7320 6120   big body. As a 
+000078c0: 7265 7375 6c74 2077 6527 6c6c 2067 6574  result we'll get
+000078d0: 2071 7569 7465 2061 2066 6577 206c 696e   quite a few lin
+000078e0: 6573 2062 6163 6b0a 2020 2020 2320 6e6f  es back.    # no
+000078f0: 772e 0a20 2020 206f 6666 7365 7420 3d20  w..    offset = 
+00007900: 300a 0a20 2020 2023 204f 7572 2062 6f64  0..    # Our bod
+00007910: 7920 7769 6c6c 206c 6f6f 6b20 6c69 6b65  y will look like
+00007920: 2074 6869 7320 696e 2073 6d61 6c6c 2063   this in small c
+00007930: 6875 6e6b 7320 6174 2074 6865 2065 6e64  hunks at the end
+00007940: 206f 6620 7468 6520 6461 790a 2020 2020   of the day.    
+00007950: 6275 6c6b 203d 2074 6974 6c65 202b 2027  bulk = title + '
+00007960: 5c72 5c6e 2720 2b20 626f 6479 0a0a 2020  \r\n' + body..  
+00007970: 2020 2320 4475 6520 746f 2074 6865 206e    # Due to the n
+00007980: 6577 206c 696e 6520 6164 6465 6420 746f  ew line added to
+00007990: 2074 6865 2065 6e64 0a20 2020 2061 7373   the end.    ass
+000079a0: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+000079b0: 3d3d 2028 0a20 2020 2020 2020 2023 2077  == (.        # w
+000079c0: 7261 7020 6469 7669 7369 6f6e 2069 6e20  rap division in 
+000079d0: 696e 7428 2920 736f 2050 7974 686f 6e20  int() so Python 
+000079e0: 3320 646f 6573 6e27 7420 636f 6e76 6572  3 doesn't conver
+000079f0: 7420 6974 2074 6f20 6120 666c 6f61 7420  t it to a float 
+00007a00: 6f6e 0a20 2020 2020 2020 2023 2075 730a  on.        # us.
+00007a10: 2020 2020 2020 2020 696e 7428 6c65 6e28          int(len(
+00007a20: 6275 6c6b 2920 2f20 6f62 6a2e 626f 6479  bulk) / obj.body
+00007a30: 5f6d 6178 6c65 6e29 202b 0a20 2020 2020  _maxlen) +.     
+00007a40: 2020 2028 3120 6966 206c 656e 2862 756c     (1 if len(bul
+00007a50: 6b29 2025 206f 626a 2e62 6f64 795f 6d61  k) % obj.body_ma
+00007a60: 786c 656e 2065 6c73 6520 3029 290a 0a20  xlen else 0)).. 
+00007a70: 2020 2066 6f72 2063 6875 6e6b 2069 6e20     for chunk in 
+00007a80: 6368 756e 6b73 3a0a 2020 2020 2020 2020  chunks:.        
+00007a90: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
+00007aa0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00007ab0: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
+00007ac0: 6c65 2729 2920 3d3d 2030 0a20 2020 2020  le')) == 0.     
+00007ad0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00007ae0: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
+00007af0: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
+00007b00: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
+00007b10: 7572 2074 6974 6c65 2069 7320 656d 7074  ur title is empt
+00007b20: 7920 6576 6572 7920 7469 6d65 0a20 2020  y every time.   
+00007b30: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
+00007b40: 6b2e 6765 7428 2774 6974 6c65 2729 203d  k.get('title') =
+00007b50: 3d20 2727 0a20 2020 2020 2020 2023 204f  = ''.        # O
+00007b60: 7572 2062 6f64 7920 6973 206f 6e6c 7920  ur body is only 
+00007b70: 6272 6f6b 656e 2075 703b 206e 6f74 206c  broken up; not l
+00007b80: 6f73 740a 2020 2020 2020 2020 5f62 6f64  ost.        _bod
+00007b90: 7920 3d20 6368 756e 6b2e 6765 7428 2762  y = chunk.get('b
+00007ba0: 6f64 7927 290a 0a20 2020 2020 2020 2023  ody')..        #
+00007bb0: 2055 6e2d 7573 6564 2077 6869 7465 7370   Un-used whitesp
+00007bc0: 6163 6520 6973 2061 6c77 6179 7320 636c  ace is always cl
+00007bd0: 6561 6e65 6420 7570 3b20 6d61 6b65 2073  eaned up; make s
+00007be0: 7572 6520 7765 2061 6363 6f75 6e74 2066  ure we account f
+00007bf0: 6f72 0a20 2020 2020 2020 2023 2074 6869  or.        # thi
+00007c00: 7320 696e 206f 7572 206e 6577 2063 616c  s in our new cal
+00007c10: 6375 6c61 7469 6f6e 0a20 2020 2020 2020  culation.       
+00007c20: 2077 735f 6469 6666 203d 206c 656e 2862   ws_diff = len(b
+00007c30: 756c 6b5b 6f66 6673 6574 3a20 6c65 6e28  ulk[offset: len(
+00007c40: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+00007c50: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
+00007c60: 2020 6c65 6e28 6275 6c6b 5b6f 6666 7365    len(bulk[offse
+00007c70: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+00007c80: 6f66 6673 6574 5d0a 2020 2020 2020 2020  offset].        
+00007c90: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+00007ca0: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+00007cb0: 7273 7472 6970 2829 290a 0a20 2020 2020  rstrip())..     
+00007cc0: 2020 2061 7373 6572 7420 6275 6c6b 5b6f     assert bulk[o
+00007cd0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+00007ce0: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
+00007cf0: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
+00007d00: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
+00007d10: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+00007d20: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
+00007d30: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
+00007d40: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
+00007d50: 6469 6666 290a 0a20 2020 2023 0a20 2020  diff)..    #.   
+00007d60: 2023 2054 6573 7420 6361 7365 2077 6865   # Test case whe
+00007d70: 7265 206f 7572 2074 6974 6c65 5f6c 656e  re our title_len
+00007d80: 2069 7320 7368 6f72 7465 7220 7468 656e   is shorter then
+00007d90: 2074 6865 2076 616c 7565 0a20 2020 2023   the value.    #
+00007da0: 2074 6861 7420 776f 756c 6420 6f74 6865   that would othe
+00007db0: 7277 6973 6520 7472 6967 6765 7220 7468  rwise trigger th
+00007dc0: 6520 5b58 582f 5858 5d20 656c 656d 656e  e [XX/XX] elemen
+00007dd0: 7473 0a20 2020 2023 0a0a 2020 2020 636c  ts.    #..    cl
+00007de0: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
+00007df0: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
+00007e00: 3a0a 0a20 2020 2020 2020 2023 2053 6574  :..        # Set
+00007e10: 2061 2073 6d61 6c6c 2074 6974 6c65 206c   a small title l
+00007e20: 656e 6774 680a 2020 2020 2020 2020 7469  ength.        ti
+00007e30: 746c 655f 6d61 786c 656e 203d 2031 3030  tle_maxlen = 100
+00007e40: 0a0a 2020 2020 2020 2020 2320 456e 666f  ..        # Enfo
+00007e50: 7263 6520 6120 626f 6479 206c 656e 6774  rce a body lengt
+00007e60: 682e 204d 616b 6520 7375 7265 2069 7427  h. Make sure it'
+00007e70: 7320 616e 2069 6e74 2e0a 2020 2020 2020  s an int..      
+00007e80: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
+00007e90: 696e 7428 626f 6479 5f6c 656e 202f 2034  int(body_len / 4
+00007ea0: 290a 0a20 2020 2020 2020 2023 2057 6974  )..        # Wit
+00007eb0: 6820 616d 616c 6761 6d61 7469 6f6e 0a20  h amalgamation. 
+00007ec0: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+00007ed0: 616d 616c 6761 6d61 7465 5f74 6974 6c65  amalgamate_title
+00007ee0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+00007ef0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00007f00: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+00007f10: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+00007f20: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+00007f30: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
+00007f40: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
+00007f50: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+00007f60: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00007f70: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
+00007f80: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
+00007f90: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+00007fa0: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
+00007fb0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
+00007fc0: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
+00007fd0: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
+00007fe0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
+00007ff0: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
+00008000: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
+00008010: 6f6e 650a 0a20 2020 2023 2056 6572 6966  one..    # Verif
+00008020: 7920 7468 6174 2077 6520 6272 6561 6b20  y that we break 
+00008030: 7468 6520 7469 746c 6520 746f 2061 206d  the title to a m
+00008040: 6178 206c 656e 6774 6820 6f66 206f 7572  ax length of our
+00008050: 2074 6974 6c65 5f6d 6178 0a20 2020 2023   title_max.    #
+00008060: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
+00008070: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
+00008080: 6368 6564 0a20 2020 2063 6875 6e6b 7320  ched.    chunks 
+00008090: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+000080a0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+000080b0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+000080c0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+000080d0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+000080e0: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
+000080f0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00008100: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00008110: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+00008120: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+00008130: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00008140: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+00008150: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00008160: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+00008170: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00008180: 6e6b 7329 203d 3d20 370a 2020 2020 666f  nks) == 7.    fo
+00008190: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+000081a0: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+000081b0: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+000081c0: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+000081d0: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+000081e0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+000081f0: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+00008200: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+00008210: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00008220: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+00008230: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+00008240: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
+00008250: 2320 4f75 7220 7469 746c 6520 6973 2074  # Our title is t
+00008260: 7275 6e63 6174 6564 2061 6e64 206e 6f20  runcated and no 
+00008270: 636f 756e 7465 7220 6164 6465 640a 2020  counter added.  
+00008280: 2020 2020 2020 6173 7365 7274 2074 6974        assert tit
+00008290: 6c65 5b3a 6f62 6a2e 7469 746c 655f 6d61  le[:obj.title_ma
+000082a0: 786c 656e 5d20 3d3d 2063 6875 6e6b 2e67  xlen] == chunk.g
+000082b0: 6574 2827 7469 746c 6527 290a 0a20 2020  et('title')..   
+000082c0: 2020 2020 2023 204f 7572 2062 6f64 7920       # Our body 
+000082d0: 6973 206f 6e6c 7920 6272 6f6b 656e 2075  is only broken u
+000082e0: 703b 206e 6f74 206c 6f73 740a 2020 2020  p; not lost.    
+000082f0: 2020 2020 5f62 6f64 7920 3d20 6368 756e      _body = chun
+00008300: 6b2e 6765 7428 2762 6f64 7927 290a 0a20  k.get('body').. 
+00008310: 2020 2020 2020 2023 2055 6e2d 7573 6564         # Un-used
+00008320: 2077 6869 7465 7370 6163 6520 6973 2061   whitespace is a
+00008330: 6c77 6179 7320 636c 6561 6e65 6420 7570  lways cleaned up
+00008340: 3b20 6d61 6b65 2073 7572 6520 7765 2061  ; make sure we a
+00008350: 6363 6f75 6e74 2066 6f72 0a20 2020 2020  ccount for.     
+00008360: 2020 2023 2074 6869 7320 696e 206f 7572     # this in our
+00008370: 206e 6577 2063 616c 6375 6c61 7469 6f6e   new calculation
+00008380: 0a20 2020 2020 2020 2077 735f 6469 6666  .        ws_diff
+00008390: 203d 206c 656e 2862 6f64 795b 6f66 6673   = len(body[offs
+000083a0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+000083b0: 206f 6666 7365 745d 2920 2d20 5c0a 2020   offset]) - \.  
+000083c0: 2020 2020 2020 2020 2020 6c65 6e28 626f            len(bo
+000083d0: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+000083e0: 626f 6479 2920 2b20 6f66 6673 6574 5d0a  body) + offset].
+000083f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008400: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
+00008410: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
+00008420: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+00008430: 7420 626f 6479 5b6f 6666 7365 743a 206c  t body[offset: l
+00008440: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+00008450: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
+00008460: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+00008470: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+00008480: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
+00008490: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
+000084a0: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
+000084b0: 7929 202b 2077 735f 6469 6666 290a 0a20  y) + ws_diff).. 
+000084c0: 2020 2023 0a20 2020 2023 2053 6365 6e61     #.    # Scena
+000084d0: 7269 6f20 7768 6572 6520 7468 6520 7469  rio where the ti
+000084e0: 746c 6520 6c65 6e67 7468 2069 7320 6c61  tle length is la
+000084f0: 7267 6572 2074 6861 6e20 7468 6520 626f  rger than the bo
+00008500: 6479 0a20 2020 2023 0a0a 2020 2020 636c  dy.    #..    cl
+00008510: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
+00008520: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
+00008530: 3a0a 0a20 2020 2020 2020 2023 2053 6574  :..        # Set
+00008540: 2061 2073 6d61 6c6c 2074 6974 6c65 206c   a small title l
+00008550: 656e 6774 680a 2020 2020 2020 2020 7469  ength.        ti
+00008560: 746c 655f 6d61 786c 656e 203d 2031 3030  tle_maxlen = 100
+00008570: 0a0a 2020 2020 2020 2020 2320 456e 666f  ..        # Enfo
+00008580: 7263 6520 6120 626f 6479 206c 656e 6774  rce a body lengt
+00008590: 682e 204d 616b 6520 7375 7265 2069 7427  h. Make sure it'
+000085a0: 7320 616e 2069 6e74 2e0a 2020 2020 2020  s an int..      
+000085b0: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
+000085c0: 3530 0a0a 2020 2020 2020 2020 2320 5769  50..        # Wi
+000085d0: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
+000085e0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
+000085f0: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
+00008600: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+00008610: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00008620: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00008630: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+00008640: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+00008650: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
+00008660: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
+00008670: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
+00008680: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00008690: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
+000086a0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
+000086b0: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
+000086c0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+000086d0: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
+000086e0: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
+000086f0: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
+00008700: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
+00008710: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
+00008720: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
+00008730: 4e6f 6e65 0a0a 2020 2020 2320 5665 7269  None..    # Veri
+00008740: 6679 2074 6861 7420 7765 2062 7265 616b  fy that we break
+00008750: 2074 6865 2074 6974 6c65 2074 6f20 6120   the title to a 
+00008760: 6d61 7820 6c65 6e67 7468 206f 6620 6f75  max length of ou
+00008770: 7220 7469 746c 655f 6d61 780a 2020 2020  r title_max.    
+00008780: 2320 616e 6420 7468 6174 2074 6865 2062  # and that the b
+00008790: 6f64 7920 7265 6d61 696e 7320 756e 746f  ody remains unto
+000087a0: 7563 6865 640a 2020 2020 6368 756e 6b73  uched.    chunks
+000087b0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+000087c0: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+000087d0: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
+000087e0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+000087f0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00008800: 6479 3d22 222c 2074 6974 6c65 3d22 2229  dy="", title="")
+00008810: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00008820: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00008830: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+00008840: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+00008850: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00008860: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+00008870: 792c 2074 6974 6c65 3d74 6974 6c65 290a  y, title=title).
+00008880: 2020 2020 6f66 6673 6574 203d 2030 0a20      offset = 0. 
+00008890: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+000088a0: 756e 6b73 2920 3d3d 2032 320a 2020 2020  unks) == 22.    
+000088b0: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
+000088c0: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
+000088d0: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
+000088e0: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
+000088f0: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
+00008900: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
+00008910: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
+00008920: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
+00008930: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+00008940: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
+00008950: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
+00008960: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
+00008970: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
+00008980: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
+00008990: 6564 2074 6f20 6974 2064 7565 2074 6f20  ed to it due to 
+000089a0: 6974 2773 206c 656e 6774 680a 2020 2020  it's length.    
+000089b0: 2020 2020 6966 2069 6478 203e 2031 3a0a      if idx > 1:.
+000089c0: 2020 2020 2020 2020 2020 2020 2320 456d              # Em
+000089d0: 7074 7920 286e 6f20 7469 746c 6520 6469  pty (no title di
+000089e0: 7370 6c61 7965 6420 6f6e 2066 6f6c 6c6f  splayed on follo
+000089f0: 7769 6e67 2065 6e74 7269 6573 0a20 2020  wing entries.   
+00008a00: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00008a10: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+00008a20: 2729 203d 3d20 2222 0a20 2020 2020 2020  ') == "".       
+00008a30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00008a40: 2020 2023 2042 6563 6175 7365 2031 3530     # Because 150
+00008a50: 2069 7320 7768 6174 2077 6520 7365 7420   is what we set 
+00008a60: 7468 6520 7469 746c 6520 6c69 6d69 7420  the title limit 
+00008a70: 746f 2035 3020 6475 650a 2020 2020 2020  to 50 due.      
+00008a80: 2020 2020 2020 2320 746f 2061 6d61 6c61        # to amala
+00008a90: 6d61 7469 6f6e 2e20 2054 6865 206c 6f77  mation.  The low
+00008aa0: 6573 7420 7661 6c75 6520 616c 7761 7973  est value always
+00008ab0: 2070 7265 7661 696c 730a 2020 2020 2020   prevails.      
+00008ac0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00008ad0: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
+00008ae0: 6527 2929 203d 3d20 6f62 6a2e 626f 6479  e')) == obj.body
+00008af0: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
+00008b00: 2020 2020 6173 7365 7274 2074 6974 6c65      assert title
+00008b10: 5b3a 6f62 6a2e 626f 6479 5f6d 6178 6c65  [:obj.body_maxle
+00008b20: 6e5d 203d 3d20 6368 756e 6b2e 6765 7428  n] == chunk.get(
+00008b30: 2774 6974 6c65 2729 0a0a 2020 2020 2020  'title')..      
+00008b40: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
+00008b50: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
+00008b60: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
+00008b70: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
+00008b80: 6574 2827 626f 6479 2729 0a0a 2020 2020  et('body')..    
+00008b90: 2020 2020 2320 556e 2d75 7365 6420 7768      # Un-used wh
+00008ba0: 6974 6573 7061 6365 2069 7320 616c 7761  itespace is alwa
+00008bb0: 7973 2063 6c65 616e 6564 2075 703b 206d  ys cleaned up; m
+00008bc0: 616b 6520 7375 7265 2077 6520 6163 636f  ake sure we acco
+00008bd0: 756e 7420 666f 720a 2020 2020 2020 2020  unt for.        
+00008be0: 2320 7468 6973 2069 6e20 6f75 7220 6e65  # this in our ne
+00008bf0: 7720 6361 6c63 756c 6174 696f 6e0a 2020  w calculation.  
+00008c00: 2020 2020 2020 7773 5f64 6966 6620 3d20        ws_diff = 
+00008c10: 6c65 6e28 626f 6479 5b6f 6666 7365 743a  len(body[offset:
+00008c20: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
+00008c30: 6673 6574 5d29 202d 205c 0a20 2020 2020  fset]) - \.     
+00008c40: 2020 2020 2020 206c 656e 2862 6f64 795b         len(body[
+00008c50: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
+00008c60: 7929 202b 206f 6666 7365 745d 0a20 2020  y) + offset].   
+00008c70: 2020 2020 2020 2020 2020 2020 202e 6c73               .ls
+00008c80: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
+00008c90: 3063 2729 2e72 7374 7269 7028 2929 0a0a  0c').rstrip())..
+00008ca0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+00008cb0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+00008cc0: 5f62 6f64 7929 202b 206f 6666 7365 7420  _body) + offset 
+00008cd0: 2b20 7773 5f64 6966 665d 5c0a 2020 2020  + ws_diff]\.    
+00008ce0: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+00008cf0: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+00008d00: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
+00008d10: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
+00008d20: 202b 3d20 286c 656e 285f 626f 6479 2920   += (len(_body) 
+00008d30: 2b20 7773 5f64 6966 6629 0a0a 0a64 6566  + ws_diff)...def
+00008d40: 2074 6573 745f 6e6f 7469 6679 5f6f 7665   test_notify_ove
+00008d50: 7266 6c6f 775f 7370 6c69 745f 7769 7468  rflow_split_with
+00008d60: 5f61 6d61 6c67 616d 6174 696f 6e5f 666f  _amalgamation_fo
+00008d70: 7263 655f 7469 746c 655f 616c 7761 7973  rce_title_always
+00008d80: 2829 3a0a 2020 2020 2222 220a 2020 2020  ():.    """.    
+00008d90: 4150 493a 204f 7665 7266 6c6f 7720 5769  API: Overflow Wi
+00008da0: 7468 2041 6d61 6c67 616d 6174 696f 6e20  th Amalgamation 
+00008db0: 2874 6974 6c65 2061 6c61 7761 7973 2053  (title alaways S
+00008dc0: 706c 6974 2046 756e 6374 696f 6e61 6c69  plit Functionali
+00008dd0: 7479 2054 6573 7469 6e67 0a0a 2020 2020  ty Testing..    
+00008de0: 2222 220a 0a20 2020 2023 0a20 2020 2023  """..    #.    #
+00008df0: 2041 206c 6974 746c 6520 7072 6570 6172   A little prepar
+00008e00: 6174 696f 6e0a 2020 2020 230a 0a20 2020  ation.    #..   
+00008e10: 2023 204e 756d 6265 7220 6f66 2063 6861   # Number of cha
+00008e20: 7261 6374 6572 7320 7065 7220 6c69 6e65  racters per line
+00008e30: 0a20 2020 2072 6f77 203d 2032 340a 0a20  .    row = 24.. 
+00008e40: 2020 2023 2053 6f6d 6520 7661 7269 6162     # Some variab
+00008e50: 6c65 7320 7765 2075 7365 2074 6f20 636f  les we use to co
+00008e60: 6e74 726f 6c20 7468 6520 6461 7461 2077  ntrol the data w
+00008e70: 6520 776f 726b 2077 6974 680a 2020 2020  e work with.    
+00008e80: 626f 6479 5f6c 656e 203d 2031 3032 340a  body_len = 1024.
+00008e90: 2020 2020 7469 746c 655f 6c65 6e20 3d20      title_len = 
+00008ea0: 3130 3234 0a0a 2020 2020 2320 4372 6561  1024..    # Crea
+00008eb0: 7465 2061 206c 6172 6765 2062 6f64 7920  te a large body 
+00008ec0: 616e 6420 7469 746c 6520 7769 7468 2072  and title with r
+00008ed0: 616e 646f 6d20 6461 7461 0a20 2020 2062  andom data.    b
+00008ee0: 6f64 7920 3d20 2727 2e6a 6f69 6e28 6368  ody = ''.join(ch
+00008ef0: 6f69 6365 2873 7472 5f61 6c70 6861 202b  oice(str_alpha +
+00008f00: 2073 7472 5f6e 756d 2920 666f 7220 5f20   str_num) for _ 
+00008f10: 696e 2072 616e 6765 2862 6f64 795f 6c65  in range(body_le
+00008f20: 6e29 290a 2020 2020 626f 6479 203d 2027  n)).    body = '
+00008f30: 5c72 5c6e 272e 6a6f 696e 285b 626f 6479  \r\n'.join([body
+00008f40: 5b69 3a20 6920 2b20 726f 775d 2066 6f72  [i: i + row] for
+00008f50: 2069 2069 6e20 7261 6e67 6528 302c 206c   i in range(0, l
+00008f60: 656e 2862 6f64 7929 2c20 726f 7729 5d29  en(body), row)])
+00008f70: 0a0a 2020 2020 2320 7468 6520 6e65 7720  ..    # the new 
+00008f80: 6c69 6e65 7320 6164 6420 6120 6c61 7267  lines add a larg
+00008f90: 6520 616d 6f75 6e74 2074 6f20 6f75 7220  e amount to our 
+00008fa0: 626f 6479 3b20 6c65 7473 2066 6f72 6365  body; lets force
+00008fb0: 2074 6865 2063 6f6e 7465 6e74 0a20 2020   the content.   
+00008fc0: 2023 2062 6163 6b20 746f 2062 6569 6e67   # back to being
+00008fd0: 2031 3032 3420 6368 6172 6163 7465 7273   1024 characters
+00008fe0: 2e0a 2020 2020 626f 6479 203d 2062 6f64  ..    body = bod
+00008ff0: 795b 303a 3130 3234 5d0a 0a20 2020 2023  y[0:1024]..    #
+00009000: 2043 7265 6174 6520 6f75 7220 7469 746c   Create our titl
+00009010: 6520 7573 696e 6720 7261 6e64 6f6d 2064  e using random d
+00009020: 6174 610a 2020 2020 7469 746c 6520 3d20  ata.    title = 
+00009030: 2727 2e6a 6f69 6e28 6368 6f69 6365 2873  ''.join(choice(s
+00009040: 7472 5f61 6c70 6861 202b 2073 7472 5f6e  tr_alpha + str_n
+00009050: 756d 2920 666f 7220 5f20 696e 2072 616e  um) for _ in ran
+00009060: 6765 2874 6974 6c65 5f6c 656e 2929 0a0a  ge(title_len))..
+00009070: 2020 2020 230a 2020 2020 2320 4669 7273      #.    # Firs
+00009080: 7420 5465 7374 3a20 5472 756e 6361 7465  t Test: Truncate
+00009090: 6420 5469 746c 650a 2020 2020 230a 2020  d Title.    #.  
+000090a0: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
+000090b0: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
+000090c0: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
+000090d0: 2054 6573 7420 7469 746c 6520 6d61 7820   Test title max 
+000090e0: 6c65 6e67 7468 0a20 2020 2020 2020 2074  length.        t
+000090f0: 6974 6c65 5f6d 6178 6c65 6e20 3d20 3130  itle_maxlen = 10
+00009100: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+00009110: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+00009120: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+00009130: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+00009140: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00009150: 2320 466f 7263 6520 7469 746c 6520 746f  # Force title to
+00009160: 2062 6520 6469 7370 6c61 7965 6420 616c   be displayed al
+00009170: 7761 7973 0a20 2020 2020 2020 206f 7665  ways.        ove
+00009180: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
+00009190: 746c 655f 6f6e 6365 203d 2046 616c 7365  tle_once = False
+000091a0: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
+000091b0: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
+000091c0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+000091d0: 2020 2020 2020 2020 2020 2073 7570 6572             super
+000091e0: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
+000091f0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
+00009200: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
+00009210: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00009220: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00009230: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
+00009240: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
+00009250: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+00009260: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
+00009270: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
+00009280: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
+00009290: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
+000092a0: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
+000092b0: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
+000092c0: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
+000092d0: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
+000092e0: 7765 2062 7265 616b 2074 6865 2074 6974  we break the tit
+000092f0: 6c65 2074 6f20 6120 6d61 7820 6c65 6e67  le to a max leng
+00009300: 7468 206f 6620 6f75 7220 7469 746c 655f  th of our title_
+00009310: 6d61 780a 2020 2020 2320 616e 6420 7468  max.    # and th
+00009320: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
+00009330: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
+00009340: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00009350: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00009360: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
+00009370: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
+00009380: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00009390: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+000093a0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+000093b0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+000093c0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+000093d0: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+000093e0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+000093f0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00009400: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+00009410: 3d74 6974 6c65 290a 2020 2020 6173 7365  =title).    asse
+00009420: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
+00009430: 3d20 310a 2020 2020 6173 7365 7274 2062  = 1.    assert b
+00009440: 6f64 792e 6c73 7472 6970 2827 5c72 5c6e  ody.lstrip('\r\n
+00009450: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+00009460: 7028 2920 3d3d 2063 6875 6e6b 735b 305d  p() == chunks[0]
+00009470: 2e67 6574 2827 626f 6479 2729 0a20 2020  .get('body').   
+00009480: 2061 7373 6572 7420 7469 746c 655b 303a   assert title[0:
+00009490: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+000094a0: 5d20 3d3d 2063 6875 6e6b 735b 305d 2e67  ] == chunks[0].g
+000094b0: 6574 2827 7469 746c 6527 290a 0a20 2020  et('title')..   
+000094c0: 2023 0a20 2020 2023 204e 6578 7420 5465   #.    # Next Te
+000094d0: 7374 3a20 4c69 6e65 2043 6f75 6e74 2043  st: Line Count C
+000094e0: 6f6e 7472 6f6c 0a20 2020 2023 0a0a 2020  ontrol.    #..  
+000094f0: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
+00009500: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
+00009510: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
+00009520: 2054 6573 7420 7469 746c 6520 6d61 7820   Test title max 
+00009530: 6c65 6e67 7468 0a20 2020 2020 2020 2074  length.        t
+00009540: 6974 6c65 5f6d 6178 6c65 6e20 3d20 350a  itle_maxlen = 5.
+00009550: 0a20 2020 2020 2020 2023 204d 6178 696d  .        # Maxim
+00009560: 756d 206e 756d 6265 7220 6f66 206c 696e  um number of lin
+00009570: 6573 0a20 2020 2020 2020 2062 6f64 795f  es.        body_
+00009580: 6d61 785f 6c69 6e65 5f63 6f75 6e74 203d  max_line_count =
+00009590: 2035 0a0a 2020 2020 2020 2020 2320 5769   5..        # Wi
+000095a0: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
+000095b0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
+000095c0: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
+000095d0: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+000095e0: 2020 2320 466f 7263 6520 7469 746c 6520    # Force title 
+000095f0: 746f 2062 6520 6469 7370 6c61 7965 6420  to be displayed 
+00009600: 616c 7761 7973 0a20 2020 2020 2020 206f  always.        o
+00009610: 7665 7266 6c6f 775f 6469 7370 6c61 795f  verflow_display_
+00009620: 7469 746c 655f 6f6e 6365 203d 2046 616c  title_once = Fal
+00009630: 7365 0a0a 2020 2020 2020 2020 6465 6620  se..        def 
+00009640: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
+00009650: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00009660: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
+00009670: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
+00009680: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
+00009690: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
+000096a0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+000096b0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+000096c0: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
+000096d0: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
+000096e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000096f0: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
+00009700: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
+00009710: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
+00009720: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
+00009730: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
+00009740: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
+00009750: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
+00009760: 2020 2020 2320 5665 7269 6679 2074 6861      # Verify tha
+00009770: 7420 7765 2062 7265 616b 2074 6865 2074  t we break the t
+00009780: 6974 6c65 2074 6f20 6120 6d61 7820 6c65  itle to a max le
+00009790: 6e67 7468 206f 6620 6f75 7220 7469 746c  ngth of our titl
+000097a0: 655f 6d61 780a 2020 2020 2320 616e 6420  e_max.    # and 
+000097b0: 7468 6174 2074 6865 2062 6f64 7920 7265  that the body re
+000097c0: 6d61 696e 7320 756e 746f 7563 6865 640a  mains untouched.
+000097d0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+000097e0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+000097f0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00009800: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
+00009810: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00009820: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+00009830: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
+00009840: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00009850: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00009860: 3d62 6f64 792c 2074 6974 6c65 3d22 2229  =body, title="")
+00009870: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00009880: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00009890: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+000098a0: 6c65 3d74 6974 6c65 290a 2020 2020 6173  le=title).    as
+000098b0: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+000098c0: 203d 3d20 310a 2020 2020 6173 7365 7274   == 1.    assert
+000098d0: 206c 656e 2863 6875 6e6b 735b 305d 2e67   len(chunks[0].g
+000098e0: 6574 2827 626f 6479 2729 2e73 706c 6974  et('body').split
+000098f0: 2827 5c6e 2729 2920 3d3d 206f 626a 2e62  ('\n')) == obj.b
+00009900: 6f64 795f 6d61 785f 6c69 6e65 5f63 6f75  ody_max_line_cou
+00009910: 6e74 0a20 2020 2061 7373 6572 7420 7469  nt.    assert ti
+00009920: 746c 655b 303a 6f62 6a2e 7469 746c 655f  tle[0:obj.title_
+00009930: 6d61 786c 656e 5d20 3d3d 2063 6875 6e6b  maxlen] == chunk
+00009940: 735b 305d 2e67 6574 2827 7469 746c 6527  s[0].get('title'
+00009950: 290a 0a20 2020 2023 0a20 2020 2023 204e  )..    #.    # N
+00009960: 6578 7420 5465 7374 3a20 5370 6c69 7420  ext Test: Split 
+00009970: 626f 6479 0a20 2020 2023 0a0a 2020 2020  body.    #..    
+00009980: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
+00009990: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
+000099a0: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
+000099b0: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
+000099c0: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
+000099d0: 6c65 5f6d 6178 6c65 6e20 3d20 7469 746c  le_maxlen = titl
+000099e0: 655f 6c65 6e0a 0a20 2020 2020 2020 2023  e_len..        #
+000099f0: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
+00009a00: 6c65 6e67 7468 2e20 4d61 6b65 2073 7572  length. Make sur
+00009a10: 6520 6974 2773 2061 6e20 696e 742e 0a20  e it's an int.. 
+00009a20: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
+00009a30: 656e 203d 2069 6e74 2862 6f64 795f 6c65  en = int(body_le
+00009a40: 6e20 2f20 3429 0a0a 2020 2020 2020 2020  n / 4)..        
+00009a50: 2320 5769 7468 2061 6d61 6c67 616d 6174  # With amalgamat
+00009a60: 696f 6e0a 2020 2020 2020 2020 6f76 6572  ion.        over
+00009a70: 666c 6f77 5f61 6d61 6c67 616d 6174 655f  flow_amalgamate_
+00009a80: 7469 746c 6520 3d20 5472 7565 0a0a 2020  title = True..  
+00009a90: 2020 2020 2020 2320 466f 7263 6520 7469        # Force ti
+00009aa0: 746c 6520 746f 2062 6520 6469 7370 6c61  tle to be displa
+00009ab0: 7965 6420 616c 7761 7973 0a20 2020 2020  yed always.     
+00009ac0: 2020 206f 7665 7266 6c6f 775f 6469 7370     overflow_disp
+00009ad0: 6c61 795f 7469 746c 655f 6f6e 6365 203d  lay_title_once =
+00009ae0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+00009af0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00009b00: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00009b10: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00009b20: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00009b30: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00009b40: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+00009b50: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00009b60: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00009b70: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+00009b80: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+00009b90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00009ba0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+00009bb0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+00009bc0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+00009bd0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+00009be0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+00009bf0: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
+00009c00: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+00009c10: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+00009c20: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+00009c30: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+00009c40: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+00009c50: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+00009c60: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+00009c70: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+00009c80: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+00009c90: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00009ca0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00009cb0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+00009cc0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00009cd0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00009ce0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+00009cf0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00009d00: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00009d10: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+00009d20: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00009d30: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00009d40: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+00009d50: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+00009d60: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
+00009d70: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+00009d80: 6b73 2920 3d3d 2035 0a20 2020 2066 6f72  ks) == 5.    for
+00009d90: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+00009da0: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+00009db0: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+00009dc0: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+00009dd0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+00009de0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+00009df0: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+00009e00: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+00009e10: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00009e20: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+00009e30: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+00009e40: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+00009e50: 204e 6f20 636f 756e 7465 7220 6973 2064   No counter is d
+00009e60: 6973 706c 6179 6564 2062 6563 6175 7365  isplayed because
+00009e70: 206f 7572 2074 6974 6c65 2069 7320 736f   our title is so
+00009e80: 2065 6e6f 726d 6f75 730a 2020 2020 2020   enormous.      
+00009e90: 2020 2320 5765 2073 7769 7463 6820 746f    # We switch to
+00009ea0: 2061 2064 6973 706c 6179 2074 6974 6c65   a display title
+00009eb0: 206f 6e20 6669 7273 7420 6d65 7373 6167   on first messag
+00009ec0: 6520 6f6e 6c79 0a20 2020 2020 2020 2069  e only.        i
+00009ed0: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+00009ee0: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+00009ef0: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+00009f00: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+00009f10: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+00009f20: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+00009f30: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+00009f40: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+00009f50: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00009f60: 5468 6520 6c65 6e67 7468 206f 6620 7468  The length of th
+00009f70: 6520 626f 6479 2070 7265 7661 696c 7320  e body prevails 
+00009f80: 6f75 7220 7469 746c 6520 6475 6520 746f  our title due to
+00009f90: 2069 7420 6265 696e 670a 2020 2020 2020   it being.      
+00009fa0: 2020 2020 2020 2320 736f 206d 7563 6820        # so much 
+00009fb0: 736d 616c 6c65 7220 7468 656e 206f 7572  smaller then our
+00009fc0: 2074 6974 6c65 206c 656e 6774 680a 2020   title length.  
+00009fd0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00009fe0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+00009ff0: 7469 746c 6527 2929 203d 3d20 6f62 6a2e  title')) == obj.
+0000a000: 626f 6479 5f6d 6178 6c65 6e0a 2020 2020  body_maxlen.    
+0000a010: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0000a020: 6974 6c65 5b3a 6f62 6a2e 626f 6479 5f6d  itle[:obj.body_m
+0000a030: 6178 6c65 6e5d 203d 3d20 6368 756e 6b2e  axlen] == chunk.
+0000a040: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
+0000a050: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
+0000a060: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
+0000a070: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
+0000a080: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
+0000a090: 6e6b 2e67 6574 2827 626f 6479 2729 0a20  nk.get('body'). 
+0000a0a0: 2020 2020 2020 2061 7373 6572 7420 626f         assert bo
+0000a0b0: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+0000a0c0: 626f 6479 2920 2b20 6f66 6673 6574 5d5c  body) + offset]\
+0000a0d0: 0a20 2020 2020 2020 2020 2020 202e 6c73  .            .ls
+0000a0e0: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
+0000a0f0: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
+0000a100: 205f 626f 6479 0a20 2020 2020 2020 206f   _body.        o
+0000a110: 6666 7365 7420 2b3d 206c 656e 285f 626f  ffset += len(_bo
+0000a120: 6479 290a 0a20 2020 2023 2041 6e6f 7468  dy)..    # Anoth
+0000a130: 6572 2065 6467 6520 6361 7365 2077 6865  er edge case whe
+0000a140: 7265 2074 6865 2074 6974 6c65 206a 7573  re the title jus
+0000a150: 7420 6973 6e27 7420 7468 6174 206c 6f6e  t isn't that lon
+0000a160: 6720 6c65 6176 696e 670a 2020 2020 2320  g leaving.    # 
+0000a170: 6120 6c6f 7420 6f66 2073 7061 6365 2066  a lot of space f
+0000a180: 6f72 2074 6865 205b 7878 2f78 785d 2065  or the [xx/xx] e
+0000a190: 6e74 7269 6573 2028 6e6f 2074 7275 6e63  ntries (no trunc
+0000a1a0: 6174 696f 6e20 6e65 6564 6564 290a 2020  ation needed).  
+0000a1b0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+0000a1c0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+0000a1d0: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
+0000a1e0: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
+0000a1f0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0000a200: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+0000a210: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+0000a220: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000a230: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+0000a240: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+0000a250: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0000a260: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0000a270: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+0000a280: 3d74 6974 6c65 5b3a 3230 5d29 0a20 2020  =title[:20]).   
+0000a290: 206f 6666 7365 7420 3d20 300a 2020 2020   offset = 0.    
+0000a2a0: 635f 6c65 6e20 3d20 6c65 6e28 2720 5b58  c_len = len(' [X
+0000a2b0: 2f58 5d27 290a 2020 2020 6173 7365 7274  /X]').    assert
+0000a2c0: 206c 656e 2863 6875 6e6b 7329 203d 3d20   len(chunks) == 
+0000a2d0: 350a 2020 2020 666f 7220 6964 782c 2063  5.    for idx, c
+0000a2e0: 6875 6e6b 2069 6e20 656e 756d 6572 6174  hunk in enumerat
+0000a2f0: 6528 6368 756e 6b73 2c20 7374 6172 743d  e(chunks, start=
+0000a300: 3129 3a0a 2020 2020 2020 2020 2320 5665  1):.        # Ve
+0000a310: 7269 6669 6361 7469 6f6e 0a20 2020 2020  rification.     
+0000a320: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+0000a330: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
+0000a340: 2920 3c3d 206f 626a 2e74 6974 6c65 5f6d  ) <= obj.title_m
+0000a350: 6178 6c65 6e0a 2020 2020 2020 2020 6173  axlen.        as
+0000a360: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
+0000a370: 6574 2827 626f 6479 2729 2920 3c3d 206f  et('body')) <= o
+0000a380: 626a 2e62 6f64 795f 6d61 786c 656e 0a0a  bj.body_maxlen..
+0000a390: 2020 2020 2020 2020 2320 4f75 7220 7469          # Our ti
+0000a3a0: 746c 6520 6861 7320 6120 636f 756e 7465  tle has a counte
+0000a3b0: 7220 6164 6465 6420 746f 2069 740a 2020  r added to it.  
+0000a3c0: 2020 2020 2020 6173 7365 7274 2074 6974        assert tit
+0000a3d0: 6c65 5b3a 3230 5d20 3d3d 2063 6875 6e6b  le[:20] == chunk
+0000a3e0: 2e67 6574 2827 7469 746c 6527 295b 3a2d  .get('title')[:-
+0000a3f0: 635f 6c65 6e5d 0a20 2020 2020 2020 2061  c_len].        a
+0000a400: 7373 6572 7420 6368 756e 6b2e 6765 7428  ssert chunk.get(
+0000a410: 2774 6974 6c65 2729 5b2d 635f 6c65 6e3a  'title')[-c_len:
+0000a420: 5d20 3d3d 205c 0a20 2020 2020 2020 2020  ] == \.         
+0000a430: 2020 2027 205b 7b3a 3031 7d2f 7b3a 3031     ' [{:01}/{:01
+0000a440: 7d5d 272e 666f 726d 6174 2869 6478 2c20  }]'.format(idx, 
+0000a450: 6c65 6e28 6368 756e 6b73 2929 0a20 2020  len(chunks)).   
+0000a460: 2020 2020 2023 204f 7572 2062 6f64 7920       # Our body 
+0000a470: 6973 206f 6e6c 7920 6272 6f6b 656e 2075  is only broken u
+0000a480: 703b 206e 6f74 206c 6f73 740a 2020 2020  p; not lost.    
+0000a490: 2020 2020 5f62 6f64 7920 3d20 6368 756e      _body = chun
+0000a4a0: 6b2e 6765 7428 2762 6f64 7927 290a 2020  k.get('body').  
+0000a4b0: 2020 2020 2020 6173 7365 7274 2062 6f64        assert bod
+0000a4c0: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
+0000a4d0: 6f64 7929 202b 206f 6666 7365 745d 5c0a  ody) + offset]\.
+0000a4e0: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
+0000a4f0: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+0000a500: 6327 292e 7273 7472 6970 2829 203d 3d20  c').rstrip() == 
+0000a510: 5f62 6f64 790a 2020 2020 2020 2020 6f66  _body.        of
+0000a520: 6673 6574 202b 3d20 6c65 6e28 5f62 6f64  fset += len(_bod
+0000a530: 7929 0a0a 2020 2020 230a 2020 2020 2320  y)..    #.    # 
+0000a540: 5465 7374 2066 6f72 6369 6e67 206f 7665  Test forcing ove
+0000a550: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
+0000a560: 746c 655f 6f6e 6365 0a20 2020 2023 0a20  tle_once.    #. 
+0000a570: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
+0000a580: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
+0000a590: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
+0000a5a0: 2320 5465 7374 2074 6974 6c65 206d 6178  # Test title max
+0000a5b0: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+0000a5c0: 7469 746c 655f 6d61 786c 656e 203d 2074  title_maxlen = t
+0000a5d0: 6974 6c65 5f6c 656e 0a0a 2020 2020 2020  itle_len..      
+0000a5e0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
+0000a5f0: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
+0000a600: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
+0000a610: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
+0000a620: 6178 6c65 6e20 3d20 696e 7428 626f 6479  axlen = int(body
+0000a630: 5f6c 656e 202f 2034 290a 0a20 2020 2020  _len / 4)..     
+0000a640: 2020 2023 2057 6974 6820 616d 616c 6761     # With amalga
+0000a650: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
+0000a660: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
+0000a670: 7465 5f74 6974 6c65 203d 2054 7275 650a  te_title = True.
+0000a680: 0a20 2020 2020 2020 2023 2046 6f72 6365  .        # Force
+0000a690: 2074 6974 6c65 2074 6f20 6265 2064 6973   title to be dis
+0000a6a0: 706c 6179 6564 2061 6c77 6179 730a 2020  played always.  
+0000a6b0: 2020 2020 2020 6f76 6572 666c 6f77 5f64        overflow_d
+0000a6c0: 6973 706c 6179 5f74 6974 6c65 5f6f 6e63  isplay_title_onc
+0000a6d0: 6520 3d20 4661 6c73 650a 0a20 2020 2020  e = False..     
+0000a6e0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+0000a6f0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+0000a700: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+0000a710: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
+0000a720: 6974 5f5f 282a 2a6b 7761 7267 7329 0a0a  it__(**kwargs)..
+0000a730: 2020 2020 2020 2020 6465 6620 6e6f 7469          def noti
+0000a740: 6679 2873 656c 662c 202a 6172 6773 2c20  fy(self, *args, 
+0000a750: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0000a760: 2020 2020 2020 2023 2050 7265 7465 6e64         # Pretend
+0000a770: 2065 7665 7279 7468 696e 6720 6973 206f   everything is o
+0000a780: 6b61 790a 2020 2020 2020 2020 2020 2020  kay.            
+0000a790: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+0000a7a0: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
+0000a7b0: 6374 0a20 2020 206f 626a 203d 2054 6573  ct.    obj = Tes
+0000a7c0: 744e 6f74 6966 6963 6174 696f 6e28 6f76  tNotification(ov
+0000a7d0: 6572 666c 6f77 3d4f 7665 7266 6c6f 774d  erflow=OverflowM
+0000a7e0: 6f64 652e 5350 4c49 5429 0a20 2020 2061  ode.SPLIT).    a
+0000a7f0: 7373 6572 7420 6f62 6a20 6973 206e 6f74  ssert obj is not
+0000a800: 204e 6f6e 650a 0a20 2020 2063 6875 6e6b   None..    chunk
+0000a810: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+0000a820: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+0000a830: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+0000a840: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+0000a850: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+0000a860: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
+0000a870: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+0000a880: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+0000a890: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+0000a8a0: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+0000a8b0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+0000a8c0: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
+0000a8d0: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
+0000a8e0: 0a20 2020 206f 6666 7365 7420 3d20 300a  .    offset = 0.
+0000a8f0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+0000a900: 6875 6e6b 7329 203d 3d20 350a 2020 2020  hunks) == 5.    
+0000a910: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
+0000a920: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
+0000a930: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
+0000a940: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
+0000a950: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
+0000a960: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
+0000a970: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
+0000a980: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
+0000a990: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0000a9a0: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
+0000a9b0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
+0000a9c0: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
+0000a9d0: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
+0000a9e0: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
+0000a9f0: 6564 2074 6f20 6974 0a20 2020 2020 2020  ed to it.       
+0000aa00: 2069 6620 6964 7820 3e20 313a 0a20 2020   if idx > 1:.   
+0000aa10: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
+0000aa20: 2028 6e6f 2074 6974 6c65 2064 6973 706c   (no title displ
+0000aa30: 6179 6564 206f 6e20 666f 6c6c 6f77 696e  ayed on followin
+0000aa40: 6720 656e 7472 6965 730a 2020 2020 2020  g entries.      
+0000aa50: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
+0000aa60: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
+0000aa70: 3d3d 2022 220a 2020 2020 2020 2020 656c  == "".        el
+0000aa80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000aa90: 2320 5468 6520 626f 6479 206c 656e 6774  # The body lengt
+0000aaa0: 6820 7072 6576 6169 6c73 2064 7565 2074  h prevails due t
+0000aab0: 6f20 6f75 7220 616d 616c 6761 6d61 7469  o our amalgamati
+0000aac0: 6f6e 2066 6c61 670a 2020 2020 2020 2020  on flag.        
+0000aad0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+0000aae0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+0000aaf0: 2929 203d 3d20 6f62 6a2e 626f 6479 5f6d  )) == obj.body_m
+0000ab00: 6178 6c65 6e0a 2020 2020 2020 2020 2020  axlen.          
+0000ab10: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
+0000ab20: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e5d  obj.body_maxlen]
+0000ab30: 203d 3d20 6368 756e 6b2e 6765 7428 2774   == chunk.get('t
+0000ab40: 6974 6c65 2729 0a0a 2020 2020 2020 2020  itle')..        
+0000ab50: 2320 4f75 7220 626f 6479 2069 7320 6f6e  # Our body is on
+0000ab60: 6c79 2062 726f 6b65 6e20 7570 3b20 6e6f  ly broken up; no
+0000ab70: 7420 6c6f 7374 0a20 2020 2020 2020 205f  t lost.        _
+0000ab80: 626f 6479 203d 2063 6875 6e6b 2e67 6574  body = chunk.get
+0000ab90: 2827 626f 6479 2729 0a20 2020 2020 2020  ('body').       
+0000aba0: 2061 7373 6572 7420 626f 6479 5b6f 6666   assert body[off
+0000abb0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+0000abc0: 2b20 6f66 6673 6574 5d5c 0a20 2020 2020  + offset]\.     
+0000abd0: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+0000abe0: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+0000abf0: 7374 7269 7028 2920 3d3d 205f 626f 6479  strip() == _body
+0000ac00: 0a20 2020 2020 2020 206f 6666 7365 7420  .        offset 
+0000ac10: 2b3d 206c 656e 285f 626f 6479 290a 0a20  += len(_body).. 
+0000ac20: 2020 2023 2054 6573 7420 6c61 7267 6572     # Test larger
+0000ac30: 206d 6573 7361 6765 730a 2020 2020 2320   messages.    # 
+0000ac40: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+0000ac50: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+0000ac60: 6865 640a 2020 2020 636c 6173 7320 5465  hed.    class Te
+0000ac70: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
+0000ac80: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
+0000ac90: 2020 2020 2023 2054 6573 7420 7469 746c       # Test titl
+0000aca0: 6520 6d61 7820 6c65 6e67 7468 0a20 2020  e max length.   
+0000acb0: 2020 2020 2074 6974 6c65 5f6d 6178 6c65       title_maxle
+0000acc0: 6e20 3d20 3135 300a 0a20 2020 2020 2020  n = 150..       
+0000acd0: 2023 2045 6e66 6f72 6365 2061 2062 6f64   # Enforce a bod
+0000ace0: 7920 6c65 6e67 7468 2e20 4d61 6b65 2073  y length. Make s
+0000acf0: 7572 6520 6974 2773 2061 6e20 696e 742e  ure it's an int.
+0000ad00: 0a20 2020 2020 2020 2062 6f64 795f 6d61  .        body_ma
+0000ad10: 786c 656e 203d 2034 3030 0a0a 2020 2020  xlen = 400..    
+0000ad20: 2020 2020 2320 5769 7468 2061 6d61 6c67      # With amalg
+0000ad30: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
+0000ad40: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
+0000ad50: 6174 655f 7469 746c 6520 3d20 5472 7565  ate_title = True
+0000ad60: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
+0000ad70: 6520 7469 746c 6520 746f 2062 6520 6469  e title to be di
+0000ad80: 7370 6c61 7965 6420 616c 7761 7973 0a20  splayed always. 
+0000ad90: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+0000ada0: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
+0000adb0: 6365 203d 2046 616c 7365 0a0a 2020 2020  ce = False..    
+0000adc0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0000add0: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+0000ade0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0000adf0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+0000ae00: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
+0000ae10: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
+0000ae20: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
+0000ae30: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0000ae40: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
+0000ae50: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
+0000ae60: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
+0000ae70: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+0000ae80: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
+0000ae90: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
+0000aea0: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
+0000aeb0: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
+0000aec0: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
+0000aed0: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
+0000aee0: 7420 4e6f 6e65 0a0a 2020 2020 6e65 775f  t None..    new_
+0000aef0: 626f 6479 203d 2028 626f 6479 202a 2035  body = (body * 5
+0000af00: 3030 290a 2020 2020 6368 756e 6b73 203d  00).    chunks =
+0000af10: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0000af20: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+0000af30: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+0000af40: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+0000af50: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+0000af60: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+0000af70: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0000af80: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0000af90: 626f 6479 3d6e 6577 5f62 6f64 792c 2074  body=new_body, t
+0000afa0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+0000afb0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000afc0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d6e  _overflow(body=n
+0000afd0: 6577 5f62 6f64 792c 2074 6974 6c65 3d74  ew_body, title=t
+0000afe0: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
+0000aff0: 203d 2030 0a20 2020 2063 5f6c 656e 203d   = 0.    c_len =
+0000b000: 206c 656e 2827 205b 5858 5858 2f58 5858   len(' [XXXX/XXX
+0000b010: 585d 2729 0a20 2020 2061 7373 6572 7420  X]').    assert 
+0000b020: 6c65 6e28 6368 756e 6b73 2920 3d3d 2032  len(chunks) == 2
+0000b030: 3034 380a 2020 2020 666f 7220 6964 782c  048.    for idx,
+0000b040: 2063 6875 6e6b 2069 6e20 656e 756d 6572   chunk in enumer
+0000b050: 6174 6528 6368 756e 6b73 2c20 7374 6172  ate(chunks, star
+0000b060: 743d 3129 3a0a 2020 2020 2020 2020 2320  t=1):.        # 
+0000b070: 5665 7269 6669 6361 7469 6f6e 0a20 2020  Verification.   
+0000b080: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0000b090: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+0000b0a0: 2729 2920 3c3d 206f 626a 2e74 6974 6c65  ')) <= obj.title
+0000b0b0: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
+0000b0c0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+0000b0d0: 2e67 6574 2827 626f 6479 2729 2920 3c3d  .get('body')) <=
+0000b0e0: 206f 626a 2e62 6f64 795f 6d61 786c 656e   obj.body_maxlen
+0000b0f0: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
+0000b100: 7469 746c 6520 6861 7320 6120 636f 756e  title has a coun
+0000b110: 7465 7220 6164 6465 6420 746f 2069 740a  ter added to it.
+0000b120: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0000b130: 6974 6c65 5b3a 6f62 6a2e 7469 746c 655f  itle[:obj.title_
+0000b140: 6d61 786c 656e 5d5b 3a2d 635f 6c65 6e5d  maxlen][:-c_len]
+0000b150: 203d 3d20 6368 756e 6b2e 6765 7428 2774   == chunk.get('t
+0000b160: 6974 6c65 2729 5b3a 2d63 5f6c 656e 5d0a  itle')[:-c_len].
+0000b170: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
+0000b180: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+0000b190: 295b 2d63 5f6c 656e 3a5d 203d 3d20 5c0a  )[-c_len:] == \.
+0000b1a0: 2020 2020 2020 2020 2020 2020 2720 5b7b              ' [{
+0000b1b0: 3a30 347d 2f7b 3a30 347d 5d27 2e66 6f72  :04}/{:04}]'.for
+0000b1c0: 6d61 7428 6964 782c 206c 656e 2863 6875  mat(idx, len(chu
+0000b1d0: 6e6b 7329 290a 0a20 2020 2020 2020 2023  nks))..        #
+0000b1e0: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+0000b1f0: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+0000b200: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+0000b210: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+0000b220: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
+0000b230: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
+0000b240: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
+0000b250: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
+0000b260: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
+0000b270: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
+0000b280: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
+0000b290: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
+0000b2a0: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
+0000b2b0: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
+0000b2c0: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+0000b2d0: 6666 7365 745d 2920 2d20 5c0a 2020 2020  ffset]) - \.    
+0000b2e0: 2020 2020 2020 2020 6c65 6e28 6e65 775f          len(new_
+0000b2f0: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
+0000b300: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
+0000b310: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000b320: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
+0000b330: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
+0000b340: 2829 290a 0a20 2020 2020 2020 2061 7373  ())..        ass
+0000b350: 6572 7420 6e65 775f 626f 6479 5b6f 6666  ert new_body[off
+0000b360: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+0000b370: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
+0000b380: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
+0000b390: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+0000b3a0: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+0000b3b0: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
+0000b3c0: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
+0000b3d0: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
+0000b3e0: 6666 290a 0a20 2020 2023 2042 6f64 7920  ff)..    # Body 
+0000b3f0: 6368 756e 6b20 6973 2062 6579 6f6e 6420  chunk is beyond 
+0000b400: 3420 6469 6769 7473 2c20 736f 205b 5858  4 digits, so [XX
+0000b410: 5858 2f58 5858 585d 2069 7320 7475 726e  XX/XXXX] is turn
+0000b420: 6564 206f 6666 0a20 2020 206e 6577 5f62  ed off.    new_b
+0000b430: 6f64 7920 3d20 2862 6f64 7920 2a20 3235  ody = (body * 25
+0000b440: 3030 290a 2020 2020 6368 756e 6b73 203d  00).    chunks =
+0000b450: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0000b460: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+0000b470: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+0000b480: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+0000b490: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+0000b4a0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+0000b4b0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0000b4c0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0000b4d0: 626f 6479 3d6e 6577 5f62 6f64 792c 2074  body=new_body, t
+0000b4e0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+0000b4f0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000b500: 5f6f 7665 7266 6c6f 7728 626f 6479 3d6e  _overflow(body=n
+0000b510: 6577 5f62 6f64 792c 2074 6974 6c65 3d74  ew_body, title=t
+0000b520: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
+0000b530: 203d 2030 0a20 2020 2061 7373 6572 7420   = 0.    assert 
+0000b540: 6c65 6e28 6368 756e 6b73 2920 3d3d 2031  len(chunks) == 1
+0000b550: 3032 3430 0a20 2020 2066 6f72 2069 6478  0240.    for idx
+0000b560: 2c20 6368 756e 6b20 696e 2065 6e75 6d65  , chunk in enume
+0000b570: 7261 7465 2863 6875 6e6b 732c 2073 7461  rate(chunks, sta
+0000b580: 7274 3d31 293a 0a20 2020 2020 2020 2023  rt=1):.        #
+0000b590: 2056 6572 6966 6963 6174 696f 6e0a 2020   Verification.  
+0000b5a0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0000b5b0: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
+0000b5c0: 6527 2929 203c 3d20 6f62 6a2e 7469 746c  e')) <= obj.titl
+0000b5d0: 655f 6d61 786c 656e 0a20 2020 2020 2020  e_maxlen.       
+0000b5e0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+0000b5f0: 6b2e 6765 7428 2762 6f64 7927 2929 203c  k.get('body')) <
+0000b600: 3d20 6f62 6a2e 626f 6479 5f6d 6178 6c65  = obj.body_maxle
+0000b610: 6e0a 0a20 2020 2020 2020 2023 204f 7572  n..        # Our
+0000b620: 2074 6974 6c65 2068 6173 206e 6f20 636f   title has no co
+0000b630: 756e 7465 7220 6164 6465 6420 746f 2069  unter added to i
+0000b640: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+0000b650: 2074 6974 6c65 5b3a 6f62 6a2e 7469 746c   title[:obj.titl
+0000b660: 655f 6d61 786c 656e 5d20 3d3d 2063 6875  e_maxlen] == chu
+0000b670: 6e6b 2e67 6574 2827 7469 746c 6527 290a  nk.get('title').
+0000b680: 0a20 2020 2020 2020 2023 204f 7572 2062  .        # Our b
+0000b690: 6f64 7920 6973 206f 6e6c 7920 6272 6f6b  ody is only brok
+0000b6a0: 656e 2075 703b 206e 6f74 206c 6f73 740a  en up; not lost.
+0000b6b0: 2020 2020 2020 2020 5f62 6f64 7920 3d20          _body = 
+0000b6c0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+0000b6d0: 290a 0a20 2020 2020 2020 2023 2055 6e2d  )..        # Un-
+0000b6e0: 7573 6564 2077 6869 7465 7370 6163 6520  used whitespace 
+0000b6f0: 6973 2061 6c77 6179 7320 636c 6561 6e65  is always cleane
+0000b700: 6420 7570 3b20 6d61 6b65 2073 7572 6520  d up; make sure 
+0000b710: 7765 2061 6363 6f75 6e74 2066 6f72 0a20  we account for. 
+0000b720: 2020 2020 2020 2023 2074 6869 7320 696e         # this in
+0000b730: 206f 7572 206e 6577 2063 616c 6375 6c61   our new calcula
+0000b740: 7469 6f6e 0a20 2020 2020 2020 2077 735f  tion.        ws_
+0000b750: 6469 6666 203d 206c 656e 286e 6577 5f62  diff = len(new_b
+0000b760: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+0000b770: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+0000b780: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
+0000b790: 2020 6c65 6e28 6e65 775f 626f 6479 5b6f    len(new_body[o
+0000b7a0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+0000b7b0: 2920 2b20 6f66 6673 6574 5d0a 2020 2020  ) + offset].    
+0000b7c0: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
+0000b7d0: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+0000b7e0: 6327 292e 7273 7472 6970 2829 290a 0a20  c').rstrip()).. 
+0000b7f0: 2020 2020 2020 2061 7373 6572 7420 6e65         assert ne
+0000b800: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
+0000b810: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+0000b820: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
+0000b830: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+0000b840: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+0000b850: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
+0000b860: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
+0000b870: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
+0000b880: 7929 202b 2077 735f 6469 6666 290a 0a20  y) + ws_diff).. 
+0000b890: 2020 2023 2054 6573 7420 6c61 7267 6572     # Test larger
+0000b8a0: 206d 6573 7361 6765 730a 2020 2020 2320   messages.    # 
+0000b8b0: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+0000b8c0: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+0000b8d0: 6865 640a 2020 2020 636c 6173 7320 5465  hed.    class Te
+0000b8e0: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
+0000b8f0: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
+0000b900: 2020 2020 2023 2054 6573 7420 7469 746c       # Test titl
+0000b910: 6520 6d61 7820 6c65 6e67 7468 0a20 2020  e max length.   
+0000b920: 2020 2020 2074 6974 6c65 5f6d 6178 6c65       title_maxle
+0000b930: 6e20 3d20 3135 300a 0a20 2020 2020 2020  n = 150..       
+0000b940: 2023 2045 6e66 6f72 6365 2061 2062 6f64   # Enforce a bod
+0000b950: 7920 6c65 6e67 7468 2e20 4d61 6b65 2073  y length. Make s
+0000b960: 7572 6520 6974 2773 2061 6e20 696e 742e  ure it's an int.
+0000b970: 0a20 2020 2020 2020 2062 6f64 795f 6d61  .        body_ma
+0000b980: 786c 656e 203d 2031 3530 0a0a 2020 2020  xlen = 150..    
+0000b990: 2020 2020 2320 5769 7468 2061 6d61 6c67      # With amalg
+0000b9a0: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
+0000b9b0: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
+0000b9c0: 6174 655f 7469 746c 6520 3d20 5472 7565  ate_title = True
+0000b9d0: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
+0000b9e0: 6520 7469 746c 6520 746f 2062 6520 6469  e title to be di
+0000b9f0: 7370 6c61 7965 6420 616c 7761 7973 0a20  splayed always. 
+0000ba00: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+0000ba10: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
+0000ba20: 6365 203d 2046 616c 7365 0a0a 2020 2020  ce = False..    
+0000ba30: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0000ba40: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+0000ba50: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0000ba60: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+0000ba70: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
+0000ba80: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
+0000ba90: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
+0000baa0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0000bab0: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
+0000bac0: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
+0000bad0: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
+0000bae0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+0000baf0: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
+0000bb00: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
+0000bb10: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
+0000bb20: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
+0000bb30: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
+0000bb40: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
+0000bb50: 7420 4e6f 6e65 0a0a 2020 2020 6e65 775f  t None..    new_
+0000bb60: 626f 6479 203d 2028 626f 6479 202a 2035  body = (body * 5
+0000bb70: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+0000bb80: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+0000bb90: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+0000bba0: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
+0000bbb0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000bbc0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+0000bbd0: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
+0000bbe0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+0000bbf0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+0000bc00: 6479 3d6e 6577 5f62 6f64 792c 2074 6974  dy=new_body, tit
+0000bc10: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+0000bc20: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+0000bc30: 7665 7266 6c6f 7728 626f 6479 3d6e 6577  verflow(body=new
+0000bc40: 5f62 6f64 792c 2074 6974 6c65 3d74 6974  _body, title=tit
+0000bc50: 6c65 290a 2020 2020 6f66 6673 6574 203d  le).    offset =
+0000bc60: 2030 0a20 2020 2023 206f 7665 7266 6c6f   0.    # overflo
+0000bc70: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
+0000bc80: 6f6e 6365 2077 686c 6520 7365 7420 746f  once whle set to
+0000bc90: 2046 616c 7365 2069 7320 7374 696c 6c20   False is still 
+0000bca0: 6967 6e6f 7265 640a 2020 2020 2320 6265  ignored.    # be
+0000bcb0: 6361 7573 6520 6f75 7220 7469 746c 655f  cause our title_
+0000bcc0: 6d61 786c 656e 203e 2062 6f64 795f 6d61  maxlen > body_ma
+0000bcd0: 786c 656e 2061 6e64 2061 2066 756c 6c20  xlen and a full 
+0000bce0: 7469 746c 6520 7761 730a 2020 2020 2320  title was.    # 
+0000bcf0: 7072 6f76 6964 6564 0a20 2020 2061 7373  provided.    ass
+0000bd00: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+0000bd10: 3d3d 2033 360a 2020 2020 666f 7220 6964  == 36.    for id
+0000bd20: 782c 2063 6875 6e6b 2069 6e20 656e 756d  x, chunk in enum
+0000bd30: 6572 6174 6528 6368 756e 6b73 2c20 7374  erate(chunks, st
+0000bd40: 6172 743d 3129 3a0a 2020 2020 2020 2020  art=1):.        
+0000bd50: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
+0000bd60: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0000bd70: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
+0000bd80: 6c65 2729 2920 3c3d 206f 626a 2e74 6974  le')) <= obj.tit
+0000bd90: 6c65 5f6d 6178 6c65 6e0a 2020 2020 2020  le_maxlen.      
+0000bda0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0000bdb0: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
+0000bdc0: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
+0000bdd0: 656e 0a0a 2020 2020 2020 2020 2320 4f75  en..        # Ou
+0000bde0: 7220 7469 746c 6520 6861 7320 6e6f 2063  r title has no c
+0000bdf0: 6f75 6e74 6572 2061 6464 6564 2074 6f20  ounter added to 
+0000be00: 6974 0a20 2020 2020 2020 2069 6620 6964  it.        if id
+0000be10: 7820 3e20 313a 0a20 2020 2020 2020 2020  x > 1:.         
+0000be20: 2020 2023 2045 6d70 7479 2028 6e6f 2074     # Empty (no t
+0000be30: 6974 6c65 2064 6973 706c 6179 6564 206f  itle displayed o
+0000be40: 6e20 666f 6c6c 6f77 696e 6720 656e 7472  n following entr
+0000be50: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
+0000be60: 6173 7365 7274 2063 6875 6e6b 2e67 6574  assert chunk.get
+0000be70: 2827 7469 746c 6527 2920 3d3d 2022 220a  ('title') == "".
+0000be80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000be90: 2020 2020 2020 2020 2020 2320 4265 6361            # Beca
+0000bea0: 7573 6520 3135 3020 6973 2077 6861 7420  use 150 is what 
+0000beb0: 7765 2073 6574 2074 6865 2074 6974 6c65  we set the title
+0000bec0: 206c 696d 6974 2074 6f0a 2020 2020 2020   limit to.      
+0000bed0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0000bee0: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
+0000bef0: 6527 2929 203d 3d20 6f62 6a2e 7469 746c  e')) == obj.titl
+0000bf00: 655f 6d61 786c 656e 0a20 2020 2020 2020  e_maxlen.       
+0000bf10: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
+0000bf20: 655b 3a6f 626a 2e74 6974 6c65 5f6d 6178  e[:obj.title_max
+0000bf30: 6c65 6e5d 203d 3d20 6368 756e 6b2e 6765  len] == chunk.ge
+0000bf40: 7428 2774 6974 6c65 2729 0a0a 2020 2020  t('title')..    
+0000bf50: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
+0000bf60: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
+0000bf70: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
+0000bf80: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
+0000bf90: 2e67 6574 2827 626f 6479 2729 0a0a 2020  .get('body')..  
+0000bfa0: 2020 2020 2020 2320 556e 2d75 7365 6420        # Un-used 
+0000bfb0: 7768 6974 6573 7061 6365 2069 7320 616c  whitespace is al
+0000bfc0: 7761 7973 2063 6c65 616e 6564 2075 703b  ways cleaned up;
+0000bfd0: 206d 616b 6520 7375 7265 2077 6520 6163   make sure we ac
+0000bfe0: 636f 756e 7420 666f 720a 2020 2020 2020  count for.      
+0000bff0: 2020 2320 7468 6973 2069 6e20 6f75 7220    # this in our 
+0000c000: 6e65 7720 6361 6c63 756c 6174 696f 6e0a  new calculation.
+0000c010: 2020 2020 2020 2020 7773 5f64 6966 6620          ws_diff 
+0000c020: 3d20 6c65 6e28 6e65 775f 626f 6479 5b6f  = len(new_body[o
+0000c030: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+0000c040: 2920 2b20 6f66 6673 6574 5d29 202d 205c  ) + offset]) - \
+0000c050: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+0000c060: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
+0000c070: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+0000c080: 6666 7365 745d 0a20 2020 2020 2020 2020  ffset].         
+0000c090: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+0000c0a0: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+0000c0b0: 7374 7269 7028 2929 0a0a 2020 2020 2020  strip())..      
+0000c0c0: 2020 6173 7365 7274 206e 6577 5f62 6f64    assert new_bod
+0000c0d0: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
+0000c0e0: 6f64 7929 202b 206f 6666 7365 7420 2b20  ody) + offset + 
+0000c0f0: 7773 5f64 6966 665d 5c0a 2020 2020 2020  ws_diff]\.      
+0000c100: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+0000c110: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+0000c120: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
+0000c130: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
+0000c140: 3d20 286c 656e 285f 626f 6479 2920 2b20  = (len(_body) + 
+0000c150: 7773 5f64 6966 6629 0a0a 2020 2020 6368  ws_diff)..    ch
+0000c160: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0000c170: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0000c180: 6e65 775f 626f 6479 2c20 7469 746c 653d  new_body, title=
+0000c190: 7469 746c 6529 0a20 2020 206f 6666 7365  title).    offse
+0000c1a0: 7420 3d20 300a 2020 2020 2320 6f76 6572  t = 0.    # over
+0000c1b0: 666c 6f77 5f64 6973 706c 6179 5f74 6974  flow_display_tit
+0000c1c0: 6c65 5f6f 6e63 6520 7768 6c65 2073 6574  le_once whle set
+0000c1d0: 2074 6f20 4661 6c73 6520 6973 2073 7469   to False is sti
+0000c1e0: 6c6c 2069 676e 6f72 6564 0a20 2020 2023  ll ignored.    #
+0000c1f0: 2062 6563 6175 7365 206f 7572 2074 6974   because our tit
+0000c200: 6c65 5f6d 6178 6c65 6e20 3e20 626f 6479  le_maxlen > body
+0000c210: 5f6d 6178 6c65 6e20 616e 6420 6120 6675  _maxlen and a fu
+0000c220: 6c6c 2074 6974 6c65 2077 6173 0a20 2020  ll title was.   
+0000c230: 2023 2070 726f 7669 6465 640a 2020 2020   # provided.    
+0000c240: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+0000c250: 7329 203d 3d20 3336 0a20 2020 2066 6f72  s) == 36.    for
+0000c260: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+0000c270: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+0000c280: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+0000c290: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+0000c2a0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+0000c2b0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0000c2c0: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+0000c2d0: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+0000c2e0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0000c2f0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+0000c300: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+0000c310: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+0000c320: 204f 7572 2074 6974 6c65 2068 6173 206e   Our title has n
+0000c330: 6f20 636f 756e 7465 7220 6164 6465 6420  o counter added 
+0000c340: 746f 2069 740a 2020 2020 2020 2020 6966  to it.        if
+0000c350: 2069 6478 203e 2031 3a0a 2020 2020 2020   idx > 1:.      
+0000c360: 2020 2020 2020 2320 456d 7074 7920 286e        # Empty (n
+0000c370: 6f20 7469 746c 6520 6469 7370 6c61 7965  o title displaye
+0000c380: 6420 6f6e 2066 6f6c 6c6f 7769 6e67 2065  d on following e
+0000c390: 6e74 7269 6573 0a20 2020 2020 2020 2020  ntries.         
+0000c3a0: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
+0000c3b0: 6765 7428 2774 6974 6c65 2729 203d 3d20  get('title') == 
+0000c3c0: 2222 0a20 2020 2020 2020 2065 6c73 653a  "".        else:
+0000c3d0: 0a20 2020 2020 2020 2020 2020 2023 2042  .            # B
+0000c3e0: 6563 6175 7365 2031 3530 2069 7320 7768  ecause 150 is wh
+0000c3f0: 6174 2077 6520 7365 7420 7468 6520 7469  at we set the ti
+0000c400: 746c 6520 6c69 6d69 7420 746f 0a20 2020  tle limit to.   
+0000c410: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0000c420: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
+0000c430: 6974 6c65 2729 2920 3d3d 206f 626a 2e74  itle')) == obj.t
+0000c440: 6974 6c65 5f6d 6178 6c65 6e0a 2020 2020  itle_maxlen.    
+0000c450: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+0000c460: 6974 6c65 5b3a 6f62 6a2e 7469 746c 655f  itle[:obj.title_
+0000c470: 6d61 786c 656e 5d20 3d3d 2063 6875 6e6b  maxlen] == chunk
+0000c480: 2e67 6574 2827 7469 746c 6527 290a 0a20  .get('title').. 
+0000c490: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
+0000c4a0: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
+0000c4b0: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
+0000c4c0: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
+0000c4d0: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
+0000c4e0: 0a20 2020 2020 2020 2023 2055 6e2d 7573  .        # Un-us
+0000c4f0: 6564 2077 6869 7465 7370 6163 6520 6973  ed whitespace is
+0000c500: 2061 6c77 6179 7320 636c 6561 6e65 6420   always cleaned 
+0000c510: 7570 3b20 6d61 6b65 2073 7572 6520 7765  up; make sure we
+0000c520: 2061 6363 6f75 6e74 2066 6f72 0a20 2020   account for.   
+0000c530: 2020 2020 2023 2074 6869 7320 696e 206f       # this in o
+0000c540: 7572 206e 6577 2063 616c 6375 6c61 7469  ur new calculati
+0000c550: 6f6e 0a20 2020 2020 2020 2077 735f 6469  on.        ws_di
+0000c560: 6666 203d 206c 656e 286e 6577 5f62 6f64  ff = len(new_bod
+0000c570: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
+0000c580: 6f64 7929 202b 206f 6666 7365 745d 2920  ody) + offset]) 
+0000c590: 2d20 5c0a 2020 2020 2020 2020 2020 2020  - \.            
+0000c5a0: 6c65 6e28 6e65 775f 626f 6479 5b6f 6666  len(new_body[off
+0000c5b0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+0000c5c0: 2b20 6f66 6673 6574 5d0a 2020 2020 2020  + offset].      
+0000c5d0: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
+0000c5e0: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
+0000c5f0: 292e 7273 7472 6970 2829 290a 0a20 2020  ).rstrip())..   
+0000c600: 2020 2020 2061 7373 6572 7420 6e65 775f       assert new_
+0000c610: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
+0000c620: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
+0000c630: 202b 2077 735f 6469 6666 5d5c 0a20 2020   + ws_diff]\.   
+0000c640: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
+0000c650: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
+0000c660: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
+0000c670: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
+0000c680: 7420 2b3d 2028 6c65 6e28 5f62 6f64 7929  t += (len(_body)
+0000c690: 202b 2077 735f 6469 6666 290a 0a20 2020   + ws_diff)..   
+0000c6a0: 2023 0a20 2020 2023 2052 756e 2061 6761   #.    # Run aga
+0000c6b0: 696e 2062 7574 2077 6974 6820 6120 736d  in but with a sm
+0000c6c0: 616c 6c65 7220 7469 746c 650a 2020 2020  aller title.    
+0000c6d0: 230a 2020 2020 6368 756e 6b73 203d 206f  #.    chunks = o
+0000c6e0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+0000c6f0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
+0000c700: 2c20 7469 746c 653d 7469 746c 655b 3a33  , title=title[:3
+0000c710: 305d 290a 2020 2020 6f66 6673 6574 203d  0]).    offset =
+0000c720: 2030 0a20 2020 2023 206f 7665 7266 6c6f   0.    # overflo
+0000c730: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
+0000c740: 6f6e 6365 2077 686c 6520 7365 7420 746f  once whle set to
+0000c750: 2046 616c 7365 2069 7320 7374 696c 6c20   False is still 
+0000c760: 6967 6e6f 7265 640a 2020 2020 2320 6265  ignored.    # be
+0000c770: 6361 7573 6520 6f75 7220 626f 6479 5f6d  cause our body_m
+0000c780: 6178 6c65 6e20 2861 6674 6572 2074 6974  axlen (after tit
+0000c790: 6c65 2068 6173 2062 6565 6e20 6361 6c63  le has been calc
+0000c7a0: 756c 6174 6564 2077 6974 6820 6974 290a  ulated with it).
+0000c7b0: 2020 2020 2320 6973 206c 6573 7320 7468      # is less th
+0000c7c0: 656e 2074 6865 206f 7665 7266 6c6f 775f  en the overflow_
+0000c7d0: 6469 7370 6c61 795f 636f 756e 745f 7468  display_count_th
+0000c7e0: 7265 7368 6f6c 643b 2068 656e 6365 2061  reshold; hence a
+0000c7f0: 206d 6573 7361 6765 0a20 2020 2023 206d   message.    # m
+0000c800: 7573 7420 6265 2061 2063 6572 7461 696e  ust be a certain
+0000c810: 206d 696e 696d 756d 2073 697a 6520 696e   minimum size in
+0000c820: 206f 7264 6572 2074 6f20 6b69 636b 2069   order to kick i
+0000c830: 6e0a 2020 2020 6173 7365 7274 206c 656e  n.    assert len
+0000c840: 2863 6875 6e6b 7329 203d 3d20 3438 0a20  (chunks) == 48. 
+0000c850: 2020 2066 6f72 2069 6478 2c20 6368 756e     for idx, chun
+0000c860: 6b20 696e 2065 6e75 6d65 7261 7465 2863  k in enumerate(c
+0000c870: 6875 6e6b 732c 2073 7461 7274 3d31 293a  hunks, start=1):
+0000c880: 0a20 2020 2020 2020 2023 2056 6572 6966  .        # Verif
+0000c890: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
+0000c8a0: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+0000c8b0: 2e67 6574 2827 7469 746c 6527 2929 203c  .get('title')) <
+0000c8c0: 3d20 6f62 6a2e 7469 746c 655f 6d61 786c  = obj.title_maxl
+0000c8d0: 656e 0a20 2020 2020 2020 2061 7373 6572  en.        asser
+0000c8e0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+0000c8f0: 2762 6f64 7927 2929 203c 3d20 6f62 6a2e  'body')) <= obj.
+0000c900: 626f 6479 5f6d 6178 6c65 6e0a 0a20 2020  body_maxlen..   
+0000c910: 2020 2020 2023 204f 7572 2074 6974 6c65       # Our title
+0000c920: 2064 6f65 736e 2774 2063 6861 6e67 650a   doesn't change.
+0000c930: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0000c940: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
+0000c950: 746c 6527 2929 203d 3d20 3330 0a20 2020  tle')) == 30.   
+0000c960: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
+0000c970: 655b 3a33 305d 203d 3d20 6368 756e 6b2e  e[:30] == chunk.
+0000c980: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
+0000c990: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
+0000c9a0: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
+0000c9b0: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
+0000c9c0: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
+0000c9d0: 6e6b 2e67 6574 2827 626f 6479 2729 0a0a  nk.get('body')..
+0000c9e0: 2020 2020 2020 2020 2320 556e 2d75 7365          # Un-use
+0000c9f0: 6420 7768 6974 6573 7061 6365 2069 7320  d whitespace is 
+0000ca00: 616c 7761 7973 2063 6c65 616e 6564 2075  always cleaned u
+0000ca10: 703b 206d 616b 6520 7375 7265 2077 6520  p; make sure we 
+0000ca20: 6163 636f 756e 7420 666f 720a 2020 2020  account for.    
+0000ca30: 2020 2020 2320 7468 6973 2069 6e20 6f75      # this in ou
+0000ca40: 7220 6e65 7720 6361 6c63 756c 6174 696f  r new calculatio
+0000ca50: 6e0a 2020 2020 2020 2020 7773 5f64 6966  n.        ws_dif
+0000ca60: 6620 3d20 6c65 6e28 6e65 775f 626f 6479  f = len(new_body
+0000ca70: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+0000ca80: 6479 2920 2b20 6f66 6673 6574 5d29 202d  dy) + offset]) -
+0000ca90: 205c 0a20 2020 2020 2020 2020 2020 206c   \.            l
+0000caa0: 656e 286e 6577 5f62 6f64 795b 6f66 6673  en(new_body[offs
+0000cab0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+0000cac0: 206f 6666 7365 745d 2e72 7374 7269 7028   offset].rstrip(
+0000cad0: 2929 0a0a 2020 2020 2020 2020 6173 7365  ))..        asse
+0000cae0: 7274 206e 6577 5f62 6f64 795b 6f66 6673  rt new_body[offs
+0000caf0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+0000cb00: 206f 6666 7365 7420 2b20 7773 5f64 6966   offset + ws_dif
+0000cb10: 665d 5c0a 2020 2020 2020 2020 2020 2020  f]\.            
+0000cb20: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
+0000cb30: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
+0000cb40: 203d 3d20 5f62 6f64 790a 2020 2020 2020   == _body.      
+0000cb50: 2020 6f66 6673 6574 202b 3d20 286c 656e    offset += (len
+0000cb60: 285f 626f 6479 2920 2b20 7773 5f64 6966  (_body) + ws_dif
+0000cb70: 6629 0a0a 2020 2020 230a 2020 2020 2320  f)..    #.    # 
+0000cb80: 4e65 7874 2054 6573 743a 2041 7070 656e  Next Test: Appen
+0000cb90: 6420 7469 746c 6520 746f 2062 6f64 7920  d title to body 
+0000cba0: 2b20 7370 6c69 7420 626f 6479 0a20 2020  + split body.   
+0000cbb0: 2023 0a0a 2020 2020 636c 6173 7320 5465   #..    class Te
+0000cbc0: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
+0000cbd0: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
+0000cbe0: 2020 2020 2023 2045 6e66 6f72 6365 206e       # Enforce n
+0000cbf0: 6f20 7469 746c 650a 2020 2020 2020 2020  o title.        
+0000cc00: 7469 746c 655f 6d61 786c 656e 203d 2030  title_maxlen = 0
+0000cc10: 0a0a 2020 2020 2020 2020 2320 456e 666f  ..        # Enfo
+0000cc20: 7263 6520 6120 626f 6479 206c 656e 6774  rce a body lengt
+0000cc30: 6820 6261 7365 6420 6f6e 2074 6865 2074  h based on the t
+0000cc40: 6974 6c65 2e20 4d61 6b65 2073 7572 6520  itle. Make sure 
+0000cc50: 6974 2773 2061 6e20 696e 742e 0a20 2020  it's an int..   
+0000cc60: 2020 2020 2062 6f64 795f 6d61 786c 656e       body_maxlen
+0000cc70: 203d 2069 6e74 2874 6974 6c65 5f6c 656e   = int(title_len
+0000cc80: 202f 2034 290a 0a20 2020 2020 2020 2023   / 4)..        #
+0000cc90: 2057 6974 6820 616d 616c 6761 6d61 7469   With amalgamati
+0000cca0: 6f6e 0a20 2020 2020 2020 206f 7665 7266  on.        overf
+0000ccb0: 6c6f 775f 616d 616c 6761 6d61 7465 5f74  low_amalgamate_t
+0000ccc0: 6974 6c65 203d 2054 7275 650a 0a20 2020  itle = True..   
+0000ccd0: 2020 2020 2023 2046 6f72 6365 2074 6974       # Force tit
+0000cce0: 6c65 2074 6f20 6265 2064 6973 706c 6179  le to be display
+0000ccf0: 6564 2061 6c77 6179 730a 2020 2020 2020  ed always.      
+0000cd00: 2020 6f76 6572 666c 6f77 5f64 6973 706c    overflow_displ
+0000cd10: 6179 5f74 6974 6c65 5f6f 6e63 6520 3d20  ay_title_once = 
+0000cd20: 4661 6c73 650a 0a20 2020 2020 2020 2064  False..        d
+0000cd30: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+0000cd40: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+0000cd50: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0000cd60: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
+0000cd70: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
+0000cd80: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
+0000cd90: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+0000cda0: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+0000cdb0: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
+0000cdc0: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
+0000cdd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000cde0: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
+0000cdf0: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
+0000ce00: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
+0000ce10: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
+0000ce20: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
+0000ce30: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
+0000ce40: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
+0000ce50: 650a 0a20 2020 2023 2056 6572 6966 7920  e..    # Verify 
+0000ce60: 7468 6174 2077 6520 6272 6561 6b20 7468  that we break th
+0000ce70: 6520 7469 746c 6520 746f 2061 206d 6178  e title to a max
+0000ce80: 206c 656e 6774 6820 6f66 206f 7572 2074   length of our t
+0000ce90: 6974 6c65 5f6d 6178 0a20 2020 2023 2061  itle_max.    # a
+0000cea0: 6e64 2074 6861 7420 7468 6520 626f 6479  nd that the body
+0000ceb0: 2072 656d 6169 6e73 2075 6e74 6f75 6368   remains untouch
+0000cec0: 6564 0a20 2020 2063 6875 6e6b 7320 3d20  ed.    chunks = 
+0000ced0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+0000cee0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
+0000cef0: 6c65 3d74 6974 6c65 290a 2020 2020 6368  le=title).    ch
+0000cf00: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0000cf10: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0000cf20: 2222 2c20 7469 746c 653d 2222 290a 2020  "", title="").  
+0000cf30: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+0000cf40: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+0000cf50: 6f64 793d 626f 6479 2c20 7469 746c 653d  ody=body, title=
+0000cf60: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+0000cf70: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0000cf80: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+0000cf90: 7469 746c 653d 7469 746c 6529 0a0a 2020  title=title)..  
+0000cfa0: 2020 2320 4f75 7220 6669 6e61 6c20 7072    # Our final pr
+0000cfb0: 6f64 7563 7420 6973 2074 6861 7420 6f75  oduct is that ou
+0000cfc0: 7220 7469 746c 6520 6861 7320 6265 656e  r title has been
+0000cfd0: 2061 7070 656e 6465 6420 746f 206f 7572   appended to our
+0000cfe0: 2062 6f64 7920 746f 0a20 2020 2023 2063   body to.    # c
+0000cff0: 7265 6174 6520 6f6e 6520 6772 6561 7420  reate one great 
+0000d000: 6269 6720 626f 6479 2e20 4173 2061 2072  big body. As a r
+0000d010: 6573 756c 7420 7765 276c 6c20 6765 7420  esult we'll get 
+0000d020: 7175 6974 6520 6120 6665 7720 6c69 6e65  quite a few line
+0000d030: 7320 6261 636b 0a20 2020 2023 206e 6f77  s back.    # now
+0000d040: 2e0a 2020 2020 6f66 6673 6574 203d 2030  ..    offset = 0
+0000d050: 0a0a 2020 2020 2320 4f75 7220 626f 6479  ..    # Our body
+0000d060: 2077 696c 6c20 6c6f 6f6b 206c 696b 6520   will look like 
+0000d070: 7468 6973 2069 6e20 736d 616c 6c20 6368  this in small ch
+0000d080: 756e 6b73 2061 7420 7468 6520 656e 6420  unks at the end 
+0000d090: 6f66 2074 6865 2064 6179 0a20 2020 2062  of the day.    b
+0000d0a0: 756c 6b20 3d20 7469 746c 6520 2b20 275c  ulk = title + '\
+0000d0b0: 725c 6e27 202b 2062 6f64 790a 0a20 2020  r\n' + body..   
+0000d0c0: 2023 2044 7565 2074 6f20 7468 6520 6e65   # Due to the ne
+0000d0d0: 7720 6c69 6e65 2061 6464 6564 2074 6f20  w line added to 
+0000d0e0: 7468 6520 656e 640a 2020 2020 6173 7365  the end.    asse
+0000d0f0: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
+0000d100: 3d20 280a 2020 2020 2020 2020 2320 7772  = (.        # wr
+0000d110: 6170 2064 6976 6973 696f 6e20 696e 2069  ap division in i
+0000d120: 6e74 2829 2073 6f20 5079 7468 6f6e 2033  nt() so Python 3
+0000d130: 2064 6f65 736e 2774 2063 6f6e 7665 7274   doesn't convert
+0000d140: 2069 7420 746f 2061 2066 6c6f 6174 206f   it to a float o
+0000d150: 6e0a 2020 2020 2020 2020 2320 7573 0a20  n.        # us. 
+0000d160: 2020 2020 2020 2069 6e74 286c 656e 2862         int(len(b
+0000d170: 756c 6b29 202f 206f 626a 2e62 6f64 795f  ulk) / obj.body_
+0000d180: 6d61 786c 656e 2920 2b0a 2020 2020 2020  maxlen) +.      
+0000d190: 2020 2831 2069 6620 6c65 6e28 6275 6c6b    (1 if len(bulk
+0000d1a0: 2920 2520 6f62 6a2e 626f 6479 5f6d 6178  ) % obj.body_max
+0000d1b0: 6c65 6e20 656c 7365 2030 2929 0a0a 2020  len else 0))..  
+0000d1c0: 2020 666f 7220 6368 756e 6b20 696e 2063    for chunk in c
+0000d1d0: 6875 6e6b 733a 0a20 2020 2020 2020 2023  hunks:.        #
+0000d1e0: 2056 6572 6966 6963 6174 696f 6e0a 2020   Verification.  
+0000d1f0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0000d200: 2863 6875 6e6b 2e67 6574 2827 7469 746c  (chunk.get('titl
+0000d210: 6527 2929 203d 3d20 300a 2020 2020 2020  e')) == 0.      
+0000d220: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0000d230: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
+0000d240: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
+0000d250: 656e 0a0a 2020 2020 2020 2020 2320 4f75  en..        # Ou
+0000d260: 7220 7469 746c 6520 6973 2065 6d70 7479  r title is empty
+0000d270: 2065 7665 7279 2074 696d 650a 2020 2020   every time.    
+0000d280: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+0000d290: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+0000d2a0: 2027 270a 2020 2020 2020 2020 2320 4f75   ''.        # Ou
+0000d2b0: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
+0000d2c0: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
+0000d2d0: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
+0000d2e0: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
+0000d2f0: 6479 2729 0a0a 2020 2020 2020 2020 2320  dy')..        # 
+0000d300: 556e 2d75 7365 6420 7768 6974 6573 7061  Un-used whitespa
+0000d310: 6365 2069 7320 616c 7761 7973 2063 6c65  ce is always cle
+0000d320: 616e 6564 2075 703b 206d 616b 6520 7375  aned up; make su
+0000d330: 7265 2077 6520 6163 636f 756e 7420 666f  re we account fo
+0000d340: 720a 2020 2020 2020 2020 2320 7468 6973  r.        # this
+0000d350: 2069 6e20 6f75 7220 6e65 7720 6361 6c63   in our new calc
+0000d360: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
+0000d370: 7773 5f64 6966 6620 3d20 6c65 6e28 6275  ws_diff = len(bu
+0000d380: 6c6b 5b6f 6666 7365 743a 206c 656e 285f  lk[offset: len(_
+0000d390: 626f 6479 2920 2b20 6f66 6673 6574 5d29  body) + offset])
+0000d3a0: 202d 205c 0a20 2020 2020 2020 2020 2020   - \.           
+0000d3b0: 206c 656e 2862 756c 6b5b 6f66 6673 6574   len(bulk[offset
+0000d3c0: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+0000d3d0: 6666 7365 745d 0a20 2020 2020 2020 2020  ffset].         
+0000d3e0: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+0000d3f0: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+0000d400: 7374 7269 7028 2929 0a0a 2020 2020 2020  strip())..      
+0000d410: 2020 6173 7365 7274 2062 756c 6b5b 6f66    assert bulk[of
+0000d420: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+0000d430: 202b 206f 6666 7365 7420 2b20 7773 5f64   + offset + ws_d
+0000d440: 6966 665d 5c0a 2020 2020 2020 2020 2020  iff]\.          
+0000d450: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
+0000d460: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
+0000d470: 2829 203d 3d20 5f62 6f64 790a 2020 2020  () == _body.    
+0000d480: 2020 2020 6f66 6673 6574 202b 3d20 286c      offset += (l
+0000d490: 656e 285f 626f 6479 2920 2b20 7773 5f64  en(_body) + ws_d
+0000d4a0: 6966 6629 0a0a 2020 2020 230a 2020 2020  iff)..    #.    
+0000d4b0: 2320 5465 7374 2063 6173 6520 7768 6572  # Test case wher
+0000d4c0: 6520 6f75 7220 7469 746c 655f 6c65 6e20  e our title_len 
+0000d4d0: 6973 2073 686f 7274 6572 2074 6865 6e20  is shorter then 
+0000d4e0: 7468 6520 7661 6c75 650a 2020 2020 2320  the value.    # 
+0000d4f0: 7468 6174 2077 6f75 6c64 206f 7468 6572  that would other
+0000d500: 7769 7365 2074 7269 6767 6572 2074 6865  wise trigger the
+0000d510: 205b 5858 2f58 585d 2065 6c65 6d65 6e74   [XX/XX] element
+0000d520: 730a 2020 2020 230a 0a20 2020 2063 6c61  s.    #..    cla
+0000d530: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
+0000d540: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+0000d550: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
+0000d560: 6120 736d 616c 6c20 7469 746c 6520 6c65  a small title le
+0000d570: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
+0000d580: 6c65 5f6d 6178 6c65 6e20 3d20 3130 300a  le_maxlen = 100.
+0000d590: 0a20 2020 2020 2020 2023 2045 6e66 6f72  .        # Enfor
+0000d5a0: 6365 2061 2062 6f64 7920 6c65 6e67 7468  ce a body length
+0000d5b0: 2e20 4d61 6b65 2073 7572 6520 6974 2773  . Make sure it's
+0000d5c0: 2061 6e20 696e 742e 0a20 2020 2020 2020   an int..       
+0000d5d0: 2062 6f64 795f 6d61 786c 656e 203d 2069   body_maxlen = i
+0000d5e0: 6e74 2862 6f64 795f 6c65 6e20 2f20 3429  nt(body_len / 4)
+0000d5f0: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+0000d600: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+0000d610: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+0000d620: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+0000d630: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+0000d640: 2320 466f 7263 6520 7469 746c 6520 746f  # Force title to
+0000d650: 2062 6520 6469 7370 6c61 7965 6420 616c   be displayed al
+0000d660: 7761 7973 0a20 2020 2020 2020 206f 7665  ways.        ove
+0000d670: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
+0000d680: 746c 655f 6f6e 6365 203d 2046 616c 7365  tle_once = False
+0000d690: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
+0000d6a0: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
+0000d6b0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+0000d6c0: 2020 2020 2020 2020 2020 2073 7570 6572             super
+0000d6d0: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
+0000d6e0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
+0000d6f0: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
+0000d700: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0000d710: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0000d720: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
+0000d730: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
+0000d740: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+0000d750: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
+0000d760: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
+0000d770: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
+0000d780: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
+0000d790: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
+0000d7a0: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
+0000d7b0: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
+0000d7c0: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
+0000d7d0: 7765 2062 7265 616b 2074 6865 2074 6974  we break the tit
+0000d7e0: 6c65 2074 6f20 6120 6d61 7820 6c65 6e67  le to a max leng
+0000d7f0: 7468 206f 6620 6f75 7220 7469 746c 655f  th of our title_
+0000d800: 6d61 780a 2020 2020 2320 616e 6420 7468  max.    # and th
+0000d810: 6174 2074 6865 2062 6f64 7920 7265 6d61  at the body rema
+0000d820: 696e 7320 756e 746f 7563 6865 640a 2020  ins untouched.  
+0000d830: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+0000d840: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+0000d850: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
+0000d860: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
+0000d870: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0000d880: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+0000d890: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+0000d8a0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000d8b0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+0000d8c0: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+0000d8d0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0000d8e0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0000d8f0: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+0000d900: 3d74 6974 6c65 290a 2020 2020 6f66 6673  =title).    offs
+0000d910: 6574 203d 2030 0a20 2020 2061 7373 6572  et = 0.    asser
+0000d920: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
+0000d930: 2037 0a20 2020 2066 6f72 2069 6478 2c20   7.    for idx, 
+0000d940: 6368 756e 6b20 696e 2065 6e75 6d65 7261  chunk in enumera
+0000d950: 7465 2863 6875 6e6b 732c 2073 7461 7274  te(chunks, start
+0000d960: 3d31 293a 0a20 2020 2020 2020 2023 2056  =1):.        # V
+0000d970: 6572 6966 6963 6174 696f 6e0a 2020 2020  erification.    
+0000d980: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+0000d990: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+0000d9a0: 2929 203c 3d20 6f62 6a2e 7469 746c 655f  )) <= obj.title_
+0000d9b0: 6d61 786c 656e 0a20 2020 2020 2020 2061  maxlen.        a
+0000d9c0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
+0000d9d0: 6765 7428 2762 6f64 7927 2929 203c 3d20  get('body')) <= 
+0000d9e0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e0a  obj.body_maxlen.
+0000d9f0: 0a20 2020 2020 2020 2023 204f 7572 2074  .        # Our t
+0000da00: 6974 6c65 2069 7320 7472 756e 6361 7465  itle is truncate
+0000da10: 6420 616e 6420 6e6f 2063 6f75 6e74 6572  d and no counter
+0000da20: 2061 6464 6564 0a20 2020 2020 2020 2061   added.        a
+0000da30: 7373 6572 7420 7469 746c 655b 3a6f 626a  ssert title[:obj
+0000da40: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
+0000da50: 3d20 6368 756e 6b2e 6765 7428 2774 6974  = chunk.get('tit
+0000da60: 6c65 2729 0a0a 2020 2020 2020 2020 2320  le')..        # 
+0000da70: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
+0000da80: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
+0000da90: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
+0000daa0: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
+0000dab0: 626f 6479 2729 0a0a 2020 2020 2020 2020  body')..        
+0000dac0: 2320 556e 2d75 7365 6420 7768 6974 6573  # Un-used whites
+0000dad0: 7061 6365 2069 7320 616c 7761 7973 2063  pace is always c
+0000dae0: 6c65 616e 6564 2075 703b 206d 616b 6520  leaned up; make 
+0000daf0: 7375 7265 2077 6520 6163 636f 756e 7420  sure we account 
+0000db00: 666f 720a 2020 2020 2020 2020 2320 7468  for.        # th
+0000db10: 6973 2069 6e20 6f75 7220 6e65 7720 6361  is in our new ca
+0000db20: 6c63 756c 6174 696f 6e0a 2020 2020 2020  lculation.      
+0000db30: 2020 7773 5f64 6966 6620 3d20 6c65 6e28    ws_diff = len(
+0000db40: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
+0000db50: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
+0000db60: 5d29 202d 205c 0a20 2020 2020 2020 2020  ]) - \.         
+0000db70: 2020 206c 656e 2862 6f64 795b 6f66 6673     len(body[offs
+0000db80: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+0000db90: 206f 6666 7365 745d 0a20 2020 2020 2020   offset].       
+0000dba0: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
+0000dbb0: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
+0000dbc0: 2e72 7374 7269 7028 2929 0a0a 2020 2020  .rstrip())..    
+0000dbd0: 2020 2020 6173 7365 7274 2062 6f64 795b      assert body[
+0000dbe0: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
+0000dbf0: 7929 202b 206f 6666 7365 7420 2b20 7773  y) + offset + ws
+0000dc00: 5f64 6966 665d 5c0a 2020 2020 2020 2020  _diff]\.        
+0000dc10: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
+0000dc20: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
+0000dc30: 6970 2829 203d 3d20 5f62 6f64 790a 2020  ip() == _body.  
+0000dc40: 2020 2020 2020 6f66 6673 6574 202b 3d20        offset += 
+0000dc50: 286c 656e 285f 626f 6479 2920 2b20 7773  (len(_body) + ws
+0000dc60: 5f64 6966 6629 0a0a 2020 2020 230a 2020  _diff)..    #.  
+0000dc70: 2020 2320 5363 656e 6172 696f 2077 6865    # Scenario whe
+0000dc80: 7265 2074 6865 2074 6974 6c65 206c 656e  re the title len
+0000dc90: 6774 6820 6973 206c 6172 6765 7220 7468  gth is larger th
+0000dca0: 616e 2074 6865 2062 6f64 790a 2020 2020  an the body.    
+0000dcb0: 230a 0a20 2020 2063 6c61 7373 2054 6573  #..    class Tes
+0000dcc0: 744e 6f74 6966 6963 6174 696f 6e28 4e6f  tNotification(No
+0000dcd0: 7469 6679 4261 7365 293a 0a0a 2020 2020  tifyBase):..    
+0000dce0: 2020 2020 2320 5365 7420 6120 736d 616c      # Set a smal
+0000dcf0: 6c20 7469 746c 6520 6c65 6e67 7468 0a20  l title length. 
+0000dd00: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
+0000dd10: 6c65 6e20 3d20 3130 300a 0a20 2020 2020  len = 100..     
+0000dd20: 2020 2023 2045 6e66 6f72 6365 2061 2062     # Enforce a b
+0000dd30: 6f64 7920 6c65 6e67 7468 2e20 4d61 6b65  ody length. Make
+0000dd40: 2073 7572 6520 6974 2773 2061 6e20 696e   sure it's an in
+0000dd50: 742e 0a20 2020 2020 2020 2062 6f64 795f  t..        body_
+0000dd60: 6d61 786c 656e 203d 2035 300a 0a20 2020  maxlen = 50..   
+0000dd70: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
+0000dd80: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
+0000dd90: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
+0000dda0: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
+0000ddb0: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
+0000ddc0: 6365 2074 6974 6c65 2074 6f20 6265 2064  ce title to be d
+0000ddd0: 6973 706c 6179 6564 2061 6c77 6179 730a  isplayed always.
+0000dde0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
+0000ddf0: 5f64 6973 706c 6179 5f74 6974 6c65 5f6f  _display_title_o
+0000de00: 6e63 6520 3d20 4661 6c73 650a 0a20 2020  nce = False..   
+0000de10: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
+0000de20: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
+0000de30: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+0000de40: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+0000de50: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
+0000de60: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
+0000de70: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
+0000de80: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+0000de90: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
+0000dea0: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
+0000deb0: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
+0000dec0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+0000ded0: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
+0000dee0: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
+0000def0: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+0000df00: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
+0000df10: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
+0000df20: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
+0000df30: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
+0000df40: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
+0000df50: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
+0000df60: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
+0000df70: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
+0000df80: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+0000df90: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+0000dfa0: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
+0000dfb0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000dfc0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+0000dfd0: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+0000dfe0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0000dff0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0000e000: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+0000e010: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+0000e020: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0000e030: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+0000e040: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+0000e050: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0000e060: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0000e070: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+0000e080: 6529 0a20 2020 206f 6666 7365 7420 3d20  e).    offset = 
+0000e090: 300a 0a20 2020 2023 206f 7665 7266 6c6f  0..    # overflo
+0000e0a0: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
+0000e0b0: 6f6e 6365 2077 686c 6520 7365 7420 746f  once whle set to
+0000e0c0: 2046 616c 7365 2069 7320 7374 696c 6c20   False is still 
+0000e0d0: 6967 6e6f 7265 640a 2020 2020 2320 6265  ignored.    # be
+0000e0e0: 6361 7573 6520 6f75 7220 7469 746c 655f  cause our title_
+0000e0f0: 6d61 786c 656e 203e 2062 6f64 795f 6d61  maxlen > body_ma
+0000e100: 786c 656e 2061 6e64 2061 2066 756c 6c20  xlen and a full 
+0000e110: 7469 746c 6520 7761 730a 2020 2020 2320  title was.    # 
+0000e120: 7072 6f76 6964 6564 0a20 2020 2061 7373  provided.    ass
+0000e130: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+0000e140: 3d3d 2032 320a 2020 2020 666f 7220 6964  == 22.    for id
+0000e150: 782c 2063 6875 6e6b 2069 6e20 656e 756d  x, chunk in enum
+0000e160: 6572 6174 6528 6368 756e 6b73 2c20 7374  erate(chunks, st
+0000e170: 6172 743d 3129 3a0a 2020 2020 2020 2020  art=1):.        
+0000e180: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
+0000e190: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0000e1a0: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
+0000e1b0: 6c65 2729 2920 3c3d 206f 626a 2e74 6974  le')) <= obj.tit
+0000e1c0: 6c65 5f6d 6178 6c65 6e0a 2020 2020 2020  le_maxlen.      
+0000e1d0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0000e1e0: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
+0000e1f0: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
+0000e200: 656e 0a0a 2020 2020 2020 2020 2320 4f75  en..        # Ou
+0000e210: 7220 7469 746c 6520 6861 7320 6e6f 2063  r title has no c
+0000e220: 6f75 6e74 6572 2061 6464 6564 2074 6f20  ounter added to 
+0000e230: 6974 2064 7565 2074 6f20 6974 2773 206c  it due to it's l
+0000e240: 656e 6774 680a 2020 2020 2020 2020 6966  ength.        if
+0000e250: 2069 6478 203e 2031 3a0a 2020 2020 2020   idx > 1:.      
+0000e260: 2020 2020 2020 2320 456d 7074 7920 286e        # Empty (n
+0000e270: 6f20 7469 746c 6520 6469 7370 6c61 7965  o title displaye
+0000e280: 6420 6f6e 2066 6f6c 6c6f 7769 6e67 2065  d on following e
+0000e290: 6e74 7269 6573 0a20 2020 2020 2020 2020  ntries.         
+0000e2a0: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
+0000e2b0: 6765 7428 2774 6974 6c65 2729 203d 3d20  get('title') == 
+0000e2c0: 2222 0a20 2020 2020 2020 2065 6c73 653a  "".        else:
+0000e2d0: 0a20 2020 2020 2020 2020 2020 2023 2042  .            # B
+0000e2e0: 6563 6175 7365 2031 3530 2069 7320 7768  ecause 150 is wh
+0000e2f0: 6174 2077 6520 7365 7420 7468 6520 7469  at we set the ti
+0000e300: 746c 6520 6c69 6d69 7420 746f 2035 3020  tle limit to 50 
+0000e310: 6475 650a 2020 2020 2020 2020 2020 2020  due.            
+0000e320: 2320 746f 2061 6d61 6c61 6d61 7469 6f6e  # to amalamation
+0000e330: 2e20 2054 6865 206c 6f77 6573 7420 7661  .  The lowest va
+0000e340: 6c75 6520 616c 7761 7973 2070 7265 7661  lue always preva
+0000e350: 696c 730a 2020 2020 2020 2020 2020 2020  ils.            
+0000e360: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+0000e370: 2e67 6574 2827 7469 746c 6527 2929 203d  .get('title')) =
+0000e380: 3d20 6f62 6a2e 626f 6479 5f6d 6178 6c65  = obj.body_maxle
+0000e390: 6e0a 2020 2020 2020 2020 2020 2020 6173  n.            as
+0000e3a0: 7365 7274 2074 6974 6c65 5b3a 6f62 6a2e  sert title[:obj.
+0000e3b0: 626f 6479 5f6d 6178 6c65 6e5d 203d 3d20  body_maxlen] == 
+0000e3c0: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+0000e3d0: 2729 0a0a 2020 2020 2020 2020 2320 4f75  ')..        # Ou
+0000e3e0: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
+0000e3f0: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
+0000e400: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
+0000e410: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
+0000e420: 6479 2729 0a0a 2020 2020 2020 2020 2320  dy')..        # 
+0000e430: 556e 2d75 7365 6420 7768 6974 6573 7061  Un-used whitespa
+0000e440: 6365 2069 7320 616c 7761 7973 2063 6c65  ce is always cle
+0000e450: 616e 6564 2075 703b 206d 616b 6520 7375  aned up; make su
+0000e460: 7265 2077 6520 6163 636f 756e 7420 666f  re we account fo
+0000e470: 720a 2020 2020 2020 2020 2320 7468 6973  r.        # this
+0000e480: 2069 6e20 6f75 7220 6e65 7720 6361 6c63   in our new calc
+0000e490: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
+0000e4a0: 7773 5f64 6966 6620 3d20 6c65 6e28 626f  ws_diff = len(bo
+0000e4b0: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+0000e4c0: 626f 6479 2920 2b20 6f66 6673 6574 5d29  body) + offset])
+0000e4d0: 202d 205c 0a20 2020 2020 2020 2020 2020   - \.           
+0000e4e0: 206c 656e 2862 6f64 795b 6f66 6673 6574   len(body[offset
+0000e4f0: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+0000e500: 6666 7365 745d 0a20 2020 2020 2020 2020  ffset].         
+0000e510: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+0000e520: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+0000e530: 7374 7269 7028 2929 0a0a 2020 2020 2020  strip())..      
+0000e540: 2020 6173 7365 7274 2062 6f64 795b 6f66    assert body[of
+0000e550: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+0000e560: 202b 206f 6666 7365 7420 2b20 7773 5f64   + offset + ws_d
+0000e570: 6966 665d 5c0a 2020 2020 2020 2020 2020  iff]\.          
+0000e580: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
+0000e590: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
+0000e5a0: 2829 203d 3d20 5f62 6f64 790a 2020 2020  () == _body.    
+0000e5b0: 2020 2020 6f66 6673 6574 202b 3d20 286c      offset += (l
+0000e5c0: 656e 285f 626f 6479 2920 2b20 7773 5f64  en(_body) + ws_d
+0000e5d0: 6966 6629 0a0a 0a64 6566 2074 6573 745f  iff)...def test_
+0000e5e0: 6e6f 7469 6679 5f6f 7665 7266 6c6f 775f  notify_overflow_
+0000e5f0: 7370 6c69 745f 7769 7468 5f61 6d61 6c67  split_with_amalg
+0000e600: 616d 6174 696f 6e5f 666f 7263 655f 7469  amation_force_ti
+0000e610: 746c 655f 6f6e 6365 2829 3a0a 2020 2020  tle_once():.    
+0000e620: 2222 220a 2020 2020 4150 493a 204f 7665  """.    API: Ove
+0000e630: 7266 6c6f 7720 5769 7468 2041 6d61 6c67  rflow With Amalg
+0000e640: 616d 6174 696f 6e20 2874 6974 6c65 206f  amation (title o
+0000e650: 6e63 6529 2053 706c 6974 2046 756e 6374  nce) Split Funct
+0000e660: 696f 6e61 6c69 7479 2054 6573 7469 6e67  ionality Testing
+0000e670: 0a0a 2020 2020 2222 220a 0a20 2020 2023  ..    """..    #
+0000e680: 0a20 2020 2023 2041 206c 6974 746c 6520  .    # A little 
+0000e690: 7072 6570 6172 6174 696f 6e0a 2020 2020  preparation.    
+0000e6a0: 230a 0a20 2020 2023 204e 756d 6265 7220  #..    # Number 
+0000e6b0: 6f66 2063 6861 7261 6374 6572 7320 7065  of characters pe
+0000e6c0: 7220 6c69 6e65 0a20 2020 2072 6f77 203d  r line.    row =
+0000e6d0: 2032 340a 0a20 2020 2023 2053 6f6d 6520   24..    # Some 
+0000e6e0: 7661 7269 6162 6c65 7320 7765 2075 7365  variables we use
+0000e6f0: 2074 6f20 636f 6e74 726f 6c20 7468 6520   to control the 
+0000e700: 6461 7461 2077 6520 776f 726b 2077 6974  data we work wit
+0000e710: 680a 2020 2020 626f 6479 5f6c 656e 203d  h.    body_len =
+0000e720: 2031 3032 340a 2020 2020 7469 746c 655f   1024.    title_
+0000e730: 6c65 6e20 3d20 3130 3234 0a0a 2020 2020  len = 1024..    
+0000e740: 2320 4372 6561 7465 2061 206c 6172 6765  # Create a large
+0000e750: 2062 6f64 7920 616e 6420 7469 746c 6520   body and title 
+0000e760: 7769 7468 2072 616e 646f 6d20 6461 7461  with random data
+0000e770: 0a20 2020 2062 6f64 7920 3d20 2727 2e6a  .    body = ''.j
+0000e780: 6f69 6e28 6368 6f69 6365 2873 7472 5f61  oin(choice(str_a
+0000e790: 6c70 6861 202b 2073 7472 5f6e 756d 2920  lpha + str_num) 
+0000e7a0: 666f 7220 5f20 696e 2072 616e 6765 2862  for _ in range(b
+0000e7b0: 6f64 795f 6c65 6e29 290a 2020 2020 626f  ody_len)).    bo
+0000e7c0: 6479 203d 2027 5c72 5c6e 272e 6a6f 696e  dy = '\r\n'.join
+0000e7d0: 285b 626f 6479 5b69 3a20 6920 2b20 726f  ([body[i: i + ro
+0000e7e0: 775d 2066 6f72 2069 2069 6e20 7261 6e67  w] for i in rang
+0000e7f0: 6528 302c 206c 656e 2862 6f64 7929 2c20  e(0, len(body), 
+0000e800: 726f 7729 5d29 0a0a 2020 2020 2320 7468  row)])..    # th
+0000e810: 6520 6e65 7720 6c69 6e65 7320 6164 6420  e new lines add 
+0000e820: 6120 6c61 7267 6520 616d 6f75 6e74 2074  a large amount t
+0000e830: 6f20 6f75 7220 626f 6479 3b20 6c65 7473  o our body; lets
+0000e840: 2066 6f72 6365 2074 6865 2063 6f6e 7465   force the conte
+0000e850: 6e74 0a20 2020 2023 2062 6163 6b20 746f  nt.    # back to
+0000e860: 2062 6569 6e67 2031 3032 3420 6368 6172   being 1024 char
+0000e870: 6163 7465 7273 2e0a 2020 2020 626f 6479  acters..    body
+0000e880: 203d 2062 6f64 795b 303a 3130 3234 5d0a   = body[0:1024].
+0000e890: 0a20 2020 2023 2043 7265 6174 6520 6f75  .    # Create ou
+0000e8a0: 7220 7469 746c 6520 7573 696e 6720 7261  r title using ra
+0000e8b0: 6e64 6f6d 2064 6174 610a 2020 2020 7469  ndom data.    ti
+0000e8c0: 746c 6520 3d20 2727 2e6a 6f69 6e28 6368  tle = ''.join(ch
+0000e8d0: 6f69 6365 2873 7472 5f61 6c70 6861 202b  oice(str_alpha +
+0000e8e0: 2073 7472 5f6e 756d 2920 666f 7220 5f20   str_num) for _ 
+0000e8f0: 696e 2072 616e 6765 2874 6974 6c65 5f6c  in range(title_l
+0000e900: 656e 2929 0a0a 2020 2020 230a 2020 2020  en))..    #.    
+0000e910: 2320 4669 7273 7420 5465 7374 3a20 5472  # First Test: Tr
+0000e920: 756e 6361 7465 6420 5469 746c 650a 2020  uncated Title.  
+0000e930: 2020 230a 2020 2020 636c 6173 7320 5465    #.    class Te
+0000e940: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
+0000e950: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
+0000e960: 2020 2020 2023 2054 6573 7420 7469 746c       # Test titl
+0000e970: 6520 6d61 7820 6c65 6e67 7468 0a20 2020  e max length.   
+0000e980: 2020 2020 2074 6974 6c65 5f6d 6178 6c65       title_maxle
+0000e990: 6e20 3d20 3130 0a0a 2020 2020 2020 2020  n = 10..        
+0000e9a0: 2320 5769 7468 2061 6d61 6c67 616d 6174  # With amalgamat
+0000e9b0: 696f 6e0a 2020 2020 2020 2020 6f76 6572  ion.        over
+0000e9c0: 666c 6f77 5f61 6d61 6c67 616d 6174 655f  flow_amalgamate_
+0000e9d0: 7469 746c 6520 3d20 5472 7565 0a0a 2020  title = True..  
+0000e9e0: 2020 2020 2020 2320 466f 7263 6520 7469        # Force ti
+0000e9f0: 746c 6520 6469 7370 6c61 7965 6420 6f6e  tle displayed on
+0000ea00: 6365 0a20 2020 2020 2020 206f 7665 7266  ce.        overf
+0000ea10: 6c6f 775f 6469 7370 6c61 795f 7469 746c  low_display_titl
+0000ea20: 655f 6f6e 6365 203d 2054 7275 650a 0a20  e_once = True.. 
+0000ea30: 2020 2020 2020 2064 6566 205f 5f69 6e69         def __ini
+0000ea40: 745f 5f28 7365 6c66 2c20 2a61 7267 732c  t__(self, *args,
+0000ea50: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0000ea60: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+0000ea70: 5f5f 696e 6974 5f5f 282a 2a6b 7761 7267  __init__(**kwarg
+0000ea80: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
+0000ea90: 6e6f 7469 6679 2873 656c 662c 202a 6172  notify(self, *ar
+0000eaa0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+0000eab0: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
+0000eac0: 7465 6e64 2065 7665 7279 7468 696e 6720  tend everything 
+0000ead0: 6973 206f 6b61 790a 2020 2020 2020 2020  is okay.        
+0000eae0: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+0000eaf0: 0a20 2020 2023 204c 6f61 6420 6f75 7220  .    # Load our 
+0000eb00: 6f62 6a65 6374 0a20 2020 206f 626a 203d  object.    obj =
+0000eb10: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+0000eb20: 6e28 6f76 6572 666c 6f77 3d4f 7665 7266  n(overflow=Overf
+0000eb30: 6c6f 774d 6f64 652e 5350 4c49 5429 0a20  lowMode.SPLIT). 
+0000eb40: 2020 2061 7373 6572 7420 6f62 6a20 6973     assert obj is
+0000eb50: 206e 6f74 204e 6f6e 650a 0a20 2020 2023   not None..    #
+0000eb60: 2056 6572 6966 7920 7468 6174 2077 6520   Verify that we 
+0000eb70: 6272 6561 6b20 7468 6520 7469 746c 6520  break the title 
+0000eb80: 746f 2061 206d 6178 206c 656e 6774 6820  to a max length 
+0000eb90: 6f66 206f 7572 2074 6974 6c65 5f6d 6178  of our title_max
+0000eba0: 0a20 2020 2023 2061 6e64 2074 6861 7420  .    # and that 
+0000ebb0: 7468 6520 626f 6479 2072 656d 6169 6e73  the body remains
+0000ebc0: 2075 6e74 6f75 6368 6564 0a20 2020 2063   untouched.    c
+0000ebd0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+0000ebe0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+0000ebf0: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
+0000ec00: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+0000ec10: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+0000ec20: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+0000ec30: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+0000ec40: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0000ec50: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+0000ec60: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
+0000ec70: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0000ec80: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0000ec90: 793d 626f 6479 2c20 7469 746c 653d 7469  y=body, title=ti
+0000eca0: 746c 6529 0a20 2020 2061 7373 6572 7420  tle).    assert 
+0000ecb0: 6c65 6e28 6368 756e 6b73 2920 3d3d 2031  len(chunks) == 1
+0000ecc0: 0a20 2020 2061 7373 6572 7420 626f 6479  .    assert body
+0000ecd0: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
+0000ece0: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
+0000ecf0: 203d 3d20 6368 756e 6b73 5b30 5d2e 6765   == chunks[0].ge
+0000ed00: 7428 2762 6f64 7927 290a 2020 2020 6173  t('body').    as
+0000ed10: 7365 7274 2074 6974 6c65 5b30 3a6f 626a  sert title[0:obj
+0000ed20: 2e74 6974 6c65 5f6d 6178 6c65 6e5d 203d  .title_maxlen] =
+0000ed30: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
+0000ed40: 2774 6974 6c65 2729 0a0a 2020 2020 230a  'title')..    #.
+0000ed50: 2020 2020 2320 4e65 7874 2054 6573 743a      # Next Test:
+0000ed60: 204c 696e 6520 436f 756e 7420 436f 6e74   Line Count Cont
+0000ed70: 726f 6c0a 2020 2020 230a 0a20 2020 2063  rol.    #..    c
+0000ed80: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
+0000ed90: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
+0000eda0: 293a 0a0a 2020 2020 2020 2020 2320 5465  ):..        # Te
+0000edb0: 7374 2074 6974 6c65 206d 6178 206c 656e  st title max len
+0000edc0: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
+0000edd0: 655f 6d61 786c 656e 203d 2035 0a0a 2020  e_maxlen = 5..  
+0000ede0: 2020 2020 2020 2320 4d61 7869 6d75 6d20        # Maximum 
+0000edf0: 6e75 6d62 6572 206f 6620 6c69 6e65 730a  number of lines.
+0000ee00: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
+0000ee10: 5f6c 696e 655f 636f 756e 7420 3d20 350a  _line_count = 5.
+0000ee20: 0a20 2020 2020 2020 2023 2057 6974 6820  .        # With 
+0000ee30: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
+0000ee40: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
+0000ee50: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
+0000ee60: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
+0000ee70: 2046 6f72 6365 2074 6974 6c65 2064 6973   Force title dis
+0000ee80: 706c 6179 6564 206f 6e63 650a 2020 2020  played once.    
+0000ee90: 2020 2020 6f76 6572 666c 6f77 5f64 6973      overflow_dis
+0000eea0: 706c 6179 5f74 6974 6c65 5f6f 6e63 6520  play_title_once 
+0000eeb0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+0000eec0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+0000eed0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+0000eee0: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+0000eef0: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+0000ef00: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+0000ef10: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+0000ef20: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+0000ef30: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+0000ef40: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+0000ef50: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+0000ef60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ef70: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+0000ef80: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+0000ef90: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+0000efa0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+0000efb0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+0000efc0: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
+0000efd0: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+0000efe0: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+0000eff0: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+0000f000: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+0000f010: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+0000f020: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+0000f030: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+0000f040: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+0000f050: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+0000f060: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0000f070: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+0000f080: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+0000f090: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+0000f0a0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+0000f0b0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+0000f0c0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0000f0d0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0000f0e0: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+0000f0f0: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+0000f100: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0000f110: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+0000f120: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+0000f130: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0000f140: 6e6b 7329 203d 3d20 310a 2020 2020 6173  nks) == 1.    as
+0000f150: 7365 7274 206c 656e 2863 6875 6e6b 735b  sert len(chunks[
+0000f160: 305d 2e67 6574 2827 626f 6479 2729 2e73  0].get('body').s
+0000f170: 706c 6974 2827 5c6e 2729 2920 3d3d 206f  plit('\n')) == o
+0000f180: 626a 2e62 6f64 795f 6d61 785f 6c69 6e65  bj.body_max_line
+0000f190: 5f63 6f75 6e74 0a20 2020 2061 7373 6572  _count.    asser
+0000f1a0: 7420 7469 746c 655b 303a 6f62 6a2e 7469  t title[0:obj.ti
+0000f1b0: 746c 655f 6d61 786c 656e 5d20 3d3d 2063  tle_maxlen] == c
+0000f1c0: 6875 6e6b 735b 305d 2e67 6574 2827 7469  hunks[0].get('ti
+0000f1d0: 746c 6527 290a 0a20 2020 2023 0a20 2020  tle')..    #.   
+0000f1e0: 2023 204e 6578 7420 5465 7374 3a20 5370   # Next Test: Sp
+0000f1f0: 6c69 7420 626f 6479 0a20 2020 2023 0a0a  lit body.    #..
+0000f200: 2020 2020 636c 6173 7320 5465 7374 4e6f      class TestNo
+0000f210: 7469 6669 6361 7469 6f6e 284e 6f74 6966  tification(Notif
+0000f220: 7942 6173 6529 3a0a 0a20 2020 2020 2020  yBase):..       
+0000f230: 2023 2054 6573 7420 7469 746c 6520 6d61   # Test title ma
+0000f240: 7820 6c65 6e67 7468 0a20 2020 2020 2020  x length.       
+0000f250: 2074 6974 6c65 5f6d 6178 6c65 6e20 3d20   title_maxlen = 
+0000f260: 7469 746c 655f 6c65 6e0a 0a20 2020 2020  title_len..     
+0000f270: 2020 2023 2045 6e66 6f72 6365 2061 2062     # Enforce a b
+0000f280: 6f64 7920 6c65 6e67 7468 2e20 4d61 6b65  ody length. Make
+0000f290: 2073 7572 6520 6974 2773 2061 6e20 696e   sure it's an in
+0000f2a0: 742e 0a20 2020 2020 2020 2062 6f64 795f  t..        body_
+0000f2b0: 6d61 786c 656e 203d 2069 6e74 2862 6f64  maxlen = int(bod
+0000f2c0: 795f 6c65 6e20 2f20 3429 0a0a 2020 2020  y_len / 4)..    
+0000f2d0: 2020 2020 2320 5769 7468 2061 6d61 6c67      # With amalg
+0000f2e0: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
+0000f2f0: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
+0000f300: 6174 655f 7469 746c 6520 3d20 5472 7565  ate_title = True
+0000f310: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
+0000f320: 6520 7469 746c 6520 6469 7370 6c61 7965  e title displaye
+0000f330: 6420 6f6e 6365 0a20 2020 2020 2020 206f  d once.        o
+0000f340: 7665 7266 6c6f 775f 6469 7370 6c61 795f  verflow_display_
+0000f350: 7469 746c 655f 6f6e 6365 203d 2054 7275  title_once = Tru
+0000f360: 650a 0a20 2020 2020 2020 2064 6566 205f  e..        def _
+0000f370: 5f69 6e69 745f 5f28 7365 6c66 2c20 2a61  _init__(self, *a
+0000f380: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+0000f390: 2020 2020 2020 2020 2020 2020 7375 7065              supe
+0000f3a0: 7228 292e 5f5f 696e 6974 5f5f 282a 2a6b  r().__init__(**k
+0000f3b0: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
+0000f3c0: 6465 6620 6e6f 7469 6679 2873 656c 662c  def notify(self,
+0000f3d0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+0000f3e0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+0000f3f0: 2050 7265 7465 6e64 2065 7665 7279 7468   Pretend everyth
+0000f400: 696e 6720 6973 206f 6b61 790a 2020 2020  ing is okay.    
+0000f410: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+0000f420: 7275 650a 0a20 2020 2023 204c 6f61 6420  rue..    # Load 
+0000f430: 6f75 7220 6f62 6a65 6374 0a20 2020 206f  our object.    o
+0000f440: 626a 203d 2054 6573 744e 6f74 6966 6963  bj = TestNotific
+0000f450: 6174 696f 6e28 6f76 6572 666c 6f77 3d4f  ation(overflow=O
+0000f460: 7665 7266 6c6f 774d 6f64 652e 5350 4c49  verflowMode.SPLI
+0000f470: 5429 0a20 2020 2061 7373 6572 7420 6f62  T).    assert ob
+0000f480: 6a20 6973 206e 6f74 204e 6f6e 650a 0a20  j is not None.. 
+0000f490: 2020 2023 2056 6572 6966 7920 7468 6174     # Verify that
+0000f4a0: 2077 6520 6272 6561 6b20 7468 6520 7469   we break the ti
+0000f4b0: 746c 6520 746f 2061 206d 6178 206c 656e  tle to a max len
+0000f4c0: 6774 6820 6f66 206f 7572 2074 6974 6c65  gth of our title
+0000f4d0: 5f6d 6178 0a20 2020 2023 2061 6e64 2074  _max.    # and t
+0000f4e0: 6861 7420 7468 6520 626f 6479 2072 656d  hat the body rem
+0000f4f0: 6169 6e73 2075 6e74 6f75 6368 6564 0a20  ains untouched. 
+0000f500: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0000f510: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0000f520: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
+0000f530: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
+0000f540: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0000f550: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+0000f560: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+0000f570: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0000f580: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0000f590: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
+0000f5a0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0000f5b0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0000f5c0: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+0000f5d0: 653d 7469 746c 6529 0a20 2020 206f 6666  e=title).    off
+0000f5e0: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
+0000f5f0: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
+0000f600: 3d20 350a 2020 2020 666f 7220 6964 782c  = 5.    for idx,
+0000f610: 2063 6875 6e6b 2069 6e20 656e 756d 6572   chunk in enumer
+0000f620: 6174 6528 6368 756e 6b73 2c20 7374 6172  ate(chunks, star
+0000f630: 743d 3129 3a0a 2020 2020 2020 2020 2320  t=1):.        # 
+0000f640: 5665 7269 6669 6361 7469 6f6e 0a20 2020  Verification.   
+0000f650: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0000f660: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+0000f670: 2729 2920 3c3d 206f 626a 2e74 6974 6c65  ')) <= obj.title
+0000f680: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
+0000f690: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+0000f6a0: 2e67 6574 2827 626f 6479 2729 2920 3c3d  .get('body')) <=
+0000f6b0: 206f 626a 2e62 6f64 795f 6d61 786c 656e   obj.body_maxlen
+0000f6c0: 0a0a 2020 2020 2020 2020 2320 4e6f 2063  ..        # No c
+0000f6d0: 6f75 6e74 6572 2069 7320 6469 7370 6c61  ounter is displa
+0000f6e0: 7965 6420 6265 6361 7573 6520 6f75 7220  yed because our 
+0000f6f0: 7469 746c 6520 6973 2073 6f20 656e 6f72  title is so enor
+0000f700: 6d6f 7573 0a20 2020 2020 2020 2023 2057  mous.        # W
+0000f710: 6520 7377 6974 6368 2074 6f20 6120 6469  e switch to a di
+0000f720: 7370 6c61 7920 7469 746c 6520 6f6e 2066  splay title on f
+0000f730: 6972 7374 206d 6573 7361 6765 206f 6e6c  irst message onl
+0000f740: 790a 2020 2020 2020 2020 6966 2069 6478  y.        if idx
+0000f750: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+0000f760: 2020 2320 456d 7074 7920 286e 6f20 7469    # Empty (no ti
+0000f770: 746c 6520 6469 7370 6c61 7965 6420 6f6e  tle displayed on
+0000f780: 2066 6f6c 6c6f 7769 6e67 2065 6e74 7269   following entri
+0000f790: 6573 0a20 2020 2020 2020 2020 2020 2061  es.            a
+0000f7a0: 7373 6572 7420 6368 756e 6b2e 6765 7428  ssert chunk.get(
+0000f7b0: 2774 6974 6c65 2729 203d 3d20 2222 0a20  'title') == "". 
+0000f7c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000f7d0: 2020 2020 2020 2020 2023 2054 6865 206c           # The l
+0000f7e0: 656e 6774 6820 6f66 2074 6865 2062 6f64  ength of the bod
+0000f7f0: 7920 7072 6576 6169 6c73 206f 7572 2074  y prevails our t
+0000f800: 6974 6c65 2064 7565 2074 6f20 6974 2062  itle due to it b
+0000f810: 6569 6e67 0a20 2020 2020 2020 2020 2020  eing.           
+0000f820: 2023 2073 6f20 6d75 6368 2073 6d61 6c6c   # so much small
+0000f830: 6572 2074 6865 6e20 6f75 7220 7469 746c  er then our titl
+0000f840: 6520 6c65 6e67 7468 0a20 2020 2020 2020  e length.       
+0000f850: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0000f860: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+0000f870: 2729 2920 3d3d 206f 626a 2e62 6f64 795f  ')) == obj.body_
+0000f880: 6d61 786c 656e 0a20 2020 2020 2020 2020  maxlen.         
+0000f890: 2020 2061 7373 6572 7420 7469 746c 655b     assert title[
+0000f8a0: 3a6f 626a 2e62 6f64 795f 6d61 786c 656e  :obj.body_maxlen
+0000f8b0: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
+0000f8c0: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
+0000f8d0: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
+0000f8e0: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
+0000f8f0: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
+0000f900: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
+0000f910: 7428 2762 6f64 7927 290a 2020 2020 2020  t('body').      
+0000f920: 2020 6173 7365 7274 2062 6f64 795b 6f66    assert body[of
+0000f930: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+0000f940: 202b 206f 6666 7365 745d 5c0a 2020 2020   + offset]\.    
+0000f950: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+0000f960: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+0000f970: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
+0000f980: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
+0000f990: 202b 3d20 6c65 6e28 5f62 6f64 7929 0a0a   += len(_body)..
+0000f9a0: 2020 2020 2320 416e 6f74 6865 7220 6564      # Another ed
+0000f9b0: 6765 2063 6173 6520 7768 6572 6520 7468  ge case where th
+0000f9c0: 6520 7469 746c 6520 6a75 7374 2069 736e  e title just isn
+0000f9d0: 2774 2074 6861 7420 6c6f 6e67 206c 6561  't that long lea
+0000f9e0: 7669 6e67 0a20 2020 2023 2061 206c 6f74  ving.    # a lot
+0000f9f0: 206f 6620 7370 6163 6520 666f 7220 7468   of space for th
+0000fa00: 6520 5b78 782f 7878 5d20 656e 7472 6965  e [xx/xx] entrie
+0000fa10: 7320 286e 6f20 7472 756e 6361 7469 6f6e  s (no truncation
+0000fa20: 206e 6565 6465 6429 0a20 2020 2063 6875   needed).    chu
+0000fa30: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0000fa40: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+0000fa50: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+0000fa60: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0000fa70: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0000fa80: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+0000fa90: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+0000faa0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0000fab0: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+0000fac0: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+0000fad0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0000fae0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0000faf0: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+0000fb00: 655b 3a32 305d 290a 2020 2020 6f66 6673  e[:20]).    offs
+0000fb10: 6574 203d 2030 0a20 2020 2061 7373 6572  et = 0.    asser
+0000fb20: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
+0000fb30: 2035 0a20 2020 2066 6f72 2069 6478 2c20   5.    for idx, 
+0000fb40: 6368 756e 6b20 696e 2065 6e75 6d65 7261  chunk in enumera
+0000fb50: 7465 2863 6875 6e6b 732c 2073 7461 7274  te(chunks, start
+0000fb60: 3d31 293a 0a20 2020 2020 2020 2023 2056  =1):.        # V
+0000fb70: 6572 6966 6963 6174 696f 6e0a 2020 2020  erification.    
+0000fb80: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+0000fb90: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+0000fba0: 2929 203c 3d20 6f62 6a2e 7469 746c 655f  )) <= obj.title_
+0000fbb0: 6d61 786c 656e 0a20 2020 2020 2020 2061  maxlen.        a
+0000fbc0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
+0000fbd0: 6765 7428 2762 6f64 7927 2929 203c 3d20  get('body')) <= 
+0000fbe0: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e0a  obj.body_maxlen.
+0000fbf0: 0a20 2020 2020 2020 2023 204f 7572 2074  .        # Our t
+0000fc00: 6974 6c65 2068 6173 206e 6f20 636f 756e  itle has no coun
+0000fc10: 7465 7220 6164 6465 6420 746f 2069 740a  ter added to it.
+0000fc20: 2020 2020 2020 2020 6966 2069 6478 203e          if idx >
+0000fc30: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0000fc40: 2320 456d 7074 7920 286e 6f20 7469 746c  # Empty (no titl
+0000fc50: 6520 6469 7370 6c61 7965 6420 6f6e 2066  e displayed on f
+0000fc60: 6f6c 6c6f 7769 6e67 2065 6e74 7269 6573  ollowing entries
+0000fc70: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+0000fc80: 6572 7420 6368 756e 6b2e 6765 7428 2774  ert chunk.get('t
+0000fc90: 6974 6c65 2729 203d 3d20 2222 0a0a 2020  itle') == ""..  
+0000fca0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000fcb0: 2020 2020 2020 2020 2320 5468 6520 626f          # The bo
+0000fcc0: 6479 206c 656e 6774 6820 7072 6576 6169  dy length prevai
+0000fcd0: 6c73 2064 7565 2074 6f20 6f75 7220 616d  ls due to our am
+0000fce0: 616c 6761 6d61 7469 6f6e 2066 6c61 670a  algamation flag.
+0000fcf0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0000fd00: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+0000fd10: 2827 7469 746c 6527 2929 203d 3d20 3230  ('title')) == 20
+0000fd20: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+0000fd30: 6572 7420 7469 746c 655b 3a32 305d 203d  ert title[:20] =
+0000fd40: 3d20 6368 756e 6b2e 6765 7428 2774 6974  = chunk.get('tit
+0000fd50: 6c65 2729 0a0a 2020 2020 2020 2020 2320  le')..        # 
+0000fd60: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
+0000fd70: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
+0000fd80: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
+0000fd90: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
+0000fda0: 626f 6479 2729 0a20 2020 2020 2020 2061  body').        a
+0000fdb0: 7373 6572 7420 626f 6479 5b6f 6666 7365  ssert body[offse
+0000fdc0: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+0000fdd0: 6f66 6673 6574 5d5c 0a20 2020 2020 2020  offset]\.       
+0000fde0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
+0000fdf0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
+0000fe00: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
+0000fe10: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
+0000fe20: 206c 656e 285f 626f 6479 290a 0a20 2020   len(_body)..   
+0000fe30: 2023 0a20 2020 2023 2054 6573 7420 666f   #.    # Test fo
+0000fe40: 7263 696e 6720 6f76 6572 666c 6f77 5f64  rcing overflow_d
+0000fe50: 6973 706c 6179 5f74 6974 6c65 5f6f 6e63  isplay_title_onc
+0000fe60: 650a 2020 2020 230a 2020 2020 636c 6173  e.    #.    clas
+0000fe70: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
+0000fe80: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
+0000fe90: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
+0000fea0: 7469 746c 6520 6d61 7820 6c65 6e67 7468  title max length
+0000feb0: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
+0000fec0: 6178 6c65 6e20 3d20 7469 746c 655f 6c65  axlen = title_le
+0000fed0: 6e0a 0a20 2020 2020 2020 2023 2045 6e66  n..        # Enf
+0000fee0: 6f72 6365 2061 2062 6f64 7920 6c65 6e67  orce a body leng
+0000fef0: 7468 2e20 4d61 6b65 2073 7572 6520 6974  th. Make sure it
+0000ff00: 2773 2061 6e20 696e 742e 0a20 2020 2020  's an int..     
+0000ff10: 2020 2062 6f64 795f 6d61 786c 656e 203d     body_maxlen =
+0000ff20: 2069 6e74 2862 6f64 795f 6c65 6e20 2f20   int(body_len / 
+0000ff30: 3429 0a0a 2020 2020 2020 2020 2320 5769  4)..        # Wi
+0000ff40: 7468 2061 6d61 6c67 616d 6174 696f 6e0a  th amalgamation.
+0000ff50: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
+0000ff60: 5f61 6d61 6c67 616d 6174 655f 7469 746c  _amalgamate_titl
+0000ff70: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+0000ff80: 2020 2320 204f 6e6c 7920 6469 7370 6c61    #  Only displa
+0000ff90: 7920 7469 746c 6520 6f6e 6365 0a20 2020  y title once.   
+0000ffa0: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
+0000ffb0: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
+0000ffc0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+0000ffd0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0000ffe0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+0000fff0: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+00010000: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+00010010: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
+00010020: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
+00010030: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+00010040: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00010050: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
+00010060: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
+00010070: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+00010080: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
+00010090: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
+000100a0: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
+000100b0: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
+000100c0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
+000100d0: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
+000100e0: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
+000100f0: 6f6e 650a 0a20 2020 2063 6875 6e6b 7320  one..    chunks 
+00010100: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00010110: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+00010120: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+00010130: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00010140: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00010150: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
+00010160: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00010170: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00010180: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+00010190: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+000101a0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+000101b0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+000101c0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+000101d0: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+000101e0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+000101f0: 6e6b 7329 203d 3d20 350a 2020 2020 666f  nks) == 5.    fo
+00010200: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+00010210: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+00010220: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+00010230: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+00010240: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+00010250: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+00010260: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+00010270: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+00010280: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00010290: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+000102a0: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+000102b0: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
+000102c0: 2320 4f75 7220 7469 746c 6520 6861 7320  # Our title has 
+000102d0: 6e6f 2063 6f75 6e74 6572 2061 6464 6564  no counter added
+000102e0: 2074 6f20 6974 0a20 2020 2020 2020 2069   to it.        i
+000102f0: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+00010300: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+00010310: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+00010320: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+00010330: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+00010340: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+00010350: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+00010360: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+00010370: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00010380: 5468 6520 626f 6479 206c 656e 6774 6820  The body length 
+00010390: 7072 6576 6169 6c73 2064 7565 2074 6f20  prevails due to 
+000103a0: 6f75 7220 616d 616c 6761 6d61 7469 6f6e  our amalgamation
+000103b0: 2066 6c61 670a 2020 2020 2020 2020 2020   flag.          
+000103c0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+000103d0: 6e6b 2e67 6574 2827 7469 746c 6527 2929  nk.get('title'))
+000103e0: 203d 3d20 6f62 6a2e 626f 6479 5f6d 6178   == obj.body_max
+000103f0: 6c65 6e0a 2020 2020 2020 2020 2020 2020  len.            
+00010400: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
+00010410: 6a2e 626f 6479 5f6d 6178 6c65 6e5d 203d  j.body_maxlen] =
+00010420: 3d20 6368 756e 6b2e 6765 7428 2774 6974  = chunk.get('tit
+00010430: 6c65 2729 0a0a 2020 2020 2020 2020 2320  le')..        # 
+00010440: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
+00010450: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
+00010460: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
+00010470: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
+00010480: 626f 6479 2729 0a20 2020 2020 2020 2061  body').        a
+00010490: 7373 6572 7420 626f 6479 5b6f 6666 7365  ssert body[offse
+000104a0: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+000104b0: 6f66 6673 6574 5d5c 0a20 2020 2020 2020  offset]\.       
+000104c0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
+000104d0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
+000104e0: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
+000104f0: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
+00010500: 206c 656e 285f 626f 6479 290a 0a20 2020   len(_body)..   
+00010510: 2023 2054 6573 7420 6c61 7267 6572 206d   # Test larger m
+00010520: 6573 7361 6765 730a 2020 2020 2320 616e  essages.    # an
+00010530: 6420 7468 6174 2074 6865 2062 6f64 7920  d that the body 
+00010540: 7265 6d61 696e 7320 756e 746f 7563 6865  remains untouche
+00010550: 640a 2020 2020 636c 6173 7320 5465 7374  d.    class Test
+00010560: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
+00010570: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
+00010580: 2020 2023 2054 6573 7420 7469 746c 6520     # Test title 
+00010590: 6d61 7820 6c65 6e67 7468 0a20 2020 2020  max length.     
+000105a0: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
+000105b0: 3d20 3135 300a 0a20 2020 2020 2020 2023  = 150..        #
+000105c0: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
+000105d0: 6c65 6e67 7468 2e20 4d61 6b65 2073 7572  length. Make sur
+000105e0: 6520 6974 2773 2061 6e20 696e 742e 0a20  e it's an int.. 
+000105f0: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
+00010600: 656e 203d 2034 3030 0a0a 2020 2020 2020  en = 400..      
+00010610: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
+00010620: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
+00010630: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
+00010640: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
+00010650: 2020 2020 2020 2020 2320 466f 7263 6520          # Force 
+00010660: 7469 746c 6520 6469 7370 6c61 7965 6420  title displayed 
+00010670: 6f6e 6365 0a20 2020 2020 2020 206f 7665  once.        ove
+00010680: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
+00010690: 746c 655f 6f6e 6365 203d 2054 7275 650a  tle_once = True.
+000106a0: 0a20 2020 2020 2020 2064 6566 205f 5f69  .        def __i
+000106b0: 6e69 745f 5f28 7365 6c66 2c20 2a61 7267  nit__(self, *arg
+000106c0: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+000106d0: 2020 2020 2020 2020 2020 7375 7065 7228            super(
+000106e0: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7761  ).__init__(**kwa
+000106f0: 7267 7329 0a0a 2020 2020 2020 2020 6465  rgs)..        de
+00010700: 6620 6e6f 7469 6679 2873 656c 662c 202a  f notify(self, *
+00010710: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00010720: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
+00010730: 7265 7465 6e64 2065 7665 7279 7468 696e  retend everythin
+00010740: 6720 6973 206f 6b61 790a 2020 2020 2020  g is okay.      
+00010750: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00010760: 650a 0a20 2020 2023 204c 6f61 6420 6f75  e..    # Load ou
+00010770: 7220 6f62 6a65 6374 0a20 2020 206f 626a  r object.    obj
+00010780: 203d 2054 6573 744e 6f74 6966 6963 6174   = TestNotificat
+00010790: 696f 6e28 6f76 6572 666c 6f77 3d4f 7665  ion(overflow=Ove
+000107a0: 7266 6c6f 774d 6f64 652e 5350 4c49 5429  rflowMode.SPLIT)
+000107b0: 0a20 2020 2061 7373 6572 7420 6f62 6a20  .    assert obj 
+000107c0: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
+000107d0: 206e 6577 5f62 6f64 7920 3d20 2862 6f64   new_body = (bod
+000107e0: 7920 2a20 3530 3029 0a20 2020 2063 6875  y * 500).    chu
+000107f0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00010800: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00010810: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00010820: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00010830: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00010840: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00010850: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+00010860: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00010870: 666c 6f77 2862 6f64 793d 6e65 775f 626f  flow(body=new_bo
+00010880: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
+00010890: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+000108a0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+000108b0: 6f64 793d 6e65 775f 626f 6479 2c20 7469  ody=new_body, ti
+000108c0: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
+000108d0: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
+000108e0: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+000108f0: 203d 3d20 3132 3831 0a20 2020 2066 6f72   == 1281.    for
+00010900: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+00010910: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+00010920: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+00010930: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+00010940: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+00010950: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+00010960: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+00010970: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+00010980: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00010990: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+000109a0: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+000109b0: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+000109c0: 204f 7572 2074 6974 6c65 2068 6173 206e   Our title has n
+000109d0: 6f20 636f 756e 7465 7220 6164 6465 6420  o counter added 
+000109e0: 746f 2069 740a 2020 2020 2020 2020 6966  to it.        if
+000109f0: 2069 6478 203e 2031 3a0a 2020 2020 2020   idx > 1:.      
+00010a00: 2020 2020 2020 2320 456d 7074 7920 286e        # Empty (n
+00010a10: 6f20 7469 746c 6520 6469 7370 6c61 7965  o title displaye
+00010a20: 6420 6f6e 2066 6f6c 6c6f 7769 6e67 2065  d on following e
+00010a30: 6e74 7269 6573 0a20 2020 2020 2020 2020  ntries.         
+00010a40: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
+00010a50: 6765 7428 2774 6974 6c65 2729 203d 3d20  get('title') == 
+00010a60: 2222 0a20 2020 2020 2020 2065 6c73 653a  "".        else:
+00010a70: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+00010a80: 6865 2062 6f64 7920 6c65 6e67 7468 2070  he body length p
+00010a90: 7265 7661 696c 7320 6475 6520 746f 206f  revails due to o
+00010aa0: 7572 2061 6d61 6c67 616d 6174 696f 6e20  ur amalgamation 
+00010ab0: 666c 6167 0a20 2020 2020 2020 2020 2020  flag.           
+00010ac0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+00010ad0: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
+00010ae0: 3d3d 206f 626a 2e74 6974 6c65 5f6d 6178  == obj.title_max
+00010af0: 6c65 6e0a 2020 2020 2020 2020 2020 2020  len.            
+00010b00: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
+00010b10: 6a2e 7469 746c 655f 6d61 786c 656e 5d20  j.title_maxlen] 
+00010b20: 3d3d 2063 6875 6e6b 2e67 6574 2827 7469  == chunk.get('ti
+00010b30: 746c 6527 290a 0a20 2020 2020 2020 2023  tle')..        #
+00010b40: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+00010b50: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+00010b60: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+00010b70: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+00010b80: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
+00010b90: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
+00010ba0: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
+00010bb0: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
+00010bc0: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
+00010bd0: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
+00010be0: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
+00010bf0: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
+00010c00: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
+00010c10: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
+00010c20: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+00010c30: 6666 7365 745d 2920 2d20 5c0a 2020 2020  ffset]) - \.    
+00010c40: 2020 2020 2020 2020 6c65 6e28 6e65 775f          len(new_
+00010c50: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
+00010c60: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
+00010c70: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00010c80: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
+00010c90: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
+00010ca0: 2829 290a 0a20 2020 2020 2020 2061 7373  ())..        ass
+00010cb0: 6572 7420 6e65 775f 626f 6479 5b6f 6666  ert new_body[off
+00010cc0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+00010cd0: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
+00010ce0: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
+00010cf0: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+00010d00: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+00010d10: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
+00010d20: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
+00010d30: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
+00010d40: 6666 290a 0a20 2020 2023 2042 6f64 7920  ff)..    # Body 
+00010d50: 6368 756e 6b20 6973 2062 6579 6f6e 6420  chunk is beyond 
+00010d60: 3420 6469 6769 7473 2c20 736f 205b 5858  4 digits, so [XX
+00010d70: 5858 2f58 5858 585d 2069 7320 7475 726e  XX/XXXX] is turn
+00010d80: 6564 206f 6666 0a20 2020 206e 6577 5f62  ed off.    new_b
+00010d90: 6f64 7920 3d20 2862 6f64 7920 2a20 3235  ody = (body * 25
+00010da0: 3030 290a 2020 2020 6368 756e 6b73 203d  00).    chunks =
+00010db0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00010dc0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00010dd0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+00010de0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00010df0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00010e00: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+00010e10: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00010e20: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00010e30: 626f 6479 3d6e 6577 5f62 6f64 792c 2074  body=new_body, t
+00010e40: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+00010e50: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00010e60: 5f6f 7665 7266 6c6f 7728 626f 6479 3d6e  _overflow(body=n
+00010e70: 6577 5f62 6f64 792c 2074 6974 6c65 3d74  ew_body, title=t
+00010e80: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
+00010e90: 203d 2030 0a20 2020 2061 7373 6572 7420   = 0.    assert 
+00010ea0: 6c65 6e28 6368 756e 6b73 2920 3d3d 2036  len(chunks) == 6
+00010eb0: 3430 310a 2020 2020 666f 7220 6964 782c  401.    for idx,
+00010ec0: 2063 6875 6e6b 2069 6e20 656e 756d 6572   chunk in enumer
+00010ed0: 6174 6528 6368 756e 6b73 2c20 7374 6172  ate(chunks, star
+00010ee0: 743d 3129 3a0a 2020 2020 2020 2020 2320  t=1):.        # 
+00010ef0: 5665 7269 6669 6361 7469 6f6e 0a20 2020  Verification.   
+00010f00: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00010f10: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+00010f20: 2729 2920 3c3d 206f 626a 2e74 6974 6c65  ')) <= obj.title
+00010f30: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
+00010f40: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+00010f50: 2e67 6574 2827 626f 6479 2729 2920 3c3d  .get('body')) <=
+00010f60: 206f 626a 2e62 6f64 795f 6d61 786c 656e   obj.body_maxlen
+00010f70: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
+00010f80: 7469 746c 6520 6861 7320 6e6f 2063 6f75  title has no cou
+00010f90: 6e74 6572 2061 6464 6564 2074 6f20 6974  nter added to it
+00010fa0: 0a20 2020 2020 2020 2069 6620 6964 7820  .        if idx 
+00010fb0: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+00010fc0: 2023 2045 6d70 7479 2028 6e6f 2074 6974   # Empty (no tit
+00010fd0: 6c65 2064 6973 706c 6179 6564 206f 6e20  le displayed on 
+00010fe0: 666f 6c6c 6f77 696e 6720 656e 7472 6965  following entrie
+00010ff0: 730a 2020 2020 2020 2020 2020 2020 6173  s.            as
+00011000: 7365 7274 2063 6875 6e6b 2e67 6574 2827  sert chunk.get('
+00011010: 7469 746c 6527 2920 3d3d 2022 220a 2020  title') == "".  
+00011020: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00011030: 2020 2020 2020 2020 2320 5468 6520 626f          # The bo
+00011040: 6479 206c 656e 6774 6820 7072 6576 6169  dy length prevai
+00011050: 6c73 2064 7565 2074 6f20 6f75 7220 616d  ls due to our am
+00011060: 616c 6761 6d61 7469 6f6e 2066 6c61 670a  algamation flag.
+00011070: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00011080: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+00011090: 2827 7469 746c 6527 2929 203d 3d20 6f62  ('title')) == ob
+000110a0: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+000110b0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+000110c0: 7420 7469 746c 655b 3a6f 626a 2e74 6974  t title[:obj.tit
+000110d0: 6c65 5f6d 6178 6c65 6e5d 203d 3d20 6368  le_maxlen] == ch
+000110e0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
+000110f0: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
+00011100: 626f 6479 2069 7320 6f6e 6c79 2062 726f  body is only bro
+00011110: 6b65 6e20 7570 3b20 6e6f 7420 6c6f 7374  ken up; not lost
+00011120: 0a20 2020 2020 2020 205f 626f 6479 203d  .        _body =
+00011130: 2063 6875 6e6b 2e67 6574 2827 626f 6479   chunk.get('body
+00011140: 2729 0a0a 2020 2020 2020 2020 2320 556e  ')..        # Un
+00011150: 2d75 7365 6420 7768 6974 6573 7061 6365  -used whitespace
+00011160: 2069 7320 616c 7761 7973 2063 6c65 616e   is always clean
+00011170: 6564 2075 703b 206d 616b 6520 7375 7265  ed up; make sure
+00011180: 2077 6520 6163 636f 756e 7420 666f 720a   we account for.
+00011190: 2020 2020 2020 2020 2320 7468 6973 2069          # this i
+000111a0: 6e20 6f75 7220 6e65 7720 6361 6c63 756c  n our new calcul
+000111b0: 6174 696f 6e0a 2020 2020 2020 2020 7773  ation.        ws
+000111c0: 5f64 6966 6620 3d20 6c65 6e28 6e65 775f  _diff = len(new_
+000111d0: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
+000111e0: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
+000111f0: 5d29 202d 205c 0a20 2020 2020 2020 2020  ]) - \.         
+00011200: 2020 206c 656e 286e 6577 5f62 6f64 795b     len(new_body[
+00011210: 6f66 6673 6574 3a20 6c65 6e28 5f62 6f64  offset: len(_bod
+00011220: 7929 202b 206f 6666 7365 745d 0a20 2020  y) + offset].   
+00011230: 2020 2020 2020 2020 2020 2020 202e 6c73               .ls
+00011240: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
+00011250: 3063 2729 2e72 7374 7269 7028 2929 0a0a  0c').rstrip())..
+00011260: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+00011270: 6577 5f62 6f64 795b 6f66 6673 6574 3a20  ew_body[offset: 
+00011280: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
+00011290: 7365 7420 2b20 7773 5f64 6966 665d 5c0a  set + ws_diff]\.
+000112a0: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
+000112b0: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+000112c0: 6327 292e 7273 7472 6970 2829 203d 3d20  c').rstrip() == 
+000112d0: 5f62 6f64 790a 2020 2020 2020 2020 6f66  _body.        of
+000112e0: 6673 6574 202b 3d20 286c 656e 285f 626f  fset += (len(_bo
+000112f0: 6479 2920 2b20 7773 5f64 6966 6629 0a0a  dy) + ws_diff)..
+00011300: 2020 2020 2320 5465 7374 206c 6172 6765      # Test large
+00011310: 7220 6d65 7373 6167 6573 0a20 2020 2023  r messages.    #
+00011320: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
+00011330: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
+00011340: 6368 6564 0a20 2020 2063 6c61 7373 2054  ched.    class T
+00011350: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00011360: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
+00011370: 2020 2020 2020 2320 5465 7374 2074 6974        # Test tit
+00011380: 6c65 206d 6178 206c 656e 6774 680a 2020  le max length.  
+00011390: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
+000113a0: 656e 203d 2031 3530 0a0a 2020 2020 2020  en = 150..      
+000113b0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
+000113c0: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
+000113d0: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
+000113e0: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
+000113f0: 6178 6c65 6e20 3d20 3135 300a 0a20 2020  axlen = 150..   
+00011400: 2020 2020 2023 2057 6974 6820 616d 616c       # With amal
+00011410: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
+00011420: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
+00011430: 6d61 7465 5f74 6974 6c65 203d 2054 7275  mate_title = Tru
+00011440: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
+00011450: 6365 2074 6974 6c65 2064 6973 706c 6179  ce title display
+00011460: 6564 206f 6e63 650a 2020 2020 2020 2020  ed once.        
+00011470: 6f76 6572 666c 6f77 5f64 6973 706c 6179  overflow_display
+00011480: 5f74 6974 6c65 5f6f 6e63 6520 3d20 5472  _title_once = Tr
+00011490: 7565 0a0a 2020 2020 2020 2020 6465 6620  ue..        def 
+000114a0: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
+000114b0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+000114c0: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
+000114d0: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
+000114e0: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
+000114f0: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
+00011500: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00011510: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00011520: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
+00011530: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
+00011540: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00011550: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
+00011560: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
+00011570: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
+00011580: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
+00011590: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
+000115a0: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
+000115b0: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
+000115c0: 2020 2020 6e65 775f 626f 6479 203d 2028      new_body = (
+000115d0: 626f 6479 202a 2035 290a 2020 2020 6368  body * 5).    ch
+000115e0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+000115f0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00011600: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
+00011610: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00011620: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00011630: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
+00011640: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00011650: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00011660: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
+00011670: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+00011680: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00011690: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+000116a0: 626f 6479 3d6e 6577 5f62 6f64 792c 2074  body=new_body, t
+000116b0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+000116c0: 6f66 6673 6574 203d 2030 0a20 2020 2061  offset = 0.    a
+000116d0: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
+000116e0: 2920 3d3d 2033 360a 2020 2020 666f 7220  ) == 36.    for 
+000116f0: 6964 782c 2063 6875 6e6b 2069 6e20 656e  idx, chunk in en
+00011700: 756d 6572 6174 6528 6368 756e 6b73 2c20  umerate(chunks, 
+00011710: 7374 6172 743d 3129 3a0a 2020 2020 2020  start=1):.      
+00011720: 2020 2320 5665 7269 6669 6361 7469 6f6e    # Verification
+00011730: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011740: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
+00011750: 6974 6c65 2729 2920 3c3d 206f 626a 2e74  itle')) <= obj.t
+00011760: 6974 6c65 5f6d 6178 6c65 6e0a 2020 2020  itle_maxlen.    
+00011770: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00011780: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
+00011790: 2920 3c3d 206f 626a 2e62 6f64 795f 6d61  ) <= obj.body_ma
+000117a0: 786c 656e 0a0a 2020 2020 2020 2020 2320  xlen..        # 
+000117b0: 4f75 7220 7469 746c 6520 6861 7320 6e6f  Our title has no
+000117c0: 2063 6f75 6e74 6572 2061 6464 6564 2074   counter added t
+000117d0: 6f20 6974 0a20 2020 2020 2020 2069 6620  o it.        if 
+000117e0: 6964 7820 3e20 313a 0a20 2020 2020 2020  idx > 1:.       
+000117f0: 2020 2020 2023 2045 6d70 7479 2028 6e6f       # Empty (no
+00011800: 2074 6974 6c65 2064 6973 706c 6179 6564   title displayed
+00011810: 206f 6e20 666f 6c6c 6f77 696e 6720 656e   on following en
+00011820: 7472 6965 730a 2020 2020 2020 2020 2020  tries.          
+00011830: 2020 6173 7365 7274 2063 6875 6e6b 2e67    assert chunk.g
+00011840: 6574 2827 7469 746c 6527 2920 3d3d 2022  et('title') == "
+00011850: 220a 2020 2020 2020 2020 656c 7365 3a0a  ".        else:.
+00011860: 2020 2020 2020 2020 2020 2020 2320 4265              # Be
+00011870: 6361 7573 6520 3135 3020 6973 2077 6861  cause 150 is wha
+00011880: 7420 7765 2073 6574 2074 6865 2074 6974  t we set the tit
+00011890: 6c65 206c 696d 6974 2074 6f0a 2020 2020  le limit to.    
+000118a0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000118b0: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
+000118c0: 746c 6527 2929 203d 3d20 6f62 6a2e 7469  tle')) == obj.ti
+000118d0: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
+000118e0: 2020 2020 2020 2061 7373 6572 7420 7469         assert ti
+000118f0: 746c 655b 3a6f 626a 2e74 6974 6c65 5f6d  tle[:obj.title_m
+00011900: 6178 6c65 6e5d 203d 3d20 6368 756e 6b2e  axlen] == chunk.
+00011910: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
+00011920: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
+00011930: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
+00011940: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
+00011950: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
+00011960: 6e6b 2e67 6574 2827 626f 6479 2729 0a0a  nk.get('body')..
+00011970: 2020 2020 2020 2020 2320 556e 2d75 7365          # Un-use
+00011980: 6420 7768 6974 6573 7061 6365 2069 7320  d whitespace is 
+00011990: 616c 7761 7973 2063 6c65 616e 6564 2075  always cleaned u
+000119a0: 703b 206d 616b 6520 7375 7265 2077 6520  p; make sure we 
+000119b0: 6163 636f 756e 7420 666f 720a 2020 2020  account for.    
+000119c0: 2020 2020 2320 7468 6973 2069 6e20 6f75      # this in ou
+000119d0: 7220 6e65 7720 6361 6c63 756c 6174 696f  r new calculatio
+000119e0: 6e0a 2020 2020 2020 2020 7773 5f64 6966  n.        ws_dif
+000119f0: 6620 3d20 6c65 6e28 6e65 775f 626f 6479  f = len(new_body
+00011a00: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+00011a10: 6479 2920 2b20 6f66 6673 6574 5d29 202d  dy) + offset]) -
+00011a20: 205c 0a20 2020 2020 2020 2020 2020 206c   \.            l
+00011a30: 656e 286e 6577 5f62 6f64 795b 6f66 6673  en(new_body[offs
+00011a40: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00011a50: 206f 6666 7365 745d 0a20 2020 2020 2020   offset].       
+00011a60: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
+00011a70: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
+00011a80: 2e72 7374 7269 7028 2929 0a0a 2020 2020  .rstrip())..    
+00011a90: 2020 2020 6173 7365 7274 206e 6577 5f62      assert new_b
+00011aa0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+00011ab0: 5f62 6f64 7929 202b 206f 6666 7365 7420  _body) + offset 
+00011ac0: 2b20 7773 5f64 6966 665d 5c0a 2020 2020  + ws_diff]\.    
+00011ad0: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+00011ae0: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+00011af0: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
+00011b00: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
+00011b10: 202b 3d20 286c 656e 285f 626f 6479 2920   += (len(_body) 
+00011b20: 2b20 7773 5f64 6966 6629 0a0a 2020 2020  + ws_diff)..    
+00011b30: 230a 2020 2020 2320 4e65 7874 2054 6573  #.    # Next Tes
+00011b40: 743a 2041 7070 656e 6420 7469 746c 6520  t: Append title 
+00011b50: 746f 2062 6f64 7920 2b20 7370 6c69 7420  to body + split 
+00011b60: 626f 6479 0a20 2020 2023 0a0a 2020 2020  body.    #..    
+00011b70: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
+00011b80: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
+00011b90: 6529 3a0a 0a20 2020 2020 2020 2023 2045  e):..        # E
+00011ba0: 6e66 6f72 6365 206e 6f20 7469 746c 650a  nforce no title.
+00011bb0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
+00011bc0: 786c 656e 203d 2030 0a0a 2020 2020 2020  xlen = 0..      
+00011bd0: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
+00011be0: 6479 206c 656e 6774 6820 6261 7365 6420  dy length based 
+00011bf0: 6f6e 2074 6865 2074 6974 6c65 2e20 4d61  on the title. Ma
+00011c00: 6b65 2073 7572 6520 6974 2773 2061 6e20  ke sure it's an 
+00011c10: 696e 742e 0a20 2020 2020 2020 2062 6f64  int..        bod
+00011c20: 795f 6d61 786c 656e 203d 2069 6e74 2874  y_maxlen = int(t
+00011c30: 6974 6c65 5f6c 656e 202f 2034 290a 0a20  itle_len / 4).. 
+00011c40: 2020 2020 2020 2023 2057 6974 6820 616d         # With am
+00011c50: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
+00011c60: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
+00011c70: 6761 6d61 7465 5f74 6974 6c65 203d 2054  gamate_title = T
+00011c80: 7275 650a 0a20 2020 2020 2020 2023 2046  rue..        # F
+00011c90: 6f72 6365 2074 6974 6c65 2064 6973 706c  orce title displ
+00011ca0: 6179 6564 206f 6e63 650a 2020 2020 2020  ayed once.      
+00011cb0: 2020 6f76 6572 666c 6f77 5f64 6973 706c    overflow_displ
+00011cc0: 6179 5f74 6974 6c65 5f6f 6e63 6520 3d20  ay_title_once = 
+00011cd0: 5472 7565 0a0a 2020 2020 2020 2020 6465  True..        de
+00011ce0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00011cf0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00011d00: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00011d10: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+00011d20: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
+00011d30: 2020 2064 6566 206e 6f74 6966 7928 7365     def notify(se
+00011d40: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+00011d50: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+00011d60: 2020 2320 5072 6574 656e 6420 6576 6572    # Pretend ever
+00011d70: 7974 6869 6e67 2069 7320 6f6b 6179 0a20  ything is okay. 
+00011d80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00011d90: 6e20 5472 7565 0a0a 2020 2020 2320 4c6f  n True..    # Lo
+00011da0: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
+00011db0: 2020 6f62 6a20 3d20 5465 7374 4e6f 7469    obj = TestNoti
+00011dc0: 6669 6361 7469 6f6e 286f 7665 7266 6c6f  fication(overflo
+00011dd0: 773d 4f76 6572 666c 6f77 4d6f 6465 2e53  w=OverflowMode.S
+00011de0: 504c 4954 290a 2020 2020 6173 7365 7274  PLIT).    assert
+00011df0: 206f 626a 2069 7320 6e6f 7420 4e6f 6e65   obj is not None
+00011e00: 0a0a 2020 2020 2320 5665 7269 6679 2074  ..    # Verify t
+00011e10: 6861 7420 7765 2062 7265 616b 2074 6865  hat we break the
+00011e20: 2074 6974 6c65 2074 6f20 6120 6d61 7820   title to a max 
+00011e30: 6c65 6e67 7468 206f 6620 6f75 7220 7469  length of our ti
+00011e40: 746c 655f 6d61 780a 2020 2020 2320 616e  tle_max.    # an
+00011e50: 6420 7468 6174 2074 6865 2062 6f64 7920  d that the body 
+00011e60: 7265 6d61 696e 7320 756e 746f 7563 6865  remains untouche
+00011e70: 640a 2020 2020 6368 756e 6b73 203d 206f  d.    chunks = o
+00011e80: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00011e90: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+00011ea0: 653d 7469 746c 6529 0a20 2020 2063 6875  e=title).    chu
+00011eb0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00011ec0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00011ed0: 222c 2074 6974 6c65 3d22 2229 0a20 2020  ", title="").   
+00011ee0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00011ef0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00011f00: 6479 3d62 6f64 792c 2074 6974 6c65 3d22  dy=body, title="
+00011f10: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+00011f20: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+00011f30: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
+00011f40: 6974 6c65 3d74 6974 6c65 290a 0a20 2020  itle=title)..   
+00011f50: 2023 204f 7572 2066 696e 616c 2070 726f   # Our final pro
+00011f60: 6475 6374 2069 7320 7468 6174 206f 7572  duct is that our
+00011f70: 2074 6974 6c65 2068 6173 2062 6565 6e20   title has been 
+00011f80: 6170 7065 6e64 6564 2074 6f20 6f75 7220  appended to our 
+00011f90: 626f 6479 2074 6f0a 2020 2020 2320 6372  body to.    # cr
+00011fa0: 6561 7465 206f 6e65 2067 7265 6174 2062  eate one great b
+00011fb0: 6967 2062 6f64 792e 2041 7320 6120 7265  ig body. As a re
+00011fc0: 7375 6c74 2077 6527 6c6c 2067 6574 2071  sult we'll get q
+00011fd0: 7569 7465 2061 2066 6577 206c 696e 6573  uite a few lines
+00011fe0: 2062 6163 6b0a 2020 2020 2320 6e6f 772e   back.    # now.
+00011ff0: 0a20 2020 206f 6666 7365 7420 3d20 300a  .    offset = 0.
+00012000: 0a20 2020 2023 204f 7572 2062 6f64 7920  .    # Our body 
+00012010: 7769 6c6c 206c 6f6f 6b20 6c69 6b65 2074  will look like t
+00012020: 6869 7320 696e 2073 6d61 6c6c 2063 6875  his in small chu
+00012030: 6e6b 7320 6174 2074 6865 2065 6e64 206f  nks at the end o
+00012040: 6620 7468 6520 6461 790a 2020 2020 6275  f the day.    bu
+00012050: 6c6b 203d 2074 6974 6c65 202b 2027 5c72  lk = title + '\r
+00012060: 5c6e 2720 2b20 626f 6479 0a0a 2020 2020  \n' + body..    
+00012070: 2320 4475 6520 746f 2074 6865 206e 6577  # Due to the new
+00012080: 206c 696e 6520 6164 6465 6420 746f 2074   line added to t
+00012090: 6865 2065 6e64 0a20 2020 2061 7373 6572  he end.    asser
+000120a0: 7420 6c65 6e28 6368 756e 6b73 2920 3d3d  t len(chunks) ==
+000120b0: 2028 0a20 2020 2020 2020 2023 2077 7261   (.        # wra
+000120c0: 7020 6469 7669 7369 6f6e 2069 6e20 696e  p division in in
+000120d0: 7428 2920 736f 2050 7974 686f 6e20 3320  t() so Python 3 
+000120e0: 646f 6573 6e27 7420 636f 6e76 6572 7420  doesn't convert 
+000120f0: 6974 2074 6f20 6120 666c 6f61 7420 6f6e  it to a float on
+00012100: 0a20 2020 2020 2020 2023 2075 730a 2020  .        # us.  
+00012110: 2020 2020 2020 696e 7428 6c65 6e28 6275        int(len(bu
+00012120: 6c6b 2920 2f20 6f62 6a2e 626f 6479 5f6d  lk) / obj.body_m
+00012130: 6178 6c65 6e29 202b 0a20 2020 2020 2020  axlen) +.       
+00012140: 2028 3120 6966 206c 656e 2862 756c 6b29   (1 if len(bulk)
+00012150: 2025 206f 626a 2e62 6f64 795f 6d61 786c   % obj.body_maxl
+00012160: 656e 2065 6c73 6520 3029 290a 0a20 2020  en else 0))..   
+00012170: 2066 6f72 2063 6875 6e6b 2069 6e20 6368   for chunk in ch
+00012180: 756e 6b73 3a0a 2020 2020 2020 2020 2320  unks:.        # 
+00012190: 5665 7269 6669 6361 7469 6f6e 0a20 2020  Verification.   
+000121a0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000121b0: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+000121c0: 2729 2920 3d3d 2030 0a20 2020 2020 2020  ')) == 0.       
+000121d0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+000121e0: 6b2e 6765 7428 2762 6f64 7927 2929 203c  k.get('body')) <
+000121f0: 3d20 6f62 6a2e 626f 6479 5f6d 6178 6c65  = obj.body_maxle
+00012200: 6e0a 0a20 2020 2020 2020 2023 204f 7572  n..        # Our
+00012210: 2074 6974 6c65 2069 7320 656d 7074 7920   title is empty 
+00012220: 6576 6572 7920 7469 6d65 0a20 2020 2020  every time.     
+00012230: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
+00012240: 6765 7428 2774 6974 6c65 2729 203d 3d20  get('title') == 
+00012250: 2727 0a20 2020 2020 2020 2023 204f 7572  ''.        # Our
+00012260: 2062 6f64 7920 6973 206f 6e6c 7920 6272   body is only br
+00012270: 6f6b 656e 2075 703b 206e 6f74 206c 6f73  oken up; not los
+00012280: 740a 2020 2020 2020 2020 5f62 6f64 7920  t.        _body 
+00012290: 3d20 6368 756e 6b2e 6765 7428 2762 6f64  = chunk.get('bod
+000122a0: 7927 290a 0a20 2020 2020 2020 2023 2055  y')..        # U
+000122b0: 6e2d 7573 6564 2077 6869 7465 7370 6163  n-used whitespac
+000122c0: 6520 6973 2061 6c77 6179 7320 636c 6561  e is always clea
+000122d0: 6e65 6420 7570 3b20 6d61 6b65 2073 7572  ned up; make sur
+000122e0: 6520 7765 2061 6363 6f75 6e74 2066 6f72  e we account for
+000122f0: 0a20 2020 2020 2020 2023 2074 6869 7320  .        # this 
+00012300: 696e 206f 7572 206e 6577 2063 616c 6375  in our new calcu
+00012310: 6c61 7469 6f6e 0a20 2020 2020 2020 2077  lation.        w
+00012320: 735f 6469 6666 203d 206c 656e 2862 756c  s_diff = len(bul
+00012330: 6b5b 6f66 6673 6574 3a20 6c65 6e28 5f62  k[offset: len(_b
+00012340: 6f64 7929 202b 206f 6666 7365 745d 2920  ody) + offset]) 
+00012350: 2d20 5c0a 2020 2020 2020 2020 2020 2020  - \.            
+00012360: 6c65 6e28 6275 6c6b 5b6f 6666 7365 743a  len(bulk[offset:
+00012370: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
+00012380: 6673 6574 5d0a 2020 2020 2020 2020 2020  fset].          
+00012390: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+000123a0: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+000123b0: 7472 6970 2829 290a 0a20 2020 2020 2020  trip())..       
+000123c0: 2061 7373 6572 7420 6275 6c6b 5b6f 6666   assert bulk[off
+000123d0: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+000123e0: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
+000123f0: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
+00012400: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+00012410: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+00012420: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
+00012430: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
+00012440: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
+00012450: 6666 290a 0a20 2020 2023 0a20 2020 2023  ff)..    #.    #
+00012460: 2054 6573 7420 6361 7365 2077 6865 7265   Test case where
+00012470: 206f 7572 2074 6974 6c65 5f6c 656e 2069   our title_len i
+00012480: 7320 7368 6f72 7465 7220 7468 656e 2074  s shorter then t
+00012490: 6865 2076 616c 7565 0a20 2020 2023 2074  he value.    # t
+000124a0: 6861 7420 776f 756c 6420 6f74 6865 7277  hat would otherw
+000124b0: 6973 6520 7472 6967 6765 7220 7468 6520  ise trigger the 
+000124c0: 5b58 582f 5858 5d20 656c 656d 656e 7473  [XX/XX] elements
+000124d0: 0a20 2020 2023 0a0a 2020 2020 636c 6173  .    #..    clas
+000124e0: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
+000124f0: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
+00012500: 0a20 2020 2020 2020 2023 2053 6574 2061  .        # Set a
+00012510: 2073 6d61 6c6c 2074 6974 6c65 206c 656e   small title len
+00012520: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
+00012530: 655f 6d61 786c 656e 203d 2031 3030 0a0a  e_maxlen = 100..
+00012540: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
+00012550: 6520 6120 626f 6479 206c 656e 6774 682e  e a body length.
+00012560: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
+00012570: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
+00012580: 626f 6479 5f6d 6178 6c65 6e20 3d20 696e  body_maxlen = in
+00012590: 7428 626f 6479 5f6c 656e 202f 2034 290a  t(body_len / 4).
+000125a0: 0a20 2020 2020 2020 2023 2057 6974 6820  .        # With 
+000125b0: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
+000125c0: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
+000125d0: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
+000125e0: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
+000125f0: 2046 6f72 6365 2074 6974 6c65 2064 6973   Force title dis
+00012600: 706c 6179 6564 206f 6e63 650a 2020 2020  played once.    
+00012610: 2020 2020 6f76 6572 666c 6f77 5f64 6973      overflow_dis
+00012620: 706c 6179 5f74 6974 6c65 5f6f 6e63 6520  play_title_once 
+00012630: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00012640: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00012650: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00012660: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00012670: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00012680: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+00012690: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+000126a0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+000126b0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+000126c0: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+000126d0: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+000126e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000126f0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+00012700: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+00012710: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+00012720: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+00012730: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+00012740: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
+00012750: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+00012760: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+00012770: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+00012780: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+00012790: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+000127a0: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+000127b0: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+000127c0: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+000127d0: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+000127e0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+000127f0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00012800: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+00012810: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00012820: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00012830: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+00012840: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00012850: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00012860: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+00012870: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00012880: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00012890: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+000128a0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+000128b0: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
+000128c0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+000128d0: 6b73 2920 3d3d 2035 0a20 2020 2066 6f72  ks) == 5.    for
+000128e0: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+000128f0: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+00012900: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+00012910: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+00012920: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+00012930: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+00012940: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+00012950: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+00012960: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00012970: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+00012980: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+00012990: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+000129a0: 204f 7572 2074 6974 6c65 2068 6173 206e   Our title has n
+000129b0: 6f20 636f 756e 7465 7220 6164 6465 6420  o counter added 
+000129c0: 746f 2069 740a 2020 2020 2020 2020 6966  to it.        if
+000129d0: 2069 6478 203e 2031 3a0a 2020 2020 2020   idx > 1:.      
+000129e0: 2020 2020 2020 2320 456d 7074 7920 286e        # Empty (n
+000129f0: 6f20 7469 746c 6520 6469 7370 6c61 7965  o title displaye
+00012a00: 6420 6f6e 2066 6f6c 6c6f 7769 6e67 2065  d on following e
+00012a10: 6e74 7269 6573 0a20 2020 2020 2020 2020  ntries.         
+00012a20: 2020 2061 7373 6572 7420 6368 756e 6b2e     assert chunk.
+00012a30: 6765 7428 2774 6974 6c65 2729 203d 3d20  get('title') == 
+00012a40: 2222 0a20 2020 2020 2020 2065 6c73 653a  "".        else:
+00012a50: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+00012a60: 6865 2062 6f64 7920 6c65 6e67 7468 2070  he body length p
+00012a70: 7265 7661 696c 7320 6475 6520 746f 206f  revails due to o
+00012a80: 7572 2061 6d61 6c67 616d 6174 696f 6e20  ur amalgamation 
+00012a90: 666c 6167 0a20 2020 2020 2020 2020 2020  flag.           
+00012aa0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+00012ab0: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
+00012ac0: 3d3d 206f 626a 2e74 6974 6c65 5f6d 6178  == obj.title_max
+00012ad0: 6c65 6e0a 2020 2020 2020 2020 2020 2020  len.            
+00012ae0: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
+00012af0: 6a2e 7469 746c 655f 6d61 786c 656e 5d20  j.title_maxlen] 
+00012b00: 3d3d 2063 6875 6e6b 2e67 6574 2827 7469  == chunk.get('ti
+00012b10: 746c 6527 290a 0a20 2020 2020 2020 2023  tle')..        #
+00012b20: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+00012b30: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+00012b40: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+00012b50: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+00012b60: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
+00012b70: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
+00012b80: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
+00012b90: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
+00012ba0: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
+00012bb0: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
+00012bc0: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
+00012bd0: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
+00012be0: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
+00012bf0: 2862 6f64 795b 6f66 6673 6574 3a20 6c65  (body[offset: le
+00012c00: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
+00012c10: 745d 2920 2d20 5c0a 2020 2020 2020 2020  t]) - \.        
+00012c20: 2020 2020 6c65 6e28 626f 6479 5b6f 6666      len(body[off
+00012c30: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+00012c40: 2b20 6f66 6673 6574 5d0a 2020 2020 2020  + offset].      
+00012c50: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
+00012c60: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
+00012c70: 292e 7273 7472 6970 2829 290a 0a20 2020  ).rstrip())..   
+00012c80: 2020 2020 2061 7373 6572 7420 626f 6479       assert body
+00012c90: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+00012ca0: 6479 2920 2b20 6f66 6673 6574 202b 2077  dy) + offset + w
+00012cb0: 735f 6469 6666 5d5c 0a20 2020 2020 2020  s_diff]\.       
+00012cc0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
+00012cd0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
+00012ce0: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
+00012cf0: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
+00012d00: 2028 6c65 6e28 5f62 6f64 7929 202b 2077   (len(_body) + w
+00012d10: 735f 6469 6666 290a 0a20 2020 2023 0a20  s_diff)..    #. 
+00012d20: 2020 2023 2053 6365 6e61 7269 6f20 7768     # Scenario wh
+00012d30: 6572 6520 7468 6520 7469 746c 6520 6c65  ere the title le
+00012d40: 6e67 7468 2069 7320 6c61 7267 6572 2074  ngth is larger t
+00012d50: 6861 6e20 7468 6520 626f 6479 0a20 2020  han the body.   
+00012d60: 2023 0a0a 2020 2020 636c 6173 7320 5465   #..    class Te
+00012d70: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
+00012d80: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
+00012d90: 2020 2020 2023 2053 6574 2061 2073 6d61       # Set a sma
+00012da0: 6c6c 2074 6974 6c65 206c 656e 6774 680a  ll title length.
+00012db0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
+00012dc0: 786c 656e 203d 2031 3030 0a0a 2020 2020  xlen = 100..    
+00012dd0: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
+00012de0: 626f 6479 206c 656e 6774 682e 204d 616b  body length. Mak
+00012df0: 6520 7375 7265 2069 7427 7320 616e 2069  e sure it's an i
+00012e00: 6e74 2e0a 2020 2020 2020 2020 626f 6479  nt..        body
+00012e10: 5f6d 6178 6c65 6e20 3d20 3530 0a0a 2020  _maxlen = 50..  
+00012e20: 2020 2020 2020 2320 5769 7468 2061 6d61        # With ama
+00012e30: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
+00012e40: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
+00012e50: 616d 6174 655f 7469 746c 6520 3d20 5472  amate_title = Tr
+00012e60: 7565 0a0a 2020 2020 2020 2020 2320 466f  ue..        # Fo
+00012e70: 7263 6520 7469 746c 6520 6469 7370 6c61  rce title displa
+00012e80: 7965 6420 6f6e 6365 0a20 2020 2020 2020  yed once.       
+00012e90: 206f 7665 7266 6c6f 775f 6469 7370 6c61   overflow_displa
+00012ea0: 795f 7469 746c 655f 6f6e 6365 203d 2054  y_title_once = T
+00012eb0: 7275 650a 0a20 2020 2020 2020 2064 6566  rue..        def
+00012ec0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00012ed0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00012ee0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
+00012ef0: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
+00012f00: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
+00012f10: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
+00012f20: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00012f30: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00012f40: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
+00012f50: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
+00012f60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00012f70: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
+00012f80: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
+00012f90: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
+00012fa0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
+00012fb0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
+00012fc0: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
+00012fd0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
+00012fe0: 0a20 2020 2023 2056 6572 6966 7920 7468  .    # Verify th
+00012ff0: 6174 2077 6520 6272 6561 6b20 7468 6520  at we break the 
+00013000: 7469 746c 6520 746f 2061 206d 6178 206c  title to a max l
+00013010: 656e 6774 6820 6f66 206f 7572 2074 6974  ength of our tit
+00013020: 6c65 5f6d 6178 0a20 2020 2023 2061 6e64  le_max.    # and
+00013030: 2074 6861 7420 7468 6520 626f 6479 2072   that the body r
+00013040: 656d 6169 6e73 2075 6e74 6f75 6368 6564  emains untouched
+00013050: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00013060: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00013070: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
+00013080: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
+00013090: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+000130a0: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
+000130b0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
+000130c0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+000130d0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+000130e0: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
+000130f0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00013100: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00013110: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+00013120: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
+00013130: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
+00013140: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+00013150: 203d 3d20 3232 0a20 2020 2066 6f72 2069   == 22.    for i
+00013160: 6478 2c20 6368 756e 6b20 696e 2065 6e75  dx, chunk in enu
+00013170: 6d65 7261 7465 2863 6875 6e6b 732c 2073  merate(chunks, s
+00013180: 7461 7274 3d31 293a 0a20 2020 2020 2020  tart=1):.       
+00013190: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
+000131a0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000131b0: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
+000131c0: 746c 6527 2929 203c 3d20 6f62 6a2e 7469  tle')) <= obj.ti
+000131d0: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
+000131e0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+000131f0: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
+00013200: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
+00013210: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
+00013220: 7572 2074 6974 6c65 2068 6173 206e 6f20  ur title has no 
+00013230: 636f 756e 7465 7220 6164 6465 6420 746f  counter added to
+00013240: 2069 7420 6475 6520 746f 2069 7427 7320   it due to it's 
+00013250: 6c65 6e67 7468 0a20 2020 2020 2020 2069  length.        i
+00013260: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+00013270: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+00013280: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+00013290: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+000132a0: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+000132b0: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+000132c0: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+000132d0: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+000132e0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000132f0: 4265 6361 7573 6520 3135 3020 6973 2077  Because 150 is w
+00013300: 6861 7420 7765 2073 6574 2074 6865 2074  hat we set the t
+00013310: 6974 6c65 206c 696d 6974 2074 6f20 3530  itle limit to 50
+00013320: 2064 7565 0a20 2020 2020 2020 2020 2020   due.           
+00013330: 2023 2074 6f20 616d 616c 616d 6174 696f   # to amalamatio
+00013340: 6e2e 2020 5468 6520 6c6f 7765 7374 2076  n.  The lowest v
+00013350: 616c 7565 2061 6c77 6179 7320 7072 6576  alue always prev
+00013360: 6169 6c73 0a20 2020 2020 2020 2020 2020  ails.           
+00013370: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+00013380: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
+00013390: 3d3d 206f 626a 2e62 6f64 795f 6d61 786c  == obj.body_maxl
+000133a0: 656e 0a20 2020 2020 2020 2020 2020 2061  en.            a
+000133b0: 7373 6572 7420 7469 746c 655b 3a6f 626a  ssert title[:obj
+000133c0: 2e62 6f64 795f 6d61 786c 656e 5d20 3d3d  .body_maxlen] ==
+000133d0: 2063 6875 6e6b 2e67 6574 2827 7469 746c   chunk.get('titl
+000133e0: 6527 290a 0a20 2020 2020 2020 2023 204f  e')..        # O
+000133f0: 7572 2062 6f64 7920 6973 206f 6e6c 7920  ur body is only 
+00013400: 6272 6f6b 656e 2075 703b 206e 6f74 206c  broken up; not l
+00013410: 6f73 740a 2020 2020 2020 2020 5f62 6f64  ost.        _bod
+00013420: 7920 3d20 6368 756e 6b2e 6765 7428 2762  y = chunk.get('b
+00013430: 6f64 7927 290a 0a20 2020 2020 2020 2023  ody')..        #
+00013440: 2055 6e2d 7573 6564 2077 6869 7465 7370   Un-used whitesp
+00013450: 6163 6520 6973 2061 6c77 6179 7320 636c  ace is always cl
+00013460: 6561 6e65 6420 7570 3b20 6d61 6b65 2073  eaned up; make s
+00013470: 7572 6520 7765 2061 6363 6f75 6e74 2066  ure we account f
+00013480: 6f72 0a20 2020 2020 2020 2023 2074 6869  or.        # thi
+00013490: 7320 696e 206f 7572 206e 6577 2063 616c  s in our new cal
+000134a0: 6375 6c61 7469 6f6e 0a20 2020 2020 2020  culation.       
+000134b0: 2077 735f 6469 6666 203d 206c 656e 2862   ws_diff = len(b
+000134c0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+000134d0: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+000134e0: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
+000134f0: 2020 6c65 6e28 626f 6479 5b6f 6666 7365    len(body[offse
+00013500: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+00013510: 6f66 6673 6574 5d0a 2020 2020 2020 2020  offset].        
+00013520: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+00013530: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+00013540: 7273 7472 6970 2829 290a 0a20 2020 2020  rstrip())..     
+00013550: 2020 2061 7373 6572 7420 626f 6479 5b6f     assert body[o
+00013560: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+00013570: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
+00013580: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
+00013590: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
+000135a0: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+000135b0: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
+000135c0: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
+000135d0: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
+000135e0: 6469 6666 290a 0a0a 6465 6620 7465 7374  diff)...def test
+000135f0: 5f6e 6f74 6966 795f 6f76 6572 666c 6f77  _notify_overflow
+00013600: 5f73 706c 6974 5f6e 6f5f 616d 616c 6761  _split_no_amalga
+00013610: 6d61 7469 6f6e 2829 3a0a 2020 2020 2222  mation():.    ""
+00013620: 220a 2020 2020 4150 493a 204f 7665 7266  ".    API: Overf
+00013630: 6c6f 7720 4e6f 2041 6d61 6c67 616d 6174  low No Amalgamat
+00013640: 696f 6e20 5370 6c69 7473 2046 756e 6374  ion Splits Funct
+00013650: 696f 6e61 6c69 7479 2054 6573 7469 6e67  ionality Testing
+00013660: 0a0a 2020 2020 2222 220a 0a20 2020 2023  ..    """..    #
+00013670: 0a20 2020 2023 2041 206c 6974 746c 6520  .    # A little 
+00013680: 7072 6570 6172 6174 696f 6e0a 2020 2020  preparation.    
+00013690: 230a 0a20 2020 2023 204e 756d 6265 7220  #..    # Number 
+000136a0: 6f66 2063 6861 7261 6374 6572 7320 7065  of characters pe
+000136b0: 7220 6c69 6e65 0a20 2020 2072 6f77 203d  r line.    row =
+000136c0: 2032 340a 0a20 2020 2023 2053 6f6d 6520   24..    # Some 
+000136d0: 7661 7269 6162 6c65 7320 7765 2075 7365  variables we use
+000136e0: 2074 6f20 636f 6e74 726f 6c20 7468 6520   to control the 
+000136f0: 6461 7461 2077 6520 776f 726b 2077 6974  data we work wit
+00013700: 680a 2020 2020 626f 6479 5f6c 656e 203d  h.    body_len =
+00013710: 2031 3032 340a 2020 2020 7469 746c 655f   1024.    title_
+00013720: 6c65 6e20 3d20 3130 3234 0a0a 2020 2020  len = 1024..    
+00013730: 2320 4372 6561 7465 2061 206c 6172 6765  # Create a large
+00013740: 2062 6f64 7920 616e 6420 7469 746c 6520   body and title 
+00013750: 7769 7468 2072 616e 646f 6d20 6461 7461  with random data
+00013760: 0a20 2020 2062 6f64 7920 3d20 2727 2e6a  .    body = ''.j
+00013770: 6f69 6e28 6368 6f69 6365 2873 7472 5f61  oin(choice(str_a
+00013780: 6c70 6861 202b 2073 7472 5f6e 756d 2920  lpha + str_num) 
+00013790: 666f 7220 5f20 696e 2072 616e 6765 2862  for _ in range(b
+000137a0: 6f64 795f 6c65 6e29 290a 2020 2020 626f  ody_len)).    bo
+000137b0: 6479 203d 2027 5c72 5c6e 272e 6a6f 696e  dy = '\r\n'.join
+000137c0: 285b 626f 6479 5b69 3a20 6920 2b20 726f  ([body[i: i + ro
+000137d0: 775d 2066 6f72 2069 2069 6e20 7261 6e67  w] for i in rang
+000137e0: 6528 302c 206c 656e 2862 6f64 7929 2c20  e(0, len(body), 
+000137f0: 726f 7729 5d29 0a0a 2020 2020 2320 7468  row)])..    # th
+00013800: 6520 6e65 7720 6c69 6e65 7320 6164 6420  e new lines add 
+00013810: 6120 6c61 7267 6520 616d 6f75 6e74 2074  a large amount t
+00013820: 6f20 6f75 7220 626f 6479 3b20 6c65 7473  o our body; lets
+00013830: 2066 6f72 6365 2074 6865 2063 6f6e 7465   force the conte
+00013840: 6e74 0a20 2020 2023 2062 6163 6b20 746f  nt.    # back to
+00013850: 2062 6569 6e67 2031 3032 3420 6368 6172   being 1024 char
+00013860: 6163 7465 7273 2e0a 2020 2020 626f 6479  acters..    body
+00013870: 203d 2062 6f64 795b 303a 3130 3234 5d0a   = body[0:1024].
+00013880: 0a20 2020 2023 2043 7265 6174 6520 6f75  .    # Create ou
+00013890: 7220 7469 746c 6520 7573 696e 6720 7261  r title using ra
+000138a0: 6e64 6f6d 2064 6174 610a 2020 2020 7469  ndom data.    ti
+000138b0: 746c 6520 3d20 2727 2e6a 6f69 6e28 6368  tle = ''.join(ch
+000138c0: 6f69 6365 2873 7472 5f61 6c70 6861 202b  oice(str_alpha +
+000138d0: 2073 7472 5f6e 756d 2920 666f 7220 5f20   str_num) for _ 
+000138e0: 696e 2072 616e 6765 2874 6974 6c65 5f6c  in range(title_l
+000138f0: 656e 2929 0a0a 2020 2020 230a 2020 2020  en))..    #.    
+00013900: 2320 4669 7273 7420 5465 7374 3a20 5472  # First Test: Tr
+00013910: 756e 6361 7465 6420 5469 746c 650a 2020  uncated Title.  
+00013920: 2020 230a 2020 2020 636c 6173 7320 5465    #.    class Te
+00013930: 7374 4e6f 7469 6669 6361 7469 6f6e 284e  stNotification(N
+00013940: 6f74 6966 7942 6173 6529 3a0a 0a20 2020  otifyBase):..   
+00013950: 2020 2020 2023 2054 6573 7420 7469 746c       # Test titl
+00013960: 6520 6d61 7820 6c65 6e67 7468 0a20 2020  e max length.   
+00013970: 2020 2020 2074 6974 6c65 5f6d 6178 6c65       title_maxle
+00013980: 6e20 3d20 3130 0a0a 2020 2020 2020 2020  n = 10..        
+00013990: 2320 4e6f 2061 6d61 6c67 616d 6174 696f  # No amalgamatio
+000139a0: 6e0a 2020 2020 2020 2020 6f76 6572 666c  n.        overfl
+000139b0: 6f77 5f61 6d61 6c67 616d 6174 655f 7469  ow_amalgamate_ti
+000139c0: 746c 6520 3d20 4661 6c73 650a 0a20 2020  tle = False..   
+000139d0: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
+000139e0: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
+000139f0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00013a00: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+00013a10: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
+00013a20: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
+00013a30: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
+00013a40: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00013a50: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
+00013a60: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
+00013a70: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
+00013a80: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00013a90: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
+00013aa0: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
+00013ab0: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00013ac0: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
+00013ad0: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
+00013ae0: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
+00013af0: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
+00013b00: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
+00013b10: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
+00013b20: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
+00013b30: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
+00013b40: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+00013b50: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+00013b60: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
+00013b70: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00013b80: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00013b90: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00013ba0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00013bb0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00013bc0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00013bd0: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+00013be0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00013bf0: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+00013c00: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+00013c10: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00013c20: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00013c30: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+00013c40: 6529 0a20 2020 2061 7373 6572 7420 6c65  e).    assert le
+00013c50: 6e28 6368 756e 6b73 2920 3d3d 2031 0a20  n(chunks) == 1. 
+00013c60: 2020 2061 7373 6572 7420 626f 6479 2e6c     assert body.l
+00013c70: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
+00013c80: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
+00013c90: 3d20 6368 756e 6b73 5b30 5d2e 6765 7428  = chunks[0].get(
+00013ca0: 2762 6f64 7927 290a 2020 2020 6173 7365  'body').    asse
+00013cb0: 7274 2074 6974 6c65 5b30 3a6f 626a 2e74  rt title[0:obj.t
+00013cc0: 6974 6c65 5f6d 6178 6c65 6e5d 203d 3d20  itle_maxlen] == 
+00013cd0: 6368 756e 6b73 5b30 5d2e 6765 7428 2774  chunks[0].get('t
+00013ce0: 6974 6c65 2729 0a0a 2020 2020 230a 2020  itle')..    #.  
+00013cf0: 2020 2320 4e65 7874 2054 6573 743a 204c    # Next Test: L
+00013d00: 696e 6520 436f 756e 7420 436f 6e74 726f  ine Count Contro
+00013d10: 6c0a 2020 2020 230a 0a20 2020 2063 6c61  l.    #..    cla
+00013d20: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
+00013d30: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+00013d40: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
+00013d50: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
+00013d60: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
+00013d70: 6d61 786c 656e 203d 2035 0a0a 2020 2020  maxlen = 5..    
+00013d80: 2020 2020 2320 4d61 7869 6d75 6d20 6e75      # Maximum nu
+00013d90: 6d62 6572 206f 6620 6c69 6e65 730a 2020  mber of lines.  
+00013da0: 2020 2020 2020 626f 6479 5f6d 6178 5f6c        body_max_l
+00013db0: 696e 655f 636f 756e 7420 3d20 350a 0a20  ine_count = 5.. 
+00013dc0: 2020 2020 2020 2023 204e 6f20 616d 616c         # No amal
+00013dd0: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
+00013de0: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
+00013df0: 6d61 7465 5f74 6974 6c65 203d 2046 616c  mate_title = Fal
+00013e00: 7365 0a0a 2020 2020 2020 2020 6465 6620  se..        def 
+00013e10: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
+00013e20: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00013e30: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
+00013e40: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
+00013e50: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
+00013e60: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
+00013e70: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00013e80: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00013e90: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
+00013ea0: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
+00013eb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00013ec0: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
+00013ed0: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
+00013ee0: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
+00013ef0: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
+00013f00: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
+00013f10: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
+00013f20: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
+00013f30: 2020 2020 2320 5665 7269 6679 2074 6861      # Verify tha
+00013f40: 7420 7765 2062 7265 616b 2074 6865 2074  t we break the t
+00013f50: 6974 6c65 2074 6f20 6120 6d61 7820 6c65  itle to a max le
+00013f60: 6e67 7468 206f 6620 6f75 7220 7469 746c  ngth of our titl
+00013f70: 655f 6d61 780a 2020 2020 2320 616e 6420  e_max.    # and 
+00013f80: 7468 6174 2074 6865 2062 6f64 7920 7265  that the body re
+00013f90: 6d61 696e 7320 756e 746f 7563 6865 640a  mains untouched.
+00013fa0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00013fb0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00013fc0: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00013fd0: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
+00013fe0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00013ff0: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+00014000: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
+00014010: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00014020: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00014030: 3d62 6f64 792c 2074 6974 6c65 3d22 2229  =body, title="")
+00014040: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00014050: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00014060: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+00014070: 6c65 3d74 6974 6c65 290a 2020 2020 6173  le=title).    as
+00014080: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+00014090: 203d 3d20 310a 2020 2020 6173 7365 7274   == 1.    assert
+000140a0: 206c 656e 2863 6875 6e6b 735b 305d 2e67   len(chunks[0].g
+000140b0: 6574 2827 626f 6479 2729 2e73 706c 6974  et('body').split
+000140c0: 2827 5c6e 2729 2920 3d3d 206f 626a 2e62  ('\n')) == obj.b
+000140d0: 6f64 795f 6d61 785f 6c69 6e65 5f63 6f75  ody_max_line_cou
+000140e0: 6e74 0a20 2020 2061 7373 6572 7420 7469  nt.    assert ti
+000140f0: 746c 655b 303a 6f62 6a2e 7469 746c 655f  tle[0:obj.title_
+00014100: 6d61 786c 656e 5d20 3d3d 2063 6875 6e6b  maxlen] == chunk
+00014110: 735b 305d 2e67 6574 2827 7469 746c 6527  s[0].get('title'
+00014120: 290a 0a20 2020 2023 0a20 2020 2023 204e  )..    #.    # N
+00014130: 6578 7420 5465 7374 3a20 5370 6c69 7420  ext Test: Split 
+00014140: 626f 6479 0a20 2020 2023 0a0a 2020 2020  body.    #..    
+00014150: 636c 6173 7320 5465 7374 4e6f 7469 6669  class TestNotifi
+00014160: 6361 7469 6f6e 284e 6f74 6966 7942 6173  cation(NotifyBas
+00014170: 6529 3a0a 0a20 2020 2020 2020 2023 2054  e):..        # T
+00014180: 6573 7420 7469 746c 6520 6d61 7820 6c65  est title max le
+00014190: 6e67 7468 0a20 2020 2020 2020 2074 6974  ngth.        tit
+000141a0: 6c65 5f6d 6178 6c65 6e20 3d20 7469 746c  le_maxlen = titl
+000141b0: 655f 6c65 6e0a 0a20 2020 2020 2020 2023  e_len..        #
+000141c0: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
+000141d0: 6c65 6e67 7468 2e20 4d61 6b65 2073 7572  length. Make sur
+000141e0: 6520 6974 2773 2061 6e20 696e 742e 0a20  e it's an int.. 
+000141f0: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
+00014200: 656e 203d 2069 6e74 2862 6f64 795f 6c65  en = int(body_le
+00014210: 6e20 2f20 3429 0a0a 2020 2020 2020 2020  n / 4)..        
+00014220: 2320 4e6f 2061 6d61 6c67 616d 6174 696f  # No amalgamatio
+00014230: 6e0a 2020 2020 2020 2020 6f76 6572 666c  n.        overfl
+00014240: 6f77 5f61 6d61 6c67 616d 6174 655f 7469  ow_amalgamate_ti
+00014250: 746c 6520 3d20 4661 6c73 650a 0a20 2020  tle = False..   
+00014260: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
+00014270: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
+00014280: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00014290: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+000142a0: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
+000142b0: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
+000142c0: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
+000142d0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+000142e0: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
+000142f0: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
+00014300: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
+00014310: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00014320: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
+00014330: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
+00014340: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00014350: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
+00014360: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
+00014370: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
+00014380: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
+00014390: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
+000143a0: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
+000143b0: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
+000143c0: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
+000143d0: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+000143e0: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+000143f0: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
+00014400: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00014410: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00014420: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00014430: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00014440: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00014450: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00014460: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+00014470: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00014480: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+00014490: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+000144a0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+000144b0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+000144c0: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+000144d0: 6529 0a20 2020 206f 6666 7365 7420 3d20  e).    offset = 
+000144e0: 300a 2020 2020 635f 6c65 6e20 3d20 6c65  0.    c_len = le
+000144f0: 6e28 2720 5b58 2f58 5d27 290a 2020 2020  n(' [X/X]').    
+00014500: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+00014510: 7329 203d 3d20 340a 2020 2020 666f 7220  s) == 4.    for 
+00014520: 6964 782c 2063 6875 6e6b 2069 6e20 656e  idx, chunk in en
+00014530: 756d 6572 6174 6528 6368 756e 6b73 2c20  umerate(chunks, 
+00014540: 7374 6172 743d 3129 3a0a 2020 2020 2020  start=1):.      
+00014550: 2020 2320 5665 7269 6669 6361 7469 6f6e    # Verification
+00014560: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014570: 6c65 6e28 6368 756e 6b2e 6765 7428 2774  len(chunk.get('t
+00014580: 6974 6c65 2729 2920 3c3d 206f 626a 2e74  itle')) <= obj.t
+00014590: 6974 6c65 5f6d 6178 6c65 6e0a 2020 2020  itle_maxlen.    
+000145a0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+000145b0: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
+000145c0: 2920 3c3d 206f 626a 2e62 6f64 795f 6d61  ) <= obj.body_ma
+000145d0: 786c 656e 0a0a 2020 2020 2020 2020 2320  xlen..        # 
+000145e0: 4f75 7220 7469 746c 6520 6861 7320 6120  Our title has a 
+000145f0: 636f 756e 7465 7220 6164 6465 6420 746f  counter added to
+00014600: 2069 740a 2020 2020 2020 2020 6173 7365   it.        asse
+00014610: 7274 2074 6974 6c65 5b3a 2d63 5f6c 656e  rt title[:-c_len
+00014620: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
+00014630: 7469 746c 6527 295b 3a2d 635f 6c65 6e5d  title')[:-c_len]
+00014640: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014650: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+00014660: 2729 5b2d 635f 6c65 6e3a 5d20 3d3d 205c  ')[-c_len:] == \
+00014670: 0a20 2020 2020 2020 2020 2020 2027 205b  .            ' [
+00014680: 7b3a 3031 7d2f 7b3a 3031 7d5d 272e 666f  {:01}/{:01}]'.fo
+00014690: 726d 6174 2869 6478 2c20 6c65 6e28 6368  rmat(idx, len(ch
+000146a0: 756e 6b73 2929 0a20 2020 2020 2020 2023  unks)).        #
+000146b0: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+000146c0: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+000146d0: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+000146e0: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+000146f0: 2762 6f64 7927 290a 2020 2020 2020 2020  'body').        
+00014700: 6173 7365 7274 2062 6f64 795b 6f66 6673  assert body[offs
+00014710: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00014720: 206f 6666 7365 745d 5c0a 2020 2020 2020   offset]\.      
+00014730: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+00014740: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+00014750: 7472 6970 2829 203d 3d20 5f62 6f64 790a  trip() == _body.
+00014760: 2020 2020 2020 2020 6f66 6673 6574 202b          offset +
+00014770: 3d20 6c65 6e28 5f62 6f64 7929 0a0a 2020  = len(_body)..  
+00014780: 2020 2320 416e 6f74 6865 7220 6564 6765    # Another edge
+00014790: 2063 6173 6520 7768 6572 6520 7468 6520   case where the 
+000147a0: 7469 746c 6520 6a75 7374 2069 736e 2774  title just isn't
+000147b0: 2074 6861 7420 6c6f 6e67 206c 6561 7669   that long leavi
+000147c0: 6e67 0a20 2020 2023 2061 206c 6f74 206f  ng.    # a lot o
+000147d0: 6620 7370 6163 6520 666f 7220 7468 6520  f space for the 
+000147e0: 5b78 782f 7878 5d20 656e 7472 6965 7320  [xx/xx] entries 
+000147f0: 286e 6f20 7472 756e 6361 7469 6f6e 206e  (no truncation n
+00014800: 6565 6465 6429 0a20 2020 2063 6875 6e6b  eeded).    chunk
+00014810: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00014820: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+00014830: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+00014840: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00014850: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00014860: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
+00014870: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00014880: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00014890: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+000148a0: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+000148b0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+000148c0: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
+000148d0: 6479 2c20 7469 746c 653d 7469 746c 655b  dy, title=title[
+000148e0: 3a32 305d 290a 2020 2020 6f66 6673 6574  :20]).    offset
+000148f0: 203d 2030 0a20 2020 2061 7373 6572 7420   = 0.    assert 
+00014900: 6c65 6e28 6368 756e 6b73 2920 3d3d 2034  len(chunks) == 4
+00014910: 0a20 2020 2066 6f72 2069 6478 2c20 6368  .    for idx, ch
+00014920: 756e 6b20 696e 2065 6e75 6d65 7261 7465  unk in enumerate
+00014930: 2863 6875 6e6b 732c 2073 7461 7274 3d31  (chunks, start=1
+00014940: 293a 0a20 2020 2020 2020 2023 2056 6572  ):.        # Ver
+00014950: 6966 6963 6174 696f 6e0a 2020 2020 2020  ification.      
+00014960: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00014970: 6e6b 2e67 6574 2827 7469 746c 6527 2929  nk.get('title'))
+00014980: 203c 3d20 6f62 6a2e 7469 746c 655f 6d61   <= obj.title_ma
+00014990: 786c 656e 0a20 2020 2020 2020 2061 7373  xlen.        ass
+000149a0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
+000149b0: 7428 2762 6f64 7927 2929 203c 3d20 6f62  t('body')) <= ob
+000149c0: 6a2e 626f 6479 5f6d 6178 6c65 6e0a 0a20  j.body_maxlen.. 
+000149d0: 2020 2020 2020 2023 204f 7572 2074 6974         # Our tit
+000149e0: 6c65 2068 6173 2061 2063 6f75 6e74 6572  le has a counter
+000149f0: 2061 6464 6564 2074 6f20 6974 0a20 2020   added to it.   
+00014a00: 2020 2020 2061 7373 6572 7420 7469 746c       assert titl
+00014a10: 655b 3a32 305d 203d 3d20 6368 756e 6b2e  e[:20] == chunk.
+00014a20: 6765 7428 2774 6974 6c65 2729 5b3a 2d63  get('title')[:-c
+00014a30: 5f6c 656e 5d0a 2020 2020 2020 2020 6173  _len].        as
+00014a40: 7365 7274 2063 6875 6e6b 2e67 6574 2827  sert chunk.get('
+00014a50: 7469 746c 6527 295b 2d63 5f6c 656e 3a5d  title')[-c_len:]
+00014a60: 203d 3d20 5c0a 2020 2020 2020 2020 2020   == \.          
+00014a70: 2020 2720 5b7b 3a30 317d 2f7b 3a30 317d    ' [{:01}/{:01}
+00014a80: 5d27 2e66 6f72 6d61 7428 6964 782c 206c  ]'.format(idx, l
+00014a90: 656e 2863 6875 6e6b 7329 290a 2020 2020  en(chunks)).    
+00014aa0: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
+00014ab0: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
+00014ac0: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
+00014ad0: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
+00014ae0: 2e67 6574 2827 626f 6479 2729 0a20 2020  .get('body').   
+00014af0: 2020 2020 2061 7373 6572 7420 626f 6479       assert body
+00014b00: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+00014b10: 6479 2920 2b20 6f66 6673 6574 5d5c 0a20  dy) + offset]\. 
+00014b20: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+00014b30: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+00014b40: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
+00014b50: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
+00014b60: 7365 7420 2b3d 206c 656e 285f 626f 6479  set += len(_body
+00014b70: 290a 0a20 2020 2023 2054 6573 7420 6c61  )..    # Test la
+00014b80: 7267 6572 206d 6573 7361 6765 730a 2020  rger messages.  
+00014b90: 2020 2320 616e 6420 7468 6174 2074 6865    # and that the
+00014ba0: 2062 6f64 7920 7265 6d61 696e 7320 756e   body remains un
+00014bb0: 746f 7563 6865 640a 2020 2020 636c 6173  touched.    clas
+00014bc0: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
+00014bd0: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
+00014be0: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
+00014bf0: 7469 746c 6520 6d61 7820 6c65 6e67 7468  title max length
+00014c00: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
+00014c10: 6178 6c65 6e20 3d20 3135 300a 0a20 2020  axlen = 150..   
+00014c20: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
+00014c30: 2062 6f64 7920 6c65 6e67 7468 2e20 4d61   body length. Ma
+00014c40: 6b65 2073 7572 6520 6974 2773 2061 6e20  ke sure it's an 
+00014c50: 696e 742e 0a20 2020 2020 2020 2062 6f64  int..        bod
+00014c60: 795f 6d61 786c 656e 203d 2034 3030 0a0a  y_maxlen = 400..
+00014c70: 2020 2020 2020 2020 2320 4e6f 2061 6d61          # No ama
+00014c80: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
+00014c90: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
+00014ca0: 616d 6174 655f 7469 746c 6520 3d20 4661  amate_title = Fa
+00014cb0: 6c73 650a 0a20 2020 2020 2020 2064 6566  lse..        def
+00014cc0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00014cd0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00014ce0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
+00014cf0: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
+00014d00: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
+00014d10: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
+00014d20: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00014d30: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+00014d40: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
+00014d50: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
+00014d60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00014d70: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
+00014d80: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
+00014d90: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
+00014da0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
+00014db0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
+00014dc0: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
+00014dd0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
+00014de0: 0a20 2020 206e 6577 5f62 6f64 7920 3d20  .    new_body = 
+00014df0: 2862 6f64 7920 2a20 3530 3029 0a20 2020  (body * 500).   
+00014e00: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00014e10: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00014e20: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
+00014e30: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
+00014e40: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00014e50: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00014e60: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+00014e70: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00014e80: 6f76 6572 666c 6f77 2862 6f64 793d 6e65  overflow(body=ne
+00014e90: 775f 626f 6479 2c20 7469 746c 653d 2222  w_body, title=""
+00014ea0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00014eb0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00014ec0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
+00014ed0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00014ee0: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+00014ef0: 2020 635f 6c65 6e20 3d20 6c65 6e28 2720    c_len = len(' 
+00014f00: 5b58 5858 582f 5858 5858 5d27 290a 2020  [XXXX/XXXX]').  
+00014f10: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00014f20: 6e6b 7329 203d 3d20 3132 3830 0a20 2020  nks) == 1280.   
+00014f30: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
+00014f40: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
+00014f50: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
+00014f60: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
+00014f70: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
+00014f80: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
+00014f90: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
+00014fa0: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+00014fb0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00014fc0: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
+00014fd0: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
+00014fe0: 6479 5f6d 6178 6c65 6e0a 2020 2020 2020  dy_maxlen.      
+00014ff0: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
+00015000: 7320 6120 636f 756e 7465 7220 6164 6465  s a counter adde
+00015010: 6420 746f 2069 740a 2020 2020 2020 2020  d to it.        
+00015020: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
+00015030: 6a2e 7469 746c 655f 6d61 786c 656e 5d5b  j.title_maxlen][
+00015040: 3a2d 635f 6c65 6e5d 203d 3d20 6368 756e  :-c_len] == chun
+00015050: 6b2e 6765 7428 2774 6974 6c65 2729 5b3a  k.get('title')[:
+00015060: 2d63 5f6c 656e 5d0a 2020 2020 2020 2020  -c_len].        
+00015070: 6173 7365 7274 2063 6875 6e6b 2e67 6574  assert chunk.get
+00015080: 2827 7469 746c 6527 295b 2d63 5f6c 656e  ('title')[-c_len
+00015090: 3a5d 203d 3d20 5c0a 2020 2020 2020 2020  :] == \.        
+000150a0: 2020 2020 2720 5b7b 3a30 347d 2f7b 3a30      ' [{:04}/{:0
+000150b0: 347d 5d27 2e66 6f72 6d61 7428 6964 782c  4}]'.format(idx,
+000150c0: 206c 656e 2863 6875 6e6b 7329 290a 2020   len(chunks)).  
+000150d0: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
+000150e0: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
+000150f0: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
+00015100: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
+00015110: 6e6b 2e67 6574 2827 626f 6479 2729 0a0a  nk.get('body')..
+00015120: 2020 2020 2020 2020 2320 556e 2d75 7365          # Un-use
+00015130: 6420 7768 6974 6573 7061 6365 2069 7320  d whitespace is 
+00015140: 616c 7761 7973 2063 6c65 616e 6564 2075  always cleaned u
+00015150: 703b 206d 616b 6520 7375 7265 2077 6520  p; make sure we 
+00015160: 6163 636f 756e 7420 666f 720a 2020 2020  account for.    
+00015170: 2020 2020 2320 7468 6973 2069 6e20 6f75      # this in ou
+00015180: 7220 6e65 7720 6361 6c63 756c 6174 696f  r new calculatio
+00015190: 6e0a 2020 2020 2020 2020 7773 5f64 6966  n.        ws_dif
+000151a0: 6620 3d20 6c65 6e28 6e65 775f 626f 6479  f = len(new_body
+000151b0: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+000151c0: 6479 2920 2b20 6f66 6673 6574 5d29 202d  dy) + offset]) -
+000151d0: 205c 0a20 2020 2020 2020 2020 2020 206c   \.            l
+000151e0: 656e 286e 6577 5f62 6f64 795b 6f66 6673  en(new_body[offs
+000151f0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00015200: 206f 6666 7365 745d 0a20 2020 2020 2020   offset].       
+00015210: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
+00015220: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
+00015230: 2e72 7374 7269 7028 2929 0a0a 2020 2020  .rstrip())..    
+00015240: 2020 2020 6173 7365 7274 206e 6577 5f62      assert new_b
+00015250: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+00015260: 5f62 6f64 7929 202b 206f 6666 7365 7420  _body) + offset 
+00015270: 2b20 7773 5f64 6966 665d 5c0a 2020 2020  + ws_diff]\.    
+00015280: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+00015290: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+000152a0: 7273 7472 6970 2829 203d 3d20 5f62 6f64  rstrip() == _bod
+000152b0: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
+000152c0: 202b 3d20 286c 656e 285f 626f 6479 2920   += (len(_body) 
+000152d0: 2b20 7773 5f64 6966 6629 0a0a 2020 2020  + ws_diff)..    
+000152e0: 2320 426f 6479 2063 6875 6e6b 2069 7320  # Body chunk is 
+000152f0: 6265 796f 6e64 2034 2064 6967 6974 732c  beyond 4 digits,
+00015300: 2073 6f20 5b58 5858 582f 5858 5858 5d20   so [XXXX/XXXX] 
+00015310: 6973 2074 7572 6e65 6420 6f66 660a 2020  is turned off.  
+00015320: 2020 6e65 775f 626f 6479 203d 2028 626f    new_body = (bo
+00015330: 6479 202a 2034 3530 3029 0a20 2020 2063  dy * 4500).    c
+00015340: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00015350: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00015360: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
+00015370: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00015380: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00015390: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+000153a0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+000153b0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+000153c0: 6572 666c 6f77 2862 6f64 793d 6e65 775f  erflow(body=new_
+000153d0: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
+000153e0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+000153f0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00015400: 2862 6f64 793d 6e65 775f 626f 6479 2c20  (body=new_body, 
+00015410: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
+00015420: 206f 6666 7365 7420 3d20 300a 2020 2020   offset = 0.    
+00015430: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+00015440: 7329 203d 3d20 3131 3532 300a 2020 2020  s) == 11520.    
+00015450: 666f 7220 6964 782c 2063 6875 6e6b 2069  for idx, chunk i
+00015460: 6e20 656e 756d 6572 6174 6528 6368 756e  n enumerate(chun
+00015470: 6b73 2c20 7374 6172 743d 3129 3a0a 2020  ks, start=1):.  
+00015480: 2020 2020 2020 2320 5665 7269 6669 6361        # Verifica
+00015490: 7469 6f6e 0a20 2020 2020 2020 2061 7373  tion.        ass
+000154a0: 6572 7420 6c65 6e28 6368 756e 6b2e 6765  ert len(chunk.ge
+000154b0: 7428 2774 6974 6c65 2729 2920 3c3d 206f  t('title')) <= o
+000154c0: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e0a  bj.title_maxlen.
+000154d0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000154e0: 656e 2863 6875 6e6b 2e67 6574 2827 626f  en(chunk.get('bo
+000154f0: 6479 2729 2920 3c3d 206f 626a 2e62 6f64  dy')) <= obj.bod
+00015500: 795f 6d61 786c 656e 0a0a 2020 2020 2020  y_maxlen..      
+00015510: 2020 2320 4f75 7220 7469 746c 6520 6861    # Our title ha
+00015520: 7320 6e6f 2063 6f75 6e74 6572 2061 6464  s no counter add
+00015530: 6564 2074 6f20 6974 0a20 2020 2020 2020  ed to it.       
+00015540: 2061 7373 6572 7420 7469 746c 655b 3a6f   assert title[:o
+00015550: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e5d  bj.title_maxlen]
+00015560: 203d 3d20 6368 756e 6b2e 6765 7428 2774   == chunk.get('t
+00015570: 6974 6c65 2729 0a20 2020 2020 2020 2023  itle').        #
+00015580: 204f 7572 2062 6f64 7920 6973 206f 6e6c   Our body is onl
+00015590: 7920 6272 6f6b 656e 2075 703b 206e 6f74  y broken up; not
+000155a0: 206c 6f73 740a 2020 2020 2020 2020 5f62   lost.        _b
+000155b0: 6f64 7920 3d20 6368 756e 6b2e 6765 7428  ody = chunk.get(
+000155c0: 2762 6f64 7927 290a 0a20 2020 2020 2020  'body')..       
+000155d0: 2023 2055 6e2d 7573 6564 2077 6869 7465   # Un-used white
+000155e0: 7370 6163 6520 6973 2061 6c77 6179 7320  space is always 
+000155f0: 636c 6561 6e65 6420 7570 3b20 6d61 6b65  cleaned up; make
+00015600: 2073 7572 6520 7765 2061 6363 6f75 6e74   sure we account
+00015610: 2066 6f72 0a20 2020 2020 2020 2023 2074   for.        # t
+00015620: 6869 7320 696e 206f 7572 206e 6577 2063  his in our new c
+00015630: 616c 6375 6c61 7469 6f6e 0a20 2020 2020  alculation.     
+00015640: 2020 2077 735f 6469 6666 203d 206c 656e     ws_diff = len
+00015650: 286e 6577 5f62 6f64 795b 6f66 6673 6574  (new_body[offset
+00015660: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+00015670: 6666 7365 745d 2920 2d20 5c0a 2020 2020  ffset]) - \.    
+00015680: 2020 2020 2020 2020 6c65 6e28 6e65 775f          len(new_
+00015690: 626f 6479 5b6f 6666 7365 743a 206c 656e  body[offset: len
+000156a0: 285f 626f 6479 2920 2b20 6f66 6673 6574  (_body) + offset
+000156b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000156c0: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
+000156d0: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
+000156e0: 2829 290a 0a20 2020 2020 2020 2061 7373  ())..        ass
+000156f0: 6572 7420 6e65 775f 626f 6479 5b6f 6666  ert new_body[off
+00015700: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+00015710: 2b20 6f66 6673 6574 202b 2077 735f 6469  + offset + ws_di
+00015720: 6666 5d5c 0a20 2020 2020 2020 2020 2020  ff]\.           
+00015730: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+00015740: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+00015750: 2920 3d3d 205f 626f 6479 0a20 2020 2020  ) == _body.     
+00015760: 2020 206f 6666 7365 7420 2b3d 2028 6c65     offset += (le
+00015770: 6e28 5f62 6f64 7929 202b 2077 735f 6469  n(_body) + ws_di
+00015780: 6666 290a 0a20 2020 2023 2054 6573 7420  ff)..    # Test 
+00015790: 6c61 7267 6572 206d 6573 7361 6765 730a  larger messages.
+000157a0: 2020 2020 2320 616e 6420 7468 6174 2074      # and that t
+000157b0: 6865 2062 6f64 7920 7265 6d61 696e 7320  he body remains 
+000157c0: 756e 746f 7563 6865 640a 2020 2020 636c  untouched.    cl
+000157d0: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
+000157e0: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
+000157f0: 3a0a 0a20 2020 2020 2020 2023 2054 6573  :..        # Tes
+00015800: 7420 7469 746c 6520 6d61 7820 6c65 6e67  t title max leng
+00015810: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
+00015820: 5f6d 6178 6c65 6e20 3d20 3135 300a 0a20  _maxlen = 150.. 
+00015830: 2020 2020 2020 2023 2045 6e66 6f72 6365         # Enforce
+00015840: 2061 2062 6f64 7920 6c65 6e67 7468 2e20   a body length. 
+00015850: 4d61 6b65 2073 7572 6520 6974 2773 2061  Make sure it's a
+00015860: 6e20 696e 742e 0a20 2020 2020 2020 2062  n int..        b
+00015870: 6f64 795f 6d61 786c 656e 203d 2031 3530  ody_maxlen = 150
+00015880: 0a0a 2020 2020 2020 2020 2320 4e6f 2061  ..        # No a
+00015890: 6d61 6c67 616d 6174 696f 6e0a 2020 2020  malgamation.    
+000158a0: 2020 2020 6f76 6572 666c 6f77 5f61 6d61      overflow_ama
+000158b0: 6c67 616d 6174 655f 7469 746c 6520 3d20  lgamate_title = 
+000158c0: 4661 6c73 650a 0a20 2020 2020 2020 2064  False..        d
+000158d0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+000158e0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+000158f0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00015900: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
+00015910: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
+00015920: 2020 2020 6465 6620 6e6f 7469 6679 2873      def notify(s
+00015930: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00015940: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+00015950: 2020 2023 2050 7265 7465 6e64 2065 7665     # Pretend eve
+00015960: 7279 7468 696e 6720 6973 206f 6b61 790a  rything is okay.
+00015970: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00015980: 726e 2054 7275 650a 0a20 2020 2023 204c  rn True..    # L
+00015990: 6f61 6420 6f75 7220 6f62 6a65 6374 0a20  oad our object. 
+000159a0: 2020 206f 626a 203d 2054 6573 744e 6f74     obj = TestNot
+000159b0: 6966 6963 6174 696f 6e28 6f76 6572 666c  ification(overfl
+000159c0: 6f77 3d4f 7665 7266 6c6f 774d 6f64 652e  ow=OverflowMode.
+000159d0: 5350 4c49 5429 0a20 2020 2061 7373 6572  SPLIT).    asser
+000159e0: 7420 6f62 6a20 6973 206e 6f74 204e 6f6e  t obj is not Non
+000159f0: 650a 0a20 2020 206e 6577 5f62 6f64 7920  e..    new_body 
+00015a00: 3d20 2862 6f64 7920 2a20 3529 0a20 2020  = (body * 5).   
+00015a10: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00015a20: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00015a30: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
+00015a40: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
+00015a50: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00015a60: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00015a70: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+00015a80: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00015a90: 6f76 6572 666c 6f77 2862 6f64 793d 6e65  overflow(body=ne
+00015aa0: 775f 626f 6479 2c20 7469 746c 653d 2222  w_body, title=""
+00015ab0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00015ac0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00015ad0: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
+00015ae0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00015af0: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+00015b00: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00015b10: 6e6b 7329 203d 3d20 3335 0a20 2020 2063  nks) == 35.    c
+00015b20: 5f6c 656e 203d 206c 656e 2827 205b 5858  _len = len(' [XX
+00015b30: 2f58 585d 2729 0a20 2020 2066 6f72 2069  /XX]').    for i
+00015b40: 6478 2c20 6368 756e 6b20 696e 2065 6e75  dx, chunk in enu
+00015b50: 6d65 7261 7465 2863 6875 6e6b 732c 2073  merate(chunks, s
+00015b60: 7461 7274 3d31 293a 0a20 2020 2020 2020  tart=1):.       
+00015b70: 2023 2056 6572 6966 6963 6174 696f 6e0a   # Verification.
+00015b80: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+00015b90: 656e 2863 6875 6e6b 2e67 6574 2827 7469  en(chunk.get('ti
+00015ba0: 746c 6527 2929 203c 3d20 6f62 6a2e 7469  tle')) <= obj.ti
+00015bb0: 746c 655f 6d61 786c 656e 0a20 2020 2020  tle_maxlen.     
+00015bc0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00015bd0: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
+00015be0: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
+00015bf0: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
+00015c00: 7572 2074 6974 6c65 2068 6173 2061 2063  ur title has a c
+00015c10: 6f75 6e74 6572 2061 6464 6564 2074 6f20  ounter added to 
+00015c20: 6974 0a20 2020 2020 2020 2061 7373 6572  it.        asser
+00015c30: 7420 7469 746c 655b 3a6f 626a 2e74 6974  t title[:obj.tit
+00015c40: 6c65 5f6d 6178 6c65 6e5d 5b3a 2d63 5f6c  le_maxlen][:-c_l
+00015c50: 656e 5d20 3d3d 2063 6875 6e6b 2e67 6574  en] == chunk.get
+00015c60: 2827 7469 746c 6527 295b 3a2d 635f 6c65  ('title')[:-c_le
+00015c70: 6e5d 0a20 2020 2020 2020 2061 7373 6572  n].        asser
+00015c80: 7420 6368 756e 6b2e 6765 7428 2774 6974  t chunk.get('tit
+00015c90: 6c65 2729 5b2d 635f 6c65 6e3a 5d20 3d3d  le')[-c_len:] ==
+00015ca0: 205c 0a20 2020 2020 2020 2020 2020 2027   \.            '
+00015cb0: 205b 7b3a 3032 7d2f 7b3a 3032 7d5d 272e   [{:02}/{:02}]'.
+00015cc0: 666f 726d 6174 2869 6478 2c20 6c65 6e28  format(idx, len(
+00015cd0: 6368 756e 6b73 2929 0a20 2020 2020 2020  chunks)).       
+00015ce0: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
+00015cf0: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
+00015d00: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
+00015d10: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
+00015d20: 7428 2762 6f64 7927 290a 0a20 2020 2020  t('body')..     
+00015d30: 2020 2023 2055 6e2d 7573 6564 2077 6869     # Un-used whi
+00015d40: 7465 7370 6163 6520 6973 2061 6c77 6179  tespace is alway
+00015d50: 7320 636c 6561 6e65 6420 7570 3b20 6d61  s cleaned up; ma
+00015d60: 6b65 2073 7572 6520 7765 2061 6363 6f75  ke sure we accou
+00015d70: 6e74 2066 6f72 0a20 2020 2020 2020 2023  nt for.        #
+00015d80: 2074 6869 7320 696e 206f 7572 206e 6577   this in our new
+00015d90: 2063 616c 6375 6c61 7469 6f6e 0a20 2020   calculation.   
+00015da0: 2020 2020 2077 735f 6469 6666 203d 206c       ws_diff = l
+00015db0: 656e 286e 6577 5f62 6f64 795b 6f66 6673  en(new_body[offs
+00015dc0: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00015dd0: 206f 6666 7365 745d 2920 2d20 5c0a 2020   offset]) - \.  
+00015de0: 2020 2020 2020 2020 2020 6c65 6e28 6e65            len(ne
+00015df0: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
+00015e00: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+00015e10: 6574 5d0a 2020 2020 2020 2020 2020 2020  et].            
+00015e20: 2020 2020 2e6c 7374 7269 7028 275c 725c      .lstrip('\r\
+00015e30: 6e5c 7830 625c 7830 6327 292e 7273 7472  n\x0b\x0c').rstr
+00015e40: 6970 2829 290a 0a20 2020 2020 2020 2061  ip())..        a
+00015e50: 7373 6572 7420 6e65 775f 626f 6479 5b6f  ssert new_body[o
+00015e60: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+00015e70: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
+00015e80: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
+00015e90: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
+00015ea0: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+00015eb0: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
+00015ec0: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
+00015ed0: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
+00015ee0: 6469 6666 290a 0a20 2020 2023 0a20 2020  diff)..    #.   
+00015ef0: 2023 204e 6578 7420 5465 7374 3a20 4170   # Next Test: Ap
+00015f00: 7065 6e64 2074 6974 6c65 2074 6f20 626f  pend title to bo
+00015f10: 6479 202b 2073 706c 6974 2062 6f64 790a  dy + split body.
+00015f20: 2020 2020 230a 0a20 2020 2063 6c61 7373      #..    class
+00015f30: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+00015f40: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
+00015f50: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
+00015f60: 6520 6e6f 2074 6974 6c65 0a20 2020 2020  e no title.     
+00015f70: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
+00015f80: 3d20 300a 0a20 2020 2020 2020 2023 2045  = 0..        # E
+00015f90: 6e66 6f72 6365 2061 2062 6f64 7920 6c65  nforce a body le
+00015fa0: 6e67 7468 2062 6173 6564 206f 6e20 7468  ngth based on th
+00015fb0: 6520 7469 746c 652e 204d 616b 6520 7375  e title. Make su
+00015fc0: 7265 2069 7427 7320 616e 2069 6e74 2e0a  re it's an int..
+00015fd0: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
+00015fe0: 6c65 6e20 3d20 696e 7428 7469 746c 655f  len = int(title_
+00015ff0: 6c65 6e20 2f20 3429 0a0a 2020 2020 2020  len / 4)..      
+00016000: 2020 2320 4e6f 2041 6d61 6c67 616d 6174    # No Amalgamat
+00016010: 696f 6e0a 2020 2020 2020 2020 6f76 6572  ion.        over
+00016020: 666c 6f77 5f61 6d61 6c67 616d 6174 655f  flow_amalgamate_
+00016030: 7469 746c 6520 3d20 4661 6c73 650a 0a20  title = False.. 
+00016040: 2020 2020 2020 2064 6566 205f 5f69 6e69         def __ini
+00016050: 745f 5f28 7365 6c66 2c20 2a61 7267 732c  t__(self, *args,
+00016060: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00016070: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+00016080: 5f5f 696e 6974 5f5f 282a 2a6b 7761 7267  __init__(**kwarg
+00016090: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
+000160a0: 6e6f 7469 6679 2873 656c 662c 202a 6172  notify(self, *ar
+000160b0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+000160c0: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
+000160d0: 7465 6e64 2065 7665 7279 7468 696e 6720  tend everything 
+000160e0: 6973 206f 6b61 790a 2020 2020 2020 2020  is okay.        
+000160f0: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+00016100: 0a20 2020 2023 204c 6f61 6420 6f75 7220  .    # Load our 
+00016110: 6f62 6a65 6374 0a20 2020 206f 626a 203d  object.    obj =
+00016120: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+00016130: 6e28 6f76 6572 666c 6f77 3d4f 7665 7266  n(overflow=Overf
+00016140: 6c6f 774d 6f64 652e 5350 4c49 5429 0a20  lowMode.SPLIT). 
+00016150: 2020 2061 7373 6572 7420 6f62 6a20 6973     assert obj is
+00016160: 206e 6f74 204e 6f6e 650a 0a20 2020 2023   not None..    #
+00016170: 2056 6572 6966 7920 7468 6174 2077 6520   Verify that we 
+00016180: 6272 6561 6b20 7468 6520 7469 746c 6520  break the title 
+00016190: 746f 2061 206d 6178 206c 656e 6774 6820  to a max length 
+000161a0: 6f66 206f 7572 2074 6974 6c65 5f6d 6178  of our title_max
+000161b0: 0a20 2020 2023 2061 6e64 2074 6861 7420  .    # and that 
+000161c0: 7468 6520 626f 6479 2072 656d 6169 6e73  the body remains
+000161d0: 2075 6e74 6f75 6368 6564 0a20 2020 2063   untouched.    c
+000161e0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+000161f0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00016200: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
+00016210: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00016220: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00016230: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+00016240: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+00016250: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00016260: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+00016270: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
+00016280: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00016290: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+000162a0: 793d 626f 6479 2c20 7469 746c 653d 7469  y=body, title=ti
+000162b0: 746c 6529 0a0a 2020 2020 2320 4f75 7220  tle)..    # Our 
+000162c0: 6669 6e61 6c20 7072 6f64 7563 7420 6973  final product is
+000162d0: 2074 6861 7420 6f75 7220 7469 746c 6520   that our title 
+000162e0: 6861 7320 6265 656e 2061 7070 656e 6465  has been appende
+000162f0: 6420 746f 206f 7572 2062 6f64 7920 746f  d to our body to
+00016300: 0a20 2020 2023 2063 7265 6174 6520 6f6e  .    # create on
+00016310: 6520 6772 6561 7420 6269 6720 626f 6479  e great big body
+00016320: 2e20 4173 2061 2072 6573 756c 7420 7765  . As a result we
+00016330: 276c 6c20 6765 7420 7175 6974 6520 6120  'll get quite a 
+00016340: 6665 7720 6c69 6e65 7320 6261 636b 0a20  few lines back. 
+00016350: 2020 2023 206e 6f77 2e0a 2020 2020 6f66     # now..    of
+00016360: 6673 6574 203d 2030 0a0a 2020 2020 2320  fset = 0..    # 
+00016370: 4f75 7220 626f 6479 2077 696c 6c20 6c6f  Our body will lo
+00016380: 6f6b 206c 696b 6520 7468 6973 2069 6e20  ok like this in 
+00016390: 736d 616c 6c20 6368 756e 6b73 2061 7420  small chunks at 
+000163a0: 7468 6520 656e 6420 6f66 2074 6865 2064  the end of the d
+000163b0: 6179 0a20 2020 2062 756c 6b20 3d20 7469  ay.    bulk = ti
+000163c0: 746c 6520 2b20 275c 725c 6e27 202b 2062  tle + '\r\n' + b
+000163d0: 6f64 790a 0a20 2020 2023 2044 7565 2074  ody..    # Due t
+000163e0: 6f20 7468 6520 6e65 7720 6c69 6e65 2061  o the new line a
+000163f0: 6464 6564 2074 6f20 7468 6520 656e 640a  dded to the end.
+00016400: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00016410: 6875 6e6b 7329 203d 3d20 280a 2020 2020  hunks) == (.    
+00016420: 2020 2020 2320 7772 6170 2064 6976 6973      # wrap divis
+00016430: 696f 6e20 696e 2069 6e74 2829 2073 6f20  ion in int() so 
+00016440: 5079 7468 6f6e 2033 2064 6f65 736e 2774  Python 3 doesn't
+00016450: 2063 6f6e 7665 7274 2069 7420 746f 2061   convert it to a
+00016460: 2066 6c6f 6174 206f 6e0a 2020 2020 2020   float on.      
+00016470: 2020 2320 7573 0a20 2020 2020 2020 2069    # us.        i
+00016480: 6e74 286c 656e 2862 756c 6b29 202f 206f  nt(len(bulk) / o
+00016490: 626a 2e62 6f64 795f 6d61 786c 656e 2920  bj.body_maxlen) 
+000164a0: 2b0a 2020 2020 2020 2020 2831 2069 6620  +.        (1 if 
+000164b0: 6c65 6e28 6275 6c6b 2920 2520 6f62 6a2e  len(bulk) % obj.
+000164c0: 626f 6479 5f6d 6178 6c65 6e20 656c 7365  body_maxlen else
+000164d0: 2030 2929 0a0a 2020 2020 666f 7220 6368   0))..    for ch
+000164e0: 756e 6b20 696e 2063 6875 6e6b 733a 0a20  unk in chunks:. 
+000164f0: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
+00016500: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
+00016510: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
+00016520: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
+00016530: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+00016540: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00016550: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
+00016560: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
+00016570: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
+00016580: 2020 2023 204f 7572 2074 6974 6c65 2069     # Our title i
+00016590: 7320 656d 7074 7920 6576 6572 7920 7469  s empty every ti
+000165a0: 6d65 0a20 2020 2020 2020 2061 7373 6572  me.        asser
+000165b0: 7420 6368 756e 6b2e 6765 7428 2774 6974  t chunk.get('tit
+000165c0: 6c65 2729 203d 3d20 2727 0a0a 2020 2020  le') == ''..    
+000165d0: 2020 2020 2320 4f75 7220 626f 6479 2069      # Our body i
+000165e0: 7320 6f6e 6c79 2062 726f 6b65 6e20 7570  s only broken up
+000165f0: 3b20 6e6f 7420 6c6f 7374 0a20 2020 2020  ; not lost.     
+00016600: 2020 205f 626f 6479 203d 2063 6875 6e6b     _body = chunk
+00016610: 2e67 6574 2827 626f 6479 2729 0a0a 2020  .get('body')..  
+00016620: 2020 2020 2020 2320 556e 2d75 7365 6420        # Un-used 
+00016630: 7768 6974 6573 7061 6365 2069 7320 616c  whitespace is al
+00016640: 7761 7973 2063 6c65 616e 6564 2075 703b  ways cleaned up;
+00016650: 206d 616b 6520 7375 7265 2077 6520 6163   make sure we ac
+00016660: 636f 756e 7420 666f 720a 2020 2020 2020  count for.      
+00016670: 2020 2320 7468 6973 2069 6e20 6f75 7220    # this in our 
+00016680: 6e65 7720 6361 6c63 756c 6174 696f 6e0a  new calculation.
+00016690: 2020 2020 2020 2020 7773 5f64 6966 6620          ws_diff 
+000166a0: 3d20 6c65 6e28 6275 6c6b 5b6f 6666 7365  = len(bulk[offse
+000166b0: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+000166c0: 6f66 6673 6574 5d29 202d 205c 0a20 2020  offset]) - \.   
+000166d0: 2020 2020 2020 2020 206c 656e 2862 756c           len(bul
+000166e0: 6b5b 6f66 6673 6574 3a20 6c65 6e28 5f62  k[offset: len(_b
+000166f0: 6f64 7929 202b 206f 6666 7365 745d 0a20  ody) + offset]. 
+00016700: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+00016710: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
+00016720: 5c78 3063 2729 2e72 7374 7269 7028 2929  \x0c').rstrip())
+00016730: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00016740: 2062 756c 6b5b 6f66 6673 6574 3a20 6c65   bulk[offset: le
+00016750: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
+00016760: 7420 2b20 7773 5f64 6966 665d 5c0a 2020  t + ws_diff]\.  
+00016770: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
+00016780: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
+00016790: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
+000167a0: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
+000167b0: 6574 202b 3d20 286c 656e 285f 626f 6479  et += (len(_body
+000167c0: 2920 2b20 7773 5f64 6966 6629 0a0a 2020  ) + ws_diff)..  
+000167d0: 2020 230a 2020 2020 2320 5465 7374 2063    #.    # Test c
+000167e0: 6173 6520 7768 6572 6520 6f75 7220 7469  ase where our ti
+000167f0: 746c 655f 6c65 6e20 6973 2073 686f 7274  tle_len is short
+00016800: 6572 2074 6865 6e20 7468 6520 7661 6c75  er then the valu
+00016810: 650a 2020 2020 2320 7468 6174 2077 6f75  e.    # that wou
+00016820: 6c64 206f 7468 6572 7769 7365 2074 7269  ld otherwise tri
+00016830: 6767 6572 2074 6865 205b 5858 2f58 585d  gger the [XX/XX]
+00016840: 2065 6c65 6d65 6e74 730a 2020 2020 230a   elements.    #.
+00016850: 0a20 2020 2063 6c61 7373 2054 6573 744e  .    class TestN
+00016860: 6f74 6966 6963 6174 696f 6e28 4e6f 7469  otification(Noti
+00016870: 6679 4261 7365 293a 0a0a 2020 2020 2020  fyBase):..      
+00016880: 2020 2320 5365 7420 6120 736d 616c 6c20    # Set a small 
+00016890: 7469 746c 6520 6c65 6e67 7468 0a20 2020  title length.   
+000168a0: 2020 2020 2074 6974 6c65 5f6d 6178 6c65       title_maxle
+000168b0: 6e20 3d20 3130 300a 0a20 2020 2020 2020  n = 100..       
+000168c0: 2023 2045 6e66 6f72 6365 2061 2062 6f64   # Enforce a bod
+000168d0: 7920 6c65 6e67 7468 2e20 4d61 6b65 2073  y length. Make s
+000168e0: 7572 6520 6974 2773 2061 6e20 696e 742e  ure it's an int.
+000168f0: 0a20 2020 2020 2020 2062 6f64 795f 6d61  .        body_ma
+00016900: 786c 656e 203d 2069 6e74 2862 6f64 795f  xlen = int(body_
+00016910: 6c65 6e20 2f20 3429 0a0a 2020 2020 2020  len / 4)..      
+00016920: 2020 2320 4e6f 2041 6d61 6c67 616d 6174    # No Amalgamat
+00016930: 696f 6e0a 2020 2020 2020 2020 6f76 6572  ion.        over
+00016940: 666c 6f77 5f61 6d61 6c67 616d 6174 655f  flow_amalgamate_
+00016950: 7469 746c 6520 3d20 4661 6c73 650a 0a20  title = False.. 
+00016960: 2020 2020 2020 2064 6566 205f 5f69 6e69         def __ini
+00016970: 745f 5f28 7365 6c66 2c20 2a61 7267 732c  t__(self, *args,
+00016980: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00016990: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+000169a0: 5f5f 696e 6974 5f5f 282a 2a6b 7761 7267  __init__(**kwarg
+000169b0: 7329 0a0a 2020 2020 2020 2020 6465 6620  s)..        def 
+000169c0: 6e6f 7469 6679 2873 656c 662c 202a 6172  notify(self, *ar
+000169d0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+000169e0: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
+000169f0: 7465 6e64 2065 7665 7279 7468 696e 6720  tend everything 
+00016a00: 6973 206f 6b61 790a 2020 2020 2020 2020  is okay.        
+00016a10: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+00016a20: 0a20 2020 2023 204c 6f61 6420 6f75 7220  .    # Load our 
+00016a30: 6f62 6a65 6374 0a20 2020 206f 626a 203d  object.    obj =
+00016a40: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+00016a50: 6e28 6f76 6572 666c 6f77 3d4f 7665 7266  n(overflow=Overf
+00016a60: 6c6f 774d 6f64 652e 5350 4c49 5429 0a20  lowMode.SPLIT). 
+00016a70: 2020 2061 7373 6572 7420 6f62 6a20 6973     assert obj is
+00016a80: 206e 6f74 204e 6f6e 650a 0a20 2020 2023   not None..    #
+00016a90: 2056 6572 6966 7920 7468 6174 2077 6520   Verify that we 
+00016aa0: 6272 6561 6b20 7468 6520 7469 746c 6520  break the title 
+00016ab0: 746f 2061 206d 6178 206c 656e 6774 6820  to a max length 
+00016ac0: 6f66 206f 7572 2074 6974 6c65 5f6d 6178  of our title_max
+00016ad0: 0a20 2020 2023 2061 6e64 2074 6861 7420  .    # and that 
+00016ae0: 7468 6520 626f 6479 2072 656d 6169 6e73  the body remains
+00016af0: 2075 6e74 6f75 6368 6564 0a20 2020 2063   untouched.    c
+00016b00: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00016b10: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00016b20: 3d22 222c 2074 6974 6c65 3d74 6974 6c65  ="", title=title
+00016b30: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00016b40: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00016b50: 6f77 2862 6f64 793d 2222 2c20 7469 746c  ow(body="", titl
+00016b60: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+00016b70: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+00016b80: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+00016b90: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
+00016ba0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00016bb0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00016bc0: 793d 626f 6479 2c20 7469 746c 653d 7469  y=body, title=ti
+00016bd0: 746c 6529 0a20 2020 206f 6666 7365 7420  tle).    offset 
+00016be0: 3d20 300a 2020 2020 6173 7365 7274 206c  = 0.    assert l
+00016bf0: 656e 2863 6875 6e6b 7329 203d 3d20 340a  en(chunks) == 4.
+00016c00: 2020 2020 666f 7220 6964 782c 2063 6875      for idx, chu
+00016c10: 6e6b 2069 6e20 656e 756d 6572 6174 6528  nk in enumerate(
+00016c20: 6368 756e 6b73 2c20 7374 6172 743d 3129  chunks, start=1)
+00016c30: 3a0a 2020 2020 2020 2020 2320 5665 7269  :.        # Veri
+00016c40: 6669 6361 7469 6f6e 0a20 2020 2020 2020  fication.       
+00016c50: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+00016c60: 6b2e 6765 7428 2774 6974 6c65 2729 2920  k.get('title')) 
+00016c70: 3c3d 206f 626a 2e74 6974 6c65 5f6d 6178  <= obj.title_max
+00016c80: 6c65 6e0a 2020 2020 2020 2020 6173 7365  len.        asse
+00016c90: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+00016ca0: 2827 626f 6479 2729 2920 3c3d 206f 626a  ('body')) <= obj
+00016cb0: 2e62 6f64 795f 6d61 786c 656e 0a0a 2020  .body_maxlen..  
+00016cc0: 2020 2020 2020 2320 4f75 7220 7469 746c        # Our titl
+00016cd0: 6520 6973 2074 7275 6e63 6174 6564 2061  e is truncated a
+00016ce0: 6e64 206e 6f20 636f 756e 7465 7220 6164  nd no counter ad
+00016cf0: 6465 640a 2020 2020 2020 2020 6173 7365  ded.        asse
+00016d00: 7274 2074 6974 6c65 5b3a 6f62 6a2e 7469  rt title[:obj.ti
+00016d10: 746c 655f 6d61 786c 656e 5d20 3d3d 2063  tle_maxlen] == c
+00016d20: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+00016d30: 290a 0a20 2020 2020 2020 2023 204f 7572  )..        # Our
+00016d40: 2062 6f64 7920 6973 206f 6e6c 7920 6272   body is only br
+00016d50: 6f6b 656e 2075 703b 206e 6f74 206c 6f73  oken up; not los
+00016d60: 740a 2020 2020 2020 2020 5f62 6f64 7920  t.        _body 
+00016d70: 3d20 6368 756e 6b2e 6765 7428 2762 6f64  = chunk.get('bod
+00016d80: 7927 290a 2020 2020 2020 2020 6173 7365  y').        asse
+00016d90: 7274 2062 6f64 795b 6f66 6673 6574 3a20  rt body[offset: 
+00016da0: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
+00016db0: 7365 745d 5c0a 2020 2020 2020 2020 2020  set]\.          
+00016dc0: 2020 2e6c 7374 7269 7028 275c 725c 6e5c    .lstrip('\r\n\
+00016dd0: 7830 625c 7830 6327 292e 7273 7472 6970  x0b\x0c').rstrip
+00016de0: 2829 203d 3d20 5f62 6f64 790a 2020 2020  () == _body.    
+00016df0: 2020 2020 6f66 6673 6574 202b 3d20 6c65      offset += le
+00016e00: 6e28 5f62 6f64 7929 0a0a 2020 2020 230a  n(_body)..    #.
+00016e10: 2020 2020 2320 5363 656e 6172 696f 2077      # Scenario w
+00016e20: 6865 7265 2074 6865 2074 6974 6c65 206c  here the title l
+00016e30: 656e 6774 6820 6973 206c 6172 6765 7220  ength is larger 
+00016e40: 7468 616e 2074 6865 2062 6f64 790a 2020  than the body.  
+00016e50: 2020 230a 0a20 2020 2063 6c61 7373 2054    #..    class T
+00016e60: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00016e70: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
+00016e80: 2020 2020 2020 2320 5365 7420 6120 736d        # Set a sm
+00016e90: 616c 6c20 7469 746c 6520 6c65 6e67 7468  all title length
+00016ea0: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
+00016eb0: 6178 6c65 6e20 3d20 3130 300a 0a20 2020  axlen = 100..   
+00016ec0: 2020 2020 2023 2045 6e66 6f72 6365 2061       # Enforce a
+00016ed0: 2062 6f64 7920 6c65 6e67 7468 2e20 4d61   body length. Ma
+00016ee0: 6b65 2073 7572 6520 6974 2773 2061 6e20  ke sure it's an 
+00016ef0: 696e 742e 0a20 2020 2020 2020 2062 6f64  int..        bod
+00016f00: 795f 6d61 786c 656e 203d 2035 300a 0a20  y_maxlen = 50.. 
+00016f10: 2020 2020 2020 2023 204e 6f20 416d 616c         # No Amal
+00016f20: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
+00016f30: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
+00016f40: 6d61 7465 5f74 6974 6c65 203d 2046 616c  mate_title = Fal
+00016f50: 7365 0a0a 2020 2020 2020 2020 6465 6620  se..        def 
+00016f60: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
+00016f70: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00016f80: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
+00016f90: 6572 2829 2e5f 5f69 6e69 745f 5f28 2a2a  er().__init__(**
+00016fa0: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
+00016fb0: 2064 6566 206e 6f74 6966 7928 7365 6c66   def notify(self
+00016fc0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00016fd0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00016fe0: 2320 5072 6574 656e 6420 6576 6572 7974  # Pretend everyt
+00016ff0: 6869 6e67 2069 7320 6f6b 6179 0a20 2020  hing is okay.   
+00017000: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017010: 5472 7565 0a0a 2020 2020 2320 4c6f 6164  True..    # Load
+00017020: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
+00017030: 6f62 6a20 3d20 5465 7374 4e6f 7469 6669  obj = TestNotifi
+00017040: 6361 7469 6f6e 286f 7665 7266 6c6f 773d  cation(overflow=
+00017050: 4f76 6572 666c 6f77 4d6f 6465 2e53 504c  OverflowMode.SPL
+00017060: 4954 290a 2020 2020 6173 7365 7274 206f  IT).    assert o
+00017070: 626a 2069 7320 6e6f 7420 4e6f 6e65 0a0a  bj is not None..
+00017080: 2020 2020 2320 5665 7269 6679 2074 6861      # Verify tha
+00017090: 7420 7765 2062 7265 616b 2074 6865 2074  t we break the t
+000170a0: 6974 6c65 2074 6f20 6120 6d61 7820 6c65  itle to a max le
+000170b0: 6e67 7468 206f 6620 6f75 7220 7469 746c  ngth of our titl
+000170c0: 655f 6d61 780a 2020 2020 2320 616e 6420  e_max.    # and 
+000170d0: 7468 6174 2074 6865 2062 6f64 7920 7265  that the body re
+000170e0: 6d61 696e 7320 756e 746f 7563 6865 640a  mains untouched.
+000170f0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00017100: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00017110: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00017120: 7469 746c 6529 0a20 2020 2063 6875 6e6b  title).    chunk
+00017130: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00017140: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+00017150: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
+00017160: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00017170: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00017180: 3d62 6f64 792c 2074 6974 6c65 3d22 2229  =body, title="")
+00017190: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+000171a0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+000171b0: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+000171c0: 6c65 3d74 6974 6c65 290a 2020 2020 6f66  le=title).    of
+000171d0: 6673 6574 203d 2030 0a20 2020 2061 7373  fset = 0.    ass
+000171e0: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+000171f0: 3d3d 2032 310a 2020 2020 666f 7220 6964  == 21.    for id
+00017200: 782c 2063 6875 6e6b 2069 6e20 656e 756d  x, chunk in enum
+00017210: 6572 6174 6528 6368 756e 6b73 2c20 7374  erate(chunks, st
+00017220: 6172 743d 3129 3a0a 2020 2020 2020 2020  art=1):.        
+00017230: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
+00017240: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00017250: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
+00017260: 6c65 2729 2920 3c3d 206f 626a 2e74 6974  le')) <= obj.tit
+00017270: 6c65 5f6d 6178 6c65 6e0a 2020 2020 2020  le_maxlen.      
+00017280: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+00017290: 6e6b 2e67 6574 2827 626f 6479 2729 2920  nk.get('body')) 
+000172a0: 3c3d 206f 626a 2e62 6f64 795f 6d61 786c  <= obj.body_maxl
+000172b0: 656e 0a0a 2020 2020 2020 2020 2320 4f75  en..        # Ou
+000172c0: 7220 7469 746c 6520 6973 2074 7275 6e63  r title is trunc
+000172d0: 6174 6564 2061 6e64 206e 6f20 636f 756e  ated and no coun
+000172e0: 7465 7220 6164 6465 640a 2020 2020 2020  ter added.      
+000172f0: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
+00017300: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+00017310: 5d20 3d3d 2063 6875 6e6b 2e67 6574 2827  ] == chunk.get('
+00017320: 7469 746c 6527 290a 0a20 2020 2020 2020  title')..       
+00017330: 2023 204f 7572 2062 6f64 7920 6973 206f   # Our body is o
+00017340: 6e6c 7920 6272 6f6b 656e 2075 703b 206e  nly broken up; n
+00017350: 6f74 206c 6f73 740a 2020 2020 2020 2020  ot lost.        
+00017360: 5f62 6f64 7920 3d20 6368 756e 6b2e 6765  _body = chunk.ge
+00017370: 7428 2762 6f64 7927 290a 0a20 2020 2020  t('body')..     
+00017380: 2020 2023 2055 6e2d 7573 6564 2077 6869     # Un-used whi
+00017390: 7465 7370 6163 6520 6973 2061 6c77 6179  tespace is alway
+000173a0: 7320 636c 6561 6e65 6420 7570 3b20 6d61  s cleaned up; ma
+000173b0: 6b65 2073 7572 6520 7765 2061 6363 6f75  ke sure we accou
+000173c0: 6e74 2066 6f72 0a20 2020 2020 2020 2023  nt for.        #
+000173d0: 2074 6869 7320 696e 206f 7572 206e 6577   this in our new
+000173e0: 2063 616c 6375 6c61 7469 6f6e 0a20 2020   calculation.   
+000173f0: 2020 2020 2077 735f 6469 6666 203d 206c       ws_diff = l
+00017400: 656e 2862 6f64 795b 6f66 6673 6574 3a20  en(body[offset: 
+00017410: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
+00017420: 7365 745d 2920 2d20 5c0a 2020 2020 2020  set]) - \.      
+00017430: 2020 2020 2020 6c65 6e28 626f 6479 5b6f        len(body[o
+00017440: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+00017450: 2920 2b20 6f66 6673 6574 5d0a 2020 2020  ) + offset].    
+00017460: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
+00017470: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+00017480: 6327 292e 7273 7472 6970 2829 290a 0a20  c').rstrip()).. 
+00017490: 2020 2020 2020 2061 7373 6572 7420 626f         assert bo
+000174a0: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+000174b0: 626f 6479 2920 2b20 6f66 6673 6574 202b  body) + offset +
+000174c0: 2077 735f 6469 6666 5d5c 0a20 2020 2020   ws_diff]\.     
+000174d0: 2020 2020 2020 202e 6c73 7472 6970 2827         .lstrip('
+000174e0: 5c72 5c6e 5c78 3062 5c78 3063 2729 2e72  \r\n\x0b\x0c').r
+000174f0: 7374 7269 7028 2920 3d3d 205f 626f 6479  strip() == _body
+00017500: 0a20 2020 2020 2020 206f 6666 7365 7420  .        offset 
+00017510: 2b3d 2028 6c65 6e28 5f62 6f64 7929 202b  += (len(_body) +
+00017520: 2077 735f 6469 6666 290a 0a0a 6465 6620   ws_diff)...def 
+00017530: 7465 7374 5f6e 6f74 6966 795f 6f76 6572  test_notify_over
+00017540: 666c 6f77 5f73 706c 6974 5f6e 6f5f 616d  flow_split_no_am
+00017550: 616c 6761 6d61 7469 6f6e 5f66 6f72 6365  algamation_force
+00017560: 5f74 6974 6c65 5f61 6c77 6179 7328 293a  _title_always():
+00017570: 0a20 2020 2022 2222 0a20 2020 2041 5049  .    """.    API
+00017580: 3a20 4f76 6572 666c 6f77 204e 6f20 416d  : Overflow No Am
+00017590: 616c 6761 6d61 7469 6f6e 2028 7469 746c  algamation (titl
+000175a0: 6520 616c 7761 7973 2920 5370 6c69 7420  e always) Split 
+000175b0: 4675 6e63 7469 6f6e 616c 6974 7920 5465  Functionality Te
+000175c0: 7374 696e 670a 0a20 2020 2022 2222 0a0a  sting..    """..
+000175d0: 2020 2020 230a 2020 2020 2320 4120 6c69      #.    # A li
+000175e0: 7474 6c65 2070 7265 7061 7261 7469 6f6e  ttle preparation
+000175f0: 0a20 2020 2023 0a0a 2020 2020 2320 4e75  .    #..    # Nu
+00017600: 6d62 6572 206f 6620 6368 6172 6163 7465  mber of characte
+00017610: 7273 2070 6572 206c 696e 650a 2020 2020  rs per line.    
+00017620: 726f 7720 3d20 3234 0a0a 2020 2020 2320  row = 24..    # 
+00017630: 536f 6d65 2076 6172 6961 626c 6573 2077  Some variables w
+00017640: 6520 7573 6520 746f 2063 6f6e 7472 6f6c  e use to control
+00017650: 2074 6865 2064 6174 6120 7765 2077 6f72   the data we wor
+00017660: 6b20 7769 7468 0a20 2020 2062 6f64 795f  k with.    body_
+00017670: 6c65 6e20 3d20 3130 3234 0a20 2020 2074  len = 1024.    t
+00017680: 6974 6c65 5f6c 656e 203d 2031 3032 340a  itle_len = 1024.
+00017690: 0a20 2020 2023 2043 7265 6174 6520 6120  .    # Create a 
+000176a0: 6c61 7267 6520 626f 6479 2061 6e64 2074  large body and t
+000176b0: 6974 6c65 2077 6974 6820 7261 6e64 6f6d  itle with random
+000176c0: 2064 6174 610a 2020 2020 626f 6479 203d   data.    body =
+000176d0: 2027 272e 6a6f 696e 2863 686f 6963 6528   ''.join(choice(
+000176e0: 7374 725f 616c 7068 6120 2b20 7374 725f  str_alpha + str_
+000176f0: 6e75 6d29 2066 6f72 205f 2069 6e20 7261  num) for _ in ra
+00017700: 6e67 6528 626f 6479 5f6c 656e 2929 0a20  nge(body_len)). 
+00017710: 2020 2062 6f64 7920 3d20 275c 725c 6e27     body = '\r\n'
+00017720: 2e6a 6f69 6e28 5b62 6f64 795b 693a 2069  .join([body[i: i
+00017730: 202b 2072 6f77 5d20 666f 7220 6920 696e   + row] for i in
+00017740: 2072 616e 6765 2830 2c20 6c65 6e28 626f   range(0, len(bo
+00017750: 6479 292c 2072 6f77 295d 290a 0a20 2020  dy), row)])..   
+00017760: 2023 2074 6865 206e 6577 206c 696e 6573   # the new lines
+00017770: 2061 6464 2061 206c 6172 6765 2061 6d6f   add a large amo
+00017780: 756e 7420 746f 206f 7572 2062 6f64 793b  unt to our body;
+00017790: 206c 6574 7320 666f 7263 6520 7468 6520   lets force the 
+000177a0: 636f 6e74 656e 740a 2020 2020 2320 6261  content.    # ba
+000177b0: 636b 2074 6f20 6265 696e 6720 3130 3234  ck to being 1024
+000177c0: 2063 6861 7261 6374 6572 732e 0a20 2020   characters..   
+000177d0: 2062 6f64 7920 3d20 626f 6479 5b30 3a31   body = body[0:1
+000177e0: 3032 345d 0a0a 2020 2020 2320 4372 6561  024]..    # Crea
+000177f0: 7465 206f 7572 2074 6974 6c65 2075 7369  te our title usi
+00017800: 6e67 2072 616e 646f 6d20 6461 7461 0a20  ng random data. 
+00017810: 2020 2074 6974 6c65 203d 2027 272e 6a6f     title = ''.jo
+00017820: 696e 2863 686f 6963 6528 7374 725f 616c  in(choice(str_al
+00017830: 7068 6120 2b20 7374 725f 6e75 6d29 2066  pha + str_num) f
+00017840: 6f72 205f 2069 6e20 7261 6e67 6528 7469  or _ in range(ti
+00017850: 746c 655f 6c65 6e29 290a 0a20 2020 2023  tle_len))..    #
+00017860: 0a20 2020 2023 2046 6972 7374 2054 6573  .    # First Tes
+00017870: 743a 2054 7275 6e63 6174 6564 2054 6974  t: Truncated Tit
+00017880: 6c65 0a20 2020 2023 0a20 2020 2063 6c61  le.    #.    cla
+00017890: 7373 2054 6573 744e 6f74 6966 6963 6174  ss TestNotificat
+000178a0: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+000178b0: 0a0a 2020 2020 2020 2020 2320 5465 7374  ..        # Test
+000178c0: 2074 6974 6c65 206d 6178 206c 656e 6774   title max lengt
+000178d0: 680a 2020 2020 2020 2020 7469 746c 655f  h.        title_
+000178e0: 6d61 786c 656e 203d 2031 300a 0a20 2020  maxlen = 10..   
+000178f0: 2020 2020 2023 204e 6f20 616d 616c 6761       # No amalga
+00017900: 6d61 7469 6f6e 0a20 2020 2020 2020 206f  mation.        o
+00017910: 7665 7266 6c6f 775f 616d 616c 6761 6d61  verflow_amalgama
+00017920: 7465 5f74 6974 6c65 203d 2046 616c 7365  te_title = False
+00017930: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
+00017940: 6520 7469 746c 6520 746f 2062 6520 6469  e title to be di
+00017950: 7370 6c61 7965 6420 616c 7761 7973 0a20  splayed always. 
+00017960: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+00017970: 6469 7370 6c61 795f 7469 746c 655f 6f6e  display_title_on
+00017980: 6365 203d 2046 616c 7365 0a0a 2020 2020  ce = False..    
+00017990: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+000179a0: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+000179b0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+000179c0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+000179d0: 6e69 745f 5f28 2a2a 6b77 6172 6773 290a  nit__(**kwargs).
+000179e0: 0a20 2020 2020 2020 2064 6566 206e 6f74  .        def not
+000179f0: 6966 7928 7365 6c66 2c20 2a61 7267 732c  ify(self, *args,
+00017a00: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00017a10: 2020 2020 2020 2020 2320 5072 6574 656e          # Preten
+00017a20: 6420 6576 6572 7974 6869 6e67 2069 7320  d everything is 
+00017a30: 6f6b 6179 0a20 2020 2020 2020 2020 2020  okay.           
+00017a40: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+00017a50: 2020 2320 4c6f 6164 206f 7572 206f 626a    # Load our obj
+00017a60: 6563 740a 2020 2020 6f62 6a20 3d20 5465  ect.    obj = Te
+00017a70: 7374 4e6f 7469 6669 6361 7469 6f6e 286f  stNotification(o
+00017a80: 7665 7266 6c6f 773d 4f76 6572 666c 6f77  verflow=Overflow
+00017a90: 4d6f 6465 2e53 504c 4954 290a 2020 2020  Mode.SPLIT).    
+00017aa0: 6173 7365 7274 206f 626a 2069 7320 6e6f  assert obj is no
+00017ab0: 7420 4e6f 6e65 0a0a 2020 2020 2320 5665  t None..    # Ve
+00017ac0: 7269 6679 2074 6861 7420 7765 2062 7265  rify that we bre
+00017ad0: 616b 2074 6865 2074 6974 6c65 2074 6f20  ak the title to 
+00017ae0: 6120 6d61 7820 6c65 6e67 7468 206f 6620  a max length of 
+00017af0: 6f75 7220 7469 746c 655f 6d61 780a 2020  our title_max.  
+00017b00: 2020 2320 616e 6420 7468 6174 2074 6865    # and that the
+00017b10: 2062 6f64 7920 7265 6d61 696e 7320 756e   body remains un
+00017b20: 746f 7563 6865 640a 2020 2020 6368 756e  touched.    chun
+00017b30: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00017b40: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
+00017b50: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00017b60: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00017b70: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00017b80: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
+00017b90: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+00017ba0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+00017bb0: 6c6f 7728 626f 6479 3d62 6f64 792c 2074  low(body=body, t
+00017bc0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+00017bd0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00017be0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+00017bf0: 6f64 792c 2074 6974 6c65 3d74 6974 6c65  ody, title=title
+00017c00: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
+00017c10: 2863 6875 6e6b 7329 203d 3d20 310a 2020  (chunks) == 1.  
+00017c20: 2020 6173 7365 7274 2062 6f64 792e 6c73    assert body.ls
+00017c30: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
+00017c40: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
+00017c50: 2063 6875 6e6b 735b 305d 2e67 6574 2827   chunks[0].get('
+00017c60: 626f 6479 2729 0a20 2020 2061 7373 6572  body').    asser
+00017c70: 7420 7469 746c 655b 303a 6f62 6a2e 7469  t title[0:obj.ti
+00017c80: 746c 655f 6d61 786c 656e 5d20 3d3d 2063  tle_maxlen] == c
+00017c90: 6875 6e6b 735b 305d 2e67 6574 2827 7469  hunks[0].get('ti
+00017ca0: 746c 6527 290a 0a20 2020 2023 0a20 2020  tle')..    #.   
+00017cb0: 2023 204e 6578 7420 5465 7374 3a20 4c69   # Next Test: Li
+00017cc0: 6e65 2043 6f75 6e74 2043 6f6e 7472 6f6c  ne Count Control
+00017cd0: 0a20 2020 2023 0a0a 2020 2020 636c 6173  .    #..    clas
+00017ce0: 7320 5465 7374 4e6f 7469 6669 6361 7469  s TestNotificati
+00017cf0: 6f6e 284e 6f74 6966 7942 6173 6529 3a0a  on(NotifyBase):.
+00017d00: 0a20 2020 2020 2020 2023 2054 6573 7420  .        # Test 
+00017d10: 7469 746c 6520 6d61 7820 6c65 6e67 7468  title max length
+00017d20: 0a20 2020 2020 2020 2074 6974 6c65 5f6d  .        title_m
+00017d30: 6178 6c65 6e20 3d20 350a 0a20 2020 2020  axlen = 5..     
+00017d40: 2020 2023 204d 6178 696d 756d 206e 756d     # Maximum num
+00017d50: 6265 7220 6f66 206c 696e 6573 0a20 2020  ber of lines.   
+00017d60: 2020 2020 2062 6f64 795f 6d61 785f 6c69       body_max_li
+00017d70: 6e65 5f63 6f75 6e74 203d 2035 0a0a 2020  ne_count = 5..  
+00017d80: 2020 2020 2020 2320 4e6f 2061 6d61 6c67        # No amalg
+00017d90: 616d 6174 696f 6e0a 2020 2020 2020 2020  amation.        
+00017da0: 6f76 6572 666c 6f77 5f61 6d61 6c67 616d  overflow_amalgam
+00017db0: 6174 655f 7469 746c 6520 3d20 4661 6c73  ate_title = Fals
+00017dc0: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
+00017dd0: 6365 2074 6974 6c65 2074 6f20 6265 2064  ce title to be d
+00017de0: 6973 706c 6179 6564 2061 6c77 6179 730a  isplayed always.
+00017df0: 2020 2020 2020 2020 6f76 6572 666c 6f77          overflow
+00017e00: 5f64 6973 706c 6179 5f74 6974 6c65 5f6f  _display_title_o
+00017e10: 6e63 6520 3d20 4661 6c73 650a 0a20 2020  nce = False..   
+00017e20: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
+00017e30: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
+00017e40: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00017e50: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+00017e60: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
+00017e70: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
+00017e80: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
+00017e90: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00017ea0: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
+00017eb0: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
+00017ec0: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
+00017ed0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00017ee0: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
+00017ef0: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
+00017f00: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00017f10: 6f76 6572 666c 6f77 3d4f 7665 7266 6c6f  overflow=Overflo
+00017f20: 774d 6f64 652e 5350 4c49 5429 0a20 2020  wMode.SPLIT).   
+00017f30: 2061 7373 6572 7420 6f62 6a20 6973 206e   assert obj is n
+00017f40: 6f74 204e 6f6e 650a 0a20 2020 2023 2056  ot None..    # V
+00017f50: 6572 6966 7920 7468 6174 2077 6520 6272  erify that we br
+00017f60: 6561 6b20 7468 6520 7469 746c 6520 746f  eak the title to
+00017f70: 2061 206d 6178 206c 656e 6774 6820 6f66   a max length of
+00017f80: 206f 7572 2074 6974 6c65 5f6d 6178 0a20   our title_max. 
+00017f90: 2020 2023 2061 6e64 2074 6861 7420 7468     # and that th
+00017fa0: 6520 626f 6479 2072 656d 6169 6e73 2075  e body remains u
+00017fb0: 6e74 6f75 6368 6564 0a20 2020 2063 6875  ntouched.    chu
+00017fc0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00017fd0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+00017fe0: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+00017ff0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+00018000: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+00018010: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+00018020: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+00018030: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00018040: 666c 6f77 2862 6f64 793d 626f 6479 2c20  flow(body=body, 
+00018050: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+00018060: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00018070: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00018080: 626f 6479 2c20 7469 746c 653d 7469 746c  body, title=titl
+00018090: 6529 0a20 2020 2061 7373 6572 7420 6c65  e).    assert le
+000180a0: 6e28 6368 756e 6b73 2920 3d3d 2031 0a20  n(chunks) == 1. 
+000180b0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+000180c0: 756e 6b73 5b30 5d2e 6765 7428 2762 6f64  unks[0].get('bod
+000180d0: 7927 292e 7370 6c69 7428 275c 6e27 2929  y').split('\n'))
+000180e0: 203d 3d20 6f62 6a2e 626f 6479 5f6d 6178   == obj.body_max
+000180f0: 5f6c 696e 655f 636f 756e 740a 2020 2020  _line_count.    
+00018100: 6173 7365 7274 2074 6974 6c65 5b30 3a6f  assert title[0:o
+00018110: 626a 2e74 6974 6c65 5f6d 6178 6c65 6e5d  bj.title_maxlen]
+00018120: 203d 3d20 6368 756e 6b73 5b30 5d2e 6765   == chunks[0].ge
+00018130: 7428 2774 6974 6c65 2729 0a0a 2020 2020  t('title')..    
+00018140: 230a 2020 2020 2320 4e65 7874 2054 6573  #.    # Next Tes
+00018150: 743a 2053 706c 6974 2062 6f64 790a 2020  t: Split body.  
+00018160: 2020 230a 0a20 2020 2063 6c61 7373 2054    #..    class T
+00018170: 6573 744e 6f74 6966 6963 6174 696f 6e28  estNotification(
+00018180: 4e6f 7469 6679 4261 7365 293a 0a0a 2020  NotifyBase):..  
+00018190: 2020 2020 2020 2320 5465 7374 2074 6974        # Test tit
+000181a0: 6c65 206d 6178 206c 656e 6774 680a 2020  le max length.  
+000181b0: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
+000181c0: 656e 203d 2074 6974 6c65 5f6c 656e 0a0a  en = title_len..
+000181d0: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
+000181e0: 6520 6120 626f 6479 206c 656e 6774 682e  e a body length.
+000181f0: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
+00018200: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
+00018210: 626f 6479 5f6d 6178 6c65 6e20 3d20 696e  body_maxlen = in
+00018220: 7428 626f 6479 5f6c 656e 202f 2034 290a  t(body_len / 4).
+00018230: 0a20 2020 2020 2020 2023 204e 6f20 616d  .        # No am
+00018240: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
+00018250: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
+00018260: 6761 6d61 7465 5f74 6974 6c65 203d 2046  gamate_title = F
+00018270: 616c 7365 0a0a 2020 2020 2020 2020 2320  alse..        # 
+00018280: 466f 7263 6520 7469 746c 6520 746f 2062  Force title to b
+00018290: 6520 6469 7370 6c61 7965 6420 616c 7761  e displayed alwa
+000182a0: 7973 0a20 2020 2020 2020 206f 7665 7266  ys.        overf
+000182b0: 6c6f 775f 6469 7370 6c61 795f 7469 746c  low_display_titl
+000182c0: 655f 6f6e 6365 203d 2046 616c 7365 0a0a  e_once = False..
+000182d0: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
+000182e0: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
+000182f0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00018300: 2020 2020 2020 2020 2073 7570 6572 2829           super()
+00018310: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
+00018320: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
+00018330: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
+00018340: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00018350: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
+00018360: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
+00018370: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
+00018380: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00018390: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
+000183a0: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
+000183b0: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
+000183c0: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
+000183d0: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
+000183e0: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
+000183f0: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
+00018400: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
+00018410: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
+00018420: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
+00018430: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
+00018440: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
+00018450: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
+00018460: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
+00018470: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00018480: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00018490: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
+000184a0: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
+000184b0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+000184c0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
+000184d0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+000184e0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+000184f0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+00018500: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
+00018510: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+00018520: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+00018530: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
+00018540: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
+00018550: 203d 2030 0a20 2020 2063 5f6c 656e 203d   = 0.    c_len =
+00018560: 206c 656e 2827 205b 582f 585d 2729 0a20   len(' [X/X]'). 
+00018570: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00018580: 756e 6b73 2920 3d3d 2034 0a20 2020 2066  unks) == 4.    f
+00018590: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
+000185a0: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+000185b0: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
+000185c0: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
+000185d0: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
+000185e0: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+000185f0: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
+00018600: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+00018610: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00018620: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
+00018630: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
+00018640: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
+00018650: 2023 204f 7572 2074 6974 6c65 2068 6173   # Our title has
+00018660: 2061 2063 6f75 6e74 6572 2061 6464 6564   a counter added
+00018670: 2074 6f20 6974 0a20 2020 2020 2020 2061   to it.        a
+00018680: 7373 6572 7420 7469 746c 655b 3a2d 635f  ssert title[:-c_
+00018690: 6c65 6e5d 203d 3d20 6368 756e 6b2e 6765  len] == chunk.ge
+000186a0: 7428 2774 6974 6c65 2729 5b3a 2d63 5f6c  t('title')[:-c_l
+000186b0: 656e 5d0a 2020 2020 2020 2020 6173 7365  en].        asse
+000186c0: 7274 2063 6875 6e6b 2e67 6574 2827 7469  rt chunk.get('ti
+000186d0: 746c 6527 295b 2d63 5f6c 656e 3a5d 203d  tle')[-c_len:] =
+000186e0: 3d20 5c0a 2020 2020 2020 2020 2020 2020  = \.            
+000186f0: 2720 5b7b 3a30 317d 2f7b 3a30 317d 5d27  ' [{:01}/{:01}]'
+00018700: 2e66 6f72 6d61 7428 6964 782c 206c 656e  .format(idx, len
+00018710: 2863 6875 6e6b 7329 290a 2020 2020 2020  (chunks)).      
+00018720: 2020 2320 4f75 7220 626f 6479 2069 7320    # Our body is 
+00018730: 6f6e 6c79 2062 726f 6b65 6e20 7570 3b20  only broken up; 
+00018740: 6e6f 7420 6c6f 7374 0a20 2020 2020 2020  not lost.       
+00018750: 205f 626f 6479 203d 2063 6875 6e6b 2e67   _body = chunk.g
+00018760: 6574 2827 626f 6479 2729 0a20 2020 2020  et('body').     
+00018770: 2020 2061 7373 6572 7420 626f 6479 5b6f     assert body[o
+00018780: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+00018790: 2920 2b20 6f66 6673 6574 5d5c 0a20 2020  ) + offset]\.   
+000187a0: 2020 2020 2020 2020 202e 6c73 7472 6970           .lstrip
+000187b0: 2827 5c72 5c6e 5c78 3062 5c78 3063 2729  ('\r\n\x0b\x0c')
+000187c0: 2e72 7374 7269 7028 2920 3d3d 205f 626f  .rstrip() == _bo
+000187d0: 6479 0a20 2020 2020 2020 206f 6666 7365  dy.        offse
+000187e0: 7420 2b3d 206c 656e 285f 626f 6479 290a  t += len(_body).
+000187f0: 0a20 2020 2023 2041 6e6f 7468 6572 2065  .    # Another e
+00018800: 6467 6520 6361 7365 2077 6865 7265 2074  dge case where t
+00018810: 6865 2074 6974 6c65 206a 7573 7420 6973  he title just is
+00018820: 6e27 7420 7468 6174 206c 6f6e 6720 6c65  n't that long le
+00018830: 6176 696e 670a 2020 2020 2320 6120 6c6f  aving.    # a lo
+00018840: 7420 6f66 2073 7061 6365 2066 6f72 2074  t of space for t
+00018850: 6865 205b 7878 2f78 785d 2065 6e74 7269  he [xx/xx] entri
+00018860: 6573 2028 6e6f 2074 7275 6e63 6174 696f  es (no truncatio
+00018870: 6e20 6e65 6564 6564 290a 2020 2020 6368  n needed).    ch
+00018880: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00018890: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+000188a0: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
+000188b0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+000188c0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+000188d0: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
+000188e0: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+000188f0: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00018900: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+00018910: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
+00018920: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00018930: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00018940: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
+00018950: 6c65 5b3a 3230 5d29 0a20 2020 206f 6666  le[:20]).    off
+00018960: 7365 7420 3d20 300a 2020 2020 6173 7365  set = 0.    asse
+00018970: 7274 206c 656e 2863 6875 6e6b 7329 203d  rt len(chunks) =
+00018980: 3d20 340a 2020 2020 666f 7220 6964 782c  = 4.    for idx,
+00018990: 2063 6875 6e6b 2069 6e20 656e 756d 6572   chunk in enumer
+000189a0: 6174 6528 6368 756e 6b73 2c20 7374 6172  ate(chunks, star
+000189b0: 743d 3129 3a0a 2020 2020 2020 2020 2320  t=1):.        # 
+000189c0: 5665 7269 6669 6361 7469 6f6e 0a20 2020  Verification.   
+000189d0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000189e0: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+000189f0: 2729 2920 3c3d 206f 626a 2e74 6974 6c65  ')) <= obj.title
+00018a00: 5f6d 6178 6c65 6e0a 2020 2020 2020 2020  _maxlen.        
+00018a10: 6173 7365 7274 206c 656e 2863 6875 6e6b  assert len(chunk
+00018a20: 2e67 6574 2827 626f 6479 2729 2920 3c3d  .get('body')) <=
+00018a30: 206f 626a 2e62 6f64 795f 6d61 786c 656e   obj.body_maxlen
+00018a40: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
+00018a50: 7469 746c 6520 6861 7320 6120 636f 756e  title has a coun
+00018a60: 7465 7220 6164 6465 6420 746f 2069 740a  ter added to it.
+00018a70: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
+00018a80: 6974 6c65 5b3a 3230 5d20 3d3d 2063 6875  itle[:20] == chu
+00018a90: 6e6b 2e67 6574 2827 7469 746c 6527 295b  nk.get('title')[
+00018aa0: 3a2d 635f 6c65 6e5d 0a20 2020 2020 2020  :-c_len].       
+00018ab0: 2061 7373 6572 7420 6368 756e 6b2e 6765   assert chunk.ge
+00018ac0: 7428 2774 6974 6c65 2729 5b2d 635f 6c65  t('title')[-c_le
+00018ad0: 6e3a 5d20 3d3d 205c 0a20 2020 2020 2020  n:] == \.       
+00018ae0: 2020 2020 2027 205b 7b3a 3031 7d2f 7b3a       ' [{:01}/{:
+00018af0: 3031 7d5d 272e 666f 726d 6174 2869 6478  01}]'.format(idx
+00018b00: 2c20 6c65 6e28 6368 756e 6b73 2929 0a20  , len(chunks)). 
+00018b10: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
+00018b20: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
+00018b30: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
+00018b40: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
+00018b50: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
+00018b60: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+00018b70: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+00018b80: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+00018b90: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
+00018ba0: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
+00018bb0: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
+00018bc0: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
+00018bd0: 6f66 6673 6574 202b 3d20 6c65 6e28 5f62  offset += len(_b
+00018be0: 6f64 7929 0a0a 2020 2020 2320 5465 7374  ody)..    # Test
+00018bf0: 206c 6172 6765 7220 6d65 7373 6167 6573   larger messages
+00018c00: 0a20 2020 2023 2061 6e64 2074 6861 7420  .    # and that 
+00018c10: 7468 6520 626f 6479 2072 656d 6169 6e73  the body remains
+00018c20: 2075 6e74 6f75 6368 6564 0a20 2020 2063   untouched.    c
+00018c30: 6c61 7373 2054 6573 744e 6f74 6966 6963  lass TestNotific
+00018c40: 6174 696f 6e28 4e6f 7469 6679 4261 7365  ation(NotifyBase
+00018c50: 293a 0a0a 2020 2020 2020 2020 2320 5465  ):..        # Te
+00018c60: 7374 2074 6974 6c65 206d 6178 206c 656e  st title max len
+00018c70: 6774 680a 2020 2020 2020 2020 7469 746c  gth.        titl
+00018c80: 655f 6d61 786c 656e 203d 2031 3530 0a0a  e_maxlen = 150..
+00018c90: 2020 2020 2020 2020 2320 456e 666f 7263          # Enforc
+00018ca0: 6520 6120 626f 6479 206c 656e 6774 682e  e a body length.
+00018cb0: 204d 616b 6520 7375 7265 2069 7427 7320   Make sure it's 
+00018cc0: 616e 2069 6e74 2e0a 2020 2020 2020 2020  an int..        
+00018cd0: 626f 6479 5f6d 6178 6c65 6e20 3d20 3430  body_maxlen = 40
+00018ce0: 300a 0a20 2020 2020 2020 2023 204e 6f20  0..        # No 
+00018cf0: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
+00018d00: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
+00018d10: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
+00018d20: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+00018d30: 2320 466f 7263 6520 7469 746c 6520 746f  # Force title to
+00018d40: 2062 6520 6469 7370 6c61 7965 6420 616c   be displayed al
+00018d50: 7761 7973 0a20 2020 2020 2020 206f 7665  ways.        ove
+00018d60: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
+00018d70: 746c 655f 6f6e 6365 203d 2046 616c 7365  tle_once = False
+00018d80: 0a0a 2020 2020 2020 2020 6465 6620 5f5f  ..        def __
+00018d90: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
+00018da0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+00018db0: 2020 2020 2020 2020 2020 2073 7570 6572             super
+00018dc0: 2829 2e5f 5f69 6e69 745f 5f28 2a2a 6b77  ().__init__(**kw
+00018dd0: 6172 6773 290a 0a20 2020 2020 2020 2064  args)..        d
+00018de0: 6566 206e 6f74 6966 7928 7365 6c66 2c20  ef notify(self, 
+00018df0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00018e00: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00018e10: 5072 6574 656e 6420 6576 6572 7974 6869  Pretend everythi
+00018e20: 6e67 2069 7320 6f6b 6179 0a20 2020 2020  ng is okay.     
+00018e30: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+00018e40: 7565 0a0a 2020 2020 2320 4c6f 6164 206f  ue..    # Load o
+00018e50: 7572 206f 626a 6563 740a 2020 2020 6f62  ur object.    ob
+00018e60: 6a20 3d20 5465 7374 4e6f 7469 6669 6361  j = TestNotifica
+00018e70: 7469 6f6e 286f 7665 7266 6c6f 773d 4f76  tion(overflow=Ov
+00018e80: 6572 666c 6f77 4d6f 6465 2e53 504c 4954  erflowMode.SPLIT
+00018e90: 290a 2020 2020 6173 7365 7274 206f 626a  ).    assert obj
+00018ea0: 2069 7320 6e6f 7420 4e6f 6e65 0a0a 2020   is not None..  
+00018eb0: 2020 6e65 775f 626f 6479 203d 2028 626f    new_body = (bo
+00018ec0: 6479 202a 2035 3030 290a 2020 2020 6368  dy * 500).    ch
+00018ed0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+00018ee0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+00018ef0: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
+00018f00: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+00018f10: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+00018f20: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
+00018f30: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+00018f40: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00018f50: 7266 6c6f 7728 626f 6479 3d6e 6577 5f62  rflow(body=new_b
+00018f60: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+00018f70: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00018f80: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00018f90: 626f 6479 3d6e 6577 5f62 6f64 792c 2074  body=new_body, t
+00018fa0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+00018fb0: 6f66 6673 6574 203d 2030 0a20 2020 2063  offset = 0.    c
+00018fc0: 5f6c 656e 203d 206c 656e 2827 205b 5858  _len = len(' [XX
+00018fd0: 5858 2f58 5858 585d 2729 0a20 2020 2061  XX/XXXX]').    a
+00018fe0: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
+00018ff0: 2920 3d3d 2031 3238 300a 2020 2020 666f  ) == 1280.    fo
+00019000: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+00019010: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+00019020: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+00019030: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+00019040: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+00019050: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+00019060: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+00019070: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+00019080: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00019090: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+000190a0: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+000190b0: 6d61 786c 656e 0a20 2020 2020 2020 2023  maxlen.        #
+000190c0: 204f 7572 2074 6974 6c65 2068 6173 2061   Our title has a
+000190d0: 2063 6f75 6e74 6572 2061 6464 6564 2074   counter added t
+000190e0: 6f20 6974 0a20 2020 2020 2020 2061 7373  o it.        ass
+000190f0: 6572 7420 7469 746c 655b 3a6f 626a 2e74  ert title[:obj.t
+00019100: 6974 6c65 5f6d 6178 6c65 6e5d 5b3a 2d63  itle_maxlen][:-c
+00019110: 5f6c 656e 5d20 3d3d 2063 6875 6e6b 2e67  _len] == chunk.g
+00019120: 6574 2827 7469 746c 6527 295b 3a2d 635f  et('title')[:-c_
+00019130: 6c65 6e5d 0a20 2020 2020 2020 2061 7373  len].        ass
+00019140: 6572 7420 6368 756e 6b2e 6765 7428 2774  ert chunk.get('t
+00019150: 6974 6c65 2729 5b2d 635f 6c65 6e3a 5d20  itle')[-c_len:] 
+00019160: 3d3d 205c 0a20 2020 2020 2020 2020 2020  == \.           
+00019170: 2027 205b 7b3a 3034 7d2f 7b3a 3034 7d5d   ' [{:04}/{:04}]
+00019180: 272e 666f 726d 6174 2869 6478 2c20 6c65  '.format(idx, le
+00019190: 6e28 6368 756e 6b73 2929 0a20 2020 2020  n(chunks)).     
+000191a0: 2020 2023 204f 7572 2062 6f64 7920 6973     # Our body is
+000191b0: 206f 6e6c 7920 6272 6f6b 656e 2075 703b   only broken up;
+000191c0: 206e 6f74 206c 6f73 740a 2020 2020 2020   not lost.      
+000191d0: 2020 5f62 6f64 7920 3d20 6368 756e 6b2e    _body = chunk.
+000191e0: 6765 7428 2762 6f64 7927 290a 0a20 2020  get('body')..   
+000191f0: 2020 2020 2023 2055 6e2d 7573 6564 2077       # Un-used w
+00019200: 6869 7465 7370 6163 6520 6973 2061 6c77  hitespace is alw
+00019210: 6179 7320 636c 6561 6e65 6420 7570 3b20  ays cleaned up; 
+00019220: 6d61 6b65 2073 7572 6520 7765 2061 6363  make sure we acc
+00019230: 6f75 6e74 2066 6f72 0a20 2020 2020 2020  ount for.       
+00019240: 2023 2074 6869 7320 696e 206f 7572 206e   # this in our n
+00019250: 6577 2063 616c 6375 6c61 7469 6f6e 0a20  ew calculation. 
+00019260: 2020 2020 2020 2077 735f 6469 6666 203d         ws_diff =
+00019270: 206c 656e 286e 6577 5f62 6f64 795b 6f66   len(new_body[of
+00019280: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+00019290: 202b 206f 6666 7365 745d 2920 2d20 5c0a   + offset]) - \.
+000192a0: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
+000192b0: 6e65 775f 626f 6479 5b6f 6666 7365 743a  new_body[offset:
+000192c0: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
+000192d0: 6673 6574 5d0a 2020 2020 2020 2020 2020  fset].          
+000192e0: 2020 2020 2020 2e6c 7374 7269 7028 275c        .lstrip('\
+000192f0: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+00019300: 7472 6970 2829 290a 0a20 2020 2020 2020  trip())..       
+00019310: 2061 7373 6572 7420 6e65 775f 626f 6479   assert new_body
+00019320: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+00019330: 6479 2920 2b20 6f66 6673 6574 202b 2077  dy) + offset + w
+00019340: 735f 6469 6666 5d5c 0a20 2020 2020 2020  s_diff]\.       
+00019350: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
+00019360: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
+00019370: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
+00019380: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
+00019390: 2028 6c65 6e28 5f62 6f64 7929 202b 2077   (len(_body) + w
+000193a0: 735f 6469 6666 290a 0a20 2020 2023 2042  s_diff)..    # B
+000193b0: 6f64 7920 6368 756e 6b20 6973 2062 6579  ody chunk is bey
+000193c0: 6f6e 6420 3420 6469 6769 7473 2c20 736f  ond 4 digits, so
+000193d0: 205b 5858 5858 2f58 5858 585d 2069 7320   [XXXX/XXXX] is 
+000193e0: 7475 726e 6564 206f 6666 0a20 2020 206e  turned off.    n
+000193f0: 6577 5f62 6f64 7920 3d20 2862 6f64 7920  ew_body = (body 
+00019400: 2a20 3435 3030 290a 2020 2020 6368 756e  * 4500).    chun
+00019410: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00019420: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
+00019430: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+00019440: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00019450: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00019460: 626f 6479 3d22 222c 2074 6974 6c65 3d22  body="", title="
+00019470: 2229 0a20 2020 2063 6875 6e6b 7320 3d20  ").    chunks = 
+00019480: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+00019490: 6c6f 7728 626f 6479 3d6e 6577 5f62 6f64  low(body=new_bod
+000194a0: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
+000194b0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+000194c0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+000194d0: 6479 3d6e 6577 5f62 6f64 792c 2074 6974  dy=new_body, tit
+000194e0: 6c65 3d74 6974 6c65 290a 2020 2020 6f66  le=title).    of
+000194f0: 6673 6574 203d 2030 0a20 2020 2061 7373  fset = 0.    ass
+00019500: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+00019510: 3d3d 2031 3135 3230 0a20 2020 2066 6f72  == 11520.    for
+00019520: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+00019530: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+00019540: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+00019550: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+00019560: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+00019570: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+00019580: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+00019590: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+000195a0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+000195b0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+000195c0: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+000195d0: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+000195e0: 204f 7572 2074 6974 6c65 2068 6173 206e   Our title has n
+000195f0: 6f20 636f 756e 7465 7220 6164 6465 6420  o counter added 
+00019600: 746f 2069 740a 2020 2020 2020 2020 6173  to it.        as
+00019610: 7365 7274 2074 6974 6c65 5b3a 6f62 6a2e  sert title[:obj.
+00019620: 7469 746c 655f 6d61 786c 656e 5d20 3d3d  title_maxlen] ==
+00019630: 2063 6875 6e6b 2e67 6574 2827 7469 746c   chunk.get('titl
+00019640: 6527 290a 2020 2020 2020 2020 2320 4f75  e').        # Ou
+00019650: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
+00019660: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
+00019670: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
+00019680: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
+00019690: 6479 2729 0a0a 2020 2020 2020 2020 2320  dy')..        # 
+000196a0: 556e 2d75 7365 6420 7768 6974 6573 7061  Un-used whitespa
+000196b0: 6365 2069 7320 616c 7761 7973 2063 6c65  ce is always cle
+000196c0: 616e 6564 2075 703b 206d 616b 6520 7375  aned up; make su
+000196d0: 7265 2077 6520 6163 636f 756e 7420 666f  re we account fo
+000196e0: 720a 2020 2020 2020 2020 2320 7468 6973  r.        # this
+000196f0: 2069 6e20 6f75 7220 6e65 7720 6361 6c63   in our new calc
+00019700: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
+00019710: 7773 5f64 6966 6620 3d20 6c65 6e28 6e65  ws_diff = len(ne
+00019720: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
+00019730: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+00019740: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
+00019750: 2020 2020 206c 656e 286e 6577 5f62 6f64       len(new_bod
+00019760: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
+00019770: 6f64 7929 202b 206f 6666 7365 745d 0a20  ody) + offset]. 
+00019780: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+00019790: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
+000197a0: 5c78 3063 2729 2e72 7374 7269 7028 2929  \x0c').rstrip())
+000197b0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+000197c0: 206e 6577 5f62 6f64 795b 6f66 6673 6574   new_body[offset
+000197d0: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+000197e0: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
+000197f0: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
+00019800: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
+00019810: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
+00019820: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
+00019830: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
+00019840: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
+00019850: 0a0a 2020 2020 2320 5465 7374 206c 6172  ..    # Test lar
+00019860: 6765 7220 6d65 7373 6167 6573 0a20 2020  ger messages.   
+00019870: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
+00019880: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
+00019890: 6f75 6368 6564 0a20 2020 2063 6c61 7373  ouched.    class
+000198a0: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+000198b0: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
+000198c0: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
+000198d0: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
+000198e0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
+000198f0: 786c 656e 203d 2031 3530 0a0a 2020 2020  xlen = 150..    
+00019900: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
+00019910: 626f 6479 206c 656e 6774 682e 204d 616b  body length. Mak
+00019920: 6520 7375 7265 2069 7427 7320 616e 2069  e sure it's an i
+00019930: 6e74 2e0a 2020 2020 2020 2020 626f 6479  nt..        body
+00019940: 5f6d 6178 6c65 6e20 3d20 3135 300a 0a20  _maxlen = 150.. 
+00019950: 2020 2020 2020 2023 204e 6f20 616d 616c         # No amal
+00019960: 6761 6d61 7469 6f6e 0a20 2020 2020 2020  gamation.       
+00019970: 206f 7665 7266 6c6f 775f 616d 616c 6761   overflow_amalga
+00019980: 6d61 7465 5f74 6974 6c65 203d 2046 616c  mate_title = Fal
+00019990: 7365 0a0a 2020 2020 2020 2020 2320 466f  se..        # Fo
+000199a0: 7263 6520 7469 746c 6520 746f 2062 6520  rce title to be 
+000199b0: 6469 7370 6c61 7965 6420 616c 7761 7973  displayed always
+000199c0: 0a20 2020 2020 2020 206f 7665 7266 6c6f  .        overflo
+000199d0: 775f 6469 7370 6c61 795f 7469 746c 655f  w_display_title_
+000199e0: 6f6e 6365 203d 2046 616c 7365 0a0a 2020  once = False..  
+000199f0: 2020 2020 2020 6465 6620 5f5f 696e 6974        def __init
+00019a00: 5f5f 2873 656c 662c 202a 6172 6773 2c20  __(self, *args, 
+00019a10: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00019a20: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+00019a30: 5f69 6e69 745f 5f28 2a2a 6b77 6172 6773  _init__(**kwargs
+00019a40: 290a 0a20 2020 2020 2020 2064 6566 206e  )..        def n
+00019a50: 6f74 6966 7928 7365 6c66 2c20 2a61 7267  otify(self, *arg
+00019a60: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+00019a70: 2020 2020 2020 2020 2020 2320 5072 6574            # Pret
+00019a80: 656e 6420 6576 6572 7974 6869 6e67 2069  end everything i
+00019a90: 7320 6f6b 6179 0a20 2020 2020 2020 2020  s okay.         
+00019aa0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+00019ab0: 2020 2020 2320 4c6f 6164 206f 7572 206f      # Load our o
+00019ac0: 626a 6563 740a 2020 2020 6f62 6a20 3d20  bject.    obj = 
+00019ad0: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+00019ae0: 286f 7665 7266 6c6f 773d 4f76 6572 666c  (overflow=Overfl
+00019af0: 6f77 4d6f 6465 2e53 504c 4954 290a 2020  owMode.SPLIT).  
+00019b00: 2020 6173 7365 7274 206f 626a 2069 7320    assert obj is 
+00019b10: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 6e65  not None..    ne
+00019b20: 775f 626f 6479 203d 2028 626f 6479 202a  w_body = (body *
+00019b30: 2035 290a 2020 2020 6368 756e 6b73 203d   5).    chunks =
+00019b40: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+00019b50: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+00019b60: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+00019b70: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+00019b80: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+00019b90: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+00019ba0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00019bb0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00019bc0: 626f 6479 3d6e 6577 5f62 6f64 792c 2074  body=new_body, t
+00019bd0: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+00019be0: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00019bf0: 5f6f 7665 7266 6c6f 7728 626f 6479 3d6e  _overflow(body=n
+00019c00: 6577 5f62 6f64 792c 2074 6974 6c65 3d74  ew_body, title=t
+00019c10: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
+00019c20: 203d 2030 0a20 2020 2061 7373 6572 7420   = 0.    assert 
+00019c30: 6c65 6e28 6368 756e 6b73 2920 3d3d 2033  len(chunks) == 3
+00019c40: 350a 2020 2020 635f 6c65 6e20 3d20 6c65  5.    c_len = le
+00019c50: 6e28 2720 5b58 582f 5858 5d27 290a 2020  n(' [XX/XX]').  
+00019c60: 2020 666f 7220 6964 782c 2063 6875 6e6b    for idx, chunk
+00019c70: 2069 6e20 656e 756d 6572 6174 6528 6368   in enumerate(ch
+00019c80: 756e 6b73 2c20 7374 6172 743d 3129 3a0a  unks, start=1):.
+00019c90: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
+00019ca0: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
+00019cb0: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
+00019cc0: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
+00019cd0: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
+00019ce0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+00019cf0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+00019d00: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
+00019d10: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
+00019d20: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
+00019d30: 6861 7320 6120 636f 756e 7465 7220 6164  has a counter ad
+00019d40: 6465 6420 746f 2069 740a 2020 2020 2020  ded to it.      
+00019d50: 2020 6173 7365 7274 2074 6974 6c65 5b3a    assert title[:
+00019d60: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+00019d70: 5d5b 3a2d 635f 6c65 6e5d 203d 3d20 6368  ][:-c_len] == ch
+00019d80: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
+00019d90: 5b3a 2d63 5f6c 656e 5d0a 2020 2020 2020  [:-c_len].      
+00019da0: 2020 6173 7365 7274 2063 6875 6e6b 2e67    assert chunk.g
+00019db0: 6574 2827 7469 746c 6527 295b 2d63 5f6c  et('title')[-c_l
+00019dc0: 656e 3a5d 203d 3d20 5c0a 2020 2020 2020  en:] == \.      
+00019dd0: 2020 2020 2020 2720 5b7b 3a30 327d 2f7b        ' [{:02}/{
+00019de0: 3a30 327d 5d27 2e66 6f72 6d61 7428 6964  :02}]'.format(id
+00019df0: 782c 206c 656e 2863 6875 6e6b 7329 290a  x, len(chunks)).
+00019e00: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
+00019e10: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
+00019e20: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
+00019e30: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
+00019e40: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
+00019e50: 0a0a 2020 2020 2020 2020 2320 556e 2d75  ..        # Un-u
+00019e60: 7365 6420 7768 6974 6573 7061 6365 2069  sed whitespace i
+00019e70: 7320 616c 7761 7973 2063 6c65 616e 6564  s always cleaned
+00019e80: 2075 703b 206d 616b 6520 7375 7265 2077   up; make sure w
+00019e90: 6520 6163 636f 756e 7420 666f 720a 2020  e account for.  
+00019ea0: 2020 2020 2020 2320 7468 6973 2069 6e20        # this in 
+00019eb0: 6f75 7220 6e65 7720 6361 6c63 756c 6174  our new calculat
+00019ec0: 696f 6e0a 2020 2020 2020 2020 7773 5f64  ion.        ws_d
+00019ed0: 6966 6620 3d20 6c65 6e28 6e65 775f 626f  iff = len(new_bo
+00019ee0: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+00019ef0: 626f 6479 2920 2b20 6f66 6673 6574 5d29  body) + offset])
+00019f00: 202d 205c 0a20 2020 2020 2020 2020 2020   - \.           
+00019f10: 206c 656e 286e 6577 5f62 6f64 795b 6f66   len(new_body[of
+00019f20: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+00019f30: 202b 206f 6666 7365 745d 0a20 2020 2020   + offset].     
+00019f40: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+00019f50: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+00019f60: 2729 2e72 7374 7269 7028 2929 0a0a 2020  ').rstrip())..  
+00019f70: 2020 2020 2020 6173 7365 7274 206e 6577        assert new
+00019f80: 5f62 6f64 795b 6f66 6673 6574 3a20 6c65  _body[offset: le
+00019f90: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
+00019fa0: 7420 2b20 7773 5f64 6966 665d 5c0a 2020  t + ws_diff]\.  
+00019fb0: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
+00019fc0: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
+00019fd0: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
+00019fe0: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
+00019ff0: 6574 202b 3d20 286c 656e 285f 626f 6479  et += (len(_body
+0001a000: 2920 2b20 7773 5f64 6966 6629 0a0a 2020  ) + ws_diff)..  
+0001a010: 2020 230a 2020 2020 2320 4e65 7874 2054    #.    # Next T
+0001a020: 6573 743a 2041 7070 656e 6420 7469 746c  est: Append titl
+0001a030: 6520 746f 2062 6f64 7920 2b20 7370 6c69  e to body + spli
+0001a040: 7420 626f 6479 0a20 2020 2023 0a0a 2020  t body.    #..  
+0001a050: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
+0001a060: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
+0001a070: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
+0001a080: 2045 6e66 6f72 6365 206e 6f20 7469 746c   Enforce no titl
+0001a090: 650a 2020 2020 2020 2020 7469 746c 655f  e.        title_
+0001a0a0: 6d61 786c 656e 203d 2030 0a0a 2020 2020  maxlen = 0..    
+0001a0b0: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
+0001a0c0: 626f 6479 206c 656e 6774 6820 6261 7365  body length base
+0001a0d0: 6420 6f6e 2074 6865 2074 6974 6c65 2e20  d on the title. 
+0001a0e0: 4d61 6b65 2073 7572 6520 6974 2773 2061  Make sure it's a
+0001a0f0: 6e20 696e 742e 0a20 2020 2020 2020 2062  n int..        b
+0001a100: 6f64 795f 6d61 786c 656e 203d 2069 6e74  ody_maxlen = int
+0001a110: 2874 6974 6c65 5f6c 656e 202f 2034 290a  (title_len / 4).
+0001a120: 0a20 2020 2020 2020 2023 204e 6f20 416d  .        # No Am
+0001a130: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
+0001a140: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
+0001a150: 6761 6d61 7465 5f74 6974 6c65 203d 2046  gamate_title = F
+0001a160: 616c 7365 0a0a 2020 2020 2020 2020 2320  alse..        # 
+0001a170: 466f 7263 6520 7469 746c 6520 746f 2062  Force title to b
+0001a180: 6520 6469 7370 6c61 7965 6420 616c 7761  e displayed alwa
+0001a190: 7973 0a20 2020 2020 2020 206f 7665 7266  ys.        overf
+0001a1a0: 6c6f 775f 6469 7370 6c61 795f 7469 746c  low_display_titl
+0001a1b0: 655f 6f6e 6365 203d 2046 616c 7365 0a0a  e_once = False..
+0001a1c0: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
+0001a1d0: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
+0001a1e0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+0001a1f0: 2020 2020 2020 2020 2073 7570 6572 2829           super()
+0001a200: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
+0001a210: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
+0001a220: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
+0001a230: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+0001a240: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
+0001a250: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
+0001a260: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
+0001a270: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+0001a280: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
+0001a290: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
+0001a2a0: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
+0001a2b0: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
+0001a2c0: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
+0001a2d0: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
+0001a2e0: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
+0001a2f0: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
+0001a300: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
+0001a310: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
+0001a320: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
+0001a330: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
+0001a340: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
+0001a350: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
+0001a360: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0001a370: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0001a380: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
+0001a390: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
+0001a3a0: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+0001a3b0: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
+0001a3c0: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+0001a3d0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+0001a3e0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+0001a3f0: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
+0001a400: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+0001a410: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+0001a420: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
+0001a430: 6974 6c65 290a 0a20 2020 2023 204f 7572  itle)..    # Our
+0001a440: 2066 696e 616c 2070 726f 6475 6374 2069   final product i
+0001a450: 7320 7468 6174 206f 7572 2074 6974 6c65  s that our title
+0001a460: 2068 6173 2062 6565 6e20 6170 7065 6e64   has been append
+0001a470: 6564 2074 6f20 6f75 7220 626f 6479 2074  ed to our body t
+0001a480: 6f0a 2020 2020 2320 6372 6561 7465 206f  o.    # create o
+0001a490: 6e65 2067 7265 6174 2062 6967 2062 6f64  ne great big bod
+0001a4a0: 792e 2041 7320 6120 7265 7375 6c74 2077  y. As a result w
+0001a4b0: 6527 6c6c 2067 6574 2071 7569 7465 2061  e'll get quite a
+0001a4c0: 2066 6577 206c 696e 6573 2062 6163 6b0a   few lines back.
+0001a4d0: 2020 2020 2320 6e6f 772e 0a20 2020 206f      # now..    o
+0001a4e0: 6666 7365 7420 3d20 300a 0a20 2020 2023  ffset = 0..    #
+0001a4f0: 204f 7572 2062 6f64 7920 7769 6c6c 206c   Our body will l
+0001a500: 6f6f 6b20 6c69 6b65 2074 6869 7320 696e  ook like this in
+0001a510: 2073 6d61 6c6c 2063 6875 6e6b 7320 6174   small chunks at
+0001a520: 2074 6865 2065 6e64 206f 6620 7468 6520   the end of the 
+0001a530: 6461 790a 2020 2020 6275 6c6b 203d 2074  day.    bulk = t
+0001a540: 6974 6c65 202b 2027 5c72 5c6e 2720 2b20  itle + '\r\n' + 
+0001a550: 626f 6479 0a0a 2020 2020 2320 4475 6520  body..    # Due 
+0001a560: 746f 2074 6865 206e 6577 206c 696e 6520  to the new line 
+0001a570: 6164 6465 6420 746f 2074 6865 2065 6e64  added to the end
+0001a580: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+0001a590: 6368 756e 6b73 2920 3d3d 2028 0a20 2020  chunks) == (.   
+0001a5a0: 2020 2020 2023 2077 7261 7020 6469 7669       # wrap divi
+0001a5b0: 7369 6f6e 2069 6e20 696e 7428 2920 736f  sion in int() so
+0001a5c0: 2050 7974 686f 6e20 3320 646f 6573 6e27   Python 3 doesn'
+0001a5d0: 7420 636f 6e76 6572 7420 6974 2074 6f20  t convert it to 
+0001a5e0: 6120 666c 6f61 7420 6f6e 0a20 2020 2020  a float on.     
+0001a5f0: 2020 2023 2075 730a 2020 2020 2020 2020     # us.        
+0001a600: 696e 7428 6c65 6e28 6275 6c6b 2920 2f20  int(len(bulk) / 
+0001a610: 6f62 6a2e 626f 6479 5f6d 6178 6c65 6e29  obj.body_maxlen)
+0001a620: 202b 0a20 2020 2020 2020 2028 3120 6966   +.        (1 if
+0001a630: 206c 656e 2862 756c 6b29 2025 206f 626a   len(bulk) % obj
+0001a640: 2e62 6f64 795f 6d61 786c 656e 2065 6c73  .body_maxlen els
+0001a650: 6520 3029 290a 0a20 2020 2066 6f72 2063  e 0))..    for c
+0001a660: 6875 6e6b 2069 6e20 6368 756e 6b73 3a0a  hunk in chunks:.
+0001a670: 2020 2020 2020 2020 2320 5665 7269 6669          # Verifi
+0001a680: 6361 7469 6f6e 0a20 2020 2020 2020 2061  cation.        a
+0001a690: 7373 6572 7420 6c65 6e28 6368 756e 6b2e  ssert len(chunk.
+0001a6a0: 6765 7428 2774 6974 6c65 2729 2920 3c3d  get('title')) <=
+0001a6b0: 206f 626a 2e74 6974 6c65 5f6d 6178 6c65   obj.title_maxle
+0001a6c0: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+0001a6d0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0001a6e0: 626f 6479 2729 2920 3c3d 206f 626a 2e62  body')) <= obj.b
+0001a6f0: 6f64 795f 6d61 786c 656e 0a0a 2020 2020  ody_maxlen..    
+0001a700: 2020 2020 2320 4f75 7220 7469 746c 6520      # Our title 
+0001a710: 6973 2065 6d70 7479 2065 7665 7279 2074  is empty every t
+0001a720: 696d 650a 2020 2020 2020 2020 6173 7365  ime.        asse
+0001a730: 7274 2063 6875 6e6b 2e67 6574 2827 7469  rt chunk.get('ti
+0001a740: 746c 6527 2920 3d3d 2027 270a 0a20 2020  tle') == ''..   
+0001a750: 2020 2020 2023 204f 7572 2062 6f64 7920       # Our body 
+0001a760: 6973 206f 6e6c 7920 6272 6f6b 656e 2075  is only broken u
+0001a770: 703b 206e 6f74 206c 6f73 740a 2020 2020  p; not lost.    
+0001a780: 2020 2020 5f62 6f64 7920 3d20 6368 756e      _body = chun
+0001a790: 6b2e 6765 7428 2762 6f64 7927 290a 0a20  k.get('body').. 
+0001a7a0: 2020 2020 2020 2023 2055 6e2d 7573 6564         # Un-used
+0001a7b0: 2077 6869 7465 7370 6163 6520 6973 2061   whitespace is a
+0001a7c0: 6c77 6179 7320 636c 6561 6e65 6420 7570  lways cleaned up
+0001a7d0: 3b20 6d61 6b65 2073 7572 6520 7765 2061  ; make sure we a
+0001a7e0: 6363 6f75 6e74 2066 6f72 0a20 2020 2020  ccount for.     
+0001a7f0: 2020 2023 2074 6869 7320 696e 206f 7572     # this in our
+0001a800: 206e 6577 2063 616c 6375 6c61 7469 6f6e   new calculation
+0001a810: 0a20 2020 2020 2020 2077 735f 6469 6666  .        ws_diff
+0001a820: 203d 206c 656e 2862 756c 6b5b 6f66 6673   = len(bulk[offs
+0001a830: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+0001a840: 206f 6666 7365 745d 2920 2d20 5c0a 2020   offset]) - \.  
+0001a850: 2020 2020 2020 2020 2020 6c65 6e28 6275            len(bu
+0001a860: 6c6b 5b6f 6666 7365 743a 206c 656e 285f  lk[offset: len(_
+0001a870: 626f 6479 2920 2b20 6f66 6673 6574 5d0a  body) + offset].
+0001a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a890: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
+0001a8a0: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
+0001a8b0: 290a 0a20 2020 2020 2020 2061 7373 6572  )..        asser
+0001a8c0: 7420 6275 6c6b 5b6f 6666 7365 743a 206c  t bulk[offset: l
+0001a8d0: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+0001a8e0: 6574 202b 2077 735f 6469 6666 5d5c 0a20  et + ws_diff]\. 
+0001a8f0: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+0001a900: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+0001a910: 2729 2e72 7374 7269 7028 2920 3d3d 205f  ').rstrip() == _
+0001a920: 626f 6479 0a20 2020 2020 2020 206f 6666  body.        off
+0001a930: 7365 7420 2b3d 2028 6c65 6e28 5f62 6f64  set += (len(_bod
+0001a940: 7929 202b 2077 735f 6469 6666 290a 0a20  y) + ws_diff).. 
+0001a950: 2020 2023 0a20 2020 2023 2054 6573 7420     #.    # Test 
+0001a960: 6361 7365 2077 6865 7265 206f 7572 2074  case where our t
+0001a970: 6974 6c65 5f6c 656e 2069 7320 7368 6f72  itle_len is shor
+0001a980: 7465 7220 7468 656e 2074 6865 2076 616c  ter then the val
+0001a990: 7565 0a20 2020 2023 2074 6861 7420 776f  ue.    # that wo
+0001a9a0: 756c 6420 6f74 6865 7277 6973 6520 7472  uld otherwise tr
+0001a9b0: 6967 6765 7220 7468 6520 5b58 582f 5858  igger the [XX/XX
+0001a9c0: 5d20 656c 656d 656e 7473 0a20 2020 2023  ] elements.    #
+0001a9d0: 0a0a 2020 2020 636c 6173 7320 5465 7374  ..    class Test
+0001a9e0: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
+0001a9f0: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
+0001aa00: 2020 2023 2053 6574 2061 2073 6d61 6c6c     # Set a small
+0001aa10: 2074 6974 6c65 206c 656e 6774 680a 2020   title length.  
+0001aa20: 2020 2020 2020 7469 746c 655f 6d61 786c        title_maxl
+0001aa30: 656e 203d 2031 3030 0a0a 2020 2020 2020  en = 100..      
+0001aa40: 2020 2320 456e 666f 7263 6520 6120 626f    # Enforce a bo
+0001aa50: 6479 206c 656e 6774 682e 204d 616b 6520  dy length. Make 
+0001aa60: 7375 7265 2069 7427 7320 616e 2069 6e74  sure it's an int
+0001aa70: 2e0a 2020 2020 2020 2020 626f 6479 5f6d  ..        body_m
+0001aa80: 6178 6c65 6e20 3d20 696e 7428 626f 6479  axlen = int(body
+0001aa90: 5f6c 656e 202f 2034 290a 0a20 2020 2020  _len / 4)..     
+0001aaa0: 2020 2023 204e 6f20 416d 616c 6761 6d61     # No Amalgama
+0001aab0: 7469 6f6e 0a20 2020 2020 2020 206f 7665  tion.        ove
+0001aac0: 7266 6c6f 775f 616d 616c 6761 6d61 7465  rflow_amalgamate
+0001aad0: 5f74 6974 6c65 203d 2046 616c 7365 0a0a  _title = False..
+0001aae0: 2020 2020 2020 2020 2320 466f 7263 6520          # Force 
+0001aaf0: 7469 746c 6520 746f 2062 6520 6469 7370  title to be disp
+0001ab00: 6c61 7965 6420 616c 7761 7973 0a20 2020  layed always.   
+0001ab10: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
+0001ab20: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
+0001ab30: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
+0001ab40: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0001ab50: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+0001ab60: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+0001ab70: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+0001ab80: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
+0001ab90: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
+0001aba0: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
+0001abb0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+0001abc0: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
+0001abd0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
+0001abe0: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
+0001abf0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+0001ac00: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
+0001ac10: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
+0001ac20: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
+0001ac30: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
+0001ac40: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
+0001ac50: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
+0001ac60: 4e6f 6e65 0a0a 2020 2020 2320 5665 7269  None..    # Veri
+0001ac70: 6679 2074 6861 7420 7765 2062 7265 616b  fy that we break
+0001ac80: 2074 6865 2074 6974 6c65 2074 6f20 6120   the title to a 
+0001ac90: 6d61 7820 6c65 6e67 7468 206f 6620 6f75  max length of ou
+0001aca0: 7220 7469 746c 655f 6d61 780a 2020 2020  r title_max.    
+0001acb0: 2320 616e 6420 7468 6174 2074 6865 2062  # and that the b
+0001acc0: 6f64 7920 7265 6d61 696e 7320 756e 746f  ody remains unto
+0001acd0: 7563 6865 640a 2020 2020 6368 756e 6b73  uched.    chunks
+0001ace0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0001acf0: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+0001ad00: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
+0001ad10: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+0001ad20: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+0001ad30: 6479 3d22 222c 2074 6974 6c65 3d22 2229  dy="", title="")
+0001ad40: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+0001ad50: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+0001ad60: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+0001ad70: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+0001ad80: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+0001ad90: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+0001ada0: 792c 2074 6974 6c65 3d74 6974 6c65 290a  y, title=title).
+0001adb0: 2020 2020 6f66 6673 6574 203d 2030 0a20      offset = 0. 
+0001adc0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+0001add0: 756e 6b73 2920 3d3d 2034 0a20 2020 2066  unks) == 4.    f
+0001ade0: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
+0001adf0: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+0001ae00: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
+0001ae10: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
+0001ae20: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
+0001ae30: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+0001ae40: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
+0001ae50: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+0001ae60: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0001ae70: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
+0001ae80: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
+0001ae90: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
+0001aea0: 2023 204f 7572 2074 6974 6c65 2069 7320   # Our title is 
+0001aeb0: 7472 756e 6361 7465 6420 616e 6420 6e6f  truncated and no
+0001aec0: 2063 6f75 6e74 6572 2061 6464 6564 0a20   counter added. 
+0001aed0: 2020 2020 2020 2061 7373 6572 7420 7469         assert ti
+0001aee0: 746c 655b 3a6f 626a 2e74 6974 6c65 5f6d  tle[:obj.title_m
+0001aef0: 6178 6c65 6e5d 203d 3d20 6368 756e 6b2e  axlen] == chunk.
+0001af00: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
+0001af10: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
+0001af20: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
+0001af30: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
+0001af40: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
+0001af50: 6e6b 2e67 6574 2827 626f 6479 2729 0a20  nk.get('body'). 
+0001af60: 2020 2020 2020 2061 7373 6572 7420 626f         assert bo
+0001af70: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+0001af80: 626f 6479 2920 2b20 6f66 6673 6574 5d5c  body) + offset]\
+0001af90: 0a20 2020 2020 2020 2020 2020 202e 6c73  .            .ls
+0001afa0: 7472 6970 2827 5c72 5c6e 5c78 3062 5c78  trip('\r\n\x0b\x
+0001afb0: 3063 2729 2e72 7374 7269 7028 2920 3d3d  0c').rstrip() ==
+0001afc0: 205f 626f 6479 0a20 2020 2020 2020 206f   _body.        o
+0001afd0: 6666 7365 7420 2b3d 206c 656e 285f 626f  ffset += len(_bo
+0001afe0: 6479 290a 0a20 2020 2023 0a20 2020 2023  dy)..    #.    #
+0001aff0: 2053 6365 6e61 7269 6f20 7768 6572 6520   Scenario where 
+0001b000: 7468 6520 7469 746c 6520 6c65 6e67 7468  the title length
+0001b010: 2069 7320 6c61 7267 6572 2074 6861 6e20   is larger than 
+0001b020: 7468 6520 626f 6479 0a20 2020 2023 0a0a  the body.    #..
+0001b030: 2020 2020 636c 6173 7320 5465 7374 4e6f      class TestNo
+0001b040: 7469 6669 6361 7469 6f6e 284e 6f74 6966  tification(Notif
+0001b050: 7942 6173 6529 3a0a 0a20 2020 2020 2020  yBase):..       
+0001b060: 2023 2053 6574 2061 2073 6d61 6c6c 2074   # Set a small t
+0001b070: 6974 6c65 206c 656e 6774 680a 2020 2020  itle length.    
+0001b080: 2020 2020 7469 746c 655f 6d61 786c 656e      title_maxlen
+0001b090: 203d 2031 3030 0a0a 2020 2020 2020 2020   = 100..        
+0001b0a0: 2320 456e 666f 7263 6520 6120 626f 6479  # Enforce a body
+0001b0b0: 206c 656e 6774 682e 204d 616b 6520 7375   length. Make su
+0001b0c0: 7265 2069 7427 7320 616e 2069 6e74 2e0a  re it's an int..
+0001b0d0: 2020 2020 2020 2020 626f 6479 5f6d 6178          body_max
+0001b0e0: 6c65 6e20 3d20 3530 0a0a 2020 2020 2020  len = 50..      
+0001b0f0: 2020 2320 4e6f 2041 6d61 6c67 616d 6174    # No Amalgamat
+0001b100: 696f 6e0a 2020 2020 2020 2020 6f76 6572  ion.        over
+0001b110: 666c 6f77 5f61 6d61 6c67 616d 6174 655f  flow_amalgamate_
+0001b120: 7469 746c 6520 3d20 4661 6c73 650a 0a20  title = False.. 
+0001b130: 2020 2020 2020 2023 2046 6f72 6365 2074         # Force t
+0001b140: 6974 6c65 2074 6f20 6265 2064 6973 706c  itle to be displ
+0001b150: 6179 6564 2061 6c77 6179 730a 2020 2020  ayed always.    
+0001b160: 2020 2020 6f76 6572 666c 6f77 5f64 6973      overflow_dis
+0001b170: 706c 6179 5f74 6974 6c65 5f6f 6e63 6520  play_title_once 
+0001b180: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+0001b190: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0001b1a0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+0001b1b0: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+0001b1c0: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+0001b1d0: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
+0001b1e0: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
+0001b1f0: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+0001b200: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0001b210: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
+0001b220: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
+0001b230: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+0001b240: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
+0001b250: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
+0001b260: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
+0001b270: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
+0001b280: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
+0001b290: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
+0001b2a0: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
+0001b2b0: 6f6e 650a 0a20 2020 2023 2056 6572 6966  one..    # Verif
+0001b2c0: 7920 7468 6174 2077 6520 6272 6561 6b20  y that we break 
+0001b2d0: 7468 6520 7469 746c 6520 746f 2061 206d  the title to a m
+0001b2e0: 6178 206c 656e 6774 6820 6f66 206f 7572  ax length of our
+0001b2f0: 2074 6974 6c65 5f6d 6178 0a20 2020 2023   title_max.    #
+0001b300: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
+0001b310: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
+0001b320: 6368 6564 0a20 2020 2063 6875 6e6b 7320  ched.    chunks 
+0001b330: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0001b340: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+0001b350: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+0001b360: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0001b370: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0001b380: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
+0001b390: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0001b3a0: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0001b3b0: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+0001b3c0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+0001b3d0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0001b3e0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+0001b3f0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+0001b400: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+0001b410: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0001b420: 6e6b 7329 203d 3d20 3231 0a20 2020 2066  nks) == 21.    f
+0001b430: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
+0001b440: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+0001b450: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
+0001b460: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
+0001b470: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
+0001b480: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+0001b490: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
+0001b4a0: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+0001b4b0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0001b4c0: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
+0001b4d0: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
+0001b4e0: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
+0001b4f0: 2023 204f 7572 2074 6974 6c65 2069 7320   # Our title is 
+0001b500: 7472 756e 6361 7465 6420 616e 6420 6e6f  truncated and no
+0001b510: 2063 6f75 6e74 6572 2061 6464 6564 0a20   counter added. 
+0001b520: 2020 2020 2020 2061 7373 6572 7420 7469         assert ti
+0001b530: 746c 655b 3a6f 626a 2e74 6974 6c65 5f6d  tle[:obj.title_m
+0001b540: 6178 6c65 6e5d 203d 3d20 6368 756e 6b2e  axlen] == chunk.
+0001b550: 6765 7428 2774 6974 6c65 2729 0a0a 2020  get('title')..  
+0001b560: 2020 2020 2020 2320 4f75 7220 626f 6479        # Our body
+0001b570: 2069 7320 6f6e 6c79 2062 726f 6b65 6e20   is only broken 
+0001b580: 7570 3b20 6e6f 7420 6c6f 7374 0a20 2020  up; not lost.   
+0001b590: 2020 2020 205f 626f 6479 203d 2063 6875       _body = chu
+0001b5a0: 6e6b 2e67 6574 2827 626f 6479 2729 0a0a  nk.get('body')..
+0001b5b0: 2020 2020 2020 2020 2320 556e 2d75 7365          # Un-use
+0001b5c0: 6420 7768 6974 6573 7061 6365 2069 7320  d whitespace is 
+0001b5d0: 616c 7761 7973 2063 6c65 616e 6564 2075  always cleaned u
+0001b5e0: 703b 206d 616b 6520 7375 7265 2077 6520  p; make sure we 
+0001b5f0: 6163 636f 756e 7420 666f 720a 2020 2020  account for.    
+0001b600: 2020 2020 2320 7468 6973 2069 6e20 6f75      # this in ou
+0001b610: 7220 6e65 7720 6361 6c63 756c 6174 696f  r new calculatio
+0001b620: 6e0a 2020 2020 2020 2020 7773 5f64 6966  n.        ws_dif
+0001b630: 6620 3d20 6c65 6e28 626f 6479 5b6f 6666  f = len(body[off
+0001b640: 7365 743a 206c 656e 285f 626f 6479 2920  set: len(_body) 
+0001b650: 2b20 6f66 6673 6574 5d29 202d 205c 0a20  + offset]) - \. 
+0001b660: 2020 2020 2020 2020 2020 206c 656e 2862             len(b
+0001b670: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+0001b680: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+0001b690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b6a0: 202e 6c73 7472 6970 2827 5c72 5c6e 5c78   .lstrip('\r\n\x
+0001b6b0: 3062 5c78 3063 2729 2e72 7374 7269 7028  0b\x0c').rstrip(
+0001b6c0: 2929 0a0a 2020 2020 2020 2020 6173 7365  ))..        asse
+0001b6d0: 7274 2062 6f64 795b 6f66 6673 6574 3a20  rt body[offset: 
+0001b6e0: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
+0001b6f0: 7365 7420 2b20 7773 5f64 6966 665d 5c0a  set + ws_diff]\.
+0001b700: 2020 2020 2020 2020 2020 2020 2e6c 7374              .lst
+0001b710: 7269 7028 275c 725c 6e5c 7830 625c 7830  rip('\r\n\x0b\x0
+0001b720: 6327 292e 7273 7472 6970 2829 203d 3d20  c').rstrip() == 
+0001b730: 5f62 6f64 790a 2020 2020 2020 2020 6f66  _body.        of
+0001b740: 6673 6574 202b 3d20 286c 656e 285f 626f  fset += (len(_bo
+0001b750: 6479 2920 2b20 7773 5f64 6966 6629 0a0a  dy) + ws_diff)..
+0001b760: 0a64 6566 2074 6573 745f 6e6f 7469 6679  .def test_notify
+0001b770: 5f6f 7665 7266 6c6f 775f 7370 6c69 745f  _overflow_split_
+0001b780: 6e6f 5f61 6d61 6c67 616d 6174 696f 6e5f  no_amalgamation_
+0001b790: 666f 7263 655f 7469 746c 655f 6f6e 6365  force_title_once
+0001b7a0: 2829 3a0a 2020 2020 2222 220a 2020 2020  ():.    """.    
+0001b7b0: 4150 493a 204f 7665 7266 6c6f 7720 4e6f  API: Overflow No
+0001b7c0: 2041 6d61 6c67 616d 6174 696f 6e20 2874   Amalgamation (t
+0001b7d0: 6974 6c65 206f 6e63 6529 2053 706c 6974  itle once) Split
+0001b7e0: 2046 756e 6374 696f 6e61 6c69 7479 2054   Functionality T
+0001b7f0: 6573 7469 6e67 0a0a 2020 2020 2222 220a  esting..    """.
+0001b800: 0a20 2020 2023 0a20 2020 2023 2041 206c  .    #.    # A l
+0001b810: 6974 746c 6520 7072 6570 6172 6174 696f  ittle preparatio
+0001b820: 6e0a 2020 2020 230a 0a20 2020 2023 204e  n.    #..    # N
+0001b830: 756d 6265 7220 6f66 2063 6861 7261 6374  umber of charact
+0001b840: 6572 7320 7065 7220 6c69 6e65 0a20 2020  ers per line.   
+0001b850: 2072 6f77 203d 2032 340a 0a20 2020 2023   row = 24..    #
+0001b860: 2053 6f6d 6520 7661 7269 6162 6c65 7320   Some variables 
+0001b870: 7765 2075 7365 2074 6f20 636f 6e74 726f  we use to contro
+0001b880: 6c20 7468 6520 6461 7461 2077 6520 776f  l the data we wo
+0001b890: 726b 2077 6974 680a 2020 2020 626f 6479  rk with.    body
+0001b8a0: 5f6c 656e 203d 2031 3032 340a 2020 2020  _len = 1024.    
+0001b8b0: 7469 746c 655f 6c65 6e20 3d20 3130 3234  title_len = 1024
+0001b8c0: 0a0a 2020 2020 2320 4372 6561 7465 2061  ..    # Create a
+0001b8d0: 206c 6172 6765 2062 6f64 7920 616e 6420   large body and 
+0001b8e0: 7469 746c 6520 7769 7468 2072 616e 646f  title with rando
+0001b8f0: 6d20 6461 7461 0a20 2020 2062 6f64 7920  m data.    body 
+0001b900: 3d20 2727 2e6a 6f69 6e28 6368 6f69 6365  = ''.join(choice
+0001b910: 2873 7472 5f61 6c70 6861 202b 2073 7472  (str_alpha + str
+0001b920: 5f6e 756d 2920 666f 7220 5f20 696e 2072  _num) for _ in r
+0001b930: 616e 6765 2862 6f64 795f 6c65 6e29 290a  ange(body_len)).
+0001b940: 2020 2020 626f 6479 203d 2027 5c72 5c6e      body = '\r\n
+0001b950: 272e 6a6f 696e 285b 626f 6479 5b69 3a20  '.join([body[i: 
+0001b960: 6920 2b20 726f 775d 2066 6f72 2069 2069  i + row] for i i
+0001b970: 6e20 7261 6e67 6528 302c 206c 656e 2862  n range(0, len(b
+0001b980: 6f64 7929 2c20 726f 7729 5d29 0a0a 2020  ody), row)])..  
+0001b990: 2020 2320 7468 6520 6e65 7720 6c69 6e65    # the new line
+0001b9a0: 7320 6164 6420 6120 6c61 7267 6520 616d  s add a large am
+0001b9b0: 6f75 6e74 2074 6f20 6f75 7220 626f 6479  ount to our body
+0001b9c0: 3b20 6c65 7473 2066 6f72 6365 2074 6865  ; lets force the
+0001b9d0: 2063 6f6e 7465 6e74 0a20 2020 2023 2062   content.    # b
+0001b9e0: 6163 6b20 746f 2062 6569 6e67 2031 3032  ack to being 102
+0001b9f0: 3420 6368 6172 6163 7465 7273 2e0a 2020  4 characters..  
+0001ba00: 2020 626f 6479 203d 2062 6f64 795b 303a    body = body[0:
+0001ba10: 3130 3234 5d0a 0a20 2020 2023 2043 7265  1024]..    # Cre
+0001ba20: 6174 6520 6f75 7220 7469 746c 6520 7573  ate our title us
+0001ba30: 696e 6720 7261 6e64 6f6d 2064 6174 610a  ing random data.
+0001ba40: 2020 2020 7469 746c 6520 3d20 2727 2e6a      title = ''.j
+0001ba50: 6f69 6e28 6368 6f69 6365 2873 7472 5f61  oin(choice(str_a
+0001ba60: 6c70 6861 202b 2073 7472 5f6e 756d 2920  lpha + str_num) 
+0001ba70: 666f 7220 5f20 696e 2072 616e 6765 2874  for _ in range(t
+0001ba80: 6974 6c65 5f6c 656e 2929 0a0a 2020 2020  itle_len))..    
+0001ba90: 230a 2020 2020 2320 4669 7273 7420 5465  #.    # First Te
+0001baa0: 7374 3a20 5472 756e 6361 7465 6420 5469  st: Truncated Ti
+0001bab0: 746c 650a 2020 2020 230a 2020 2020 636c  tle.    #.    cl
+0001bac0: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
+0001bad0: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
+0001bae0: 3a0a 0a20 2020 2020 2020 2023 2054 6573  :..        # Tes
+0001baf0: 7420 7469 746c 6520 6d61 7820 6c65 6e67  t title max leng
+0001bb00: 7468 0a20 2020 2020 2020 2074 6974 6c65  th.        title
+0001bb10: 5f6d 6178 6c65 6e20 3d20 3130 0a0a 2020  _maxlen = 10..  
+0001bb20: 2020 2020 2020 2320 5769 7468 2061 6d61        # With ama
+0001bb30: 6c67 616d 6174 696f 6e0a 2020 2020 2020  lgamation.      
+0001bb40: 2020 6f76 6572 666c 6f77 5f61 6d61 6c67    overflow_amalg
+0001bb50: 616d 6174 655f 7469 746c 6520 3d20 5472  amate_title = Tr
+0001bb60: 7565 0a0a 2020 2020 2020 2020 2320 466f  ue..        # Fo
+0001bb70: 7263 6520 7469 746c 6520 6469 7370 6c61  rce title displa
+0001bb80: 7965 6420 6f6e 6365 0a20 2020 2020 2020  yed once.       
+0001bb90: 206f 7665 7266 6c6f 775f 6469 7370 6c61   overflow_displa
+0001bba0: 795f 7469 746c 655f 6f6e 6365 203d 2054  y_title_once = T
+0001bbb0: 7275 650a 0a20 2020 2020 2020 2064 6566  rue..        def
+0001bbc0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+0001bbd0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0001bbe0: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
+0001bbf0: 7065 7228 292e 5f5f 696e 6974 5f5f 282a  per().__init__(*
+0001bc00: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
+0001bc10: 2020 6465 6620 6e6f 7469 6679 2873 656c    def notify(sel
+0001bc20: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+0001bc30: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+0001bc40: 2023 2050 7265 7465 6e64 2065 7665 7279   # Pretend every
+0001bc50: 7468 696e 6720 6973 206f 6b61 790a 2020  thing is okay.  
+0001bc60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001bc70: 2054 7275 650a 0a20 2020 2023 204c 6f61   True..    # Loa
+0001bc80: 6420 6f75 7220 6f62 6a65 6374 0a20 2020  d our object.   
+0001bc90: 206f 626a 203d 2054 6573 744e 6f74 6966   obj = TestNotif
+0001bca0: 6963 6174 696f 6e28 6f76 6572 666c 6f77  ication(overflow
+0001bcb0: 3d4f 7665 7266 6c6f 774d 6f64 652e 5350  =OverflowMode.SP
+0001bcc0: 4c49 5429 0a20 2020 2061 7373 6572 7420  LIT).    assert 
+0001bcd0: 6f62 6a20 6973 206e 6f74 204e 6f6e 650a  obj is not None.
+0001bce0: 0a20 2020 2023 2056 6572 6966 7920 7468  .    # Verify th
+0001bcf0: 6174 2077 6520 6272 6561 6b20 7468 6520  at we break the 
+0001bd00: 7469 746c 6520 746f 2061 206d 6178 206c  title to a max l
+0001bd10: 656e 6774 6820 6f66 206f 7572 2074 6974  ength of our tit
+0001bd20: 6c65 5f6d 6178 0a20 2020 2023 2061 6e64  le_max.    # and
+0001bd30: 2074 6861 7420 7468 6520 626f 6479 2072   that the body r
+0001bd40: 656d 6169 6e73 2075 6e74 6f75 6368 6564  emains untouched
+0001bd50: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+0001bd60: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+0001bd70: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
+0001bd80: 3d74 6974 6c65 290a 2020 2020 6368 756e  =title).    chun
+0001bd90: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+0001bda0: 6f76 6572 666c 6f77 2862 6f64 793d 2222  overflow(body=""
+0001bdb0: 2c20 7469 746c 653d 2222 290a 2020 2020  , title="").    
+0001bdc0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0001bdd0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0001bde0: 793d 626f 6479 2c20 7469 746c 653d 2222  y=body, title=""
+0001bdf0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+0001be00: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+0001be10: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+0001be20: 746c 653d 7469 746c 6529 0a20 2020 2061  tle=title).    a
+0001be30: 7373 6572 7420 6c65 6e28 6368 756e 6b73  ssert len(chunks
+0001be40: 2920 3d3d 2031 0a20 2020 2061 7373 6572  ) == 1.    asser
+0001be50: 7420 626f 6479 2e6c 7374 7269 7028 275c  t body.lstrip('\
+0001be60: 725c 6e5c 7830 625c 7830 6327 292e 7273  r\n\x0b\x0c').rs
+0001be70: 7472 6970 2829 203d 3d20 6368 756e 6b73  trip() == chunks
+0001be80: 5b30 5d2e 6765 7428 2762 6f64 7927 290a  [0].get('body').
+0001be90: 2020 2020 6173 7365 7274 2074 6974 6c65      assert title
+0001bea0: 5b30 3a6f 626a 2e74 6974 6c65 5f6d 6178  [0:obj.title_max
+0001beb0: 6c65 6e5d 203d 3d20 6368 756e 6b73 5b30  len] == chunks[0
+0001bec0: 5d2e 6765 7428 2774 6974 6c65 2729 0a0a  ].get('title')..
+0001bed0: 2020 2020 230a 2020 2020 2320 4e65 7874      #.    # Next
+0001bee0: 2054 6573 743a 204c 696e 6520 436f 756e   Test: Line Coun
+0001bef0: 7420 436f 6e74 726f 6c0a 2020 2020 230a  t Control.    #.
+0001bf00: 0a20 2020 2063 6c61 7373 2054 6573 744e  .    class TestN
+0001bf10: 6f74 6966 6963 6174 696f 6e28 4e6f 7469  otification(Noti
+0001bf20: 6679 4261 7365 293a 0a0a 2020 2020 2020  fyBase):..      
+0001bf30: 2020 2320 5465 7374 2074 6974 6c65 206d    # Test title m
+0001bf40: 6178 206c 656e 6774 680a 2020 2020 2020  ax length.      
+0001bf50: 2020 7469 746c 655f 6d61 786c 656e 203d    title_maxlen =
+0001bf60: 2035 0a0a 2020 2020 2020 2020 2320 4d61   5..        # Ma
+0001bf70: 7869 6d75 6d20 6e75 6d62 6572 206f 6620  ximum number of 
+0001bf80: 6c69 6e65 730a 2020 2020 2020 2020 626f  lines.        bo
+0001bf90: 6479 5f6d 6178 5f6c 696e 655f 636f 756e  dy_max_line_coun
+0001bfa0: 7420 3d20 350a 0a20 2020 2020 2020 2023  t = 5..        #
+0001bfb0: 2057 6974 6820 616d 616c 6761 6d61 7469   With amalgamati
+0001bfc0: 6f6e 0a20 2020 2020 2020 206f 7665 7266  on.        overf
+0001bfd0: 6c6f 775f 616d 616c 6761 6d61 7465 5f74  low_amalgamate_t
+0001bfe0: 6974 6c65 203d 2054 7275 650a 0a20 2020  itle = True..   
+0001bff0: 2020 2020 2023 2046 6f72 6365 2074 6974       # Force tit
+0001c000: 6c65 2064 6973 706c 6179 6564 206f 6e63  le displayed onc
+0001c010: 650a 2020 2020 2020 2020 6f76 6572 666c  e.        overfl
+0001c020: 6f77 5f64 6973 706c 6179 5f74 6974 6c65  ow_display_title
+0001c030: 5f6f 6e63 6520 3d20 5472 7565 0a0a 2020  _once = True..  
+0001c040: 2020 2020 2020 6465 6620 5f5f 696e 6974        def __init
+0001c050: 5f5f 2873 656c 662c 202a 6172 6773 2c20  __(self, *args, 
+0001c060: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0001c070: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+0001c080: 5f69 6e69 745f 5f28 2a2a 6b77 6172 6773  _init__(**kwargs
+0001c090: 290a 0a20 2020 2020 2020 2064 6566 206e  )..        def n
+0001c0a0: 6f74 6966 7928 7365 6c66 2c20 2a61 7267  otify(self, *arg
+0001c0b0: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+0001c0c0: 2020 2020 2020 2020 2020 2320 5072 6574            # Pret
+0001c0d0: 656e 6420 6576 6572 7974 6869 6e67 2069  end everything i
+0001c0e0: 7320 6f6b 6179 0a20 2020 2020 2020 2020  s okay.         
+0001c0f0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+0001c100: 2020 2020 2320 4c6f 6164 206f 7572 206f      # Load our o
+0001c110: 626a 6563 740a 2020 2020 6f62 6a20 3d20  bject.    obj = 
+0001c120: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+0001c130: 286f 7665 7266 6c6f 773d 4f76 6572 666c  (overflow=Overfl
+0001c140: 6f77 4d6f 6465 2e53 504c 4954 290a 2020  owMode.SPLIT).  
+0001c150: 2020 6173 7365 7274 206f 626a 2069 7320    assert obj is 
+0001c160: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 2320  not None..    # 
+0001c170: 5665 7269 6679 2074 6861 7420 7765 2062  Verify that we b
+0001c180: 7265 616b 2074 6865 2074 6974 6c65 2074  reak the title t
+0001c190: 6f20 6120 6d61 7820 6c65 6e67 7468 206f  o a max length o
+0001c1a0: 6620 6f75 7220 7469 746c 655f 6d61 780a  f our title_max.
+0001c1b0: 2020 2020 2320 616e 6420 7468 6174 2074      # and that t
+0001c1c0: 6865 2062 6f64 7920 7265 6d61 696e 7320  he body remains 
+0001c1d0: 756e 746f 7563 6865 640a 2020 2020 6368  untouched.    ch
+0001c1e0: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0001c1f0: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0001c200: 2222 2c20 7469 746c 653d 7469 746c 6529  "", title=title)
+0001c210: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+0001c220: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+0001c230: 7728 626f 6479 3d22 222c 2074 6974 6c65  w(body="", title
+0001c240: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+0001c250: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0001c260: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+0001c270: 2074 6974 6c65 3d22 2229 0a20 2020 2063   title="").    c
+0001c280: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+0001c290: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+0001c2a0: 3d62 6f64 792c 2074 6974 6c65 3d74 6974  =body, title=tit
+0001c2b0: 6c65 290a 2020 2020 6173 7365 7274 206c  le).    assert l
+0001c2c0: 656e 2863 6875 6e6b 7329 203d 3d20 310a  en(chunks) == 1.
+0001c2d0: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+0001c2e0: 6875 6e6b 735b 305d 2e67 6574 2827 626f  hunks[0].get('bo
+0001c2f0: 6479 2729 2e73 706c 6974 2827 5c6e 2729  dy').split('\n')
+0001c300: 2920 3d3d 206f 626a 2e62 6f64 795f 6d61  ) == obj.body_ma
+0001c310: 785f 6c69 6e65 5f63 6f75 6e74 0a20 2020  x_line_count.   
+0001c320: 2061 7373 6572 7420 7469 746c 655b 303a   assert title[0:
+0001c330: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+0001c340: 5d20 3d3d 2063 6875 6e6b 735b 305d 2e67  ] == chunks[0].g
+0001c350: 6574 2827 7469 746c 6527 290a 0a20 2020  et('title')..   
+0001c360: 2023 0a20 2020 2023 204e 6578 7420 5465   #.    # Next Te
+0001c370: 7374 3a20 5370 6c69 7420 626f 6479 0a20  st: Split body. 
+0001c380: 2020 2023 0a0a 2020 2020 636c 6173 7320     #..    class 
+0001c390: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+0001c3a0: 284e 6f74 6966 7942 6173 6529 3a0a 0a20  (NotifyBase):.. 
+0001c3b0: 2020 2020 2020 2023 2054 6573 7420 7469         # Test ti
+0001c3c0: 746c 6520 6d61 7820 6c65 6e67 7468 0a20  tle max length. 
+0001c3d0: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
+0001c3e0: 6c65 6e20 3d20 7469 746c 655f 6c65 6e0a  len = title_len.
+0001c3f0: 0a20 2020 2020 2020 2023 2045 6e66 6f72  .        # Enfor
+0001c400: 6365 2061 2062 6f64 7920 6c65 6e67 7468  ce a body length
+0001c410: 2e20 4d61 6b65 2073 7572 6520 6974 2773  . Make sure it's
+0001c420: 2061 6e20 696e 742e 0a20 2020 2020 2020   an int..       
+0001c430: 2062 6f64 795f 6d61 786c 656e 203d 2069   body_maxlen = i
+0001c440: 6e74 2862 6f64 795f 6c65 6e20 2f20 3429  nt(body_len / 4)
+0001c450: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+0001c460: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+0001c470: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+0001c480: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+0001c490: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+0001c4a0: 2320 466f 7263 6520 7469 746c 6520 6469  # Force title di
+0001c4b0: 7370 6c61 7965 6420 6f6e 6365 0a20 2020  splayed once.   
+0001c4c0: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
+0001c4d0: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
+0001c4e0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+0001c4f0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0001c500: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+0001c510: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+0001c520: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+0001c530: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
+0001c540: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
+0001c550: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+0001c560: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0001c570: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
+0001c580: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
+0001c590: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+0001c5a0: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
+0001c5b0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
+0001c5c0: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
+0001c5d0: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
+0001c5e0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
+0001c5f0: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
+0001c600: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
+0001c610: 6f6e 650a 0a20 2020 2023 2056 6572 6966  one..    # Verif
+0001c620: 7920 7468 6174 2077 6520 6272 6561 6b20  y that we break 
+0001c630: 7468 6520 7469 746c 6520 746f 2061 206d  the title to a m
+0001c640: 6178 206c 656e 6774 6820 6f66 206f 7572  ax length of our
+0001c650: 2074 6974 6c65 5f6d 6178 0a20 2020 2023   title_max.    #
+0001c660: 2061 6e64 2074 6861 7420 7468 6520 626f   and that the bo
+0001c670: 6479 2072 656d 6169 6e73 2075 6e74 6f75  dy remains untou
+0001c680: 6368 6564 0a20 2020 2063 6875 6e6b 7320  ched.    chunks 
+0001c690: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0001c6a0: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+0001c6b0: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+0001c6c0: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0001c6d0: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0001c6e0: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
+0001c6f0: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0001c700: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0001c710: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+0001c720: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+0001c730: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0001c740: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+0001c750: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+0001c760: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+0001c770: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0001c780: 6e6b 7329 203d 3d20 350a 2020 2020 666f  nks) == 5.    fo
+0001c790: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+0001c7a0: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+0001c7b0: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+0001c7c0: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+0001c7d0: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+0001c7e0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+0001c7f0: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+0001c800: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+0001c810: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0001c820: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+0001c830: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+0001c840: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
+0001c850: 2320 4e6f 2063 6f75 6e74 6572 2069 7320  # No counter is 
+0001c860: 6469 7370 6c61 7965 6420 6265 6361 7573  displayed becaus
+0001c870: 6520 6f75 7220 7469 746c 6520 6973 2073  e our title is s
+0001c880: 6f20 656e 6f72 6d6f 7573 0a20 2020 2020  o enormous.     
+0001c890: 2020 2023 2057 6520 7377 6974 6368 2074     # We switch t
+0001c8a0: 6f20 6120 6469 7370 6c61 7920 7469 746c  o a display titl
+0001c8b0: 6520 6f6e 2066 6972 7374 206d 6573 7361  e on first messa
+0001c8c0: 6765 206f 6e6c 790a 2020 2020 2020 2020  ge only.        
+0001c8d0: 6966 2069 6478 203e 2031 3a0a 2020 2020  if idx > 1:.    
+0001c8e0: 2020 2020 2020 2020 2320 456d 7074 7920          # Empty 
+0001c8f0: 286e 6f20 7469 746c 6520 6469 7370 6c61  (no title displa
+0001c900: 7965 6420 6f6e 2066 6f6c 6c6f 7769 6e67  yed on following
+0001c910: 2065 6e74 7269 6573 0a20 2020 2020 2020   entries.       
+0001c920: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
+0001c930: 6b2e 6765 7428 2774 6974 6c65 2729 203d  k.get('title') =
+0001c940: 3d20 2222 0a20 2020 2020 2020 2065 6c73  = "".        els
+0001c950: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+0001c960: 2054 6865 206c 656e 6774 6820 6f66 2074   The length of t
+0001c970: 6865 2062 6f64 7920 7072 6576 6169 6c73  he body prevails
+0001c980: 206f 7572 2074 6974 6c65 2064 7565 2074   our title due t
+0001c990: 6f20 6974 2062 6569 6e67 0a20 2020 2020  o it being.     
+0001c9a0: 2020 2020 2020 2023 2073 6f20 6d75 6368         # so much
+0001c9b0: 2073 6d61 6c6c 6572 2074 6865 6e20 6f75   smaller then ou
+0001c9c0: 7220 7469 746c 6520 6c65 6e67 7468 0a20  r title length. 
+0001c9d0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0001c9e0: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+0001c9f0: 2774 6974 6c65 2729 2920 3d3d 206f 626a  'title')) == obj
+0001ca00: 2e62 6f64 795f 6d61 786c 656e 0a20 2020  .body_maxlen.   
+0001ca10: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001ca20: 7469 746c 655b 3a6f 626a 2e62 6f64 795f  title[:obj.body_
+0001ca30: 6d61 786c 656e 5d20 3d3d 2063 6875 6e6b  maxlen] == chunk
+0001ca40: 2e67 6574 2827 7469 746c 6527 290a 0a20  .get('title').. 
+0001ca50: 2020 2020 2020 2023 204f 7572 2062 6f64         # Our bod
+0001ca60: 7920 6973 206f 6e6c 7920 6272 6f6b 656e  y is only broken
+0001ca70: 2075 703b 206e 6f74 206c 6f73 740a 2020   up; not lost.  
+0001ca80: 2020 2020 2020 5f62 6f64 7920 3d20 6368        _body = ch
+0001ca90: 756e 6b2e 6765 7428 2762 6f64 7927 290a  unk.get('body').
+0001caa0: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+0001cab0: 6f64 795b 6f66 6673 6574 3a20 6c65 6e28  ody[offset: len(
+0001cac0: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+0001cad0: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
+0001cae0: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
+0001caf0: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
+0001cb00: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
+0001cb10: 6f66 6673 6574 202b 3d20 6c65 6e28 5f62  offset += len(_b
+0001cb20: 6f64 7929 0a0a 2020 2020 2320 416e 6f74  ody)..    # Anot
+0001cb30: 6865 7220 6564 6765 2063 6173 6520 7768  her edge case wh
+0001cb40: 6572 6520 7468 6520 7469 746c 6520 6a75  ere the title ju
+0001cb50: 7374 2069 736e 2774 2074 6861 7420 6c6f  st isn't that lo
+0001cb60: 6e67 206c 6561 7669 6e67 0a20 2020 2023  ng leaving.    #
+0001cb70: 2061 206c 6f74 206f 6620 7370 6163 6520   a lot of space 
+0001cb80: 666f 7220 7468 6520 5b78 782f 7878 5d20  for the [xx/xx] 
+0001cb90: 656e 7472 6965 7320 286e 6f20 7472 756e  entries (no trun
+0001cba0: 6361 7469 6f6e 206e 6565 6465 6429 0a20  cation needed). 
+0001cbb0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0001cbc0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0001cbd0: 626f 6479 3d22 222c 2074 6974 6c65 3d74  body="", title=t
+0001cbe0: 6974 6c65 290a 2020 2020 6368 756e 6b73  itle).    chunks
+0001cbf0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0001cc00: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+0001cc10: 7469 746c 653d 2222 290a 2020 2020 6368  title="").    ch
+0001cc20: 756e 6b73 203d 206f 626a 2e5f 6170 706c  unks = obj._appl
+0001cc30: 795f 6f76 6572 666c 6f77 2862 6f64 793d  y_overflow(body=
+0001cc40: 626f 6479 2c20 7469 746c 653d 2222 290a  body, title="").
+0001cc50: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0001cc60: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0001cc70: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+0001cc80: 653d 7469 746c 655b 3a32 305d 290a 2020  e=title[:20]).  
+0001cc90: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
+0001cca0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+0001ccb0: 6b73 2920 3d3d 2035 0a20 2020 2066 6f72  ks) == 5.    for
+0001ccc0: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+0001ccd0: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+0001cce0: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+0001ccf0: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+0001cd00: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+0001cd10: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0001cd20: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+0001cd30: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+0001cd40: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0001cd50: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+0001cd60: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+0001cd70: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+0001cd80: 204e 6f20 636f 756e 7465 7220 6973 2064   No counter is d
+0001cd90: 6973 706c 6179 6564 2062 6563 6175 7365  isplayed because
+0001cda0: 206f 7572 2074 6974 6c65 2069 7320 736f   our title is so
+0001cdb0: 2065 6e6f 726d 6f75 730a 2020 2020 2020   enormous.      
+0001cdc0: 2020 2320 5765 2073 7769 7463 6820 746f    # We switch to
+0001cdd0: 2061 2064 6973 706c 6179 2074 6974 6c65   a display title
+0001cde0: 206f 6e20 6669 7273 7420 6d65 7373 6167   on first messag
+0001cdf0: 6520 6f6e 6c79 0a20 2020 2020 2020 2069  e only.        i
+0001ce00: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+0001ce10: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+0001ce20: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+0001ce30: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+0001ce40: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+0001ce50: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+0001ce60: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+0001ce70: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+0001ce80: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001ce90: 5468 6520 6c65 6e67 7468 206f 6620 7468  The length of th
+0001cea0: 6520 626f 6479 2070 7265 7661 696c 7320  e body prevails 
+0001ceb0: 6f75 7220 7469 746c 6520 6475 6520 746f  our title due to
+0001cec0: 2069 7420 6265 696e 670a 2020 2020 2020   it being.      
+0001ced0: 2020 2020 2020 2320 736f 206d 7563 6820        # so much 
+0001cee0: 736d 616c 6c65 7220 7468 656e 206f 7572  smaller then our
+0001cef0: 2074 6974 6c65 206c 656e 6774 680a 2020   title length.  
+0001cf00: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0001cf10: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0001cf20: 7469 746c 6527 2929 203d 3d20 3230 0a20  title')) == 20. 
+0001cf30: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0001cf40: 7420 7469 746c 655b 3a32 305d 203d 3d20  t title[:20] == 
+0001cf50: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+0001cf60: 2729 0a0a 2020 2020 2020 2020 2320 4f75  ')..        # Ou
+0001cf70: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
+0001cf80: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
+0001cf90: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
+0001cfa0: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
+0001cfb0: 6479 2729 0a20 2020 2020 2020 2061 7373  dy').        ass
+0001cfc0: 6572 7420 626f 6479 5b6f 6666 7365 743a  ert body[offset:
+0001cfd0: 206c 656e 285f 626f 6479 2920 2b20 6f66   len(_body) + of
+0001cfe0: 6673 6574 5d5c 0a20 2020 2020 2020 2020  fset]\.         
+0001cff0: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
+0001d000: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+0001d010: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
+0001d020: 2020 2020 206f 6666 7365 7420 2b3d 206c       offset += l
+0001d030: 656e 285f 626f 6479 290a 0a20 2020 2023  en(_body)..    #
+0001d040: 0a20 2020 2023 2054 6573 7420 666f 7263  .    # Test forc
+0001d050: 696e 6720 6f76 6572 666c 6f77 5f64 6973  ing overflow_dis
+0001d060: 706c 6179 5f74 6974 6c65 5f6f 6e63 650a  play_title_once.
+0001d070: 2020 2020 230a 2020 2020 636c 6173 7320      #.    class 
+0001d080: 5465 7374 4e6f 7469 6669 6361 7469 6f6e  TestNotification
+0001d090: 284e 6f74 6966 7942 6173 6529 3a0a 0a20  (NotifyBase):.. 
+0001d0a0: 2020 2020 2020 2023 2054 6573 7420 7469         # Test ti
+0001d0b0: 746c 6520 6d61 7820 6c65 6e67 7468 0a20  tle max length. 
+0001d0c0: 2020 2020 2020 2074 6974 6c65 5f6d 6178         title_max
+0001d0d0: 6c65 6e20 3d20 7469 746c 655f 6c65 6e0a  len = title_len.
+0001d0e0: 0a20 2020 2020 2020 2023 2045 6e66 6f72  .        # Enfor
+0001d0f0: 6365 2061 2062 6f64 7920 6c65 6e67 7468  ce a body length
+0001d100: 2e20 4d61 6b65 2073 7572 6520 6974 2773  . Make sure it's
+0001d110: 2061 6e20 696e 742e 0a20 2020 2020 2020   an int..       
+0001d120: 2062 6f64 795f 6d61 786c 656e 203d 2069   body_maxlen = i
+0001d130: 6e74 2862 6f64 795f 6c65 6e20 2f20 3429  nt(body_len / 4)
+0001d140: 0a0a 2020 2020 2020 2020 2320 5769 7468  ..        # With
+0001d150: 2061 6d61 6c67 616d 6174 696f 6e0a 2020   amalgamation.  
+0001d160: 2020 2020 2020 6f76 6572 666c 6f77 5f61        overflow_a
+0001d170: 6d61 6c67 616d 6174 655f 7469 746c 6520  malgamate_title 
+0001d180: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+0001d190: 2320 466f 7263 6520 7469 746c 6520 6469  # Force title di
+0001d1a0: 7370 6c61 7965 6420 6f6e 6365 0a20 2020  splayed once.   
+0001d1b0: 2020 2020 206f 7665 7266 6c6f 775f 6469       overflow_di
+0001d1c0: 7370 6c61 795f 7469 746c 655f 6f6e 6365  splay_title_once
+0001d1d0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+0001d1e0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0001d1f0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+0001d200: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+0001d210: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+0001d220: 5f5f 282a 2a6b 7761 7267 7329 0a0a 2020  __(**kwargs)..  
+0001d230: 2020 2020 2020 6465 6620 6e6f 7469 6679        def notify
+0001d240: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+0001d250: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0001d260: 2020 2020 2023 2050 7265 7465 6e64 2065       # Pretend e
+0001d270: 7665 7279 7468 696e 6720 6973 206f 6b61  verything is oka
+0001d280: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+0001d290: 7475 726e 2054 7275 650a 0a20 2020 2023  turn True..    #
+0001d2a0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
+0001d2b0: 0a20 2020 206f 626a 203d 2054 6573 744e  .    obj = TestN
+0001d2c0: 6f74 6966 6963 6174 696f 6e28 6f76 6572  otification(over
+0001d2d0: 666c 6f77 3d4f 7665 7266 6c6f 774d 6f64  flow=OverflowMod
+0001d2e0: 652e 5350 4c49 5429 0a20 2020 2061 7373  e.SPLIT).    ass
+0001d2f0: 6572 7420 6f62 6a20 6973 206e 6f74 204e  ert obj is not N
+0001d300: 6f6e 650a 0a20 2020 2063 6875 6e6b 7320  one..    chunks 
+0001d310: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0001d320: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+0001d330: 6974 6c65 3d74 6974 6c65 290a 2020 2020  itle=title).    
+0001d340: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0001d350: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0001d360: 793d 2222 2c20 7469 746c 653d 2222 290a  y="", title="").
+0001d370: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0001d380: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0001d390: 2862 6f64 793d 626f 6479 2c20 7469 746c  (body=body, titl
+0001d3a0: 653d 2222 290a 2020 2020 6368 756e 6b73  e="").    chunks
+0001d3b0: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0001d3c0: 6572 666c 6f77 2862 6f64 793d 626f 6479  erflow(body=body
+0001d3d0: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+0001d3e0: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+0001d3f0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0001d400: 6e6b 7329 203d 3d20 350a 2020 2020 666f  nks) == 5.    fo
+0001d410: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+0001d420: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+0001d430: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+0001d440: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+0001d450: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+0001d460: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+0001d470: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+0001d480: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+0001d490: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0001d4a0: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+0001d4b0: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+0001d4c0: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
+0001d4d0: 2320 4f75 7220 7469 746c 6520 6861 7320  # Our title has 
+0001d4e0: 6e6f 2063 6f75 6e74 6572 2061 6464 6564  no counter added
+0001d4f0: 2074 6f20 6974 0a20 2020 2020 2020 2069   to it.        i
+0001d500: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+0001d510: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+0001d520: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+0001d530: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+0001d540: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+0001d550: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+0001d560: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+0001d570: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+0001d580: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001d590: 5468 6520 626f 6479 206c 656e 6774 6820  The body length 
+0001d5a0: 7072 6576 6169 6c73 2064 7565 2074 6f20  prevails due to 
+0001d5b0: 6f75 7220 616d 616c 6761 6d61 7469 6f6e  our amalgamation
+0001d5c0: 2066 6c61 670a 2020 2020 2020 2020 2020   flag.          
+0001d5d0: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0001d5e0: 6e6b 2e67 6574 2827 7469 746c 6527 2929  nk.get('title'))
+0001d5f0: 203d 3d20 6f62 6a2e 626f 6479 5f6d 6178   == obj.body_max
+0001d600: 6c65 6e0a 2020 2020 2020 2020 2020 2020  len.            
+0001d610: 6173 7365 7274 2074 6974 6c65 5b3a 6f62  assert title[:ob
+0001d620: 6a2e 626f 6479 5f6d 6178 6c65 6e5d 203d  j.body_maxlen] =
+0001d630: 3d20 6368 756e 6b2e 6765 7428 2774 6974  = chunk.get('tit
+0001d640: 6c65 2729 0a0a 2020 2020 2020 2020 2320  le')..        # 
+0001d650: 4f75 7220 626f 6479 2069 7320 6f6e 6c79  Our body is only
+0001d660: 2062 726f 6b65 6e20 7570 3b20 6e6f 7420   broken up; not 
+0001d670: 6c6f 7374 0a20 2020 2020 2020 205f 626f  lost.        _bo
+0001d680: 6479 203d 2063 6875 6e6b 2e67 6574 2827  dy = chunk.get('
+0001d690: 626f 6479 2729 0a20 2020 2020 2020 2061  body').        a
+0001d6a0: 7373 6572 7420 626f 6479 5b6f 6666 7365  ssert body[offse
+0001d6b0: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+0001d6c0: 6f66 6673 6574 5d5c 0a20 2020 2020 2020  offset]\.       
+0001d6d0: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
+0001d6e0: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
+0001d6f0: 7269 7028 2920 3d3d 205f 626f 6479 0a20  rip() == _body. 
+0001d700: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
+0001d710: 206c 656e 285f 626f 6479 290a 0a20 2020   len(_body)..   
+0001d720: 2023 2054 6573 7420 6c61 7267 6572 206d   # Test larger m
+0001d730: 6573 7361 6765 730a 2020 2020 2320 616e  essages.    # an
+0001d740: 6420 7468 6174 2074 6865 2062 6f64 7920  d that the body 
+0001d750: 7265 6d61 696e 7320 756e 746f 7563 6865  remains untouche
+0001d760: 640a 2020 2020 636c 6173 7320 5465 7374  d.    class Test
+0001d770: 4e6f 7469 6669 6361 7469 6f6e 284e 6f74  Notification(Not
+0001d780: 6966 7942 6173 6529 3a0a 0a20 2020 2020  ifyBase):..     
+0001d790: 2020 2023 2054 6573 7420 7469 746c 6520     # Test title 
+0001d7a0: 6d61 7820 6c65 6e67 7468 0a20 2020 2020  max length.     
+0001d7b0: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
+0001d7c0: 3d20 3135 300a 0a20 2020 2020 2020 2023  = 150..        #
+0001d7d0: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
+0001d7e0: 6c65 6e67 7468 2e20 4d61 6b65 2073 7572  length. Make sur
+0001d7f0: 6520 6974 2773 2061 6e20 696e 742e 0a20  e it's an int.. 
+0001d800: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
+0001d810: 656e 203d 2034 3030 0a0a 2020 2020 2020  en = 400..      
+0001d820: 2020 2320 5769 7468 2061 6d61 6c67 616d    # With amalgam
+0001d830: 6174 696f 6e0a 2020 2020 2020 2020 6f76  ation.        ov
+0001d840: 6572 666c 6f77 5f61 6d61 6c67 616d 6174  erflow_amalgamat
+0001d850: 655f 7469 746c 6520 3d20 5472 7565 0a0a  e_title = True..
+0001d860: 2020 2020 2020 2020 2320 466f 7263 6520          # Force 
+0001d870: 7469 746c 6520 6469 7370 6c61 7965 6420  title displayed 
+0001d880: 6f6e 6365 0a20 2020 2020 2020 206f 7665  once.        ove
+0001d890: 7266 6c6f 775f 6469 7370 6c61 795f 7469  rflow_display_ti
+0001d8a0: 746c 655f 6f6e 6365 203d 2054 7275 650a  tle_once = True.
+0001d8b0: 0a20 2020 2020 2020 2064 6566 205f 5f69  .        def __i
+0001d8c0: 6e69 745f 5f28 7365 6c66 2c20 2a61 7267  nit__(self, *arg
+0001d8d0: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+0001d8e0: 2020 2020 2020 2020 2020 7375 7065 7228            super(
+0001d8f0: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7761  ).__init__(**kwa
+0001d900: 7267 7329 0a0a 2020 2020 2020 2020 6465  rgs)..        de
+0001d910: 6620 6e6f 7469 6679 2873 656c 662c 202a  f notify(self, *
+0001d920: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+0001d930: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
+0001d940: 7265 7465 6e64 2065 7665 7279 7468 696e  retend everythin
+0001d950: 6720 6973 206f 6b61 790a 2020 2020 2020  g is okay.      
+0001d960: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+0001d970: 650a 0a20 2020 2023 204c 6f61 6420 6f75  e..    # Load ou
+0001d980: 7220 6f62 6a65 6374 0a20 2020 206f 626a  r object.    obj
+0001d990: 203d 2054 6573 744e 6f74 6966 6963 6174   = TestNotificat
+0001d9a0: 696f 6e28 6f76 6572 666c 6f77 3d4f 7665  ion(overflow=Ove
+0001d9b0: 7266 6c6f 774d 6f64 652e 5350 4c49 5429  rflowMode.SPLIT)
+0001d9c0: 0a20 2020 2061 7373 6572 7420 6f62 6a20  .    assert obj 
+0001d9d0: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
+0001d9e0: 206e 6577 5f62 6f64 7920 3d20 2862 6f64   new_body = (bod
+0001d9f0: 7920 2a20 3530 3029 0a20 2020 2063 6875  y * 500).    chu
+0001da00: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+0001da10: 5f6f 7665 7266 6c6f 7728 626f 6479 3d22  _overflow(body="
+0001da20: 222c 2074 6974 6c65 3d74 6974 6c65 290a  ", title=title).
+0001da30: 2020 2020 6368 756e 6b73 203d 206f 626a      chunks = obj
+0001da40: 2e5f 6170 706c 795f 6f76 6572 666c 6f77  ._apply_overflow
+0001da50: 2862 6f64 793d 2222 2c20 7469 746c 653d  (body="", title=
+0001da60: 2222 290a 2020 2020 6368 756e 6b73 203d  "").    chunks =
+0001da70: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0001da80: 666c 6f77 2862 6f64 793d 6e65 775f 626f  flow(body=new_bo
+0001da90: 6479 2c20 7469 746c 653d 2222 290a 2020  dy, title="").  
+0001daa0: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+0001dab0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+0001dac0: 6f64 793d 6e65 775f 626f 6479 2c20 7469  ody=new_body, ti
+0001dad0: 746c 653d 7469 746c 6529 0a20 2020 206f  tle=title).    o
+0001dae0: 6666 7365 7420 3d20 300a 2020 2020 6173  ffset = 0.    as
+0001daf0: 7365 7274 206c 656e 2863 6875 6e6b 7329  sert len(chunks)
+0001db00: 203d 3d20 3132 3831 0a20 2020 2066 6f72   == 1281.    for
+0001db10: 2069 6478 2c20 6368 756e 6b20 696e 2065   idx, chunk in e
+0001db20: 6e75 6d65 7261 7465 2863 6875 6e6b 732c  numerate(chunks,
+0001db30: 2073 7461 7274 3d31 293a 0a20 2020 2020   start=1):.     
+0001db40: 2020 2023 2056 6572 6966 6963 6174 696f     # Verificatio
+0001db50: 6e0a 2020 2020 2020 2020 6173 7365 7274  n.        assert
+0001db60: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0001db70: 7469 746c 6527 2929 203c 3d20 6f62 6a2e  title')) <= obj.
+0001db80: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+0001db90: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0001dba0: 6368 756e 6b2e 6765 7428 2762 6f64 7927  chunk.get('body'
+0001dbb0: 2929 203c 3d20 6f62 6a2e 626f 6479 5f6d  )) <= obj.body_m
+0001dbc0: 6178 6c65 6e0a 0a20 2020 2020 2020 2023  axlen..        #
+0001dbd0: 204e 6f20 636f 756e 7465 7220 6973 2064   No counter is d
+0001dbe0: 6973 706c 6179 6564 2062 6563 6175 7365  isplayed because
+0001dbf0: 206f 7572 2074 6974 6c65 2069 7320 736f   our title is so
+0001dc00: 2065 6e6f 726d 6f75 730a 2020 2020 2020   enormous.      
+0001dc10: 2020 2320 5765 2073 7769 7463 6820 746f    # We switch to
+0001dc20: 2061 2064 6973 706c 6179 2074 6974 6c65   a display title
+0001dc30: 206f 6e20 6669 7273 7420 6d65 7373 6167   on first messag
+0001dc40: 6520 6f6e 6c79 0a20 2020 2020 2020 2069  e only.        i
+0001dc50: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+0001dc60: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+0001dc70: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+0001dc80: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+0001dc90: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+0001dca0: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+0001dcb0: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+0001dcc0: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+0001dcd0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001dce0: 5468 6520 6c65 6e67 7468 206f 6620 7468  The length of th
+0001dcf0: 6520 626f 6479 2070 7265 7661 696c 7320  e body prevails 
+0001dd00: 6f75 7220 7469 746c 6520 6475 6520 746f  our title due to
+0001dd10: 2069 7420 6265 696e 670a 2020 2020 2020   it being.      
+0001dd20: 2020 2020 2020 2320 736f 206d 7563 6820        # so much 
+0001dd30: 736d 616c 6c65 7220 7468 656e 206f 7572  smaller then our
+0001dd40: 2074 6974 6c65 206c 656e 6774 680a 2020   title length.  
+0001dd50: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0001dd60: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0001dd70: 7469 746c 6527 2929 203d 3d20 6f62 6a2e  title')) == obj.
+0001dd80: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+0001dd90: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001dda0: 7469 746c 655b 3a6f 626a 2e74 6974 6c65  title[:obj.title
+0001ddb0: 5f6d 6178 6c65 6e5d 203d 3d20 6368 756e  _maxlen] == chun
+0001ddc0: 6b2e 6765 7428 2774 6974 6c65 2729 0a0a  k.get('title')..
+0001ddd0: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
+0001dde0: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
+0001ddf0: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
+0001de00: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
+0001de10: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
+0001de20: 0a0a 2020 2020 2020 2020 2320 556e 2d75  ..        # Un-u
+0001de30: 7365 6420 7768 6974 6573 7061 6365 2069  sed whitespace i
+0001de40: 7320 616c 7761 7973 2063 6c65 616e 6564  s always cleaned
+0001de50: 2075 703b 206d 616b 6520 7375 7265 2077   up; make sure w
+0001de60: 6520 6163 636f 756e 7420 666f 720a 2020  e account for.  
+0001de70: 2020 2020 2020 2320 7468 6973 2069 6e20        # this in 
+0001de80: 6f75 7220 6e65 7720 6361 6c63 756c 6174  our new calculat
+0001de90: 696f 6e0a 2020 2020 2020 2020 7773 5f64  ion.        ws_d
+0001dea0: 6966 6620 3d20 6c65 6e28 6e65 775f 626f  iff = len(new_bo
+0001deb0: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+0001dec0: 626f 6479 2920 2b20 6f66 6673 6574 5d29  body) + offset])
+0001ded0: 202d 205c 0a20 2020 2020 2020 2020 2020   - \.           
+0001dee0: 206c 656e 286e 6577 5f62 6f64 795b 6f66   len(new_body[of
+0001def0: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+0001df00: 202b 206f 6666 7365 745d 0a20 2020 2020   + offset].     
+0001df10: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+0001df20: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+0001df30: 2729 2e72 7374 7269 7028 2929 0a0a 2020  ').rstrip())..  
+0001df40: 2020 2020 2020 6173 7365 7274 206e 6577        assert new
+0001df50: 5f62 6f64 795b 6f66 6673 6574 3a20 6c65  _body[offset: le
+0001df60: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
+0001df70: 7420 2b20 7773 5f64 6966 665d 5c0a 2020  t + ws_diff]\.  
+0001df80: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
+0001df90: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
+0001dfa0: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
+0001dfb0: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
+0001dfc0: 6574 202b 3d20 286c 656e 285f 626f 6479  et += (len(_body
+0001dfd0: 2920 2b20 7773 5f64 6966 6629 0a0a 2020  ) + ws_diff)..  
+0001dfe0: 2020 2320 426f 6479 2063 6875 6e6b 2069    # Body chunk i
+0001dff0: 7320 6265 796f 6e64 2034 2064 6967 6974  s beyond 4 digit
+0001e000: 732c 2073 6f20 5b58 5858 582f 5858 5858  s, so [XXXX/XXXX
+0001e010: 5d20 6973 2074 7572 6e65 6420 6f66 660a  ] is turned off.
+0001e020: 2020 2020 6e65 775f 626f 6479 203d 2028      new_body = (
+0001e030: 626f 6479 202a 2032 3530 3029 0a20 2020  body * 2500).   
+0001e040: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+0001e050: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+0001e060: 6479 3d22 222c 2074 6974 6c65 3d74 6974  dy="", title=tit
+0001e070: 6c65 290a 2020 2020 6368 756e 6b73 203d  le).    chunks =
+0001e080: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0001e090: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+0001e0a0: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+0001e0b0: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+0001e0c0: 6f76 6572 666c 6f77 2862 6f64 793d 6e65  overflow(body=ne
+0001e0d0: 775f 626f 6479 2c20 7469 746c 653d 2222  w_body, title=""
+0001e0e0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+0001e0f0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+0001e100: 6f77 2862 6f64 793d 6e65 775f 626f 6479  ow(body=new_body
+0001e110: 2c20 7469 746c 653d 7469 746c 6529 0a20  , title=title). 
+0001e120: 2020 206f 6666 7365 7420 3d20 300a 2020     offset = 0.  
+0001e130: 2020 6173 7365 7274 206c 656e 2863 6875    assert len(chu
+0001e140: 6e6b 7329 203d 3d20 3634 3031 0a20 2020  nks) == 6401.   
+0001e150: 2066 6f72 2069 6478 2c20 6368 756e 6b20   for idx, chunk 
+0001e160: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
+0001e170: 6e6b 732c 2073 7461 7274 3d31 293a 0a20  nks, start=1):. 
+0001e180: 2020 2020 2020 2023 2056 6572 6966 6963         # Verific
+0001e190: 6174 696f 6e0a 2020 2020 2020 2020 6173  ation.        as
+0001e1a0: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
+0001e1b0: 6574 2827 7469 746c 6527 2929 203c 3d20  et('title')) <= 
+0001e1c0: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+0001e1d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001e1e0: 6c65 6e28 6368 756e 6b2e 6765 7428 2762  len(chunk.get('b
+0001e1f0: 6f64 7927 2929 203c 3d20 6f62 6a2e 626f  ody')) <= obj.bo
+0001e200: 6479 5f6d 6178 6c65 6e0a 0a20 2020 2020  dy_maxlen..     
+0001e210: 2020 2023 204e 6f20 636f 756e 7465 7220     # No counter 
+0001e220: 6973 2064 6973 706c 6179 6564 2062 6563  is displayed bec
+0001e230: 6175 7365 206f 7572 2074 6974 6c65 2069  ause our title i
+0001e240: 7320 736f 2065 6e6f 726d 6f75 730a 2020  s so enormous.  
+0001e250: 2020 2020 2020 2320 5765 2073 7769 7463        # We switc
+0001e260: 6820 746f 2061 2064 6973 706c 6179 2074  h to a display t
+0001e270: 6974 6c65 206f 6e20 6669 7273 7420 6d65  itle on first me
+0001e280: 7373 6167 6520 6f6e 6c79 0a20 2020 2020  ssage only.     
+0001e290: 2020 2069 6620 6964 7820 3e20 313a 0a20     if idx > 1:. 
+0001e2a0: 2020 2020 2020 2020 2020 2023 2045 6d70             # Emp
+0001e2b0: 7479 2028 6e6f 2074 6974 6c65 2064 6973  ty (no title dis
+0001e2c0: 706c 6179 6564 206f 6e20 666f 6c6c 6f77  played on follow
+0001e2d0: 696e 6720 656e 7472 6965 730a 2020 2020  ing entries.    
+0001e2e0: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
+0001e2f0: 6875 6e6b 2e67 6574 2827 7469 746c 6527  hunk.get('title'
+0001e300: 2920 3d3d 2022 220a 2020 2020 2020 2020  ) == "".        
+0001e310: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001e320: 2020 2320 5468 6520 6c65 6e67 7468 206f    # The length o
+0001e330: 6620 7468 6520 626f 6479 2070 7265 7661  f the body preva
+0001e340: 696c 7320 6f75 7220 7469 746c 6520 6475  ils our title du
+0001e350: 6520 746f 2069 7420 6265 696e 670a 2020  e to it being.  
+0001e360: 2020 2020 2020 2020 2020 2320 736f 206d            # so m
+0001e370: 7563 6820 736d 616c 6c65 7220 7468 656e  uch smaller then
+0001e380: 206f 7572 2074 6974 6c65 206c 656e 6774   our title lengt
+0001e390: 680a 2020 2020 2020 2020 2020 2020 6173  h.            as
+0001e3a0: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
+0001e3b0: 6574 2827 7469 746c 6527 2929 203d 3d20  et('title')) == 
+0001e3c0: 6f62 6a2e 7469 746c 655f 6d61 786c 656e  obj.title_maxlen
+0001e3d0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+0001e3e0: 6572 7420 7469 746c 655b 3a6f 626a 2e74  ert title[:obj.t
+0001e3f0: 6974 6c65 5f6d 6178 6c65 6e5d 203d 3d20  itle_maxlen] == 
+0001e400: 6368 756e 6b2e 6765 7428 2774 6974 6c65  chunk.get('title
+0001e410: 2729 0a0a 2020 2020 2020 2020 2320 4f75  ')..        # Ou
+0001e420: 7220 626f 6479 2069 7320 6f6e 6c79 2062  r body is only b
+0001e430: 726f 6b65 6e20 7570 3b20 6e6f 7420 6c6f  roken up; not lo
+0001e440: 7374 0a20 2020 2020 2020 205f 626f 6479  st.        _body
+0001e450: 203d 2063 6875 6e6b 2e67 6574 2827 626f   = chunk.get('bo
+0001e460: 6479 2729 0a0a 2020 2020 2020 2020 2320  dy')..        # 
+0001e470: 556e 2d75 7365 6420 7768 6974 6573 7061  Un-used whitespa
+0001e480: 6365 2069 7320 616c 7761 7973 2063 6c65  ce is always cle
+0001e490: 616e 6564 2075 703b 206d 616b 6520 7375  aned up; make su
+0001e4a0: 7265 2077 6520 6163 636f 756e 7420 666f  re we account fo
+0001e4b0: 720a 2020 2020 2020 2020 2320 7468 6973  r.        # this
+0001e4c0: 2069 6e20 6f75 7220 6e65 7720 6361 6c63   in our new calc
+0001e4d0: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
+0001e4e0: 7773 5f64 6966 6620 3d20 6c65 6e28 6e65  ws_diff = len(ne
+0001e4f0: 775f 626f 6479 5b6f 6666 7365 743a 206c  w_body[offset: l
+0001e500: 656e 285f 626f 6479 2920 2b20 6f66 6673  en(_body) + offs
+0001e510: 6574 5d29 202d 205c 0a20 2020 2020 2020  et]) - \.       
+0001e520: 2020 2020 206c 656e 286e 6577 5f62 6f64       len(new_bod
+0001e530: 795b 6f66 6673 6574 3a20 6c65 6e28 5f62  y[offset: len(_b
+0001e540: 6f64 7929 202b 206f 6666 7365 745d 0a20  ody) + offset]. 
+0001e550: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+0001e560: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
+0001e570: 5c78 3063 2729 2e72 7374 7269 7028 2929  \x0c').rstrip())
+0001e580: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+0001e590: 206e 6577 5f62 6f64 795b 6f66 6673 6574   new_body[offset
+0001e5a0: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+0001e5b0: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
+0001e5c0: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
+0001e5d0: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
+0001e5e0: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
+0001e5f0: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
+0001e600: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
+0001e610: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
+0001e620: 0a0a 2020 2020 2320 5465 7374 206c 6172  ..    # Test lar
+0001e630: 6765 7220 6d65 7373 6167 6573 0a20 2020  ger messages.   
+0001e640: 2023 2061 6e64 2074 6861 7420 7468 6520   # and that the 
+0001e650: 626f 6479 2072 656d 6169 6e73 2075 6e74  body remains unt
+0001e660: 6f75 6368 6564 0a20 2020 2063 6c61 7373  ouched.    class
+0001e670: 2054 6573 744e 6f74 6966 6963 6174 696f   TestNotificatio
+0001e680: 6e28 4e6f 7469 6679 4261 7365 293a 0a0a  n(NotifyBase):..
+0001e690: 2020 2020 2020 2020 2320 5465 7374 2074          # Test t
+0001e6a0: 6974 6c65 206d 6178 206c 656e 6774 680a  itle max length.
+0001e6b0: 2020 2020 2020 2020 7469 746c 655f 6d61          title_ma
+0001e6c0: 786c 656e 203d 2031 3530 0a0a 2020 2020  xlen = 150..    
+0001e6d0: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
+0001e6e0: 626f 6479 206c 656e 6774 682e 204d 616b  body length. Mak
+0001e6f0: 6520 7375 7265 2069 7427 7320 616e 2069  e sure it's an i
+0001e700: 6e74 2e0a 2020 2020 2020 2020 626f 6479  nt..        body
+0001e710: 5f6d 6178 6c65 6e20 3d20 3135 300a 0a20  _maxlen = 150.. 
+0001e720: 2020 2020 2020 2023 2057 6974 6820 616d         # With am
+0001e730: 616c 6761 6d61 7469 6f6e 0a20 2020 2020  algamation.     
+0001e740: 2020 206f 7665 7266 6c6f 775f 616d 616c     overflow_amal
+0001e750: 6761 6d61 7465 5f74 6974 6c65 203d 2054  gamate_title = T
+0001e760: 7275 650a 0a20 2020 2020 2020 2023 2046  rue..        # F
+0001e770: 6f72 6365 2074 6974 6c65 2064 6973 706c  orce title displ
+0001e780: 6179 6564 206f 6e63 650a 2020 2020 2020  ayed once.      
+0001e790: 2020 6f76 6572 666c 6f77 5f64 6973 706c    overflow_displ
+0001e7a0: 6179 5f74 6974 6c65 5f6f 6e63 6520 3d20  ay_title_once = 
+0001e7b0: 5472 7565 0a0a 2020 2020 2020 2020 6465  True..        de
+0001e7c0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+0001e7d0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+0001e7e0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+0001e7f0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+0001e800: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
+0001e810: 2020 2064 6566 206e 6f74 6966 7928 7365     def notify(se
+0001e820: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+0001e830: 7267 7329 3a0a 2020 2020 2020 2020 2020  rgs):.          
+0001e840: 2020 2320 5072 6574 656e 6420 6576 6572    # Pretend ever
+0001e850: 7974 6869 6e67 2069 7320 6f6b 6179 0a20  ything is okay. 
+0001e860: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001e870: 6e20 5472 7565 0a0a 2020 2020 2320 4c6f  n True..    # Lo
+0001e880: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
+0001e890: 2020 6f62 6a20 3d20 5465 7374 4e6f 7469    obj = TestNoti
+0001e8a0: 6669 6361 7469 6f6e 286f 7665 7266 6c6f  fication(overflo
+0001e8b0: 773d 4f76 6572 666c 6f77 4d6f 6465 2e53  w=OverflowMode.S
+0001e8c0: 504c 4954 290a 2020 2020 6173 7365 7274  PLIT).    assert
+0001e8d0: 206f 626a 2069 7320 6e6f 7420 4e6f 6e65   obj is not None
+0001e8e0: 0a0a 2020 2020 6e65 775f 626f 6479 203d  ..    new_body =
+0001e8f0: 2028 626f 6479 202a 2035 290a 2020 2020   (body * 5).    
+0001e900: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+0001e910: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+0001e920: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
+0001e930: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
+0001e940: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+0001e950: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
+0001e960: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+0001e970: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+0001e980: 7665 7266 6c6f 7728 626f 6479 3d6e 6577  verflow(body=new
+0001e990: 5f62 6f64 792c 2074 6974 6c65 3d22 2229  _body, title="")
+0001e9a0: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+0001e9b0: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+0001e9c0: 7728 626f 6479 3d6e 6577 5f62 6f64 792c  w(body=new_body,
+0001e9d0: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+0001e9e0: 2020 6f66 6673 6574 203d 2030 0a20 2020    offset = 0.   
+0001e9f0: 2061 7373 6572 7420 6c65 6e28 6368 756e   assert len(chun
+0001ea00: 6b73 2920 3d3d 2033 360a 2020 2020 666f  ks) == 36.    fo
+0001ea10: 7220 6964 782c 2063 6875 6e6b 2069 6e20  r idx, chunk in 
+0001ea20: 656e 756d 6572 6174 6528 6368 756e 6b73  enumerate(chunks
+0001ea30: 2c20 7374 6172 743d 3129 3a0a 2020 2020  , start=1):.    
+0001ea40: 2020 2020 2320 5665 7269 6669 6361 7469      # Verificati
+0001ea50: 6f6e 0a20 2020 2020 2020 2061 7373 6572  on.        asser
+0001ea60: 7420 6c65 6e28 6368 756e 6b2e 6765 7428  t len(chunk.get(
+0001ea70: 2774 6974 6c65 2729 2920 3c3d 206f 626a  'title')) <= obj
+0001ea80: 2e74 6974 6c65 5f6d 6178 6c65 6e0a 2020  .title_maxlen.  
+0001ea90: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0001eaa0: 2863 6875 6e6b 2e67 6574 2827 626f 6479  (chunk.get('body
+0001eab0: 2729 2920 3c3d 206f 626a 2e62 6f64 795f  ')) <= obj.body_
+0001eac0: 6d61 786c 656e 0a0a 2020 2020 2020 2020  maxlen..        
+0001ead0: 2320 4f75 7220 7469 746c 6520 6861 7320  # Our title has 
+0001eae0: 6e6f 2063 6f75 6e74 6572 2061 6464 6564  no counter added
+0001eaf0: 2074 6f20 6974 0a20 2020 2020 2020 2069   to it.        i
+0001eb00: 6620 6964 7820 3e20 313a 0a20 2020 2020  f idx > 1:.     
+0001eb10: 2020 2020 2020 2023 2045 6d70 7479 2028         # Empty (
+0001eb20: 6e6f 2074 6974 6c65 2064 6973 706c 6179  no title display
+0001eb30: 6564 206f 6e20 666f 6c6c 6f77 696e 6720  ed on following 
+0001eb40: 656e 7472 6965 730a 2020 2020 2020 2020  entries.        
+0001eb50: 2020 2020 6173 7365 7274 2063 6875 6e6b      assert chunk
+0001eb60: 2e67 6574 2827 7469 746c 6527 2920 3d3d  .get('title') ==
+0001eb70: 2022 220a 2020 2020 2020 2020 656c 7365   "".        else
+0001eb80: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001eb90: 4265 6361 7573 6520 3135 3020 6973 2077  Because 150 is w
+0001eba0: 6861 7420 7765 2073 6574 2074 6865 2074  hat we set the t
+0001ebb0: 6974 6c65 206c 696d 6974 2074 6f0a 2020  itle limit to.  
+0001ebc0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0001ebd0: 206c 656e 2863 6875 6e6b 2e67 6574 2827   len(chunk.get('
+0001ebe0: 7469 746c 6527 2929 203d 3d20 6f62 6a2e  title')) == obj.
+0001ebf0: 7469 746c 655f 6d61 786c 656e 0a20 2020  title_maxlen.   
+0001ec00: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001ec10: 7469 746c 655b 3a6f 626a 2e74 6974 6c65  title[:obj.title
+0001ec20: 5f6d 6178 6c65 6e5d 203d 3d20 6368 756e  _maxlen] == chun
+0001ec30: 6b2e 6765 7428 2774 6974 6c65 2729 0a0a  k.get('title')..
+0001ec40: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
+0001ec50: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
+0001ec60: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
+0001ec70: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
+0001ec80: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
+0001ec90: 0a0a 2020 2020 2020 2020 2320 556e 2d75  ..        # Un-u
+0001eca0: 7365 6420 7768 6974 6573 7061 6365 2069  sed whitespace i
+0001ecb0: 7320 616c 7761 7973 2063 6c65 616e 6564  s always cleaned
+0001ecc0: 2075 703b 206d 616b 6520 7375 7265 2077   up; make sure w
+0001ecd0: 6520 6163 636f 756e 7420 666f 720a 2020  e account for.  
+0001ece0: 2020 2020 2020 2320 7468 6973 2069 6e20        # this in 
+0001ecf0: 6f75 7220 6e65 7720 6361 6c63 756c 6174  our new calculat
+0001ed00: 696f 6e0a 2020 2020 2020 2020 7773 5f64  ion.        ws_d
+0001ed10: 6966 6620 3d20 6c65 6e28 6e65 775f 626f  iff = len(new_bo
+0001ed20: 6479 5b6f 6666 7365 743a 206c 656e 285f  dy[offset: len(_
+0001ed30: 626f 6479 2920 2b20 6f66 6673 6574 5d29  body) + offset])
+0001ed40: 202d 205c 0a20 2020 2020 2020 2020 2020   - \.           
+0001ed50: 206c 656e 286e 6577 5f62 6f64 795b 6f66   len(new_body[of
+0001ed60: 6673 6574 3a20 6c65 6e28 5f62 6f64 7929  fset: len(_body)
+0001ed70: 202b 206f 6666 7365 745d 0a20 2020 2020   + offset].     
+0001ed80: 2020 2020 2020 2020 2020 202e 6c73 7472             .lstr
+0001ed90: 6970 2827 5c72 5c6e 5c78 3062 5c78 3063  ip('\r\n\x0b\x0c
+0001eda0: 2729 2e72 7374 7269 7028 2929 0a0a 2020  ').rstrip())..  
+0001edb0: 2020 2020 2020 6173 7365 7274 206e 6577        assert new
+0001edc0: 5f62 6f64 795b 6f66 6673 6574 3a20 6c65  _body[offset: le
+0001edd0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
+0001ede0: 7420 2b20 7773 5f64 6966 665d 5c0a 2020  t + ws_diff]\.  
+0001edf0: 2020 2020 2020 2020 2020 2e6c 7374 7269            .lstri
+0001ee00: 7028 275c 725c 6e5c 7830 625c 7830 6327  p('\r\n\x0b\x0c'
+0001ee10: 292e 7273 7472 6970 2829 203d 3d20 5f62  ).rstrip() == _b
+0001ee20: 6f64 790a 2020 2020 2020 2020 6f66 6673  ody.        offs
+0001ee30: 6574 202b 3d20 286c 656e 285f 626f 6479  et += (len(_body
+0001ee40: 2920 2b20 7773 5f64 6966 6629 0a0a 2020  ) + ws_diff)..  
+0001ee50: 2020 230a 2020 2020 2320 4e65 7874 2054    #.    # Next T
+0001ee60: 6573 743a 2041 7070 656e 6420 7469 746c  est: Append titl
+0001ee70: 6520 746f 2062 6f64 7920 2b20 7370 6c69  e to body + spli
+0001ee80: 7420 626f 6479 0a20 2020 2023 0a0a 2020  t body.    #..  
+0001ee90: 2020 636c 6173 7320 5465 7374 4e6f 7469    class TestNoti
+0001eea0: 6669 6361 7469 6f6e 284e 6f74 6966 7942  fication(NotifyB
+0001eeb0: 6173 6529 3a0a 0a20 2020 2020 2020 2023  ase):..        #
+0001eec0: 2045 6e66 6f72 6365 206e 6f20 7469 746c   Enforce no titl
+0001eed0: 650a 2020 2020 2020 2020 7469 746c 655f  e.        title_
+0001eee0: 6d61 786c 656e 203d 2030 0a0a 2020 2020  maxlen = 0..    
+0001eef0: 2020 2020 2320 456e 666f 7263 6520 6120      # Enforce a 
+0001ef00: 626f 6479 206c 656e 6774 6820 6261 7365  body length base
+0001ef10: 6420 6f6e 2074 6865 2074 6974 6c65 2e20  d on the title. 
+0001ef20: 4d61 6b65 2073 7572 6520 6974 2773 2061  Make sure it's a
+0001ef30: 6e20 696e 742e 0a20 2020 2020 2020 2062  n int..        b
+0001ef40: 6f64 795f 6d61 786c 656e 203d 2069 6e74  ody_maxlen = int
+0001ef50: 2874 6974 6c65 5f6c 656e 202f 2034 290a  (title_len / 4).
+0001ef60: 0a20 2020 2020 2020 2023 2057 6974 6820  .        # With 
+0001ef70: 616d 616c 6761 6d61 7469 6f6e 0a20 2020  amalgamation.   
+0001ef80: 2020 2020 206f 7665 7266 6c6f 775f 616d       overflow_am
+0001ef90: 616c 6761 6d61 7465 5f74 6974 6c65 203d  algamate_title =
+0001efa0: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
+0001efb0: 2046 6f72 6365 2074 6974 6c65 2064 6973   Force title dis
+0001efc0: 706c 6179 6564 206f 6e63 650a 2020 2020  played once.    
+0001efd0: 2020 2020 6f76 6572 666c 6f77 5f64 6973      overflow_dis
+0001efe0: 706c 6179 5f74 6974 6c65 5f6f 6e63 6520  play_title_once 
+0001eff0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+0001f000: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+0001f010: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+0001f020: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
+0001f030: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+0001f040: 5f28 2a2a 6b77 6172 6773 290a 0a20 2020  _(**kwargs)..   
+0001f050: 2020 2020 2064 6566 206e 6f74 6966 7928       def notify(
+0001f060: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+0001f070: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+0001f080: 2020 2020 2320 5072 6574 656e 6420 6576      # Pretend ev
+0001f090: 6572 7974 6869 6e67 2069 7320 6f6b 6179  erything is okay
+0001f0a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001f0b0: 7572 6e20 5472 7565 0a0a 2020 2020 2320  urn True..    # 
+0001f0c0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+0001f0d0: 2020 2020 6f62 6a20 3d20 5465 7374 4e6f      obj = TestNo
+0001f0e0: 7469 6669 6361 7469 6f6e 286f 7665 7266  tification(overf
+0001f0f0: 6c6f 773d 4f76 6572 666c 6f77 4d6f 6465  low=OverflowMode
+0001f100: 2e53 504c 4954 290a 2020 2020 6173 7365  .SPLIT).    asse
+0001f110: 7274 206f 626a 2069 7320 6e6f 7420 4e6f  rt obj is not No
+0001f120: 6e65 0a0a 2020 2020 2320 5665 7269 6679  ne..    # Verify
+0001f130: 2074 6861 7420 7765 2062 7265 616b 2074   that we break t
+0001f140: 6865 2074 6974 6c65 2074 6f20 6120 6d61  he title to a ma
+0001f150: 7820 6c65 6e67 7468 206f 6620 6f75 7220  x length of our 
+0001f160: 7469 746c 655f 6d61 780a 2020 2020 2320  title_max.    # 
+0001f170: 616e 6420 7468 6174 2074 6865 2062 6f64  and that the bod
+0001f180: 7920 7265 6d61 696e 7320 756e 746f 7563  y remains untouc
+0001f190: 6865 640a 2020 2020 6368 756e 6b73 203d  hed.    chunks =
+0001f1a0: 206f 626a 2e5f 6170 706c 795f 6f76 6572   obj._apply_over
+0001f1b0: 666c 6f77 2862 6f64 793d 2222 2c20 7469  flow(body="", ti
+0001f1c0: 746c 653d 7469 746c 6529 0a20 2020 2063  tle=title).    c
+0001f1d0: 6875 6e6b 7320 3d20 6f62 6a2e 5f61 7070  hunks = obj._app
+0001f1e0: 6c79 5f6f 7665 7266 6c6f 7728 626f 6479  ly_overflow(body
+0001f1f0: 3d22 222c 2074 6974 6c65 3d22 2229 0a20  ="", title=""). 
+0001f200: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+0001f210: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+0001f220: 626f 6479 3d62 6f64 792c 2074 6974 6c65  body=body, title
+0001f230: 3d22 2229 0a20 2020 2063 6875 6e6b 7320  ="").    chunks 
+0001f240: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+0001f250: 7266 6c6f 7728 626f 6479 3d62 6f64 792c  rflow(body=body,
+0001f260: 2074 6974 6c65 3d74 6974 6c65 290a 0a20   title=title).. 
+0001f270: 2020 2023 204f 7572 2066 696e 616c 2070     # Our final p
+0001f280: 726f 6475 6374 2069 7320 7468 6174 206f  roduct is that o
+0001f290: 7572 2074 6974 6c65 2068 6173 2062 6565  ur title has bee
+0001f2a0: 6e20 6170 7065 6e64 6564 2074 6f20 6f75  n appended to ou
+0001f2b0: 7220 626f 6479 2074 6f0a 2020 2020 2320  r body to.    # 
+0001f2c0: 6372 6561 7465 206f 6e65 2067 7265 6174  create one great
+0001f2d0: 2062 6967 2062 6f64 792e 2041 7320 6120   big body. As a 
+0001f2e0: 7265 7375 6c74 2077 6527 6c6c 2067 6574  result we'll get
+0001f2f0: 2071 7569 7465 2061 2066 6577 206c 696e   quite a few lin
+0001f300: 6573 2062 6163 6b0a 2020 2020 2320 6e6f  es back.    # no
+0001f310: 772e 0a20 2020 206f 6666 7365 7420 3d20  w..    offset = 
+0001f320: 300a 0a20 2020 2023 204f 7572 2062 6f64  0..    # Our bod
+0001f330: 7920 7769 6c6c 206c 6f6f 6b20 6c69 6b65  y will look like
+0001f340: 2074 6869 7320 696e 2073 6d61 6c6c 2063   this in small c
+0001f350: 6875 6e6b 7320 6174 2074 6865 2065 6e64  hunks at the end
+0001f360: 206f 6620 7468 6520 6461 790a 2020 2020   of the day.    
+0001f370: 6275 6c6b 203d 2074 6974 6c65 202b 2027  bulk = title + '
+0001f380: 5c72 5c6e 2720 2b20 626f 6479 0a0a 2020  \r\n' + body..  
+0001f390: 2020 2320 4475 6520 746f 2074 6865 206e    # Due to the n
+0001f3a0: 6577 206c 696e 6520 6164 6465 6420 746f  ew line added to
+0001f3b0: 2074 6865 2065 6e64 0a20 2020 2061 7373   the end.    ass
+0001f3c0: 6572 7420 6c65 6e28 6368 756e 6b73 2920  ert len(chunks) 
+0001f3d0: 3d3d 2028 0a20 2020 2020 2020 2023 2077  == (.        # w
+0001f3e0: 7261 7020 6469 7669 7369 6f6e 2069 6e20  rap division in 
+0001f3f0: 696e 7428 2920 736f 2050 7974 686f 6e20  int() so Python 
+0001f400: 3320 646f 6573 6e27 7420 636f 6e76 6572  3 doesn't conver
+0001f410: 7420 6974 2074 6f20 6120 666c 6f61 7420  t it to a float 
+0001f420: 6f6e 0a20 2020 2020 2020 2023 2075 730a  on.        # us.
+0001f430: 2020 2020 2020 2020 696e 7428 6c65 6e28          int(len(
+0001f440: 6275 6c6b 2920 2f20 6f62 6a2e 626f 6479  bulk) / obj.body
+0001f450: 5f6d 6178 6c65 6e29 202b 0a20 2020 2020  _maxlen) +.     
+0001f460: 2020 2028 3120 6966 206c 656e 2862 756c     (1 if len(bul
+0001f470: 6b29 2025 206f 626a 2e62 6f64 795f 6d61  k) % obj.body_ma
+0001f480: 786c 656e 2065 6c73 6520 3029 290a 0a20  xlen else 0)).. 
+0001f490: 2020 2066 6f72 2063 6875 6e6b 2069 6e20     for chunk in 
+0001f4a0: 6368 756e 6b73 3a0a 2020 2020 2020 2020  chunks:.        
+0001f4b0: 2320 5665 7269 6669 6361 7469 6f6e 0a20  # Verification. 
+0001f4c0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0001f4d0: 6e28 6368 756e 6b2e 6765 7428 2774 6974  n(chunk.get('tit
+0001f4e0: 6c65 2729 2920 3d3d 2030 0a20 2020 2020  le')) == 0.     
+0001f4f0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+0001f500: 756e 6b2e 6765 7428 2762 6f64 7927 2929  unk.get('body'))
+0001f510: 203c 3d20 6f62 6a2e 626f 6479 5f6d 6178   <= obj.body_max
+0001f520: 6c65 6e0a 0a20 2020 2020 2020 2023 204f  len..        # O
+0001f530: 7572 2074 6974 6c65 2069 7320 656d 7074  ur title is empt
+0001f540: 7920 6576 6572 7920 7469 6d65 0a20 2020  y every time.   
+0001f550: 2020 2020 2061 7373 6572 7420 6368 756e       assert chun
+0001f560: 6b2e 6765 7428 2774 6974 6c65 2729 203d  k.get('title') =
+0001f570: 3d20 2727 0a20 2020 2020 2020 2023 204f  = ''.        # O
+0001f580: 7572 2062 6f64 7920 6973 206f 6e6c 7920  ur body is only 
+0001f590: 6272 6f6b 656e 2075 703b 206e 6f74 206c  broken up; not l
+0001f5a0: 6f73 740a 2020 2020 2020 2020 5f62 6f64  ost.        _bod
+0001f5b0: 7920 3d20 6368 756e 6b2e 6765 7428 2762  y = chunk.get('b
+0001f5c0: 6f64 7927 290a 0a20 2020 2020 2020 2023  ody')..        #
+0001f5d0: 2055 6e2d 7573 6564 2077 6869 7465 7370   Un-used whitesp
+0001f5e0: 6163 6520 6973 2061 6c77 6179 7320 636c  ace is always cl
+0001f5f0: 6561 6e65 6420 7570 3b20 6d61 6b65 2073  eaned up; make s
+0001f600: 7572 6520 7765 2061 6363 6f75 6e74 2066  ure we account f
+0001f610: 6f72 0a20 2020 2020 2020 2023 2074 6869  or.        # thi
+0001f620: 7320 696e 206f 7572 206e 6577 2063 616c  s in our new cal
+0001f630: 6375 6c61 7469 6f6e 0a20 2020 2020 2020  culation.       
+0001f640: 2077 735f 6469 6666 203d 206c 656e 2862   ws_diff = len(b
+0001f650: 756c 6b5b 6f66 6673 6574 3a20 6c65 6e28  ulk[offset: len(
+0001f660: 5f62 6f64 7929 202b 206f 6666 7365 745d  _body) + offset]
+0001f670: 2920 2d20 5c0a 2020 2020 2020 2020 2020  ) - \.          
+0001f680: 2020 6c65 6e28 6275 6c6b 5b6f 6666 7365    len(bulk[offse
+0001f690: 743a 206c 656e 285f 626f 6479 2920 2b20  t: len(_body) + 
+0001f6a0: 6f66 6673 6574 5d0a 2020 2020 2020 2020  offset].        
+0001f6b0: 2020 2020 2020 2020 2e6c 7374 7269 7028          .lstrip(
+0001f6c0: 275c 725c 6e5c 7830 625c 7830 6327 292e  '\r\n\x0b\x0c').
+0001f6d0: 7273 7472 6970 2829 290a 0a20 2020 2020  rstrip())..     
+0001f6e0: 2020 2061 7373 6572 7420 6275 6c6b 5b6f     assert bulk[o
+0001f6f0: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+0001f700: 2920 2b20 6f66 6673 6574 202b 2077 735f  ) + offset + ws_
+0001f710: 6469 6666 5d5c 0a20 2020 2020 2020 2020  diff]\.         
+0001f720: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
+0001f730: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+0001f740: 7028 2920 3d3d 205f 626f 6479 0a20 2020  p() == _body.   
+0001f750: 2020 2020 206f 6666 7365 7420 2b3d 2028       offset += (
+0001f760: 6c65 6e28 5f62 6f64 7929 202b 2077 735f  len(_body) + ws_
+0001f770: 6469 6666 290a 0a20 2020 2023 0a20 2020  diff)..    #.   
+0001f780: 2023 2054 6573 7420 6361 7365 2077 6865   # Test case whe
+0001f790: 7265 206f 7572 2074 6974 6c65 5f6c 656e  re our title_len
+0001f7a0: 2069 7320 7368 6f72 7465 7220 7468 656e   is shorter then
+0001f7b0: 2074 6865 2076 616c 7565 0a20 2020 2023   the value.    #
+0001f7c0: 2074 6861 7420 776f 756c 6420 6f74 6865   that would othe
+0001f7d0: 7277 6973 6520 7472 6967 6765 7220 7468  rwise trigger th
+0001f7e0: 6520 5b58 582f 5858 5d20 656c 656d 656e  e [XX/XX] elemen
+0001f7f0: 7473 0a20 2020 2023 0a0a 2020 2020 636c  ts.    #..    cl
+0001f800: 6173 7320 5465 7374 4e6f 7469 6669 6361  ass TestNotifica
+0001f810: 7469 6f6e 284e 6f74 6966 7942 6173 6529  tion(NotifyBase)
+0001f820: 3a0a 0a20 2020 2020 2020 2023 2053 6574  :..        # Set
+0001f830: 2061 2073 6d61 6c6c 2074 6974 6c65 206c   a small title l
+0001f840: 656e 6774 680a 2020 2020 2020 2020 7469  ength.        ti
+0001f850: 746c 655f 6d61 786c 656e 203d 2031 3030  tle_maxlen = 100
+0001f860: 0a0a 2020 2020 2020 2020 2320 456e 666f  ..        # Enfo
+0001f870: 7263 6520 6120 626f 6479 206c 656e 6774  rce a body lengt
+0001f880: 682e 204d 616b 6520 7375 7265 2069 7427  h. Make sure it'
+0001f890: 7320 616e 2069 6e74 2e0a 2020 2020 2020  s an int..      
+0001f8a0: 2020 626f 6479 5f6d 6178 6c65 6e20 3d20    body_maxlen = 
+0001f8b0: 696e 7428 626f 6479 5f6c 656e 202f 2034  int(body_len / 4
+0001f8c0: 290a 0a20 2020 2020 2020 2023 2057 6974  )..        # Wit
+0001f8d0: 6820 616d 616c 6761 6d61 7469 6f6e 0a20  h amalgamation. 
+0001f8e0: 2020 2020 2020 206f 7665 7266 6c6f 775f         overflow_
+0001f8f0: 616d 616c 6761 6d61 7465 5f74 6974 6c65  amalgamate_title
+0001f900: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+0001f910: 2023 2046 6f72 6365 2074 6974 6c65 2064   # Force title d
+0001f920: 6973 706c 6179 6564 206f 6e63 650a 2020  isplayed once.  
+0001f930: 2020 2020 2020 6f76 6572 666c 6f77 5f64        overflow_d
+0001f940: 6973 706c 6179 5f74 6974 6c65 5f6f 6e63  isplay_title_onc
+0001f950: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+0001f960: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0001f970: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+0001f980: 6172 6773 293a 0a20 2020 2020 2020 2020  args):.         
+0001f990: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
+0001f9a0: 745f 5f28 2a2a 6b77 6172 6773 290a 0a20  t__(**kwargs).. 
+0001f9b0: 2020 2020 2020 2064 6566 206e 6f74 6966         def notif
+0001f9c0: 7928 7365 6c66 2c20 2a61 7267 732c 202a  y(self, *args, *
+0001f9d0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+0001f9e0: 2020 2020 2020 2320 5072 6574 656e 6420        # Pretend 
+0001f9f0: 6576 6572 7974 6869 6e67 2069 7320 6f6b  everything is ok
+0001fa00: 6179 0a20 2020 2020 2020 2020 2020 2072  ay.            r
+0001fa10: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+0001fa20: 2320 4c6f 6164 206f 7572 206f 626a 6563  # Load our objec
+0001fa30: 740a 2020 2020 6f62 6a20 3d20 5465 7374  t.    obj = Test
+0001fa40: 4e6f 7469 6669 6361 7469 6f6e 286f 7665  Notification(ove
+0001fa50: 7266 6c6f 773d 4f76 6572 666c 6f77 4d6f  rflow=OverflowMo
+0001fa60: 6465 2e53 504c 4954 290a 2020 2020 6173  de.SPLIT).    as
+0001fa70: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
+0001fa80: 4e6f 6e65 0a0a 2020 2020 2320 5665 7269  None..    # Veri
+0001fa90: 6679 2074 6861 7420 7765 2062 7265 616b  fy that we break
+0001faa0: 2074 6865 2074 6974 6c65 2074 6f20 6120   the title to a 
+0001fab0: 6d61 7820 6c65 6e67 7468 206f 6620 6f75  max length of ou
+0001fac0: 7220 7469 746c 655f 6d61 780a 2020 2020  r title_max.    
+0001fad0: 2320 616e 6420 7468 6174 2074 6865 2062  # and that the b
+0001fae0: 6f64 7920 7265 6d61 696e 7320 756e 746f  ody remains unto
+0001faf0: 7563 6865 640a 2020 2020 6368 756e 6b73  uched.    chunks
+0001fb00: 203d 206f 626a 2e5f 6170 706c 795f 6f76   = obj._apply_ov
+0001fb10: 6572 666c 6f77 2862 6f64 793d 2222 2c20  erflow(body="", 
+0001fb20: 7469 746c 653d 7469 746c 6529 0a20 2020  title=title).   
+0001fb30: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+0001fb40: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+0001fb50: 6479 3d22 222c 2074 6974 6c65 3d22 2229  dy="", title="")
+0001fb60: 0a20 2020 2063 6875 6e6b 7320 3d20 6f62  .    chunks = ob
+0001fb70: 6a2e 5f61 7070 6c79 5f6f 7665 7266 6c6f  j._apply_overflo
+0001fb80: 7728 626f 6479 3d62 6f64 792c 2074 6974  w(body=body, tit
+0001fb90: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+0001fba0: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+0001fbb0: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+0001fbc0: 792c 2074 6974 6c65 3d74 6974 6c65 290a  y, title=title).
+0001fbd0: 2020 2020 6f66 6673 6574 203d 2030 0a20      offset = 0. 
+0001fbe0: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+0001fbf0: 756e 6b73 2920 3d3d 2035 0a20 2020 2066  unks) == 5.    f
+0001fc00: 6f72 2069 6478 2c20 6368 756e 6b20 696e  or idx, chunk in
+0001fc10: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+0001fc20: 732c 2073 7461 7274 3d31 293a 0a20 2020  s, start=1):.   
+0001fc30: 2020 2020 2023 2056 6572 6966 6963 6174       # Verificat
+0001fc40: 696f 6e0a 2020 2020 2020 2020 6173 7365  ion.        asse
+0001fc50: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+0001fc60: 2827 7469 746c 6527 2929 203c 3d20 6f62  ('title')) <= ob
+0001fc70: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+0001fc80: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0001fc90: 6e28 6368 756e 6b2e 6765 7428 2762 6f64  n(chunk.get('bod
+0001fca0: 7927 2929 203c 3d20 6f62 6a2e 626f 6479  y')) <= obj.body
+0001fcb0: 5f6d 6178 6c65 6e0a 0a20 2020 2020 2020  _maxlen..       
+0001fcc0: 2023 204e 6f20 636f 756e 7465 7220 6973   # No counter is
+0001fcd0: 2064 6973 706c 6179 6564 2062 6563 6175   displayed becau
+0001fce0: 7365 206f 7572 2074 6974 6c65 2069 7320  se our title is 
+0001fcf0: 736f 2065 6e6f 726d 6f75 730a 2020 2020  so enormous.    
+0001fd00: 2020 2020 2320 5765 2073 7769 7463 6820      # We switch 
+0001fd10: 746f 2061 2064 6973 706c 6179 2074 6974  to a display tit
+0001fd20: 6c65 206f 6e20 6669 7273 7420 6d65 7373  le on first mess
+0001fd30: 6167 6520 6f6e 6c79 0a20 2020 2020 2020  age only.       
+0001fd40: 2069 6620 6964 7820 3e20 313a 0a20 2020   if idx > 1:.   
+0001fd50: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
+0001fd60: 2028 6e6f 2074 6974 6c65 2064 6973 706c   (no title displ
+0001fd70: 6179 6564 206f 6e20 666f 6c6c 6f77 696e  ayed on followin
+0001fd80: 6720 656e 7472 6965 730a 2020 2020 2020  g entries.      
+0001fd90: 2020 2020 2020 6173 7365 7274 2063 6875        assert chu
+0001fda0: 6e6b 2e67 6574 2827 7469 746c 6527 2920  nk.get('title') 
+0001fdb0: 3d3d 2022 220a 2020 2020 2020 2020 656c  == "".        el
+0001fdc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001fdd0: 2320 5468 6520 6c65 6e67 7468 206f 6620  # The length of 
+0001fde0: 7468 6520 626f 6479 2070 7265 7661 696c  the body prevail
+0001fdf0: 7320 6f75 7220 7469 746c 6520 6475 6520  s our title due 
+0001fe00: 746f 2069 7420 6265 696e 670a 2020 2020  to it being.    
+0001fe10: 2020 2020 2020 2020 2320 736f 206d 7563          # so muc
+0001fe20: 6820 736d 616c 6c65 7220 7468 656e 206f  h smaller then o
+0001fe30: 7572 2074 6974 6c65 206c 656e 6774 680a  ur title length.
+0001fe40: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0001fe50: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+0001fe60: 2827 7469 746c 6527 2929 203d 3d20 6f62  ('title')) == ob
+0001fe70: 6a2e 7469 746c 655f 6d61 786c 656e 0a20  j.title_maxlen. 
+0001fe80: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0001fe90: 7420 7469 746c 655b 3a6f 626a 2e74 6974  t title[:obj.tit
+0001fea0: 6c65 5f6d 6178 6c65 6e5d 203d 3d20 6368  le_maxlen] == ch
+0001feb0: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
+0001fec0: 0a0a 2020 2020 2020 2020 2320 4f75 7220  ..        # Our 
+0001fed0: 626f 6479 2069 7320 6f6e 6c79 2062 726f  body is only bro
+0001fee0: 6b65 6e20 7570 3b20 6e6f 7420 6c6f 7374  ken up; not lost
+0001fef0: 0a20 2020 2020 2020 205f 626f 6479 203d  .        _body =
+0001ff00: 2063 6875 6e6b 2e67 6574 2827 626f 6479   chunk.get('body
+0001ff10: 2729 0a0a 2020 2020 2020 2020 2320 556e  ')..        # Un
+0001ff20: 2d75 7365 6420 7768 6974 6573 7061 6365  -used whitespace
+0001ff30: 2069 7320 616c 7761 7973 2063 6c65 616e   is always clean
+0001ff40: 6564 2075 703b 206d 616b 6520 7375 7265  ed up; make sure
+0001ff50: 2077 6520 6163 636f 756e 7420 666f 720a   we account for.
+0001ff60: 2020 2020 2020 2020 2320 7468 6973 2069          # this i
+0001ff70: 6e20 6f75 7220 6e65 7720 6361 6c63 756c  n our new calcul
+0001ff80: 6174 696f 6e0a 2020 2020 2020 2020 7773  ation.        ws
+0001ff90: 5f64 6966 6620 3d20 6c65 6e28 626f 6479  _diff = len(body
+0001ffa0: 5b6f 6666 7365 743a 206c 656e 285f 626f  [offset: len(_bo
+0001ffb0: 6479 2920 2b20 6f66 6673 6574 5d29 202d  dy) + offset]) -
+0001ffc0: 205c 0a20 2020 2020 2020 2020 2020 206c   \.            l
+0001ffd0: 656e 2862 6f64 795b 6f66 6673 6574 3a20  en(body[offset: 
+0001ffe0: 6c65 6e28 5f62 6f64 7929 202b 206f 6666  len(_body) + off
+0001fff0: 7365 745d 0a20 2020 2020 2020 2020 2020  set].           
+00020000: 2020 2020 202e 6c73 7472 6970 2827 5c72       .lstrip('\r
+00020010: 5c6e 5c78 3062 5c78 3063 2729 2e72 7374  \n\x0b\x0c').rst
+00020020: 7269 7028 2929 0a0a 2020 2020 2020 2020  rip())..        
+00020030: 6173 7365 7274 2062 6f64 795b 6f66 6673  assert body[offs
+00020040: 6574 3a20 6c65 6e28 5f62 6f64 7929 202b  et: len(_body) +
+00020050: 206f 6666 7365 7420 2b20 7773 5f64 6966   offset + ws_dif
+00020060: 665d 5c0a 2020 2020 2020 2020 2020 2020  f]\.            
+00020070: 2e6c 7374 7269 7028 275c 725c 6e5c 7830  .lstrip('\r\n\x0
+00020080: 625c 7830 6327 292e 7273 7472 6970 2829  b\x0c').rstrip()
+00020090: 203d 3d20 5f62 6f64 790a 2020 2020 2020   == _body.      
+000200a0: 2020 6f66 6673 6574 202b 3d20 286c 656e    offset += (len
+000200b0: 285f 626f 6479 2920 2b20 7773 5f64 6966  (_body) + ws_dif
+000200c0: 6629 0a0a 2020 2020 230a 2020 2020 2320  f)..    #.    # 
+000200d0: 5363 656e 6172 696f 2077 6865 7265 2074  Scenario where t
+000200e0: 6865 2074 6974 6c65 206c 656e 6774 6820  he title length 
+000200f0: 6973 206c 6172 6765 7220 7468 616e 2074  is larger than t
+00020100: 6865 2062 6f64 790a 2020 2020 230a 0a20  he body.    #.. 
+00020110: 2020 2063 6c61 7373 2054 6573 744e 6f74     class TestNot
+00020120: 6966 6963 6174 696f 6e28 4e6f 7469 6679  ification(Notify
+00020130: 4261 7365 293a 0a0a 2020 2020 2020 2020  Base):..        
+00020140: 2320 5365 7420 6120 736d 616c 6c20 7469  # Set a small ti
+00020150: 746c 6520 6c65 6e67 7468 0a20 2020 2020  tle length.     
+00020160: 2020 2074 6974 6c65 5f6d 6178 6c65 6e20     title_maxlen 
+00020170: 3d20 3130 300a 0a20 2020 2020 2020 2023  = 100..        #
+00020180: 2045 6e66 6f72 6365 2061 2062 6f64 7920   Enforce a body 
+00020190: 6c65 6e67 7468 2e20 4d61 6b65 2073 7572  length. Make sur
+000201a0: 6520 6974 2773 2061 6e20 696e 742e 0a20  e it's an int.. 
+000201b0: 2020 2020 2020 2062 6f64 795f 6d61 786c         body_maxl
+000201c0: 656e 203d 2035 300a 0a20 2020 2020 2020  en = 50..       
+000201d0: 2023 2057 6974 6820 616d 616c 6761 6d61   # With amalgama
+000201e0: 7469 6f6e 0a20 2020 2020 2020 206f 7665  tion.        ove
+000201f0: 7266 6c6f 775f 616d 616c 6761 6d61 7465  rflow_amalgamate
+00020200: 5f74 6974 6c65 203d 2054 7275 650a 0a20  _title = True.. 
+00020210: 2020 2020 2020 2023 2046 6f72 6365 2074         # Force t
+00020220: 6974 6c65 2064 6973 706c 6179 6564 206f  itle displayed o
+00020230: 6e63 650a 2020 2020 2020 2020 6f76 6572  nce.        over
+00020240: 666c 6f77 5f64 6973 706c 6179 5f74 6974  flow_display_tit
+00020250: 6c65 5f6f 6e63 6520 3d20 5472 7565 0a0a  le_once = True..
+00020260: 2020 2020 2020 2020 6465 6620 5f5f 696e          def __in
+00020270: 6974 5f5f 2873 656c 662c 202a 6172 6773  it__(self, *args
+00020280: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00020290: 2020 2020 2020 2020 2073 7570 6572 2829           super()
+000202a0: 2e5f 5f69 6e69 745f 5f28 2a2a 6b77 6172  .__init__(**kwar
+000202b0: 6773 290a 0a20 2020 2020 2020 2064 6566  gs)..        def
+000202c0: 206e 6f74 6966 7928 7365 6c66 2c20 2a61   notify(self, *a
+000202d0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+000202e0: 2020 2020 2020 2020 2020 2020 2320 5072              # Pr
+000202f0: 6574 656e 6420 6576 6572 7974 6869 6e67  etend everything
+00020300: 2069 7320 6f6b 6179 0a20 2020 2020 2020   is okay.       
+00020310: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00020320: 0a0a 2020 2020 2320 4c6f 6164 206f 7572  ..    # Load our
+00020330: 206f 626a 6563 740a 2020 2020 6f62 6a20   object.    obj 
+00020340: 3d20 5465 7374 4e6f 7469 6669 6361 7469  = TestNotificati
+00020350: 6f6e 286f 7665 7266 6c6f 773d 4f76 6572  on(overflow=Over
+00020360: 666c 6f77 4d6f 6465 2e53 504c 4954 290a  flowMode.SPLIT).
+00020370: 2020 2020 6173 7365 7274 206f 626a 2069      assert obj i
+00020380: 7320 6e6f 7420 4e6f 6e65 0a0a 2020 2020  s not None..    
+00020390: 2320 5665 7269 6679 2074 6861 7420 7765  # Verify that we
+000203a0: 2062 7265 616b 2074 6865 2074 6974 6c65   break the title
+000203b0: 2074 6f20 6120 6d61 7820 6c65 6e67 7468   to a max length
+000203c0: 206f 6620 6f75 7220 7469 746c 655f 6d61   of our title_ma
+000203d0: 780a 2020 2020 2320 616e 6420 7468 6174  x.    # and that
+000203e0: 2074 6865 2062 6f64 7920 7265 6d61 696e   the body remain
+000203f0: 7320 756e 746f 7563 6865 640a 2020 2020  s untouched.    
+00020400: 6368 756e 6b73 203d 206f 626a 2e5f 6170  chunks = obj._ap
+00020410: 706c 795f 6f76 6572 666c 6f77 2862 6f64  ply_overflow(bod
+00020420: 793d 2222 2c20 7469 746c 653d 7469 746c  y="", title=titl
+00020430: 6529 0a20 2020 2063 6875 6e6b 7320 3d20  e).    chunks = 
+00020440: 6f62 6a2e 5f61 7070 6c79 5f6f 7665 7266  obj._apply_overf
+00020450: 6c6f 7728 626f 6479 3d22 222c 2074 6974  low(body="", tit
+00020460: 6c65 3d22 2229 0a20 2020 2063 6875 6e6b  le="").    chunk
+00020470: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00020480: 7665 7266 6c6f 7728 626f 6479 3d62 6f64  verflow(body=bod
+00020490: 792c 2074 6974 6c65 3d22 2229 0a20 2020  y, title="").   
+000204a0: 2063 6875 6e6b 7320 3d20 6f62 6a2e 5f61   chunks = obj._a
+000204b0: 7070 6c79 5f6f 7665 7266 6c6f 7728 626f  pply_overflow(bo
+000204c0: 6479 3d62 6f64 792c 2074 6974 6c65 3d74  dy=body, title=t
+000204d0: 6974 6c65 290a 2020 2020 6f66 6673 6574  itle).    offset
+000204e0: 203d 2030 0a20 2020 2061 7373 6572 7420   = 0.    assert 
+000204f0: 6c65 6e28 6368 756e 6b73 2920 3d3d 2032  len(chunks) == 2
+00020500: 320a 2020 2020 666f 7220 6964 782c 2063  2.    for idx, c
+00020510: 6875 6e6b 2069 6e20 656e 756d 6572 6174  hunk in enumerat
+00020520: 6528 6368 756e 6b73 2c20 7374 6172 743d  e(chunks, start=
+00020530: 3129 3a0a 2020 2020 2020 2020 2320 5665  1):.        # Ve
+00020540: 7269 6669 6361 7469 6f6e 0a20 2020 2020  rification.     
+00020550: 2020 2061 7373 6572 7420 6c65 6e28 6368     assert len(ch
+00020560: 756e 6b2e 6765 7428 2774 6974 6c65 2729  unk.get('title')
+00020570: 2920 3c3d 206f 626a 2e74 6974 6c65 5f6d  ) <= obj.title_m
+00020580: 6178 6c65 6e0a 2020 2020 2020 2020 6173  axlen.        as
+00020590: 7365 7274 206c 656e 2863 6875 6e6b 2e67  sert len(chunk.g
+000205a0: 6574 2827 626f 6479 2729 2920 3c3d 206f  et('body')) <= o
+000205b0: 626a 2e62 6f64 795f 6d61 786c 656e 0a0a  bj.body_maxlen..
+000205c0: 2020 2020 2020 2020 2320 4f75 7220 7469          # Our ti
+000205d0: 746c 6520 6861 7320 6e6f 2063 6f75 6e74  tle has no count
+000205e0: 6572 2061 6464 6564 2074 6f20 6974 2064  er added to it d
+000205f0: 7565 2074 6f20 6974 2773 206c 656e 6774  ue to it's lengt
+00020600: 680a 2020 2020 2020 2020 6966 2069 6478  h.        if idx
+00020610: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+00020620: 2020 2320 456d 7074 7920 286e 6f20 7469    # Empty (no ti
+00020630: 746c 6520 6469 7370 6c61 7965 6420 6f6e  tle displayed on
+00020640: 2066 6f6c 6c6f 7769 6e67 2065 6e74 7269   following entri
+00020650: 6573 0a20 2020 2020 2020 2020 2020 2061  es.            a
+00020660: 7373 6572 7420 6368 756e 6b2e 6765 7428  ssert chunk.get(
+00020670: 2774 6974 6c65 2729 203d 3d20 2222 0a20  'title') == "". 
+00020680: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00020690: 2020 2020 2020 2020 2023 2042 6563 6175           # Becau
+000206a0: 7365 2031 3530 2069 7320 7768 6174 2077  se 150 is what w
+000206b0: 6520 7365 7420 7468 6520 7469 746c 6520  e set the title 
+000206c0: 6c69 6d69 7420 746f 2035 3020 6475 650a  limit to 50 due.
+000206d0: 2020 2020 2020 2020 2020 2020 2320 746f              # to
+000206e0: 2061 6d61 6c61 6d61 7469 6f6e 2e20 2054   amalamation.  T
+000206f0: 6865 206c 6f77 6573 7420 7661 6c75 6520  he lowest value 
+00020700: 616c 7761 7973 2070 7265 7661 696c 730a  always prevails.
+00020710: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00020720: 7274 206c 656e 2863 6875 6e6b 2e67 6574  rt len(chunk.get
+00020730: 2827 7469 746c 6527 2929 203d 3d20 6f62  ('title')) == ob
+00020740: 6a2e 626f 6479 5f6d 6178 6c65 6e0a 2020  j.body_maxlen.  
+00020750: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00020760: 2074 6974 6c65 5b3a 6f62 6a2e 626f 6479   title[:obj.body
+00020770: 5f6d 6178 6c65 6e5d 203d 3d20 6368 756e  _maxlen] == chun
+00020780: 6b2e 6765 7428 2774 6974 6c65 2729 0a0a  k.get('title')..
+00020790: 2020 2020 2020 2020 2320 4f75 7220 626f          # Our bo
+000207a0: 6479 2069 7320 6f6e 6c79 2062 726f 6b65  dy is only broke
+000207b0: 6e20 7570 3b20 6e6f 7420 6c6f 7374 0a20  n up; not lost. 
+000207c0: 2020 2020 2020 205f 626f 6479 203d 2063         _body = c
+000207d0: 6875 6e6b 2e67 6574 2827 626f 6479 2729  hunk.get('body')
+000207e0: 0a0a 2020 2020 2020 2020 2320 556e 2d75  ..        # Un-u
+000207f0: 7365 6420 7768 6974 6573 7061 6365 2069  sed whitespace i
+00020800: 7320 616c 7761 7973 2063 6c65 616e 6564  s always cleaned
+00020810: 2075 703b 206d 616b 6520 7375 7265 2077   up; make sure w
+00020820: 6520 6163 636f 756e 7420 666f 720a 2020  e account for.  
+00020830: 2020 2020 2020 2320 7468 6973 2069 6e20        # this in 
+00020840: 6f75 7220 6e65 7720 6361 6c63 756c 6174  our new calculat
+00020850: 696f 6e0a 2020 2020 2020 2020 7773 5f64  ion.        ws_d
+00020860: 6966 6620 3d20 6c65 6e28 626f 6479 5b6f  iff = len(body[o
+00020870: 6666 7365 743a 206c 656e 285f 626f 6479  ffset: len(_body
+00020880: 2920 2b20 6f66 6673 6574 5d29 202d 205c  ) + offset]) - \
+00020890: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+000208a0: 2862 6f64 795b 6f66 6673 6574 3a20 6c65  (body[offset: le
+000208b0: 6e28 5f62 6f64 7929 202b 206f 6666 7365  n(_body) + offse
+000208c0: 745d 0a20 2020 2020 2020 2020 2020 2020  t].             
+000208d0: 2020 202e 6c73 7472 6970 2827 5c72 5c6e     .lstrip('\r\n
+000208e0: 5c78 3062 5c78 3063 2729 2e72 7374 7269  \x0b\x0c').rstri
+000208f0: 7028 2929 0a0a 2020 2020 2020 2020 6173  p())..        as
+00020900: 7365 7274 2062 6f64 795b 6f66 6673 6574  sert body[offset
+00020910: 3a20 6c65 6e28 5f62 6f64 7929 202b 206f  : len(_body) + o
+00020920: 6666 7365 7420 2b20 7773 5f64 6966 665d  ffset + ws_diff]
+00020930: 5c0a 2020 2020 2020 2020 2020 2020 2e6c  \.            .l
+00020940: 7374 7269 7028 275c 725c 6e5c 7830 625c  strip('\r\n\x0b\
+00020950: 7830 6327 292e 7273 7472 6970 2829 203d  x0c').rstrip() =
+00020960: 3d20 5f62 6f64 790a 2020 2020 2020 2020  = _body.        
+00020970: 6f66 6673 6574 202b 3d20 286c 656e 285f  offset += (len(_
+00020980: 626f 6479 2920 2b20 7773 5f64 6966 6629  body) + ws_diff)
+00020990: 0a0a 0a64 6566 2074 6573 745f 6e6f 7469  ...def test_noti
+000209a0: 6679 5f6d 6172 6b64 6f77 6e5f 6765 6e65  fy_markdown_gene
+000209b0: 7261 6c28 293a 0a20 2020 2022 2222 0a20  ral():.    """. 
+000209c0: 2020 2041 5049 3a20 4d61 726b 646f 776e     API: Markdown
+000209d0: 2047 656e 6572 616c 2054 6573 7469 6e67   General Testing
+000209e0: 0a0a 2020 2020 2222 220a 0a20 2020 2023  ..    """..    #
+000209f0: 0a20 2020 2023 2041 206c 6974 746c 6520  .    # A little 
+00020a00: 7072 6570 6172 6174 696f 6e0a 2020 2020  preparation.    
+00020a10: 230a 0a20 2020 2023 0a20 2020 2023 2046  #..    #.    # F
+00020a20: 6972 7374 2054 6573 743a 2054 7275 6e63  irst Test: Trunc
+00020a30: 6174 6564 2054 6974 6c65 0a20 2020 2023  ated Title.    #
+00020a40: 0a20 2020 2063 6c61 7373 2054 6573 744d  .    class TestM
+00020a50: 6172 6b64 6f77 6e4e 6f74 6966 6963 6174  arkdownNotificat
+00020a60: 696f 6e28 4e6f 7469 6679 4261 7365 293a  ion(NotifyBase):
+00020a70: 0a0a 2020 2020 2020 2020 2320 466f 7263  ..        # Forc
+00020a80: 6520 6f75 7220 7469 746c 6520 746f 2077  e our title to w
+00020a90: 7261 700a 2020 2020 2020 2020 7469 746c  rap.        titl
+00020aa0: 655f 6d61 786c 656e 203d 2030 0a0a 2020  e_maxlen = 0..  
+00020ab0: 2020 2020 2020 2320 4465 6661 756c 7420        # Default 
+00020ac0: 4e6f 7469 6679 2046 6f72 6d61 740a 2020  Notify Format.  
+00020ad0: 2020 2020 2020 6e6f 7469 6679 5f66 6f72        notify_for
+00020ae0: 6d61 7420 3d20 4e6f 7469 6679 466f 726d  mat = NotifyForm
+00020af0: 6174 2e4d 4152 4b44 4f57 4e0a 0a20 2020  at.MARKDOWN..   
+00020b00: 2020 2020 2064 6566 205f 5f69 6e69 745f       def __init_
+00020b10: 5f28 7365 6c66 2c20 2a61 7267 732c 202a  _(self, *args, *
+00020b20: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00020b30: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+00020b40: 696e 6974 5f5f 282a 2a6b 7761 7267 7329  init__(**kwargs)
+00020b50: 0a0a 2020 2020 2020 2020 6465 6620 6e6f  ..        def no
+00020b60: 7469 6679 2873 656c 662c 202a 6172 6773  tify(self, *args
+00020b70: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00020b80: 2020 2020 2020 2020 2023 2050 7265 7465           # Prete
+00020b90: 6e64 2065 7665 7279 7468 696e 6720 6973  nd everything is
+00020ba0: 206f 6b61 790a 2020 2020 2020 2020 2020   okay.          
+00020bb0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00020bc0: 2020 2023 204c 6f61 6420 6f75 7220 6f62     # Load our ob
+00020bd0: 6a65 6374 0a20 2020 206f 626a 203d 2054  ject.    obj = T
+00020be0: 6573 744d 6172 6b64 6f77 6e4e 6f74 6966  estMarkdownNotif
+00020bf0: 6963 6174 696f 6e28 290a 2020 2020 6173  ication().    as
+00020c00: 7365 7274 206f 626a 2069 7320 6e6f 7420  sert obj is not 
+00020c10: 4e6f 6e65 0a0a 2020 2020 2320 4120 6261  None..    # A ba
+00020c20: 6420 6865 6164 6572 0a20 2020 2074 6974  d header.    tit
+00020c30: 6c65 203d 2022 2023 2022 0a20 2020 2062  le = " # ".    b
+00020c40: 6f64 7920 3d20 222a 2a54 6573 7420 426f  ody = "**Test Bo
+00020c50: 6479 2a2a 220a 0a20 2020 2063 6875 6e6b  dy**"..    chunk
+00020c60: 7320 3d20 6f62 6a2e 5f61 7070 6c79 5f6f  s = obj._apply_o
+00020c70: 7665 7266 6c6f 7728 626f 6479 3d22 222c  verflow(body="",
+00020c80: 2074 6974 6c65 3d74 6974 6c65 290a 2020   title=title).  
+00020c90: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00020ca0: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00020cb0: 6f64 793d 2222 2c20 7469 746c 653d 2222  ody="", title=""
+00020cc0: 290a 2020 2020 6368 756e 6b73 203d 206f  ).    chunks = o
+00020cd0: 626a 2e5f 6170 706c 795f 6f76 6572 666c  bj._apply_overfl
+00020ce0: 6f77 2862 6f64 793d 626f 6479 2c20 7469  ow(body=body, ti
+00020cf0: 746c 653d 2222 290a 2020 2020 6368 756e  tle="").    chun
+00020d00: 6b73 203d 206f 626a 2e5f 6170 706c 795f  ks = obj._apply_
+00020d10: 6f76 6572 666c 6f77 2862 6f64 793d 626f  overflow(body=bo
+00020d20: 6479 2c20 7469 746c 653d 7469 746c 6529  dy, title=title)
+00020d30: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+00020d40: 6368 756e 6b73 2920 3d3d 2031 0a20 2020  chunks) == 1.   
+00020d50: 2023 2077 6869 7473 7061 6365 2069 7320   # whitspace is 
+00020d60: 7472 696d 6d65 640a 2020 2020 6173 7365  trimmed.    asse
+00020d70: 7274 2027 235c 725c 6e2a 2a54 6573 7420  rt '#\r\n**Test 
+00020d80: 426f 6479 2a2a 2720 3d3d 2063 6875 6e6b  Body**' == chunk
+00020d90: 735b 305d 2e67 6574 2827 626f 6479 2729  s[0].get('body')
+00020da0: 0a20 2020 2061 7373 6572 7420 6368 756e  .    assert chun
+00020db0: 6b73 5b30 5d2e 6765 7428 2774 6974 6c65  ks[0].get('title
+00020dc0: 2729 203d 3d20 2222 0a0a 2020 2020 2320  ') == ""..    # 
+00020dd0: 4966 2077 6520 6b6e 6f77 206f 7572 2069  If we know our i
+00020de0: 6e70 7574 2069 7320 7465 7874 2068 6f77  nput is text how
+00020df0: 6576 6572 2c20 7765 2070 6572 666f 726d  ever, we perform
+00020e00: 206d 616e 6970 756c 6174 696f 6e0a 2020   manipulation.  
+00020e10: 2020 6368 756e 6b73 203d 206f 626a 2e5f    chunks = obj._
+00020e20: 6170 706c 795f 6f76 6572 666c 6f77 2862  apply_overflow(b
+00020e30: 6f64 793d 2222 2c20 7469 746c 653d 7469  ody="", title=ti
+00020e40: 746c 6529 0a20 2020 2063 6875 6e6b 7320  tle).    chunks 
+00020e50: 3d20 6f62 6a2e 5f61 7070 6c79 5f6f 7665  = obj._apply_ove
+00020e60: 7266 6c6f 7728 626f 6479 3d22 222c 2074  rflow(body="", t
+00020e70: 6974 6c65 3d22 2229 0a20 2020 2063 6875  itle="").    chu
+00020e80: 6e6b 7320 3d20 6f62 6a2e 5f61 7070 6c79  nks = obj._apply
+00020e90: 5f6f 7665 7266 6c6f 7728 626f 6479 3d62  _overflow(body=b
+00020ea0: 6f64 792c 2074 6974 6c65 3d22 2229 0a20  ody, title=""). 
+00020eb0: 2020 2063 6875 6e6b 7320 3d20 6f62 6a2e     chunks = obj.
+00020ec0: 5f61 7070 6c79 5f6f 7665 7266 6c6f 7728  _apply_overflow(
+00020ed0: 0a20 2020 2020 2020 2062 6f64 793d 626f  .        body=bo
+00020ee0: 6479 2c20 7469 746c 653d 7469 746c 652c  dy, title=title,
+00020ef0: 2062 6f64 795f 666f 726d 6174 3d4e 6f74   body_format=Not
+00020f00: 6966 7946 6f72 6d61 742e 5445 5854 290a  ifyFormat.TEXT).
+00020f10: 2020 2020 6173 7365 7274 206c 656e 2863      assert len(c
+00020f20: 6875 6e6b 7329 203d 3d20 310a 2020 2020  hunks) == 1.    
+00020f30: 2320 4f75 7220 7469 746c 6520 6765 7427  # Our title get'
+00020f40: 7320 7374 7269 7070 6564 206f 6666 2073  s stripped off s
+00020f50: 696e 6365 2069 7427 7320 6e6f 7420 6f66  ince it's not of
+00020f60: 2076 616c 6964 206d 6172 6b64 6f77 6e0a   valid markdown.
+00020f70: 2020 2020 6173 7365 7274 2062 6f64 792e      assert body.
+00020f80: 6c73 7472 6970 2827 5c72 5c6e 5c78 3062  lstrip('\r\n\x0b
+00020f90: 5c78 3063 2729 2e72 7374 7269 7028 2920  \x0c').rstrip() 
+00020fa0: 3d3d 2063 6875 6e6b 735b 305d 2e67 6574  == chunks[0].get
+00020fb0: 2827 626f 6479 2729 0a20 2020 2061 7373  ('body').    ass
+00020fc0: 6572 7420 6368 756e 6b73 5b30 5d2e 6765  ert chunks[0].ge
+00020fd0: 7428 2774 6974 6c65 2729 203d 3d20 2222  t('title') == ""
+00020fe0: 0a0a 0a40 6d6f 636b 2e70 6174 6368 2827  ...@mock.patch('
+00020ff0: 7265 7175 6573 7473 2e70 6f73 7427 290a  requests.post').
+00021000: 6465 6620 7465 7374 5f6e 6f74 6966 795f  def test_notify_
+00021010: 656d 6f6a 695f 6765 6e65 7261 6c28 6d6f  emoji_general(mo
+00021020: 636b 5f70 6f73 7429 3a0a 2020 2020 2222  ck_post):.    ""
+00021030: 220a 2020 2020 4150 493a 2045 6d6f 6a69  ".    API: Emoji
+00021040: 2047 656e 6572 616c 2054 6573 7469 6e67   General Testing
+00021050: 0a0a 2020 2020 2222 220a 0a20 2020 2023  ..    """..    #
+00021060: 2050 7265 7061 7265 206f 7572 2072 6573   Prepare our res
+00021070: 706f 6e73 650a 2020 2020 7265 7370 6f6e  ponse.    respon
+00021080: 7365 203d 2072 6571 7565 7374 732e 5265  se = requests.Re
+00021090: 7175 6573 7428 290a 2020 2020 7265 7370  quest().    resp
+000210a0: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
+000210b0: 203d 2072 6571 7565 7374 732e 636f 6465   = requests.code
+000210c0: 732e 6f6b 0a0a 2020 2020 2320 5072 6570  s.ok..    # Prep
+000210d0: 6172 6520 4d6f 636b 0a20 2020 206d 6f63  are Mock.    moc
+000210e0: 6b5f 706f 7374 2e72 6574 7572 6e5f 7661  k_post.return_va
+000210f0: 6c75 6520 3d20 7265 7370 6f6e 7365 0a0a  lue = response..
+00021100: 2020 2020 2320 5365 7420 7570 206f 7572      # Set up our
+00021110: 2065 6d6f 6a69 730a 2020 2020 7469 746c   emojis.    titl
+00021120: 6520 3d20 223a 736d 696c 653a 220a 2020  e = ":smile:".  
+00021130: 2020 626f 6479 203d 2022 3a67 7269 6e3a    body = ":grin:
+00021140: 220a 0a20 2020 2023 2067 656e 6572 616c  "..    # general
+00021150: 2072 6566 6572 656e 6365 2075 7365 6420   reference used 
+00021160: 6265 6c6f 7720 2875 7369 6e67 2064 6566  below (using def
+00021170: 6175 6c74 2076 616c 7565 7329 0a20 2020  ault values).   
+00021180: 2061 7373 6574 203d 2041 7070 7269 7365   asset = Apprise
+00021190: 4173 7365 7428 290a 0a20 2020 2023 0a20  Asset()..    #. 
+000211a0: 2020 2023 2054 6573 7420 6465 6661 756c     # Test defaul
+000211b0: 7420 656d 6f6a 6920 6173 7365 7420 7661  t emoji asset va
+000211c0: 6c75 650a 2020 2020 230a 0a20 2020 2023  lue.    #..    #
+000211d0: 204c 6f61 6420 6f75 7220 6f62 6a65 6374   Load our object
+000211e0: 0a20 2020 2061 705f 6f62 6a20 3d20 4170  .    ap_obj = Ap
+000211f0: 7072 6973 6528 6173 7365 743d 6173 7365  prise(asset=asse
+00021200: 7429 0a20 2020 2061 705f 6f62 6a2e 6164  t).    ap_obj.ad
+00021210: 6428 276a 736f 6e3a 2f2f 6c6f 6361 6c68  d('json://localh
+00021220: 6f73 7427 290a 2020 2020 6173 7365 7274  ost').    assert
+00021230: 206c 656e 2861 705f 6f62 6a29 203d 3d20   len(ap_obj) == 
+00021240: 310a 0a20 2020 2061 7373 6572 7420 6170  1..    assert ap
+00021250: 5f6f 626a 2e6e 6f74 6966 7928 7469 746c  _obj.notify(titl
+00021260: 653d 7469 746c 652c 2062 6f64 793d 626f  e=title, body=bo
+00021270: 6479 2920 6973 2054 7275 650a 2020 2020  dy) is True.    
+00021280: 6173 7365 7274 206d 6f63 6b5f 706f 7374  assert mock_post
+00021290: 2e63 616c 6c5f 636f 756e 7420 3d3d 2031  .call_count == 1
+000212a0: 0a0a 2020 2020 6465 7461 696c 7320 3d20  ..    details = 
+000212b0: 6d6f 636b 5f70 6f73 742e 6361 6c6c 5f61  mock_post.call_a
+000212c0: 7267 735f 6c69 7374 5b30 5d0a 2020 2020  rgs_list[0].    
+000212d0: 6461 7461 7365 7420 3d20 6a73 6f6e 2e6c  dataset = json.l
+000212e0: 6f61 6473 2864 6574 6169 6c73 5b31 5d5b  oads(details[1][
+000212f0: 2764 6174 6127 5d29 0a0a 2020 2020 2320  'data'])..    # 
+00021300: 4e6f 2063 6861 6e67 6573 0a20 2020 2061  No changes.    a
+00021310: 7373 6572 7420 6461 7461 7365 745b 2774  ssert dataset['t
+00021320: 6974 6c65 275d 203d 3d20 7469 746c 650a  itle'] == title.
+00021330: 2020 2020 6173 7365 7274 2064 6174 6173      assert datas
+00021340: 6574 5b27 6d65 7373 6167 6527 5d20 3d3d  et['message'] ==
+00021350: 2062 6f64 790a 0a20 2020 206d 6f63 6b5f   body..    mock_
+00021360: 706f 7374 2e72 6573 6574 5f6d 6f63 6b28  post.reset_mock(
+00021370: 290a 0a20 2020 2023 0a20 2020 2023 2054  )..    #.    # T
+00021380: 6573 7420 5552 4c20 6f76 6572 2d72 6964  est URL over-rid
+00021390: 6520 7768 696c 6520 6465 6661 756c 7420  e while default 
+000213a0: 7661 6c75 6520 7365 7420 696e 2061 7373  value set in ass
+000213b0: 6574 0a20 2020 2023 0a0a 2020 2020 2320  et.    #..    # 
+000213c0: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+000213d0: 2020 2020 6170 5f6f 626a 203d 2041 7070      ap_obj = App
+000213e0: 7269 7365 2861 7373 6574 3d61 7373 6574  rise(asset=asset
+000213f0: 290a 2020 2020 6170 5f6f 626a 2e61 6464  ).    ap_obj.add
+00021400: 2827 6a73 6f6e 3a2f 2f6c 6f63 616c 686f  ('json://localho
+00021410: 7374 3f65 6d6f 6a69 733d 6e6f 2729 0a20  st?emojis=no'). 
+00021420: 2020 2061 7373 6572 7420 6c65 6e28 6170     assert len(ap
+00021430: 5f6f 626a 2920 3d3d 2031 0a0a 2020 2020  _obj) == 1..    
+00021440: 6173 7365 7274 2061 705f 6f62 6a2e 6e6f  assert ap_obj.no
+00021450: 7469 6679 2874 6974 6c65 3d74 6974 6c65  tify(title=title
+00021460: 2c20 626f 6479 3d62 6f64 7929 2069 7320  , body=body) is 
+00021470: 5472 7565 0a20 2020 2061 7373 6572 7420  True.    assert 
+00021480: 6d6f 636b 5f70 6f73 742e 6361 6c6c 5f63  mock_post.call_c
+00021490: 6f75 6e74 203d 3d20 310a 0a20 2020 2064  ount == 1..    d
+000214a0: 6574 6169 6c73 203d 206d 6f63 6b5f 706f  etails = mock_po
+000214b0: 7374 2e63 616c 6c5f 6172 6773 5f6c 6973  st.call_args_lis
+000214c0: 745b 305d 0a20 2020 2064 6174 6173 6574  t[0].    dataset
+000214d0: 203d 206a 736f 6e2e 6c6f 6164 7328 6465   = json.loads(de
+000214e0: 7461 696c 735b 315d 5b27 6461 7461 275d  tails[1]['data']
+000214f0: 290a 0a20 2020 2023 204e 6f20 6368 616e  )..    # No chan
+00021500: 6765 730a 2020 2020 6173 7365 7274 2064  ges.    assert d
+00021510: 6174 6173 6574 5b27 7469 746c 6527 5d20  ataset['title'] 
+00021520: 3d3d 2074 6974 6c65 0a20 2020 2061 7373  == title.    ass
+00021530: 6572 7420 6461 7461 7365 745b 276d 6573  ert dataset['mes
+00021540: 7361 6765 275d 203d 3d20 626f 6479 0a0a  sage'] == body..
+00021550: 2020 2020 6d6f 636b 5f70 6f73 742e 7265      mock_post.re
+00021560: 7365 745f 6d6f 636b 2829 0a0a 2020 2020  set_mock()..    
+00021570: 230a 2020 2020 2320 5465 7374 2055 524c  #.    # Test URL
+00021580: 206f 7665 722d 7269 6465 2077 6869 6c65   over-ride while
+00021590: 2064 6566 6175 6c74 2076 616c 7565 2073   default value s
+000215a0: 6574 2069 6e20 6173 7365 7420 7074 2032  et in asset pt 2
+000215b0: 0a20 2020 2023 0a0a 2020 2020 2320 4c6f  .    #..    # Lo
+000215c0: 6164 206f 7572 206f 626a 6563 740a 2020  ad our object.  
+000215d0: 2020 6170 5f6f 626a 203d 2041 7070 7269    ap_obj = Appri
+000215e0: 7365 2861 7373 6574 3d61 7373 6574 290a  se(asset=asset).
+000215f0: 2020 2020 6170 5f6f 626a 2e61 6464 2827      ap_obj.add('
+00021600: 6a73 6f6e 3a2f 2f6c 6f63 616c 686f 7374  json://localhost
+00021610: 3f65 6d6f 6a69 733d 7965 7327 290a 2020  ?emojis=yes').  
+00021620: 2020 6173 7365 7274 206c 656e 2861 705f    assert len(ap_
+00021630: 6f62 6a29 203d 3d20 310a 0a20 2020 2061  obj) == 1..    a
+00021640: 7373 6572 7420 6170 5f6f 626a 2e6e 6f74  ssert ap_obj.not
+00021650: 6966 7928 7469 746c 653d 7469 746c 652c  ify(title=title,
+00021660: 2062 6f64 793d 626f 6479 2920 6973 2054   body=body) is T
+00021670: 7275 650a 2020 2020 6173 7365 7274 206d  rue.    assert m
+00021680: 6f63 6b5f 706f 7374 2e63 616c 6c5f 636f  ock_post.call_co
+00021690: 756e 7420 3d3d 2031 0a0a 2020 2020 6465  unt == 1..    de
+000216a0: 7461 696c 7320 3d20 6d6f 636b 5f70 6f73  tails = mock_pos
+000216b0: 742e 6361 6c6c 5f61 7267 735f 6c69 7374  t.call_args_list
+000216c0: 5b30 5d0a 2020 2020 6461 7461 7365 7420  [0].    dataset 
+000216d0: 3d20 6a73 6f6e 2e6c 6f61 6473 2864 6574  = json.loads(det
+000216e0: 6169 6c73 5b31 5d5b 2764 6174 6127 5d29  ails[1]['data'])
+000216f0: 0a0a 2020 2020 2320 456d 6f6a 6927 7320  ..    # Emoji's 
+00021700: 6172 6520 6469 7370 6c61 7965 640a 2020  are displayed.  
+00021710: 2020 6173 7365 7274 2064 6174 6173 6574    assert dataset
+00021720: 5b27 7469 746c 6527 5d20 3d3d 2027 f09f  ['title'] == '..
+00021730: 9884 270a 2020 2020 6173 7365 7274 2064  ..'.    assert d
+00021740: 6174 6173 6574 5b27 6d65 7373 6167 6527  ataset['message'
+00021750: 5d20 3d3d 2027 f09f 9883 270a 0a20 2020  ] == '....'..   
+00021760: 206d 6f63 6b5f 706f 7374 2e72 6573 6574   mock_post.reset
+00021770: 5f6d 6f63 6b28 290a 0a20 2020 2023 0a20  _mock()..    #. 
+00021780: 2020 2023 2054 6573 7420 5552 4c20 6f76     # Test URL ov
+00021790: 6572 2d72 6964 6520 7768 696c 6520 6465  er-ride while de
+000217a0: 6661 756c 7420 7661 6c75 6520 7365 7420  fault value set 
+000217b0: 696e 2061 7373 6574 2070 7420 320a 2020  in asset pt 2.  
+000217c0: 2020 230a 0a20 2020 2023 204c 6f61 6420    #..    # Load 
+000217d0: 6f75 7220 6f62 6a65 6374 0a20 2020 2061  our object.    a
+000217e0: 705f 6f62 6a20 3d20 4170 7072 6973 6528  p_obj = Apprise(
+000217f0: 6173 7365 743d 6173 7365 7429 0a20 2020  asset=asset).   
+00021800: 2061 705f 6f62 6a2e 6164 6428 276a 736f   ap_obj.add('jso
+00021810: 6e3a 2f2f 6c6f 6361 6c68 6f73 743f 656d  n://localhost?em
+00021820: 6f6a 6973 3d6e 6f27 290a 2020 2020 6173  ojis=no').    as
+00021830: 7365 7274 206c 656e 2861 705f 6f62 6a29  sert len(ap_obj)
+00021840: 203d 3d20 310a 0a20 2020 2061 7373 6572   == 1..    asser
+00021850: 7420 6170 5f6f 626a 2e6e 6f74 6966 7928  t ap_obj.notify(
+00021860: 7469 746c 653d 7469 746c 652c 2062 6f64  title=title, bod
+00021870: 793d 626f 6479 2920 6973 2054 7275 650a  y=body) is True.
+00021880: 2020 2020 6173 7365 7274 206d 6f63 6b5f      assert mock_
+00021890: 706f 7374 2e63 616c 6c5f 636f 756e 7420  post.call_count 
+000218a0: 3d3d 2031 0a0a 2020 2020 6465 7461 696c  == 1..    detail
+000218b0: 7320 3d20 6d6f 636b 5f70 6f73 742e 6361  s = mock_post.ca
+000218c0: 6c6c 5f61 7267 735f 6c69 7374 5b30 5d0a  ll_args_list[0].
+000218d0: 2020 2020 6461 7461 7365 7420 3d20 6a73      dataset = js
+000218e0: 6f6e 2e6c 6f61 6473 2864 6574 6169 6c73  on.loads(details
+000218f0: 5b31 5d5b 2764 6174 6127 5d29 0a0a 2020  [1]['data'])..  
+00021900: 2020 2320 4e6f 2063 6861 6e67 6573 0a20    # No changes. 
+00021910: 2020 2061 7373 6572 7420 6461 7461 7365     assert datase
+00021920: 745b 2774 6974 6c65 275d 203d 3d20 7469  t['title'] == ti
+00021930: 746c 650a 2020 2020 6173 7365 7274 2064  tle.    assert d
+00021940: 6174 6173 6574 5b27 6d65 7373 6167 6527  ataset['message'
+00021950: 5d20 3d3d 2062 6f64 790a 0a20 2020 206d  ] == body..    m
+00021960: 6f63 6b5f 706f 7374 2e72 6573 6574 5f6d  ock_post.reset_m
+00021970: 6f63 6b28 290a 0a20 2020 2023 0a20 2020  ock()..    #.   
+00021980: 2023 2054 6573 7420 4465 6661 756c 7420   # Test Default 
+00021990: 456d 6f6a 6920 7365 7474 696e 6773 0a20  Emoji settings. 
+000219a0: 2020 2023 0a0a 2020 2020 2320 5365 7420     #..    # Set 
+000219b0: 6f75 7220 696e 7465 7270 7265 7420 656d  our interpret em
+000219c0: 6f6a 6927 7320 666c 6167 0a20 2020 2061  oji's flag.    a
+000219d0: 7373 6574 203d 2041 7070 7269 7365 4173  sset = AppriseAs
+000219e0: 7365 7428 696e 7465 7270 7265 745f 656d  set(interpret_em
+000219f0: 6f6a 6973 3d54 7275 6529 0a0a 2020 2020  ojis=True)..    
+00021a00: 2320 5265 2d63 7265 6174 6520 6f75 7220  # Re-create our 
+00021a10: 6f62 6a65 6374 0a20 2020 2061 705f 6f62  object.    ap_ob
+00021a20: 6a20 3d20 4170 7072 6973 6528 6173 7365  j = Apprise(asse
+00021a30: 743d 6173 7365 7429 0a0a 2020 2020 2320  t=asset)..    # 
+00021a40: 4c6f 6164 206f 7572 206f 626a 6563 740a  Load our object.
+00021a50: 2020 2020 6170 5f6f 626a 2e61 6464 2827      ap_obj.add('
+00021a60: 6a73 6f6e 3a2f 2f6c 6f63 616c 686f 7374  json://localhost
+00021a70: 2729 0a20 2020 2061 7373 6572 7420 6c65  ').    assert le
+00021a80: 6e28 6170 5f6f 626a 2920 3d3d 2031 0a0a  n(ap_obj) == 1..
+00021a90: 2020 2020 6173 7365 7274 2061 705f 6f62      assert ap_ob
+00021aa0: 6a2e 6e6f 7469 6679 2874 6974 6c65 3d74  j.notify(title=t
+00021ab0: 6974 6c65 2c20 626f 6479 3d62 6f64 7929  itle, body=body)
+00021ac0: 2069 7320 5472 7565 0a20 2020 2061 7373   is True.    ass
+00021ad0: 6572 7420 6d6f 636b 5f70 6f73 742e 6361  ert mock_post.ca
+00021ae0: 6c6c 5f63 6f75 6e74 203d 3d20 310a 0a20  ll_count == 1.. 
+00021af0: 2020 2064 6574 6169 6c73 203d 206d 6f63     details = moc
+00021b00: 6b5f 706f 7374 2e63 616c 6c5f 6172 6773  k_post.call_args
+00021b10: 5f6c 6973 745b 305d 0a20 2020 2064 6174  _list[0].    dat
+00021b20: 6173 6574 203d 206a 736f 6e2e 6c6f 6164  aset = json.load
+00021b30: 7328 6465 7461 696c 735b 315d 5b27 6461  s(details[1]['da
+00021b40: 7461 275d 290a 0a20 2020 2023 2065 6d6f  ta'])..    # emo
+00021b50: 6a69 2773 2061 7265 2064 6973 706c 6179  ji's are display
+00021b60: 6564 0a20 2020 2061 7373 6572 7420 6461  ed.    assert da
+00021b70: 7461 7365 745b 2774 6974 6c65 275d 203d  taset['title'] =
+00021b80: 3d20 27f0 9f98 8427 0a20 2020 2061 7373  = '....'.    ass
+00021b90: 6572 7420 6461 7461 7365 745b 276d 6573  ert dataset['mes
+00021ba0: 7361 6765 275d 203d 3d20 27f0 9f98 8327  sage'] == '....'
+00021bb0: 0a0a 2020 2020 6d6f 636b 5f70 6f73 742e  ..    mock_post.
+00021bc0: 7265 7365 745f 6d6f 636b 2829 0a0a 2020  reset_mock()..  
+00021bd0: 2020 230a 2020 2020 2320 5769 7468 2045    #.    # With E
+00021be0: 6d6f 6a69 2773 2074 7572 6e65 6420 6f6e  moji's turned on
+00021bf0: 2062 7920 6465 6661 756c 742c 2074 6865   by default, the
+00021c00: 2075 7365 7220 6361 6e20 6f70 7469 6f6e   user can option
+00021c10: 616c 6c79 2074 7572 6e20 7468 656d 0a20  ally turn them. 
+00021c20: 2020 2023 206f 6666 2e0a 2020 2020 230a     # off..    #.
+00021c30: 0a20 2020 2023 2052 652d 6372 6561 7465  .    # Re-create
+00021c40: 206f 7572 206f 626a 6563 740a 2020 2020   our object.    
+00021c50: 6170 5f6f 626a 203d 2041 7070 7269 7365  ap_obj = Apprise
+00021c60: 2861 7373 6574 3d61 7373 6574 290a 0a20  (asset=asset).. 
+00021c70: 2020 2061 705f 6f62 6a2e 6164 6428 276a     ap_obj.add('j
+00021c80: 736f 6e3a 2f2f 6c6f 6361 6c68 6f73 743f  son://localhost?
+00021c90: 656d 6f6a 6973 3d6e 6f27 290a 2020 2020  emojis=no').    
+00021ca0: 6173 7365 7274 206c 656e 2861 705f 6f62  assert len(ap_ob
+00021cb0: 6a29 203d 3d20 310a 0a20 2020 2061 7373  j) == 1..    ass
+00021cc0: 6572 7420 6170 5f6f 626a 2e6e 6f74 6966  ert ap_obj.notif
+00021cd0: 7928 7469 746c 653d 7469 746c 652c 2062  y(title=title, b
+00021ce0: 6f64 793d 626f 6479 2920 6973 2054 7275  ody=body) is Tru
+00021cf0: 650a 2020 2020 6173 7365 7274 206d 6f63  e.    assert moc
+00021d00: 6b5f 706f 7374 2e63 616c 6c5f 636f 756e  k_post.call_coun
+00021d10: 7420 3d3d 2031 0a0a 2020 2020 6465 7461  t == 1..    deta
+00021d20: 696c 7320 3d20 6d6f 636b 5f70 6f73 742e  ils = mock_post.
+00021d30: 6361 6c6c 5f61 7267 735f 6c69 7374 5b30  call_args_list[0
+00021d40: 5d0a 2020 2020 6461 7461 7365 7420 3d20  ].    dataset = 
+00021d50: 6a73 6f6e 2e6c 6f61 6473 2864 6574 6169  json.loads(detai
+00021d60: 6c73 5b31 5d5b 2764 6174 6127 5d29 0a0a  ls[1]['data'])..
+00021d70: 2020 2020 2320 4e6f 2063 6861 6e67 6573      # No changes
+00021d80: 0a20 2020 2061 7373 6572 7420 6461 7461  .    assert data
+00021d90: 7365 745b 2774 6974 6c65 275d 203d 3d20  set['title'] == 
+00021da0: 7469 746c 650a 2020 2020 6173 7365 7274  title.    assert
+00021db0: 2064 6174 6173 6574 5b27 6d65 7373 6167   dataset['messag
+00021dc0: 6527 5d20 3d3d 2062 6f64 790a 0a20 2020  e'] == body..   
+00021dd0: 206d 6f63 6b5f 706f 7374 2e72 6573 6574   mock_post.reset
+00021de0: 5f6d 6f63 6b28 290a 0a20 2020 2023 0a20  _mock()..    #. 
+00021df0: 2020 2023 2057 6974 6820 456d 6f6a 6927     # With Emoji'
+00021e00: 7320 7475 726e 6564 206f 6e20 6279 2064  s turned on by d
+00021e10: 6566 6175 6c74 2c20 7468 6572 6520 6973  efault, there is
+00021e20: 206e 6f20 6368 616e 6765 2077 6865 6e20   no change when 
+00021e30: 656d 6f6a 6973 0a20 2020 2023 2066 6c61  emojis.    # fla
+00021e40: 6720 6973 2073 6574 2074 6f20 6f6e 0a20  g is set to on. 
+00021e50: 2020 2023 0a0a 2020 2020 2320 5265 2d63     #..    # Re-c
+00021e60: 7265 6174 6520 6f75 7220 6f62 6a65 6374  reate our object
+00021e70: 0a20 2020 2061 705f 6f62 6a20 3d20 4170  .    ap_obj = Ap
+00021e80: 7072 6973 6528 6173 7365 743d 6173 7365  prise(asset=asse
+00021e90: 7429 0a0a 2020 2020 6170 5f6f 626a 2e61  t)..    ap_obj.a
+00021ea0: 6464 2827 6a73 6f6e 3a2f 2f6c 6f63 616c  dd('json://local
+00021eb0: 686f 7374 3f65 6d6f 6a69 733d 7965 7327  host?emojis=yes'
+00021ec0: 290a 2020 2020 6173 7365 7274 206c 656e  ).    assert len
+00021ed0: 2861 705f 6f62 6a29 203d 3d20 310a 0a20  (ap_obj) == 1.. 
+00021ee0: 2020 2061 7373 6572 7420 6170 5f6f 626a     assert ap_obj
+00021ef0: 2e6e 6f74 6966 7928 7469 746c 653d 7469  .notify(title=ti
+00021f00: 746c 652c 2062 6f64 793d 626f 6479 2920  tle, body=body) 
+00021f10: 6973 2054 7275 650a 2020 2020 6173 7365  is True.    asse
+00021f20: 7274 206d 6f63 6b5f 706f 7374 2e63 616c  rt mock_post.cal
+00021f30: 6c5f 636f 756e 7420 3d3d 2031 0a0a 2020  l_count == 1..  
+00021f40: 2020 6465 7461 696c 7320 3d20 6d6f 636b    details = mock
+00021f50: 5f70 6f73 742e 6361 6c6c 5f61 7267 735f  _post.call_args_
+00021f60: 6c69 7374 5b30 5d0a 2020 2020 6461 7461  list[0].    data
+00021f70: 7365 7420 3d20 6a73 6f6e 2e6c 6f61 6473  set = json.loads
+00021f80: 2864 6574 6169 6c73 5b31 5d5b 2764 6174  (details[1]['dat
+00021f90: 6127 5d29 0a0a 2020 2020 2320 656d 6f6a  a'])..    # emoj
+00021fa0: 6927 7320 6172 6520 6469 7370 6c61 7965  i's are displaye
+00021fb0: 640a 2020 2020 6173 7365 7274 2064 6174  d.    assert dat
+00021fc0: 6173 6574 5b27 7469 746c 6527 5d20 3d3d  aset['title'] ==
+00021fd0: 2027 f09f 9884 270a 2020 2020 6173 7365   '....'.    asse
+00021fe0: 7274 2064 6174 6173 6574 5b27 6d65 7373  rt dataset['mess
+00021ff0: 6167 6527 5d20 3d3d 2027 f09f 9883 270a  age'] == '....'.
+00022000: 0a20 2020 206d 6f63 6b5f 706f 7374 2e72  .    mock_post.r
+00022010: 6573 6574 5f6d 6f63 6b28 290a 0a20 2020  eset_mock()..   
+00022020: 2023 0a20 2020 2023 2045 6e66 6f72 6365   #.    # Enforce
+00022030: 2074 6865 2064 6973 6162 6c69 6e67 206f   the disabling o
+00022040: 6620 656d 6f6a 6973 0a20 2020 2023 0a0a  f emojis.    #..
+00022050: 2020 2020 2320 5365 7420 6f75 7220 696e      # Set our in
+00022060: 7465 7270 7265 7420 656d 6f6a 6927 7320  terpret emoji's 
+00022070: 666c 6167 0a20 2020 2061 7373 6574 203d  flag.    asset =
+00022080: 2041 7070 7269 7365 4173 7365 7428 696e   AppriseAsset(in
+00022090: 7465 7270 7265 745f 656d 6f6a 6973 3d46  terpret_emojis=F
+000220a0: 616c 7365 290a 0a20 2020 2023 2052 652d  alse)..    # Re-
+000220b0: 6372 6561 7465 206f 7572 206f 626a 6563  create our objec
+000220c0: 740a 2020 2020 6170 5f6f 626a 203d 2041  t.    ap_obj = A
+000220d0: 7070 7269 7365 2861 7373 6574 3d61 7373  pprise(asset=ass
+000220e0: 6574 290a 0a20 2020 2023 204c 6f61 6420  et)..    # Load 
+000220f0: 6f75 7220 6f62 6a65 6374 0a20 2020 2061  our object.    a
+00022100: 705f 6f62 6a2e 6164 6428 276a 736f 6e3a  p_obj.add('json:
+00022110: 2f2f 6c6f 6361 6c68 6f73 7427 290a 2020  //localhost').  
+00022120: 2020 6173 7365 7274 206c 656e 2861 705f    assert len(ap_
+00022130: 6f62 6a29 203d 3d20 310a 0a20 2020 2061  obj) == 1..    a
+00022140: 7373 6572 7420 6170 5f6f 626a 2e6e 6f74  ssert ap_obj.not
+00022150: 6966 7928 7469 746c 653d 7469 746c 652c  ify(title=title,
+00022160: 2062 6f64 793d 626f 6479 2920 6973 2054   body=body) is T
+00022170: 7275 650a 2020 2020 6173 7365 7274 206d  rue.    assert m
+00022180: 6f63 6b5f 706f 7374 2e63 616c 6c5f 636f  ock_post.call_co
+00022190: 756e 7420 3d3d 2031 0a0a 2020 2020 6465  unt == 1..    de
+000221a0: 7461 696c 7320 3d20 6d6f 636b 5f70 6f73  tails = mock_pos
+000221b0: 742e 6361 6c6c 5f61 7267 735f 6c69 7374  t.call_args_list
+000221c0: 5b30 5d0a 2020 2020 6461 7461 7365 7420  [0].    dataset 
+000221d0: 3d20 6a73 6f6e 2e6c 6f61 6473 2864 6574  = json.loads(det
+000221e0: 6169 6c73 5b31 5d5b 2764 6174 6127 5d29  ails[1]['data'])
+000221f0: 0a0a 2020 2020 2320 4469 7361 626c 6564  ..    # Disabled
+00022200: 202d 206e 6f20 656d 6f6a 6973 0a20 2020   - no emojis.   
+00022210: 2061 7373 6572 7420 6461 7461 7365 745b   assert dataset[
+00022220: 2774 6974 6c65 275d 203d 3d20 7469 746c  'title'] == titl
+00022230: 650a 2020 2020 6173 7365 7274 2064 6174  e.    assert dat
+00022240: 6173 6574 5b27 6d65 7373 6167 6527 5d20  aset['message'] 
+00022250: 3d3d 2062 6f64 790a 0a20 2020 206d 6f63  == body..    moc
+00022260: 6b5f 706f 7374 2e72 6573 6574 5f6d 6f63  k_post.reset_moc
+00022270: 6b28 290a 0a20 2020 2023 0a20 2020 2023  k()..    #.    #
+00022280: 2045 6e66 6f72 6365 2074 6865 2064 6973   Enforce the dis
+00022290: 6162 6c69 6e67 206f 6620 656d 6f6a 6973  abling of emojis
+000222a0: 0a20 2020 2023 0a0a 2020 2020 2320 5365  .    #..    # Se
+000222b0: 7420 6f75 7220 696e 7465 7270 7265 7420  t our interpret 
+000222c0: 656d 6f6a 6927 7320 666c 6167 0a20 2020  emoji's flag.   
+000222d0: 2061 7373 6574 203d 2041 7070 7269 7365   asset = Apprise
+000222e0: 4173 7365 7428 696e 7465 7270 7265 745f  Asset(interpret_
+000222f0: 656d 6f6a 6973 3d46 616c 7365 290a 0a20  emojis=False).. 
+00022300: 2020 2023 2052 652d 6372 6561 7465 206f     # Re-create o
+00022310: 7572 206f 626a 6563 740a 2020 2020 6170  ur object.    ap
+00022320: 5f6f 626a 203d 2041 7070 7269 7365 2861  _obj = Apprise(a
+00022330: 7373 6574 3d61 7373 6574 290a 0a20 2020  sset=asset)..   
+00022340: 2023 204c 6f61 6420 6f75 7220 6f62 6a65   # Load our obje
+00022350: 6374 0a20 2020 2061 705f 6f62 6a2e 6164  ct.    ap_obj.ad
+00022360: 6428 276a 736f 6e3a 2f2f 6c6f 6361 6c68  d('json://localh
+00022370: 6f73 743f 656d 6f6a 6973 3d79 6573 2729  ost?emojis=yes')
+00022380: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
+00022390: 6170 5f6f 626a 2920 3d3d 2031 0a0a 2020  ap_obj) == 1..  
+000223a0: 2020 6173 7365 7274 2061 705f 6f62 6a2e    assert ap_obj.
+000223b0: 6e6f 7469 6679 2874 6974 6c65 3d74 6974  notify(title=tit
+000223c0: 6c65 2c20 626f 6479 3d62 6f64 7929 2069  le, body=body) i
+000223d0: 7320 5472 7565 0a20 2020 2061 7373 6572  s True.    asser
+000223e0: 7420 6d6f 636b 5f70 6f73 742e 6361 6c6c  t mock_post.call
+000223f0: 5f63 6f75 6e74 203d 3d20 310a 0a20 2020  _count == 1..   
+00022400: 2064 6574 6169 6c73 203d 206d 6f63 6b5f   details = mock_
+00022410: 706f 7374 2e63 616c 6c5f 6172 6773 5f6c  post.call_args_l
+00022420: 6973 745b 305d 0a20 2020 2064 6174 6173  ist[0].    datas
+00022430: 6574 203d 206a 736f 6e2e 6c6f 6164 7328  et = json.loads(
+00022440: 6465 7461 696c 735b 315d 5b27 6461 7461  details[1]['data
+00022450: 275d 290a 0a20 2020 2023 2044 6973 6162  '])..    # Disab
+00022460: 6c65 6420 2d20 6e6f 2065 6d6f 6a69 730a  led - no emojis.
+00022470: 2020 2020 6173 7365 7274 2064 6174 6173      assert datas
+00022480: 6574 5b27 7469 746c 6527 5d20 3d3d 2074  et['title'] == t
+00022490: 6974 6c65 0a20 2020 2061 7373 6572 7420  itle.    assert 
+000224a0: 6461 7461 7365 745b 276d 6573 7361 6765  dataset['message
+000224b0: 275d 203d 3d20 626f 6479 0a0a 2020 2020  '] == body..    
+000224c0: 6d6f 636b 5f70 6f73 742e 7265 7365 745f  mock_post.reset_
+000224d0: 6d6f 636b 2829 0a                        mock().
```

### Comparing `apprise-1.7.6/test/var/01_test_example.html` & `apprise-1.8.0/test/var/01_test_example.html`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/var/apprise-test.gif` & `apprise-1.8.0/test/var/apprise-test.gif`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/var/apprise-test.jpeg` & `apprise-1.8.0/test/var/apprise-test.jpeg`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/var/apprise-test.mp4` & `apprise-1.8.0/test/var/apprise-test.mp4`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/var/apprise-test.png` & `apprise-1.8.0/test/var/apprise-test.png`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/var/fcm/service_account-bad-type.json` & `apprise-1.8.0/test/var/fcm/service_account-bad-type.json`

 * *Files identical despite different names*

### Comparing `apprise-1.7.6/test/var/fcm/service_account.json` & `apprise-1.8.0/test/var/fcm/service_account.json`

 * *Files identical despite different names*

